<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta name="baidu-site-verification" content="UqlC4pwKIm" />
  <meta name="baidu-site-verification" content="d3U0dGeqGw" />
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.cat.net/css?family=Roboto Slab:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="设计模式,常用设计模式," />





  <link rel="alternate" href="/atom.xml" title="渡口一艘船" type="application/atom+xml" />






<meta name="description" content="0x00 概述学习设计模式是一个漫长的过程，也是一个程序员登堂入室的必经之路。这篇博文就是记录学习设计模式的过程,会持续更新(属于天狼星计划的一部分，严肃脸)，每个模式都有对应的学习代码，学习在https://github.com/xsfelvis/DesignPattern.git 0x01 大纲    创建型 结构型 行为型     对象 Factory Method Adapter_Cla">
<meta name="keywords" content="设计模式,常用设计模式">
<meta property="og:type" content="article">
<meta property="og:title" content="常用设计模式">
<meta property="og:url" content="https://xsfelvis.github.io/2016/11/16/设计模式学习/index.html">
<meta property="og:site_name" content="渡口一艘船">
<meta property="og:description" content="0x00 概述学习设计模式是一个漫长的过程，也是一个程序员登堂入室的必经之路。这篇博文就是记录学习设计模式的过程,会持续更新(属于天狼星计划的一部分，严肃脸)，每个模式都有对应的学习代码，学习在https://github.com/xsfelvis/DesignPattern.git 0x01 大纲    创建型 结构型 行为型     对象 Factory Method Adapter_Cla">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://ogopjinry.bkt.clouddn.com/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F">
<meta property="og:image" content="http://ogopjinry.bkt.clouddn.com/abstract%20factory.jpg">
<meta property="og:image" content="http://ogopjinry.bkt.clouddn.com/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F.jpg">
<meta property="og:image" content="http://ogopjinry.bkt.clouddn.com/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F.jpeg">
<meta property="og:image" content="http://ogopjinry.bkt.clouddn.com/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F.jpeg">
<meta property="og:image" content="http://ogopjinry.bkt.clouddn.com/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F.png">
<meta property="og:image" content="http://ogopjinry.bkt.clouddn.com/%E5%A4%8D%E6%9D%82%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F.png">
<meta property="og:image" content="http://ogopjinry.bkt.clouddn.com/state.jpg">
<meta property="og:image" content="http://ogopjinry.bkt.clouddn.com/Observer.jpg">
<meta property="og:image" content="http://ogopjinry.bkt.clouddn.com/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F.jpg">
<meta property="og:updated_time" content="2018-06-04T04:55:24.485Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="常用设计模式">
<meta name="twitter:description" content="0x00 概述学习设计模式是一个漫长的过程，也是一个程序员登堂入室的必经之路。这篇博文就是记录学习设计模式的过程,会持续更新(属于天狼星计划的一部分，严肃脸)，每个模式都有对应的学习代码，学习在https://github.com/xsfelvis/DesignPattern.git 0x01 大纲    创建型 结构型 行为型     对象 Factory Method Adapter_Cla">
<meta name="twitter:image" content="http://ogopjinry.bkt.clouddn.com/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://xsfelvis.github.io/2016/11/16/设计模式学习/"/>





  <title>常用设计模式 | 渡口一艘船</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-120283281-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?2a3365c396bc1892919405bfc6ea04a8";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">渡口一艘船</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">不积跬步，无以至千里；不积小流，无以成江海</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xsfelvis.github.io/2016/11/16/设计模式学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="云来">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渡口一艘船">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">常用设计模式</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-11-16T00:00:00+08:00">
                2016-11-16
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-06-04T12:55:24+08:00">
                2018-06-04
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/设计模式/" itemprop="url" rel="index">
                    <span itemprop="name">设计模式</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2016/11/16/设计模式学习/" class="leancloud_visitors" data-flag-title="常用设计模式">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4,916
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  18
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <script src="/assets/js/APlayer.min.js"> </script><h2 id="0x00-概述"><a href="#0x00-概述" class="headerlink" title="0x00 概述"></a>0x00 概述</h2><p>学习设计模式是一个漫长的过程，也是一个程序员登堂入室的必经之路。这篇博文就是记录学习设计模式的过程,会持续更新(属于<code>天狼星</code>计划的一部分，严肃脸)，<code>每个模式都有对应的学习代码</code>，学习在<a href="https://github.com/xsfelvis/DesignPattern.git" target="_blank" rel="noopener">https://github.com/xsfelvis/DesignPattern.git</a></p>
<h2 id="0x01-大纲"><a href="#0x01-大纲" class="headerlink" title="0x01 大纲"></a>0x01 大纲</h2><table>
<thead>
<tr>
<th></th>
<th style="text-align:center">创建型</th>
<th>结构型</th>
<th style="text-align:right">行为型</th>
</tr>
</thead>
<tbody>
<tr>
<td>对象</td>
<td style="text-align:center">Factory Method</td>
<td>Adapter_Class</td>
<td style="text-align:right">Interpreter<br>Template Method</td>
</tr>
<tr>
<td>类</td>
<td style="text-align:center">Abstract Factory <br> Builder <br> Prototype <br> Singleton</td>
<td>Adapter_Object <br>Bridge<br>Composite<br> Decorator<br>Facade<br> Flyweight<br>Proxy</td>
<td style="text-align:right">Chain of Responsibility<br>Command<br> Iterator<br>Mediator<br> Memento<br>Observer<br> State<br>Strategy<br> Visitor</td>
</tr>
</tbody>
</table>
<h2 id="0x02-Factory-Method-简单工厂方法"><a href="#0x02-Factory-Method-简单工厂方法" class="headerlink" title="0x02 Factory Method (简单工厂方法)"></a>0x02 Factory Method (简单工厂方法)</h2><blockquote>
<p>Factory Method (简单工厂方法)</p>
</blockquote>
<p>又称简单工厂模式或者静态工厂模式</p>
<ul>
<li>使用动机</li>
</ul>
<p>定义一个用于创建对象的接口，让子类决定去实例化哪一个类。Factory Method使用一个类的实例化延迟到其子类。</p>
<ul>
<li>通用UML图</li>
</ul>
<p><img src="http://ogopjinry.bkt.clouddn.com/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F" alt="工厂模式"></p>
<p>这个uml基本概括了工厂模式的核心，其他的都是可以根据这个衍生发展。</p>
<p>主要分为4大模块，</p>
<p><code>抽象工厂</code>：其为工厂方法模式的核心；</p>
<p><code>具体工厂</code>：体现实现具体的业务逻辑</p>
<p><code>抽象产品</code>：是工厂方法模式所创建的产品的父类</p>
<p><code>具体产品</code>：实现抽象产品的某个具体产品的对象</p>
<ul>
<li>适用场景</li>
</ul>
<ol>
<li>当一个类不知道它所必须创建对象类的时候</li>
<li>当一个类希望由它的子类来指定它所创建的对象的时候</li>
<li>当类将创建对象的职责委托给多个帮助子类中的某一个，并且你希望将哪一个帮助子类是代理者这一信息局部化的时候</li>
</ol>
<ul>
<li>要点分析</li>
</ul>
<blockquote>
<p>工厂根据type生成对应示例</p>
</blockquote>
<p>在最简单的工厂中，往往传入产品的type，然后得到具体的产品示例。在我们金融app中分享部分的代码就是按照这个思路来处理的(代码已经脱敏)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onShareButtonClick</span><span class="params">(<span class="keyword">int</span> btnType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (btnType)&#123;</span><br><span class="line">            <span class="keyword">case</span> R.id.weixin:</span><br><span class="line">                client = ShareFactory.getClient(<span class="keyword">this</span>, ShareFactory.ClientEnum.wx);</span><br><span class="line">                ((WXClient) client).setType(SendMessageToWX.Req.WXSceneSession);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">                    ……</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看出通过在工厂中定义一个枚举类型，然后根据传入的type生成对应的示例</p>
<blockquote>
<p>传入class 根据反射更加简洁的生产出具体产品</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 抽象工厂方法</span></span><br><span class="line"><span class="comment"> * 具体交由子类实现</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory</span> </span>&#123;</span><br><span class="line">    <span class="comment">//public abstract Product createProduct();</span></span><br><span class="line">    <span class="comment">//使用抽象类</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> &lt;T extends Product&gt; <span class="function">T <span class="title">createProduct</span><span class="params">(Class&lt;T&gt; clz)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 具体工厂实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreateFactory</span> <span class="keyword">extends</span> <span class="title">Factory</span></span>&#123;</span><br><span class="line">    <span class="comment">//根据传入的class通过反射取得</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T extends Product&gt; <span class="function">T <span class="title">createProduct</span><span class="params">(Class&lt;T&gt; clz)</span> </span>&#123;</span><br><span class="line">        Product product = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            product = (Product) (Class.forName(clz.getName())).newInstance();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (T) product;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*@Override</span></span><br><span class="line"><span class="comment">    public Product createProduct() &#123;</span></span><br><span class="line"><span class="comment">        return new ProductA();</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>具体使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestClient</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Factory factory = <span class="keyword">new</span> ConcreateFactory();</span><br><span class="line">        <span class="comment">//Product product = new ProductA();</span></span><br><span class="line">        Product product = factory.createProduct(ProductA.class);</span><br><span class="line">        product.method();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>工厂方法模式 降低了对象之间的耦合度，而且依赖于抽象的架构，扩展性比较好</p>
</blockquote>
<h2 id="0x03-Abstract-Factory-抽象工厂模式"><a href="#0x03-Abstract-Factory-抽象工厂模式" class="headerlink" title="0x03 Abstract Factory(抽象工厂模式)"></a>0x03 Abstract Factory(抽象工厂模式)</h2><blockquote>
<p>Abstract Factory(抽象工厂模式)</p>
</blockquote>
<ul>
<li>使用动机</li>
</ul>
<p>提供一个创建一些列相关或相互依赖对象的接口,而无需指定它们的具体类</p>
<p>相比之前的工厂都是生产具体的产品，抽象工厂生产的产品是不确定的。起源于操作系统的图形化结业方案，每个操作系统都是一个产品类，而各自的按钮与文本框也是构成一个产品类，这两种产品都有自己的特性，如android和ios的Button和TextView等。</p>
<ul>
<li>通用UML图</li>
</ul>
<p><img src="http://ogopjinry.bkt.clouddn.com/abstract%20factory.jpg" alt="abstract factory"></p>
<p>跟普通工厂一样，主要的类还是4个：</p>
<p><code>AbstractFactroy</code>：抽象工厂角色，声明了一组用于创建一种产品的方法，每个方法对应一种产品。</p>
<p><code>ConcreateFactroy</code>：具体工厂角色，实现在抽象工厂中定义的产品的方法，生成一组具体产品，这些产品构成一个产品种类，每个产品都位于某个产品等级结构中，如ConcreateFactroy1和ConcreateFactroy2。</p>
<p><code>AbstractProduct</code>：抽象产品角色，它为每种产品声明接口，如AbstractProductA和AbstractProductB。</p>
<p><code>ConcreateProduct</code>：具体产品角色，它定义具体工厂生产的具体产品对象，实现抽象产品接口中声明的业务方法。</p>
<ul>
<li><p>适用场景</p>
<ol>
<li>一个系统要独立于它的产品的创建、组合和表示</li>
<li>一个系统要由多个产品系列中的一个来配置时</li>
<li>当需要强调一系列相关的产品对象的设计以便进行联合使用</li>
<li>当提供一个产品类库，只想显示它们接口而不是实现</li>
</ol>
</li>
</ul>
<p>缺点：</p>
<p>抽象工厂的缺点就是随着工厂类增多而导致类文件非常多，这个在实际开发中要权衡使用</p>
<h2 id="0x04-Builder-建造者模式"><a href="#0x04-Builder-建造者模式" class="headerlink" title="0x04 Builder(建造者模式)"></a>0x04 Builder(建造者模式)</h2><ul>
<li>使用动机</li>
</ul>
<p>将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示</p>
<ul>
<li>适用场景</li>
</ul>
<ol>
<li>当要实例化的类是在运行时刻指定时，例如，通过动态装载；</li>
<li>为了避免创建一个与产品类层次平行的工厂类层次时；</li>
<li>当一个类的实例只能有几个不同状态组合中的一种时，建立相应得原型并克隆它们可能比每次用合适的状态手工实例化该类更方便一些。</li>
</ol>
<ul>
<li>通用UML图</li>
</ul>
<p><img src="http://ogopjinry.bkt.clouddn.com/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F.jpg" alt="Builder"></p>
<p>建造者模式通常也是有4大部分组成</p>
<p>Product产品类: 产品的抽象类</p>
<p>Builder: 抽象Builder类，规范产品的组建，一般是由子类实现具体的构建过程</p>
<p>ConcreateBuilder： 具体的Builder类</p>
<p>Director： 统一组装过程</p>
<ul>
<li>要点分析</li>
</ul>
<blockquote>
<p>链式调用</p>
</blockquote>
<p>通常在开发中，Director可以当做内部类来处理，直接使用一个Builder来进行对象的组装，这个Buidler通常称为链式调用，它的关键点是每个setter方法都返回自身即<code>return this</code> 这样就使得setter方法可以称为链式调用，套路如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">new</span> TestBuilder().setA(<span class="string">"A"</span>).setB(<span class="string">"B"</span>).create();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Dialog的经典实现</p>
</blockquote>
<h2 id="0x05-单例模式"><a href="#0x05-单例模式" class="headerlink" title="0x05 单例模式"></a>0x05 单例模式</h2><ul>
<li>使用动机</li>
</ul>
<p>保证一个类仅有一个实例，而且自行实例化并向整个系统提供这个实例</p>
<ul>
<li>使用场景</li>
</ul>
<ol>
<li>当类只能有一个实例而且客户可以从一个众所周知的访问点访问它时</li>
<li>当这个唯一实例应该是通过子类化可以扩展，并且客户应该无需更改代码就可以使用一个扩展的实例时</li>
</ol>
<ul>
<li>核心UML图</li>
</ul>
<p><img src="http://ogopjinry.bkt.clouddn.com/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F.jpeg" alt=""></p>
<p>核心角色有2个</p>
<p><code>Client</code>  高层客户端<br><code>Singleton</code> 单例类</p>
<ul>
<li>要点分析</li>
</ul>
<ol>
<li>构造函数不对外开放，一般为Private</li>
<li>通过一个静态方法或者枚举类返回单例类对象</li>
<li>确保单例类的对象有且只有一个，尤其是在多线程的环境下</li>
<li>确保单例类对象在反序列化是不会重新构建对象</li>
<li>实现方式：</li>
</ol>
<p>单例看似简单，其实很有门道的，常见的比如<code>饿汉模式</code>、<code>懒汉模式</code> 、<code>双重检验(valtile)</code>等，下面将一一道来。</p>
<blockquote>
<p>饿汉模式&amp;懒汉模式</p>
</blockquote>
<p>首先需要介绍下什么是<code>延迟加载</code>，即等到真正使用的时候才去创建实例，不用的时候不去创建实例。</p>
<p>因此从速度和反应时间角度来看，非延时加载(饿汉模式)好,从资源利用率上看，延时加载(又称懒汉模式)好。<br>先从两个简单的入手：</p>
<p>第一种：非延时加载(饿汉模式)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HungrySingleton</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HungrySingleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> HungrySingleton instance = <span class="keyword">new</span> HungrySingleton();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> HungrySingleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第二种：同步延迟加载(懒汉模式)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LazySingleton</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LazySingleton instance = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LazySingleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> LazySingleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> LazySingleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>双重检验(valtile) 同步延时加载</p>
</blockquote>
<p>第三种：双重检测同步延迟加载(懒汉模式)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DCSingleton</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span>  <span class="keyword">static</span>  DCSingleton instance = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DCSingleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DCSingleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(instance==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (DCSingleton.class)&#123;</span><br><span class="line">                <span class="keyword">if</span>(instance==<span class="keyword">null</span>)&#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> DCSingleton();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>  instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第二种单例方式在java中会行不通的，可以看到上面的代码对instance进行二次检查，第一层判断是为了避免不必要的同步，第二层判断是为了在null情况下创建实例，目的是避开过多的同步，需要声明instance时定义为volatile即可。java中之所以需要双重加锁进行单例，是由于java内存模型允许<code>无序写入</code>，假设未加上关键字volatile时，执行到instance=new Singleton()时，实际上它并不是一个原子操作，会被编译成多条汇编指令，大致做了3件事：</p>
<p>(1)给DCSingleton 的实例分配内存<br>(2)调用DCSingleton()的构造函数，初始化成员字段<br>(3)将instance对象指向分配的内存空间(此时instance就不是null)</p>
<p>由于java编译器<code>无序写入</code>，Cache、寄存器到主内存的回写顺序，上面第二第三条顺序是无法保证的，即可以是1-2-3也有可能是1-3-2，如果是后者，并且在3执行完毕、2未执行之前，被切换到线程B上，此时A线程已经执行了第三点，instance已经是非空了，B线程直接取走instance再使用时就会报错，这就是DCL失效的问题。而加上volatile关键字则禁止了指令的重排序从而避免了这个问题。</p>
<blockquote>
<p>更加优雅的单例</p>
</blockquote>
<p>DLC并不优雅，在《java 并发编程实践》一书中建议使用下面的单例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BetterSingleton</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BetterSingleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BetterSingleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> BetterSingleton instance = <span class="keyword">new</span> BetterSingleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这种方式当第一次加载是不会初始化实例instance，只有第一次调用getInstance方法时才会导致instance被初始化。这样不会能够确保线程安全，也能够保证单例对象的唯一性，同时也延时了单例的实例化，这是推荐的单例模式实现方式</p>
<blockquote>
<p>使用容器实现单例模式</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonManager</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String,Object&gt; objMap = <span class="keyword">new</span> Hashtable&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SingletonManager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">registerService</span><span class="params">(String key,Object instance)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!objMap.containsKey(key))&#123;</span><br><span class="line">            objMap.put(key,instance);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getService</span><span class="params">(String key)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> objMap.get(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以在程序的初始将多种单例类型注入到一个统一的管理类中，在使用时根据key获取对象对应类型的对象，这种方式使得我们可以管理多种类型的单例，并且在使用可以通过统一的接口进行获取操作，降低了用户的成本，也对用户隐藏了具体实现，降低了耦合度。</p>
<h2 id="0x06-策略模式"><a href="#0x06-策略模式" class="headerlink" title="0x06 策略模式"></a>0x06 策略模式</h2><ul>
<li>使用动机</li>
</ul>
<p>策略模式定义了一些列的算法，并将每一个算法封装起来，而且使他们可以相互替换。。策略模式让算法独立于使用它的客户端而独立变化。</p>
<ul>
<li>使用场景</li>
</ul>
<ol>
<li>针对同一问题的多种处理方式，仅仅是具体行为有差别时</li>
<li>需要安全地封装多种同一类型的操作时</li>
<li>出现同一抽象类有多个子类，而又需要使用if-else或者switch-case来选择具体子类时</li>
</ol>
<ul>
<li>核心UML图</li>
</ul>
<p><img src="http://ogopjinry.bkt.clouddn.com/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F.jpeg" alt="策略模式"></p>
<p>策略模式主要有3个核心</p>
<p><code>Context</code>: 用来操作策略的上下文环境</p>
<p><code>Stragety</code>:策略的抽象</p>
<p><code>ConcreateStragetyX</code>:具体策略的实现</p>
<ul>
<li>要点分析</li>
</ul>
<blockquote>
<p>通过一个Context(实际中可能称作Manager/Controller)结合注入的方式来管理不同的策略</p>
<p>干掉了多余的if-else</p>
<p>可扩展性变得很强</p>
</blockquote>
<p>缺点： 随着策略的增加，子类会变得繁多</p>
<h2 id="0x07责任链模式"><a href="#0x07责任链模式" class="headerlink" title="0x07责任链模式"></a>0x07责任链模式</h2><ul>
<li>动机</li>
</ul>
<p>使很多对象都有机会处理请求，从而避免请求的发送者和接受者之间的耦合关系，将这些对象连成一条链，并沿着这条链条传递，直到有一个对象处理它为止。</p>
<ul>
<li>使用场景</li>
</ul>
<ol>
<li>有多个的对象可以处理一个请求，哪个对象处理该请求，运行时刻自动确定</li>
<li>你想在不明确指定接收者的情况下，向多个对象中的一个提交一个请求<br>3.可处理一个请求的对象集合应被动态指定</li>
</ol>
<ul>
<li>核心UML</li>
</ul>
<p><img src="http://ogopjinry.bkt.clouddn.com/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F.png" alt="责任链模式"></p>
<p>主要抽象成两个角色：</p>
<p><code>Hanlder</code>: 抽象处理者角色，声明一个请求处理的方法，并在其中保持Handler对象的引用</p>
<p><code>ConcreateHanlder</code>: 具体处理者角色，对请求进行处理，如果不能处理则将该请求转发给下一个节点上的对象处理</p>
<ul>
<li>要点分析</li>
</ul>
<blockquote>
<p>精髓在与保持Handler对象的引用</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> Handler successor;<span class="comment">//下一节点的处理者</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(String condition)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>通常，责任链中的请求和处理规则是不尽相同的，在这种请求下可以将请求进行封装，同时对请求的处理规则也进行封装作为一个独立的对象</p>
</blockquote>
<p>下面将介绍一下基于核心UML的稍微复杂的扩展，UML图如下：</p>
<p><img src="http://ogopjinry.bkt.clouddn.com/%E5%A4%8D%E6%9D%82%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F.png" alt="复杂责任链"></p>
<blockquote>
<p>android源码中最典型就是Touch事件的分发</p>
<p>可以借鉴责任链的思想来优化 有序广播</p>
<p>优缺点</p>
</blockquote>
<ol>
<li><p>最大的缺点就是对链中请求的遍历，如果处理者爱多那么遍历必定会影响性能，特别是在一些递归调用中，需要谨慎使用</p>
</li>
<li><p>优点显而易见，就是请求者和处理者的关系解耦</p>
</li>
</ol>
<h2 id="0x07-状态模式"><a href="#0x07-状态模式" class="headerlink" title="0x07 状态模式"></a>0x07 状态模式</h2><ul>
<li>使用动机</li>
</ul>
<p>允许一个对象再起内部状态改变时改变它的行为，这个对象看起来像是改变了其类</p>
<ul>
<li>使用场景</li>
</ul>
<ol>
<li>一个对象的行为取决于它的状态，并且它必须在运行时根据状态改变它的行为</li>
<li>代码中包含大量与对象状态有关的条件语句，且这些分值依赖于该对象的状态。状态模式将每一个条件分值放入一个独立的类中，使得可以根据对象自身情况将对象的状态作为一个对象，这个对象可以不依赖于其他对象而独立变化，这样通过多态来去除过多的、重复的if-else等分支语句</li>
</ol>
<ul>
<li>核心UML图</li>
</ul>
<p><img src="http://ogopjinry.bkt.clouddn.com/state.jpg" alt="state"></p>
<p>抽象成3和核心角色</p>
<p><code>Context</code>: 环境类，定义客户感兴趣的接口，维护一个State子类实例，这个子类定义了对象当前的状态</p>
<p><code>State</code>: 抽象状态类或者状态接口，定义一个或者一组接口，表示该状态下的行为</p>
<p><code>ConcreateX</code>: 具体状态类，每一个具体的状态类实现抽象State中定义的接口，从而达到不同的行为</p>
<ul>
<li>要点分析</li>
</ul>
<ol>
<li>状态模式的关键是在不同的状态下对于同一行为在不同状态下有着不同的响应</li>
</ol>
<h2 id="0x08-观察者模式"><a href="#0x08-观察者模式" class="headerlink" title="0x08 观察者模式"></a>0x08 观察者模式</h2><ul>
<li>使用动机</li>
</ul>
<p>定义对象间一种一对多的依赖关系，使得每当一个对象改变状态，则所有依赖于它的对象都会得到通知并且被自动更新</p>
<ul>
<li>使用场景</li>
</ul>
<ol>
<li>关联行为场景，需要注意的是关联行为是可拆分的，而不是组合关系</li>
<li>事件多级触发场景</li>
<li>跨系统的消息交换场景，如消息队列，事件总线的处理机制</li>
</ol>
<ul>
<li>核心UML图</li>
</ul>
<p><img src="http://ogopjinry.bkt.clouddn.com/Observer.jpg" alt="Observer"></p>
<p>核心为2个</p>
<p><code>Observer</code>:抽象观察者，该角色是观察者的抽象类，它定义了一个更新接口，使得在主题更改时通知更新自己</p>
<p><code>ConcreateObserver</code>: 具体的观察者，该角色实现抽象观察者角色所定义的更新接口，以便在主题的状态发生改变时更新自己</p>
<ul>
<li>要点分析</li>
</ul>
<p>1.在java中观察者可以继承Observer,发布者可以继承Observable来迅速实现</p>
<p>2.观察者模式最经典的就是listview的adapter，当然也有EventBus这种事件总线的库也是采用观察者模式</p>
<blockquote>
<p>Note：</p>
<p><code>Step1</code>在ListView中设置Adapter时会构建一个AdapterDataSetObserver,并且注册到Adapter中，这就是一个<code>观察者</code>。Adapter中包含一个数据集<code>可观察者</code>DataSetObservable。<br><code>Step2</code> 在数据发生变更时，开发者手动调用Adapter.notifyDataSetChanged,而notifyDataSetChanged会去调用notifyChanged函数，该函数会遍历所有观察者的onChanged函数。<br><code>Step3</code> 在AdapterDataSetObserver的onChanged函数中会获取Adapter中数据集的新数据，然后调用ListView的requestLayout()方法重新布局更新用户界面</p>
</blockquote>
<h2 id="0x09-代理模式"><a href="#0x09-代理模式" class="headerlink" title="0x09 代理模式"></a>0x09 代理模式</h2><ul>
<li>使用动机</li>
</ul>
<p>为其他对象提供一种代理以控制这个对象的访问。</p>
<ul>
<li>适用场景</li>
</ul>
<ol>
<li>当无法或者不想直接访问某个对象或者访问某个对象存在困难时可以通过一个代理对象来间接访问，为了保证客户端使用的透明性，委托对象与代理对象需要实现相同的接口</li>
</ol>
<ul>
<li>核心UML图</li>
</ul>
<p><img src="http://ogopjinry.bkt.clouddn.com/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F.jpg" alt="代理模式"></p>
<p>主要有3个角色组成：<br><code>Subject</code>:抽象主题类,该类主要职责是声明真实主题与代理的共同接口方法，该类既可以是一个接口也可以是一个接口</p>
<p><code>RealSubject</code>:真实主题类,该类也被称为委托类或被代理类，该类定义了代理表示的真实对象，由其执行具体的业务逻辑方法。</p>
<p><code>ProxSubject</code>:代理类,该类也称为委托类，该类持有一个对真实主题类的引用,在其所实现的接口方法中调用真实主题类中相应的接口方法执行，以此起到代理的作用</p>
<p><code>Client</code>: 客户类，即使用代理类的类型</p>
<ul>
<li>要点分析</li>
</ul>
<ol>
<li>通常代理模式分为<code>静态代理</code>、<code>动态代理</code>,静态代理即在我们的代码运行前代理类的class编译文件就已经存在，而动态代理则与静态代理相反，通过反射机制动态地生成代理者对象，而java也给我们提供了一个便捷的动态代理接口InvocationHandler实现该接口需要重写其调用方法invoke</li>
<li>静态代理和动态代理只是从code方面来区分代理模式的两种方法，我们也可以通过适用范围来区分不同类型的代理实现<ul>
<li>远程代理(Remote Proxy):为某个对象在不同的内存地址空间提供局部代理，使系统可以将Server部分实现隐藏，以便Client可以不考虑Server的存在</li>
<li>虚拟代理(Virtual Proxy):虚拟代理经常直到我们真正需要一个对象时才创建它，当对象在创建前和创建中时，由虚拟代理来扮演对象的替身，对象创建后，代理就会将请求直接委托给对象</li>
<li>保护代理（Protection Proxy):使用代理控制对原始对象的访问,该类型的代理常用于原始对象有着不同的访问权限的情况<a href="http://blog.csdn.net/shuangde800/article/details/10381495" target="_blank" rel="noopener">保护模式实例</a></li>
</ul>
</li>
</ol>
<p>未完待续……</p>

      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    云来
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://xsfelvis.github.io/2016/11/16/设计模式学习/" title="常用设计模式">https://xsfelvis.github.io/2016/11/16/设计模式学习/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/设计模式/" rel="tag"># 设计模式</a>
          
            <a href="/tags/常用设计模式/" rel="tag"># 常用设计模式</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/11/13/设计模式入门/" rel="next" title="设计模式六大原则">
                <i class="fa fa-chevron-left"></i> 设计模式六大原则
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/11/28/粒子动画学习/" rel="prev" title="粒子动画效果">
                粒子动画效果 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zNzA1My8xMzU4OQ=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="云来" />
            
              <p class="site-author-name" itemprop="name">云来</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

			<!--my custom code begin-->
			<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.5.0/velocity.min.js"></script>
			<script type="text/javascript">
			  $("#sidebar").hover(function(){
				$("#mydivshow").velocity('stop').velocity({opacity: 1});
			  },function(){
				$("#mydivshow").velocity('stop').velocity({opacity: 0});
			  });
			</script>
			<div id="mydivshow" class="mydivshow">
			<!--my custom code end-->
			
          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">42</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">34</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/xsfelvis" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://blog.csdn.net/XSF50717" target="_blank" title="CSDN">
                    
                      <i class="fa fa-fw fa-csdn"></i>CSDN</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://juejin.im/user/5643754060b27f7a018bd10d" target="_blank" title="掘金">
                    
                      <i class="fa fa-fw fa-juejin"></i>掘金</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:xsfelvis@gmail.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            
          </div>

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友情链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://juejin.im/timeline" title="稀土掘金" target="_blank">稀土掘金</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://gank.io/" title="干货集中营" target="_blank">干货集中营</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://wanandroid.com/tools" title="玩Android" target="_blank">玩Android</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://tech.meituan.com/" title="美团点评" target="_blank">美团点评</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.androidblog.cn/about/" title="酷站" target="_blank">酷站</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://pingguohe.net/" title="苹果核" target="_blank">苹果核</a>
                  </li>
                
              </ul>
            </div>
          

          <div id="player1" class="aplayer"></div>
<script src="/js/src/APlayer.min.js"></script>
<script type="text/javascript">
var ap = new APlayer({
    element: document.getElementById('player1'),                       // Optional, player element
    narrow: false,                                                     // Optional, narrow style
    autoplay: false,                                                    // Optional, autoplay song(s), not supported by mobile browsers
    showlrc: 0,                                                        // Optional, show lrc, can be 0, 1, 2, see: ###With lrc
    mutex: true,                                                       // Optional, pause other players when this player playing
    theme: '#e6d0b2',                                                  // Optional, theme color, default: #b7daff
    mode: 'random',                                                    // Optional, play mode, can be `random` `single` `circulation`(loop) `order`(no loop), default: `circulation`
    preload: 'metadata',                                               // Optional, the way to load music, can be 'none' 'metadata' 'auto', default: 'auto'
    listmaxheight: '513px',                                             // Optional, max height of play list
    music: {                                                           // Required, music info, see: ###With playlist
        title: 'Summertime Sadness',                                          // Required, music title
        author: 'cover',                          // Required, music author
        url: 'http://www.170mv.com/kw/other.web.rb01.sycdn.kuwo.cn/resource/n2/71/36/4211820203.mp3',  // Required, music url
        pic: '/images/music.jpg',  // Optional, music picture
    }
});
</script>
        </div>
		<!--my custom code begin-->
		</div>
		<!--my custom code end-->
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x00-概述"><span class="nav-number">1.</span> <span class="nav-text">0x00 概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-大纲"><span class="nav-number">2.</span> <span class="nav-text">0x01 大纲</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-Factory-Method-简单工厂方法"><span class="nav-number">3.</span> <span class="nav-text">0x02 Factory Method (简单工厂方法)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-Abstract-Factory-抽象工厂模式"><span class="nav-number">4.</span> <span class="nav-text">0x03 Abstract Factory(抽象工厂模式)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04-Builder-建造者模式"><span class="nav-number">5.</span> <span class="nav-text">0x04 Builder(建造者模式)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x05-单例模式"><span class="nav-number">6.</span> <span class="nav-text">0x05 单例模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x06-策略模式"><span class="nav-number">7.</span> <span class="nav-text">0x06 策略模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x07责任链模式"><span class="nav-number">8.</span> <span class="nav-text">0x07责任链模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x07-状态模式"><span class="nav-number">9.</span> <span class="nav-text">0x07 状态模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x08-观察者模式"><span class="nav-number">10.</span> <span class="nav-text">0x08 观察者模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x09-代理模式"><span class="nav-number">11.</span> <span class="nav-text">0x09 代理模式</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">云来</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">103.2k</span>
  
</div>






  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a></div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  


<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>




  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("QFKdnKcTHhFexYDWSA4tMBzH-gzGzoHsz", "wq2r6eiGoNMmUhgBsA7hAO9a");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>

  

  
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.3"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.3"></script>


  
  <script type="text/javascript" src="/js/src/exturl.js?v=5.1.3"></script>


  <script src="/js/src/Aplayer-Controler.js"></script>
<div id="AP-controler"></div>
<script type="text/javascript">
var myapc=new APlayer_Controler({
		APC_dom:$('#AP-controler'),
		aplayer:ap, //此为绑定的aplayer对象
		attach_right:false,
		position:{top:'300px',bottom:''},
		fixed:true,
		btn_width:100,
		btn_height:120,
		img_src:['http://oty1v077k.bkt.clouddn.com/bukagirl.jpg',
				'http://oty1v077k.bkt.clouddn.com/jumpgirl.jpg',
				'http://oty1v077k.bkt.clouddn.com/pentigirl.jpg',
				'http://oty1v077k.bkt.clouddn.com/%E8%90%8C1.gif'],
		img_style:{repeat:'no-repeat',position:'center',size:'contain'},
		ctrls_color:'rgba(173,255,47,0.8)',
		ctrls_hover_color:'rgba(255,140,0,0.7)',
		tips_on:true,
		tips_width:140,
		tips_height:25,
		tips_color:'rgba(255,255,255,0.6)',
		tips_content:{},
		timeout:30
	});
</script>
  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>



</body>
</html>
