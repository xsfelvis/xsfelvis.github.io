<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ¸¡å£ä¸€è‰˜èˆ¹</title>
  
  <subtitle>ä¸ç§¯è·¬æ­¥ï¼Œæ— ä»¥è‡³åƒé‡Œï¼›ä¸ç§¯å°æµï¼Œæ— ä»¥æˆæ±Ÿæµ·</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://xsfelvis.github.io/"/>
  <updated>2019-04-19T03:14:43.952Z</updated>
  <id>https://xsfelvis.github.io/</id>
  
  <author>
    <name>äº‘æ¥</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>EasyAdapter</title>
    <link href="https://xsfelvis.github.io/2019/04/19/EasyAdapter/"/>
    <id>https://xsfelvis.github.io/2019/04/19/EasyAdapter/</id>
    <published>2019-04-18T16:00:00.000Z</published>
    <updated>2019-04-19T03:14:43.952Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h2 id="å¸¸è§„å†™æ³•çš„æ¢è®¨"><a href="#å¸¸è§„å†™æ³•çš„æ¢è®¨" class="headerlink" title="å¸¸è§„å†™æ³•çš„æ¢è®¨"></a>å¸¸è§„å†™æ³•çš„æ¢è®¨</h2><p>å¸¸è§„çš„å†™æ³•ï¼Œä¸ºäº†ä½¿ç”¨ <code>RecyclerView</code>ï¼Œå¿…é¡»æŒ‡å®šä¸€ä¸ª <code>adapter</code> å’Œ ä¸€ä¸ª <code>LayoutManager</code>ã€‚å…¶ä¸­è‡ªå®šä¹‰çš„ <code>adapter</code> å¿…é¡»ç»§æ‰¿è‡ª <code>RecyclerView.Adapter</code>ï¼Œå…¶ä¸­å¿…é¡»å®ç°å‡ ä¸ªæ¥å£ï¼š</p><ul><li><p>public ItemViewHolder onCreateViewHolder(ViewGroup viewGroup, int viewType)<br>åœ¨è¿™ä¸ªæ¥å£å½“ä¸­æ ¹æ®ç±»åˆ«åˆ›å»º <code>ViewHolder</code> å’Œ inflate <code>layout</code>ï¼Œè¦æ˜¯æœ‰å¤šä¸ªiteméœ€è¦å†™ä¸€å †if-else</p></li><li><p>public void onBindViewHolder(ItemViewHolder viewHolder, int position)æˆ–è€…</p><pre><code>public void onBindViewHolder(TRealViewHolder holder, int position, List&lt;Object&gt; payloads)&lt;br /&gt;</code></pre><p><br>åœ¨è¿™ä¸ªæ¥å£å½“ä¸­æ ¹æ®ä½ç½® <code>position</code> å–å‡ºå¯¹åº”çš„æ•°æ®ï¼Œå¹¶ç”¨äºåˆ·æ–° <code>viewHolder</code> é‡Œé¢çš„ <code>UI</code>ã€‚<br></p></li><li><p>public int getItemCount()<br>åœ¨è¿™ä¸ªæ¥å£å½“ä¸­æ ¹æ®ä½ç½®ä¿å­˜çš„æ•°æ®æ•°é‡æŒ‡å®šåˆ—è¡¨æ§ä»¶ <code>item</code> çš„æ•°é‡<br></p></li></ul><p><strong>å› æ­¤å¯ä»¥çœ‹å‡º</strong></p><ol><li>ğŸ‘†ä»¥ä¸Šå‡ ä¸ªæ¥å£çš„å¥—è·¯éƒ½æ˜¯å›ºå®šçš„ï¼Œå¯ä»¥åšä¸€å±‚ç»Ÿä¸€çš„å°è£…</li><li>å…¶æ¬¡ <code>onCreateViewHolder</code> å’Œ <code>onBindViewHolder</code> è¿˜ä¸è¶³ä»¥æ¸…æ™°ç›´è§‚çš„è¡¨è¾¾ <code>itemView</code> æ˜¯åˆ›å»ºè¿˜æ˜¯å¤ç”¨<br></li><li><code>Model</code> å’Œ <code>ViewHolder</code> ä¹‹é—´çš„æ˜ å°„å…³ç³»æ²¡æœ‰åšç¡¬æ€§è§„å®š</li></ol><p><a name="8a483843"></a></p><h2 id="é’ˆå¯¹æ”¹è¿›"><a href="#é’ˆå¯¹æ”¹è¿›" class="headerlink" title="é’ˆå¯¹æ”¹è¿›"></a>é’ˆå¯¹æ”¹è¿›</h2><ul><li>æ³¨è§£çš„æ–¹å¼åŠ è½½å¸ƒå±€         </li><li>å°†æ•°æ®å’Œè§†å›¾åˆ†ç¦»</li><li>æ›´åŠ æ¸…æ™°çš„holderå¤ç”¨</li></ul><p><a name="a491b1bc"></a></p><h3 id="1ã€æ³¨è§£çš„æ–¹å¼åŠ è½½å¸ƒå±€"><a href="#1ã€æ³¨è§£çš„æ–¹å¼åŠ è½½å¸ƒå±€" class="headerlink" title="1ã€æ³¨è§£çš„æ–¹å¼åŠ è½½å¸ƒå±€"></a>1ã€æ³¨è§£çš„æ–¹å¼åŠ è½½å¸ƒå±€</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EasyViewHolderAnnotation</span>(resId = R.layout.item_infoone)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InfoViewViewHolderOne</span> <span class="keyword">extends</span> <span class="title">BaseEasyViewHolder</span>&lt;<span class="title">ItemOneData</span>&gt; </span>&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">InfoViewViewHolderOne</span><span class="params">(Context context, View itemView, RecyclerView recyclerView)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, itemView, recyclerView);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">inflate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆå§‹åŒ–æ§ä»¶</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">refresh</span><span class="params">(EasyAdapterItem&lt;ItemOneData&gt; tAdapterItem)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (tAdapterItem == <span class="keyword">null</span> || tAdapterItem.getDataModel() == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ItemOneData model = tAdapterItem.getDataModel();</span><br><span class="line">        <span class="comment">//ä½¿ç”¨datamodelåˆ·æ–° UI</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a name="d3ba7598"></a></p><h3 id="2ã€æ•°æ®ä¸è§†å›¾åˆ†ç¦»"><a href="#2ã€æ•°æ®ä¸è§†å›¾åˆ†ç¦»" class="headerlink" title="2ã€æ•°æ®ä¸è§†å›¾åˆ†ç¦»"></a>2ã€æ•°æ®ä¸è§†å›¾åˆ†ç¦»</h3><p>ä¸¾ä¸ªä¾‹å­ ä¸Šé¢çš„InfoViewViewHolderOneéœ€è¦ä½¿ç”¨ ItemDataModelçš„æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InfoViewHolderItemOne</span> <span class="keyword">implements</span> <span class="title">EasyAdapterItem</span>&lt;<span class="title">ItemOneData</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ItemOneData mItemOneData;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">InfoViewHolderItemOne</span><span class="params">(ItemOneData goodInfo)</span> </span>&#123;</span><br><span class="line">        mItemOneData = goodInfo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getViewType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> VIEW_TYPE_INFO_ONE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ItemOneData <span class="title">getDataModel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mItemOneData;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»‘å®šæ˜¯é€šè¿‡ä¸€ä¸ªmapæ¥è¿›è¡Œæ•°æ®æ•°æ®ç»‘å®šï¼Œè¿™æ ·å¤ç”¨æ›´åŠ æ¸…æ™°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> SparseArray&lt;Class&lt;? extends BaseEasyViewHolder&gt;&gt; viewHolders = <span class="keyword">new</span> SparseArray&lt;Class&lt;? extends BaseEasyViewHolder&gt;&gt;() &#123;</span><br><span class="line">        &#123;</span><br><span class="line">            put(ViewItemType.VIEW_TYPE_INFO_ONE, InfoViewViewHolderOne.class);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure><p><a name="4b30c109"></a></p><h2 id="æ•´ä½“è®¾è®¡"><a href="#æ•´ä½“è®¾è®¡" class="headerlink" title="æ•´ä½“è®¾è®¡"></a>æ•´ä½“è®¾è®¡</h2><p><img src="https://cdn.nlark.com/yuque/0/2019/png/215777/1555579402657-55755ccb-5f54-4923-91d6-20fb836904bb.png#align=left&amp;display=inline&amp;height=616&amp;name=image.png&amp;originHeight=1232&amp;originWidth=1600&amp;size=209351&amp;status=done&amp;width=800" alt="image.png"></p><p><a name="ecff77a8"></a></p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>ç»“åˆç¤ºä¾‹ä»£ç </p><p>1ã€å®šä¹‰ <code>ViewItemType</code> ç±»å‹æšä¸¾å€¼:<br>2ã€å®šä¹‰å…·ä½“ <code>InfoViewViewHolderOne</code> classå’Œå¯¹åº”æ•°æ® <code>ItemOneData</code> ç±»å‹<br>3ã€ç»‘å®šholderå’ŒviewitemType</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> SparseArray&lt;Class&lt;? extends BaseEasyViewHolder&gt;&gt; viewHolders = <span class="keyword">new</span> SparseArray&lt;Class&lt;? extends BaseEasyViewHolder&gt;&gt;() &#123;</span><br><span class="line">        &#123;</span><br><span class="line">            put(ViewItemType.VIEW_TYPE_INFO_ONE, InfoViewViewHolderOne.class);</span><br><span class="line">            put(ViewItemType.VIEW_TYPE_INFO_TWO, InfoViewViewHolderTwo.class);</span><br><span class="line">        &#125;</span><br><span class="line"> &#125;;</span><br></pre></td></tr></table></figure><p>4ã€åˆå§‹åŒ– æ•°æ®æº List<easyadapteritem> mTAdapterItems</easyadapteritem></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> List&lt;EasyAdapterItem&gt; mAdapterItems = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br></pre></td></tr></table></figure><p>5ã€å°†Adapterè®¾ç½®ç»™ RecyclerView</p><p><a name="0ba75d5d"></a></p><h2 id="æŠ€æœ¯ç‚¹"><a href="#æŠ€æœ¯ç‚¹" class="headerlink" title="æŠ€æœ¯ç‚¹"></a>æŠ€æœ¯ç‚¹</h2><ul><li>æ³›å‹ã€æŠ½è±¡</li><li>æ³¨è§£</li><li>åå°„</li></ul><p><a name="9415a826"></a></p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>ç”±äºä½¿ç”¨åˆ°äº†åå°„å»åˆ›å»ºviewHolderï¼Œå› æ­¤ç»§æ‰¿BaseEasyViewHolderæ—¶å€™æ³¨æ„é˜²æ­¢æ··æ·†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">-keep <span class="class"><span class="keyword">class</span> <span class="title">me</span>.<span class="title">xsfdev</span>.<span class="title">easyadapterlib</span>.<span class="title">base</span>.** </span>&#123;*;&#125;</span><br><span class="line">-keep <span class="class"><span class="keyword">class</span> * <span class="keyword">extends</span> <span class="title">me</span>.<span class="title">xsfdev</span>.<span class="title">easyadapterlib</span>.<span class="title">base</span>.<span class="title">BaseEasyViewHolder</span></span>&#123;*;&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h2 id=&quot;å¸¸è§„å†™æ³•çš„æ¢è®¨&quot;&gt;&lt;a href=&quot;#å¸¸è§„å†™æ³•çš„æ¢è®¨&quot; class=&quot;headerlink&quot; title=&quot;å¸¸è§„å†™æ³•çš„æ¢è®¨&quot;&gt;&lt;/a&gt;å¸¸è§„å†™æ³•çš„æ¢è®¨&lt;/h2&gt;&lt;p&gt;
      
    
    </summary>
    
      <category term="å·¥å…·" scheme="https://xsfelvis.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="Adapter" scheme="https://xsfelvis.github.io/tags/Adapter/"/>
    
  </entry>
  
  <entry>
    <title>æ·±å…¥ç†è§£åŠ¨æ€ä»£ç†</title>
    <link href="https://xsfelvis.github.io/2019/02/22/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/"/>
    <id>https://xsfelvis.github.io/2019/02/22/æ·±å…¥ç†è§£åŠ¨æ€ä»£ç†/</id>
    <published>2019-02-21T16:00:00.000Z</published>
    <updated>2019-02-22T14:49:21.165Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><blockquote><p>åƒå±±é¸Ÿé£ç»ï¼Œä¸‡å¾„äººè¸ªç­ã€‚</p><p>å­¤èˆŸè“‘ç¬ ç¿ï¼Œç‹¬é’“å¯’æ±Ÿé›ª</p><p>â€”â€”å”Â·æŸ³å®—å…ƒã€Šæ±Ÿé›ªã€‹</p><p>é¦–å‘äºæˆ‘çš„å…¬ä¼—å·</p><p><a href="https://mp.weixin.qq.com/s?__biz=MzU5OTgzNzM0NA==&amp;mid=2247483807&amp;idx=1&amp;sn=2981adda8dd17924cda1c9b05ad17f58&amp;chksm=feaf9e50c9d8174662f43f039de9b500094635d83fbff1a4df2c0923ef51dffbf11a2ae0d135&amp;token=722070929&amp;lang=zh_CN#rd" target="_blank" rel="noopener">æ·±å…¥ç†è§£åŠ¨æ€ä»£ç†</a></p></blockquote><h1 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h1><p>æœ€è¿‘åœ¨é˜…è¯»retrofitæºç æ—¶,æœ‰ä¸ªå…³é”®çš„æ‰€åœ¨å°±æ˜¯åŠ¨æ€ä»£ç†ï¼Œç»†ç»†å›æƒ³äº†ä¸€ä¸‹åŠ¨æ€ä»£ç†,å‘ç°ä¹‹å‰æœ‰äº›ç»†èŠ‚è¿˜æ²¡æœ‰ç†è§£åˆ°ä½ï¼Œæœ¬ç¯‡åšæ–‡å°†é‡æ–°æ·±å…¥ç†è§£ä¸€ä¸‹åŠ¨æ€ä»£ç†ã€‚</p><h1 id="äºŒã€å…³äºä»£ç†"><a href="#äºŒã€å…³äºä»£ç†" class="headerlink" title="äºŒã€å…³äºä»£ç†"></a>äºŒã€å…³äºä»£ç†</h1><p>ä¸­ååæ—æ˜¯ä¸€ä¸ªå«è“„çš„åæ—ï¼Œè®²ç©¶å¾®å¦™å’Œé—´æ¥çš„äº¤æµæ–¹å¼ã€‚å¯¹è±¡ä¹‹é—´çš„é—´æ¥é€šä¿¡ä¹Ÿæ˜¯åŒæ ·æ˜¯é¢å‘å¯¹è±¡è®¾è®¡ä¸­ä¸€æ¡é‡è¦çš„å®¡ç¾è§‚ï¼Œè¿ªç±³ç‰¹æ³•åˆ™ä¹ŸæŒ‡å‡ºâ€œä¸€ä¸ªå¯¹è±¡åº”è¯¥å¯¹å…¶ä»–å¯¹è±¡ä¿æŒæœ€å°‘çš„äº†è§£â€,é—´æ¥é—´é€šä¿¡å¯ä»¥è¾¾åˆ°â€œé«˜å†…èšï¼Œä½è€¦åˆâ€çš„æ•ˆæœã€‚<br>ä»£ç†æ˜¯ä¸€ç§é‡è¦çš„æ‰‹æ®µä¹‹ä¸€ï¼Œæ¯”å¦‚ç”Ÿæ´»ä¸­çš„å¾®å•†ä»£ç†ï¼Œå‚å®¶å§”æ‰˜å…¶ä»£ç†é”€å”®å•†å“ï¼Œæˆ‘ä»¬åªè·Ÿå¾®å•†æ‰“äº¤é“ï¼Œä¸çŸ¥é“èƒŒåçš„â€œå‚å®¶æ˜¯è°â€ï¼Œå¾®å•†å’Œå‚å®¶å°±å¯ä»¥æŠ½è±¡ä¸º â€œä»£ç†ç±»â€å’Œâ€œå§”æ‰˜ç±»â€ï¼Œè¿™æ ·å°±å¯ä»¥ï¼Œéšè—å§”æ‰˜ç±»çš„å®ç°ã€å®ç°å®¢æˆ·ä¸å§”æ‰˜ç±»ä¹‹é—´çš„è§£è€¦ï¼Œå¯ä»¥ä¸ç”¨ä¿®æ”¹å§”æ‰˜ç±»çš„æƒ…å†µä¸‹åšä¸€äº›é¢å¤–çš„å¤„ç†</p><h2 id="2-1ã€ä»£ç†æ¨¡å¼ç®€ä»‹"><a href="#2-1ã€ä»£ç†æ¨¡å¼ç®€ä»‹" class="headerlink" title="2.1ã€ä»£ç†æ¨¡å¼ç®€ä»‹"></a>2.1ã€ä»£ç†æ¨¡å¼ç®€ä»‹</h2><p>åœ¨ã€ŠJavaä¸æ¨¡å¼ã€‹ä¸€ä¹¦ä¸­æŒ‡å‡ºâ€ä»£ç†æ¨¡å¼ç»™æŸä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œå¹¶ç”±ä»£ç†å¯¹è±¡æ§åˆ¶å¯¹åŸå¯¹è±¡çš„è®¿é—®â€ï¼Œç±»å›¾å¦‚ä¸‹<br><img src="https://user-gold-cdn.xitu.io/2019/2/22/16915a41d98d4237?w=1172&amp;h=422&amp;f=png&amp;s=38943" alt="image.png"><br>é€šè¿‡ç±»å›¾å¯ä»¥å‘ç°ï¼Œä»£ç†æ¨¡å¼çš„ä»£ç†å¯¹è±¡<code>Proxy</code>å’Œç›®æ ‡å¯¹è±¡<code>Subject</code>å®ç°åŒä¸€ä¸ªæ¥å£ï¼Œå®¢æˆ·è°ƒç”¨çš„æ˜¯<code>Proxy</code>å¯¹è±¡ï¼Œ<code>Proxy</code>å¯ä»¥æ§åˆ¶<code>Subject</code>çš„è®¿é—®ï¼ŒçœŸæ­£çš„åŠŸèƒ½å®ç°æ˜¯åœ¨<code>Subject</code>å®Œæˆçš„ã€‚</p><p>é€‚ç”¨åœºæ™¯:</p><ul><li>ä¸å¸Œæœ›æŸäº›ç±»è¢«ç›´æ¥è®¿é—®ã€‚<br></li><li>è®¿é—®ä¹‹å‰å¸Œæœ›å…ˆè¿›è¡Œä¸€äº›é¢„å¤„ç†ã€‚<br></li><li>å¸Œæœ›å¯¹è¢«è®¿é—®çš„å¯¹è±¡è¿›è¡Œå†…å­˜ã€æƒé™ç­‰æ–¹é¢çš„æ§åˆ¶ã€‚ </li></ul><p>ä¼˜ç‚¹å¦‚ä¸‹</p><ul><li>ä»£ç†æ¨¡å¼æ˜¯é€šè¿‡ä½¿ç”¨å¼•ç”¨ä»£ç†å¯¹è±¡æ¥è®¿é—®çœŸå®å¯¹è±¡ï¼Œåœ¨è¿™é‡Œä»£ç†å¯¹è±¡å……å½“ç”¨äºè¿æ¥å®¢æˆ·ç«¯å’ŒçœŸå®å¯¹è±¡çš„ä¸­ä»‹è€…ã€‚<br></li><li>ä»£ç†æ¨¡å¼ä¸»è¦ç”¨äºè¿œç¨‹ä»£ç†ã€è™šæ‹Ÿä»£ç†å’Œä¿æŠ¤ä»£ç†ã€‚å…¶ä¸­ä¿æŠ¤ä»£ç†å¯ä»¥è¿›è¡Œè®¿é—®æƒé™æ§åˆ¶ã€‚<br></li></ul><h2 id="2-2ã€é™æ€ä»£ç†"><a href="#2-2ã€é™æ€ä»£ç†" class="headerlink" title="2.2ã€é™æ€ä»£ç†"></a>2.2ã€é™æ€ä»£ç†</h2><p>â€œé™æ€â€ä»£ç†ï¼Œè‹¥ä»£ç†ç±»åœ¨ç¨‹åºè¿è¡Œå‰å·²ç»å­˜åœ¨ï¼Œè¿™ç§é€šå¸¸ç§°ä¸ºé™æ€ä»£ç†ï¼Œæ¯”å¦‚å¾®å•†Aåªä»£ç†Aå“ç‰Œçš„é¢è†œ,æ¶ˆè´¹è€…é€šè¿‡å¾®å•†æ‰èƒ½ä¹°åˆ°æŸå‚çš„é¢è†œ(æ§åˆ¶æƒ)ï¼Œå…¶ä¸­å¾®å•†å’Œå·¥å‚éƒ½å®ç°äº†äº†Sellçš„æ¥å£</p><blockquote><p>å§”æ‰˜ç±»é¢è†œå·¥å‚</p></blockquote><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span>  <span class="title">FactoryOne</span> :<span class="type">SellMask&#123;</span></span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">sell</span><span class="params">()</span></span> &#123;</span><br><span class="line">        println(<span class="string">"FactoryOne: æ¥è‡ªå·¥å‚Açš„é¢è†œ"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¾®å•†é™æ€ä»£ç†</p></blockquote><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BusinessAgent</span> : <span class="type">SellMask &#123;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> sellMask: SellMask</span><br><span class="line"></span><br><span class="line">    init &#123;</span><br><span class="line">        sellMask = FactoryOne()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">sell</span><span class="params">()</span></span> &#123;</span><br><span class="line">        println(<span class="string">"BusinessAgent: å¾®å•†ä»£ç†å¼€å§‹åœ¨æœ‹å‹åœˆæ‰“å¹¿å‘Š"</span>)</span><br><span class="line">        sellMask.sell()</span><br><span class="line">        print(<span class="string">"BusinessAgent: èµšäº†ä¸€å¤§æŠŠ"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…±åŒæ¥å£<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">SellMask</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">sell</span><span class="params">()</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="2-3ã€ç›¸ä¼¼æ¨¡å¼çš„æ¯”è¾ƒ"><a href="#2-3ã€ç›¸ä¼¼æ¨¡å¼çš„æ¯”è¾ƒ" class="headerlink" title="2.3ã€ç›¸ä¼¼æ¨¡å¼çš„æ¯”è¾ƒ"></a>2.3ã€ç›¸ä¼¼æ¨¡å¼çš„æ¯”è¾ƒ</h2><p>æ—¢ç„¶è·å¾—å¼•ç”¨å°±å¯ä»¥åšä¸€äº›æ‰©å±•ä¹‹ç±»çš„äº‹æƒ…ï¼Œè¿™ç‚¹è·Ÿè£…é¥°è€…æ¨¡å¼ã€é€‚é…å™¨æ¨¡å¼çœ‹èµ·æ¥å¾ˆåƒï¼Œä¸‰è€…éƒ½å±äºç»“æ„å‹æ¨¡å¼ï¼Œä½†æ˜¯ä»£ç†æ¨¡å¼æ ¸å¿ƒæ˜¯ä¸ºå…¶å®ƒå¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®()<br><br></p><blockquote><p>ä»£ç†æ¨¡å¼ VS é€‚é…å™¨æ¨¡å¼</p></blockquote><p>çœ‹ä¸Šå»å¾ˆåƒï¼Œå®ƒä»¬éƒ½å¯è§†ä¸ºä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ç§å‰ç½®çš„æ¥å£ï¼Œä½†æ˜¯é€‚é…å™¨æ¨¡å¼çš„ç”¨æ„æ˜¯æ”¹å˜æ‰€è€ƒè™‘çš„å¯¹è±¡çš„æ¥å£ï¼Œè€Œä»£ç†æ¨¡å¼å¹¶ä¸èƒ½æ”¹å˜æ‰€ä»£ç†çš„å¯¹è±¡çš„æ¥å£ï¼Œè¿™ä¸€ç‚¹ä¸Šä¸¤ä¸ªæ¨¡å¼æœ‰ç€æ˜æ˜¾çš„åŒºåˆ«ï¼Œä¸‹å›¾åˆ†åˆ«æ˜¯ å¯¹è±¡é€‚é…å™¨å’Œç±»çš„é€‚é…å™¨UMLå›¾</p><p><img src="https://user-gold-cdn.xitu.io/2019/2/22/16915a41d9a53c4a?w=1286&amp;h=900&amp;f=png&amp;s=82798" alt="image.png"><br><br></p><blockquote><p>ä»£ç†æ¨¡å¼VS è£…é¥°æ¨¡å¼</p></blockquote><p>è£…é¥°è€…æ¨¡å¼ä¸æ‰€è£…é¥°çš„å¯¹è±¡æœ‰ç€ç›¸åŒçš„æ¥å£ï¼Œè¿™ä¸€ç‚¹è·Ÿä»£ç†æ¨¡å¼ç›¸åŒï¼Œä½†æ˜¯è£…é¥°æ¨¡å¼æ›´å¼ºè°ƒä¸ºæ‰€è£…é¥°çš„å¯¹è±¡æä¾›å¢å¼ºåŠŸèƒ½ï¼Œè€Œä»£ç†æ¨¡å¼åˆ™æ˜¯å¯¹å¯¹è±¡çš„ä½¿ç”¨æ–½åŠ æ§åˆ¶ï¼Œå¹¶ä¸æä¾›å¯¹è±¡æœ¬èº«çš„å¢å¼ºåŠŸèƒ½ï¼›è¢«ä»£ç†å¯¹è±¡ç”±ä»£ç†å¯¹è±¡åˆ›å»ºï¼Œå®¢æˆ·ç«¯ç”šè‡³ä¸éœ€è¦çŸ¥é“è¢«ä»£ç†ç±»çš„å­˜åœ¨ï¼›è¢«è£…é¥°å¯¹è±¡ç”±å®¢æˆ·ç«¯åˆ›å»ºå¹¶ä¼ ç»™è£…é¥°å¯¹è±¡ã€‚è£…é¥°è€…UMLå›¾å¦‚ä¸‹</p><p><img src="https://user-gold-cdn.xitu.io/2019/2/22/16915a41d9bb2a1a?w=1358&amp;h=590&amp;f=png&amp;s=78546" alt="image.png"></p><p>ä½ ä»¥ä¸ºè¿™å°±å®Œäº†å—ï¼Ÿä¸‹é¢ğŸ‘‡æ‰æ˜¯é‡å¤´æˆï¼</p><h1 id="ä¸‰ã€æ·±å…¥ç†è§£åŠ¨æ€ä»£ç†"><a href="#ä¸‰ã€æ·±å…¥ç†è§£åŠ¨æ€ä»£ç†" class="headerlink" title="ä¸‰ã€æ·±å…¥ç†è§£åŠ¨æ€ä»£ç†"></a>ä¸‰ã€æ·±å…¥ç†è§£åŠ¨æ€ä»£ç†</h1><h2 id="3-1ã€ä»€ä¹ˆæ˜¯åŠ¨æ€ä»£ç†"><a href="#3-1ã€ä»€ä¹ˆæ˜¯åŠ¨æ€ä»£ç†" class="headerlink" title="3.1ã€ä»€ä¹ˆæ˜¯åŠ¨æ€ä»£ç†"></a>3.1ã€ä»€ä¹ˆæ˜¯åŠ¨æ€ä»£ç†</h2><p>ä»£ç†ç±»åœ¨ç¨‹åºè¿è¡Œæ—¶åˆ›å»ºçš„ä»£ç†æ–¹å¼è¢«æˆä¸º åŠ¨æ€ä»£ç†ã€‚å³ä»£ç†ç±»å¹¶ä¸æ˜¯åœ¨ä»£ç ä¸­å®šä¹‰çš„ï¼Œè€Œæ˜¯åœ¨è¿è¡Œæ—¶æ ¹æ®æˆ‘ä»¬åœ¨Javaä»£ç ä¸­â€è§„å®šâ€çš„ä¿¡æ¯è‡ªåŠ¨ç”Ÿæˆã€‚é™æ€ä»£ç†å®¹æ˜“é€ æˆä»£ç çš„è†¨èƒ€ï¼Œã€‚ç›¸æ¯”äºé™æ€ä»£ç†ï¼Œ åŠ¨æ€ä»£ç†çš„ä¼˜åŠ¿åœ¨äºå¯ä»¥å¾ˆæ–¹ä¾¿çš„å¯¹ä»£ç†ç±»çš„å‡½æ•°è¿›è¡Œç»Ÿä¸€çš„å¤„ç†ï¼Œè€Œä¸ç”¨ä¿®æ”¹æ¯ä¸ªä»£ç†ç±»çš„å‡½æ•°ã€‚ è¿˜æ˜¯ä»¥ä¸Šé¢çš„å–é¢è†œå¾®å•†ä¸ºä¾‹ï¼Œå¥¹åœ¨è¿›è´§å¸‚åœºè¿›è¡Œä¸€ç•ªæ¯”è¾ƒä¹‹åå†å†³å®šä»£ç†å“ªä¸ªå“ç‰Œçš„é¢è†œã€‚</p><h2 id="3-2ã€å¦‚ä½•ä½¿ç”¨åŠ¨æ€ä»£ç†"><a href="#3-2ã€å¦‚ä½•ä½¿ç”¨åŠ¨æ€ä»£ç†" class="headerlink" title="3.2ã€å¦‚ä½•ä½¿ç”¨åŠ¨æ€ä»£ç†"></a>3.2ã€å¦‚ä½•ä½¿ç”¨åŠ¨æ€ä»£ç†</h2><p>è·Ÿä¸Šæ–‡ä¸€æ ·ï¼Œå¾®å•†å’Œé¢è†œå·¥å‚éƒ½å®ç°äº†sellæ¥å£ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ï¼Œä¸‹é¢çœ‹ä¸‹ä¸ä¼—ä¸åŒçš„åœ°æ–¹ï¼Œå®ç°åŠ¨æ€ä»£ç†éœ€è¦å®ç°InvocationHandleræ¥å£</p><blockquote><p>å®ç°InvocationHandleræ¥å£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicProxy</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Object object;<span class="comment">//è¢«å¼•ç”¨çš„ä»£ç†</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">newProxyInstance</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.object = object;</span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(object.getClass().getClassLoader(),object.getClass().getInterfaces(),<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ä»£ç†å•† åŒ…è£…å‘æœ‹å‹åœˆ"</span>);</span><br><span class="line">        Object result = method.invoke(object,args);</span><br><span class="line">        System.out.println(<span class="string">"ä»£ç†å•† èµšé’±"</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>target å±æ€§è¡¨ç¤ºå§”æ‰˜ç±»å¯¹è±¡</li><li><code>InvocationHandler</code>æ˜¯è´Ÿè´£è¿æ¥ä»£ç†ç±»å’Œå§”æ‰˜ç±»çš„ä¸­é—´ç±»å¿…é¡»å®ç°çš„æ¥å£ã€‚å…¶ä¸­åªæœ‰ä¸€ä¸ª invokeå‡½æ•°éœ€è¦å®ç°</li><li>invokeå‡½æ•°</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span></span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢å¥½å¥½çœ‹çœ‹è¿™ä¸ªæ ¸å¿ƒå‡½æ•°çš„å‚æ•°å«ä¹‰</p><ul><li>proxy ä»£é€šè¿‡dynamicproxy.newProxyInstance(business)è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç†ç±» $Proxy0.class(ä¸‹æ–‡ä¼šè¯¦ç»†ä»‹ç»)</li><li>methodè¡¨ç¤ºä»£ç†å¯¹è±¡è¢«è°ƒç”¨çš„å‡½æ•°ï¼Œæ¯”å¦‚sellMaskæ¥å£é‡Œé¢çš„sellæ–¹æ³•</li><li>args è¡¨ç¤ºä»£ç†å¤§åŠ›è°ƒç”¨å‡½æ•°çš„çš„å‚æ•°ï¼Œè¿™é‡Œsellæ–¹æ³•æ— å‚æ•°</li></ul><p>è°ƒç”¨ä»£ç†å¯¹è±¡çš„æ¯ä¸ªå‡½æ•°ï¼Œå®é™…ä¸Šæœ€ç»ˆéƒ½æ˜¯èµ°åˆ°InvocationHandlerçš„invokeå‡½æ•°ï¼Œå› æ­¤å¯ä»¥åœ¨è¿™é‡Œåšä¸€äº›ç»Ÿä¸€çš„å¤„ç†ï¼ŒAOPçš„é›å½¢å°±æ…¢æ…¢å‡ºç°äº†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®methodæ–¹æ³•ååšä¸€äº›åˆ¤æ–­ï¼Œä»è€Œå®ç°å¯¹æŸäº›å‡½æ•°çš„ç‰¹æ®Šå¤„ç†ã€‚</p><blockquote><p>ä½¿ç”¨åŠ¨æ€ä»£ç†</p></blockquote><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">(args: <span class="type">Array</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">    System.getProperties().put(<span class="string">"sun.misc.ProxyGenerator.saveGeneratedFiles"</span>, <span class="string">"true"</span>)  <span class="comment">//åŠ å…¥è¿™ä¸ªå¯ä»¥è·å–ä»£ç†ç±»</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> maskFactory = FactoryMaskOne()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> dynamicproxy: DynamicProxy = DynamicProxy()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> sellMask: SellMask = dynamicproxy.newProxyInstance(maskFactory) <span class="keyword">as</span> SellMask</span><br><span class="line"></span><br><span class="line">    sellMask.sell()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å°†å§”æ‰˜ç±»é¢è†œå·¥ç¨‹FactoryMaskOneä¼ åˆ°dynamicproxy.newProxyInstanceä¸­ï¼Œé€šè¿‡ä¸‹é¢çš„å‡½æ•°è¿”å›äº†ä¸€ä¸ªä»£ç†å¯¹è±¡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public Object newProxyInstance(Object object) &#123;</span><br><span class="line">        this.object = object;</span><br><span class="line">        return Proxy.newProxyInstance(object.getClass().getClassLoader(),object.getClass().getInterfaces(),this);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>å®é™…ä»£ç†ç±»å°±æ˜¯åœ¨è¿™ä¸ªæ—¶å€™åŠ¨æ€ç”Ÿæˆçš„ï¼Œåç»­è°ƒç”¨åˆ°è¿™ä¸ªä»£ç†ç±»çš„å‡½æ•°å°±ä¼šç›´æ¥è°ƒç”¨invokeå‡½æ•°ï¼Œè®©æˆ‘ä»¬ç»†ç»†çœ‹ä¸‹è¿™ä¸ªProxy.newProxyInstance</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">newProxyInstance</span><span class="params">(ClassLoader loader, Class&lt;?&gt;[] interfaces, InvocationHandler h)</span></span></span><br></pre></td></tr></table></figure><p>æ³•çš„ä¸‰ä¸ªå‚æ•°å«ä¹‰åˆ†åˆ«å¦‚ä¸‹ï¼š</p><ul><li>loaderï¼šå®šä¹‰äº†ä»£ç†ç±»çš„ClassLoder;</li><li>interfacesï¼šä»£ç†ç±»å®ç°çš„æ¥å£åˆ—è¡¨</li><li>hï¼šè°ƒç”¨å¤„ç†å™¨ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸Šé¢å®šä¹‰çš„å®ç°äº†InvocationHandleræ¥å£çš„ç±»å®ä¾‹</li></ul><p>è¿™é‡Œç®€å•æ€»ç»“ä¸€ä¸‹ï¼Œå§”æ‰˜ç±»é€šè¿‡<strong>newProxyInstance </strong>æ–¹æ³•è·å–åŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»çš„å®ä¾‹(æœ¬ä¾‹æ˜¯$Proxy0.class),ç„¶åå¯ä»¥é€šè¿‡è¿™ä¸ªä»£ç†ç±»å®ä¾‹è°ƒç”¨ä»£ç†çš„æ–¹æ³•è·å¾—å§”æ‰˜ç±»çš„æ§åˆ¶æƒï¼Œå¯¹ä»£ç†ç±»çš„è°ƒç”¨å®é™…ä¸Šéƒ½ä¼šèµ°åˆ°invokeæ–¹æ³•ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬è°ƒç”¨å§”æ‰˜ç±»çš„ç›¸åº”æ–¹æ³•ï¼Œå¹¶ä¸”å¯ä»¥æ·»åŠ è‡ªå·±çš„ä¸€äº›é€»è¾‘ï¼Œæ¯”å¦‚ç»Ÿä¸€å¤„ç†ç™»é™†ã€æ ¡éªŒä¹‹ç±»çš„ã€‚</p><h2 id="3-3ã€åŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»-Proxy0"><a href="#3-3ã€åŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»-Proxy0" class="headerlink" title="3.3ã€åŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»$Proxy0"></a>3.3ã€åŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»$Proxy0</h2><p>åœ¨Android Studioä¸­è°ƒç”¨ä¸äº†<code>ProxyGenerator</code>è¿™ä¸ªç±»,è¿™ä¸ªç±»åœ¨sun.miscåŒ…ä¸­,ä½¿ç”¨IntelliJ IDEåˆ›å»ºjavaå·¥ç¨‹ï¼Œéœ€è¦çœ‹ä¸€ä¸‹<a href="">jdk</a>çš„åå°„ä¸­Proxyå’Œç”Ÿæˆçš„ä»£ç†ç±»$Proxy0çš„æºç ï¼Œå¯ä»¥ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç”Ÿæˆ$Proxy0çš„classæ–‡ä»¶</span></span><br><span class="line">System.getProperties().put(<span class="string">"sun.misc.ProxyGenerator.saveGeneratedFiles"</span>, <span class="string">"true"</span>);</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆçš„ä»£ç†ç±»åœ¨com.sun.proxyåŒ…é‡Œé¢å®Œæ•´ä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> $<span class="title">Proxy0</span> <span class="keyword">extends</span> <span class="title">Proxy</span> <span class="keyword">implements</span> <span class="title">SellMask</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m1;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m2;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m3;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m0;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $Proxy0(InvocationHandler var1) <span class="keyword">throws</span>  &#123;</span><br><span class="line">        <span class="keyword">super</span>(var1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object var1)</span> <span class="keyword">throws</span>  </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (Boolean)<span class="keyword">super</span>.h.invoke(<span class="keyword">this</span>, m1, <span class="keyword">new</span> Object[]&#123;var1&#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RuntimeException | Error var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> var3;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable var4) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(var4);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">toString</span><span class="params">()</span> <span class="keyword">throws</span>  </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (String)<span class="keyword">super</span>.h.invoke(<span class="keyword">this</span>, m2, (Object[])<span class="keyword">null</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RuntimeException | Error var2) &#123;</span><br><span class="line">            <span class="keyword">throw</span> var2;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(var3);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span> <span class="keyword">throws</span>  </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="comment">//å¯ä»¥çœ‹åˆ°æ¥å£æ–¹æ³•éƒ½äº¤ç”±hçš„invokeæ–¹æ³•å¤„ç†ï¼Œhåœ¨çˆ¶ç±»Proxyä¸­å®šä¹‰ä¸ºInvocationHandleræ¥å£</span></span><br><span class="line">            <span class="keyword">super</span>.h.invoke(<span class="keyword">this</span>, m3, (Object[])<span class="keyword">null</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RuntimeException | Error var2) &#123;</span><br><span class="line">            <span class="keyword">throw</span> var2;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(var3);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> <span class="keyword">throws</span>  </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (Integer)<span class="keyword">super</span>.h.invoke(<span class="keyword">this</span>, m0, (Object[])<span class="keyword">null</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RuntimeException | Error var2) &#123;</span><br><span class="line">            <span class="keyword">throw</span> var2;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(var3);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            m1 = Class.forName(<span class="string">"java.lang.Object"</span>).getMethod(<span class="string">"equals"</span>, Class.forName(<span class="string">"java.lang.Object"</span>));</span><br><span class="line">            m2 = Class.forName(<span class="string">"java.lang.Object"</span>).getMethod(<span class="string">"toString"</span>);</span><br><span class="line">            m3 = Class.forName(<span class="string">"dev.proxy.SellMask"</span>).getMethod(<span class="string">"sell"</span>);</span><br><span class="line">            m0 = Class.forName(<span class="string">"java.lang.Object"</span>).getMethod(<span class="string">"hashCode"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException var2) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchMethodError(var2.getMessage());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoClassDefFoundError(var3.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ç”Ÿæˆçš„ä»£ç†ç±»ä¸­å¯ä»¥çœ‹åˆ°</p><ul><li>åŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»æ˜¯ä»¥<code>$Proxy</code>ä¸ºç±»åå‰ç¼€ï¼Œç»§æ‰¿è‡ª<code>Proxy</code>ï¼Œå¹¶ä¸”å®ç°äº†<code>Proxy.newProxyInstance(â€¦)</code>ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥çš„æ‰€æœ‰æ¥å£çš„ç±»ã€‚</li><li>æ¥å£æ–¹æ³•éƒ½äº¤ç”±hçš„invokeæ–¹æ³•å¤„ç†ï¼Œhåœ¨çˆ¶ç±»Proxyä¸­å®šä¹‰ä¸ºInvocationHandleræ¥å£ï¼Œä¸ºProxy.newProxyInstance(â€¦)çš„ç¬¬ä¸‰ä¸ªå‚æ•°<h2 id="3-4-åŠ¨æ€ä»£ç†ç±»å¦‚ä½•ç”Ÿæˆ"><a href="#3-4-åŠ¨æ€ä»£ç†ç±»å¦‚ä½•ç”Ÿæˆ" class="headerlink" title="3.4 åŠ¨æ€ä»£ç†ç±»å¦‚ä½•ç”Ÿæˆ"></a>3.4 åŠ¨æ€ä»£ç†ç±»å¦‚ä½•ç”Ÿæˆ</h2></li><li>å…³æ³¨ç‚¹1 Proxy.newProxyInstance(â€¦â€¦)å‡½æ•°</li></ul><p>åŠ¨æ€ä»£ç†ç±»æ˜¯åœ¨è°ƒç”¨ Proxy.newProxyInstance(â€¦â€¦)å‡½æ•°æ—¶ç”Ÿæˆçš„ï¼Œç²¾ç®€åçš„æ ¸å¿ƒä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">newProxyInstance</span><span class="params">(ClassLoader loader,</span></span></span><br><span class="line"><span class="function"><span class="params">                                          Class&lt;?&gt;[] interfaces,</span></span></span><br><span class="line"><span class="function"><span class="params">                                          InvocationHandler h)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> IllegalArgumentException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">final</span> Class&lt;?&gt;[] intfs = interfaces.clone();</span><br><span class="line">        â€¦â€¦</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * Look up or generate the designated proxy class.</span></span><br><span class="line"><span class="comment">         * å¾—åˆ°åŠ¨æ€ä»£ç†ç±»</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        Class&lt;?&gt; cl = getProxyClass0(loader, intfs);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * Invoke its constructor with the designated invocation handler.</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            â€¦â€¦</span><br><span class="line">            <span class="keyword">final</span> Constructor&lt;?&gt; cons = cl.getConstructor(constructorParams);</span><br><span class="line">            <span class="keyword">final</span> InvocationHandler ih = h;</span><br><span class="line">            <span class="keyword">if</span> (!Modifier.isPublic(cl.getModifiers())) &#123;</span><br><span class="line">                AccessController.doPrivileged(<span class="keyword">new</span> PrivilegedAction&lt;Void&gt;() &#123;</span><br><span class="line">                    <span class="function"><span class="keyword">public</span> Void <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                        cons.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//ç„¶åå°†InvocationHandlerä½œä¸ºä»£ç†ç±»æ„é€ å‡½æ•°å…¥å‚æ–°å»ºä»£ç†ç±»å¯¹è±¡</span></span><br><span class="line">            <span class="keyword">return</span> cons.newInstance(<span class="keyword">new</span> Object[]&#123;h&#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException|InstantiationException e) &#123;</span><br><span class="line">           â€¦â€¦</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° é¦–å…ˆè°ƒç”¨å®ƒå…ˆè°ƒç”¨<code>getProxyClass(loader, interfaces)</code>å¾—åˆ°åŠ¨æ€ä»£ç†ç±»ï¼Œç„¶åå°†<code>InvocationHandler</code>ä½œä¸ºä»£ç†ç±»æ„é€ å‡½æ•°å…¥å‚æ–°å»ºä»£ç†ç±»å¯¹è±¡ã€‚</p><ul><li>å…³æ³¨ç‚¹2  Class&lt;?&gt; cl = getProxyClass0(loader, intfs);</li></ul><p>å¦‚ä½•è·å–åˆ° ç”ŸæˆåŠ¨æ€ä»£ç†ç±»å‘¢ï¼Œä¸€æ­¥æ­¥è¿½è¸ªï¼Œæˆ‘ä»¬å‘ç°ï¼Œåœ¨Proxy#ProxyClassFactoryç±»ä¸­ï¼Œåœ¨ProxyGeneratorä¸­å»ç”ŸæˆåŠ¨æ€ä»£ç†ï¼Œç±»åä»¥$Proxy+numä½œä¸ºæ ‡è®°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">       * Generate the specified proxy class.</span><br><span class="line">       */</span><br><span class="line">      byte[] proxyClassFile = ProxyGenerator.generateProxyClass(</span><br><span class="line">          proxyName, interfaces, accessFlags);</span><br><span class="line">      try &#123;</span><br><span class="line">          return defineClass0(loader, proxyName,</span><br><span class="line">                              proxyClassFile, 0, proxyClassFile.length);</span><br><span class="line">      &#125; catch (ClassFormatError e) &#123;</span><br><span class="line">          throw new IllegalArgumentException(e.toString());</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><p>æœ¬ç¯‡ä¸»è¦javaä¸­çš„ä»£ç†æ¨¡å¼ä»¥åŠè·Ÿå…¶ä»–æ¨¡å¼çš„å¯¹æ¯”ï¼Œå¹¶é‡ç‚¹ä»‹ç»äº†JDKä¸­çš„åŠ¨æ€ä»£ç†æœºåˆ¶ï¼ŒåƒAOPã€retrofitæ ¸å¿ƒæœºåˆ¶ä¹‹ä¸€å°±ä½¿ç”¨åˆ°äº†è¿™ç§æŠ€æœ¯ï¼Œä½†JavaåŠ¨æ€ä»£ç†æ˜¯åŸºäºæ¥å£çš„ï¼Œå¦‚æœå¯¹è±¡æ²¡æœ‰å®ç°æ¥å£æˆ‘ä»¬è¯¥å¦‚ä½•ä»£ç†å‘¢ï¼Ÿé‚£å°±éœ€è¦CGLIBäº†ï¼Œ<a href="https://github.com/cglib/cglib" target="_blank" rel="noopener">CGLIB</a>(<em>Code Generation Library</em>)æ˜¯ä¸€ä¸ªåŸºäº<a href="http://www.baeldung.com/java-asm" target="_blank" rel="noopener">ASM</a>çš„å­—èŠ‚ç ç”Ÿæˆåº“ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨è¿è¡Œæ—¶å¯¹å­—èŠ‚ç è¿›è¡Œä¿®æ”¹å’ŒåŠ¨æ€ç”Ÿæˆã€‚CGLIBé€šè¿‡ç»§æ‰¿æ–¹å¼å®ç°ä»£ç†ï¼Œè¿™é‡Œå°±ä¸å±•å¼€èµ˜è¿°äº†ã€‚</p><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><ul><li><a href="https://juejin.im/post/5a99048a6fb9a028d5668e62" target="_blank" rel="noopener">https://juejin.im/post/5a99048a6fb9a028d5668e62</a></li><li><a href="https://juejin.im/post/5ad3e6b36fb9a028ba1fee6a" target="_blank" rel="noopener">https://juejin.im/post/5ad3e6b36fb9a028ba1fee6a</a></li><li><a href="http://www.cnblogs.com/xiaoluo501395377/p/3383130.html" target="_blank" rel="noopener">http://www.cnblogs.com/xiaoluo501395377/p/3383130.html</a></li><li><a href="https://www.zhihu.com/question/20794107" target="_blank" rel="noopener">https://www.zhihu.com/question/20794107</a></li><li><a href="https://blog.csdn.net/qq_27095957/article/details/80184291" target="_blank" rel="noopener">https://blog.csdn.net/qq_27095957/article/details/80184291</a></li><li><a href="http://a.codekk.com/detail/Android/Caij/%E5%85%AC%E5%85%B1%E6%8A%80%E6%9C%AF%E7%82%B9%E4%B9%8B%20Java%20%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86" target="_blank" rel="noopener">http://a.codekk.com/detail/Android/Caij/å…¬å…±æŠ€æœ¯ç‚¹ä¹‹ Java åŠ¨æ€ä»£ç†</a></li><li><a href="https://www.jianshu.com/p/0391a8e93d3d" target="_blank" rel="noopener">https://www.jianshu.com/p/0391a8e93d3d</a></li></ul><blockquote><p>æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼Œä¸€èµ·å­¦ä¹ ï¼Œå…±åŒæé«˜~<br><br><img src="https://user-gold-cdn.xitu.io/2019/2/22/16915a41d97876fc?w=304&amp;h=302&amp;f=jpeg&amp;s=46553" alt=""></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;blockquote&gt;
&lt;p&gt;åƒå±±é¸Ÿé£ç»ï¼Œä¸‡å¾„äººè¸ªç­ã€‚&lt;/p&gt;
&lt;p&gt;å­¤èˆŸè“‘ç¬ ç¿ï¼Œç‹¬é’“å¯’æ±Ÿé›ª&lt;/p&gt;
&lt;p&gt;â€”â€”å”Â·æŸ³å®—å…ƒã€Šæ±Ÿé›ªã€‹&lt;/p&gt;
&lt;p&gt;é¦–å‘äºæˆ‘çš„å…¬ä¼—å·&lt;/p&gt;
&lt;p&gt;
      
    
    </summary>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://xsfelvis.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://xsfelvis.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼ç²¾ç®€å›¾å†Œ</title>
    <link href="https://xsfelvis.github.io/2019/02/19/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%B2%BE%E7%AE%80%E5%9B%BE%E5%86%8C/"/>
    <id>https://xsfelvis.github.io/2019/02/19/è®¾è®¡æ¨¡å¼ç²¾ç®€å›¾å†Œ/</id>
    <published>2019-02-18T16:00:00.000Z</published>
    <updated>2019-02-19T16:00:59.407Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h1 id="è®¾è®¡æ¨¡å¼ç²¾ç®€å›¾å†Œ"><a href="#è®¾è®¡æ¨¡å¼ç²¾ç®€å›¾å†Œ" class="headerlink" title="è®¾è®¡æ¨¡å¼ç²¾ç®€å›¾å†Œ"></a>è®¾è®¡æ¨¡å¼ç²¾ç®€å›¾å†Œ</h1><blockquote><p>é¦–å‘äºæˆ‘çš„å…¬ä¼—å·</p><p><a href="https://mp.weixin.qq.com/s?__biz=MzU5OTgzNzM0NA==&amp;tempkey=OTk2X1BicGw2U2lQRURlOVBhMUU3SklRenkyQW5lMF9xRWRWOHVjTlJyaE5yRGJrcVh1UElfU3VtOGxsdTVMSTRuREs0X0JJYVpvRGRFMUVheXNxMmJXZ3pJR0V3aUFDV3VpSWZIa09VZ2J3Nkw5Z19BVENlaHpZSkZvbEZ2UWNqZEVwbGE2WTRoVVZBQmZta1RqdzE4UTV2TFUwOG90WHlpTURuRmw2dWd%2Bfg%3D%3D&amp;chksm=7eaf9eac49d817baef4bd670f1571d475435e108ca8246731fb3c47c52cfccac32905e63d13f#rd" target="_blank" rel="noopener">è®¾è®¡æ¨¡å¼å›¾å†Œ</a></p></blockquote><h2 id="è®¾è®¡æ¨¡å¼åˆ†ç±»"><a href="#è®¾è®¡æ¨¡å¼åˆ†ç±»" class="headerlink" title="è®¾è®¡æ¨¡å¼åˆ†ç±»"></a>è®¾è®¡æ¨¡å¼åˆ†ç±»</h2><h3 id="åˆ›å»ºå‹æ¨¡å¼ï¼š"><a href="#åˆ›å»ºå‹æ¨¡å¼ï¼š" class="headerlink" title="åˆ›å»ºå‹æ¨¡å¼ï¼š"></a>åˆ›å»ºå‹æ¨¡å¼ï¼š</h3><p>ä¸»è¦ç”¨äºåˆ›å»ºå¯¹è±¡ï¼ŒåŒ…æ‹¬</p><ul><li>å·¥å‚æ–¹æ³•(Factory Method)</li><li>æŠ½è±¡å·¥å‚(Abstract Factory)</li><li>å•ä¾‹(Singleton)</li><li>ç”Ÿæˆå™¨(Builder)</li><li><p>åŸå‹(Prototype)</p><h3 id="ç»“æ„å‹æ¨¡å¼ï¼š"><a href="#ç»“æ„å‹æ¨¡å¼ï¼š" class="headerlink" title="ç»“æ„å‹æ¨¡å¼ï¼š"></a>ç»“æ„å‹æ¨¡å¼ï¼š</h3><p>ç”¨äºå¤„ç†ç±»æˆ–è€…å¯¹è±¡çš„ç»„åˆï¼ŒåŒ…æ‹¬</p></li><li><p>é€‚é…å™¨(Adapter)</p></li><li>è£…é¥°è€…(Decorator)</li><li>ä»£ç†(Proxy)</li><li>å¤–è§‚(Facade)</li><li>æ¡¥æ¥(<span data-type="color" style="color:rgb(84, 84, 84)"><span data-type="background" style="background-color:rgb(255, 255, 255)">Bridge Pattern</span></span>)</li><li>ç»„åˆ(Composite)</li><li>è½»é‡(<span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">Flyweigh</span></span>)</li></ul><h3 id="è¡Œä¸ºå‹æ¨¡å¼ï¼š"><a href="#è¡Œä¸ºå‹æ¨¡å¼ï¼š" class="headerlink" title="è¡Œä¸ºå‹æ¨¡å¼ï¼š"></a>è¡Œä¸ºå‹æ¨¡å¼ï¼š</h3><p>ç”¨äºæè¿°ç±»ä¸å¯¹è±¡æ€æ ·çš„äº¤äº’å’Œåˆ†é…èŒè´£ï¼ŒåŒ…æ‹¬</p><ul><li>ç­–ç•¥(Strategy)</li><li>è§‚å¯Ÿè€…(Observer)</li><li>å‘½ä»¤(Command)</li><li>æ¨¡æ¿æ–¹æ³•(Template Method)</li><li>è¿­ä»£å™¨(Iterator)</li><li>çŠ¶æ€(State)</li><li>è´£ä»»é“¾(Chain)</li><li>è§£é‡Šå™¨(Interpreter)</li><li>ä¸­ä»‹è€…(Mediator)</li><li>å¤‡å¿˜å½•(Memo)</li><li>è®¿é—®è€…(Visitor)</li></ul><h2 id="è®¾è®¡åŸåˆ™"><a href="#è®¾è®¡åŸåˆ™" class="headerlink" title="è®¾è®¡åŸåˆ™"></a>è®¾è®¡åŸåˆ™</h2><h3 id="å•ä¸€èŒè´£åŸåˆ™-Single-responsibility-principle"><a href="#å•ä¸€èŒè´£åŸåˆ™-Single-responsibility-principle" class="headerlink" title="å•ä¸€èŒè´£åŸåˆ™(Single responsibility principle)"></a>å•ä¸€èŒè´£åŸåˆ™(Single responsibility principle)</h3><ul><li>æ ¸å¿ƒ<br><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä¸è¦å­˜åœ¨å¤šäºä¸€ä¸ªå¯¼è‡´ç±»å˜æ›´çš„åŸå› ã€‚é€šä¿—çš„è¯´ï¼Œå³ä¸€ä¸ªç±»åªè´Ÿè´£ä¸€é¡¹èŒè´£ã€‚</span></span></li><li>é—®é¢˜äº§ç”Ÿ<br>ç±»Tè´Ÿè´£ä¸¤ä¸ªä¸åŒçš„èŒè´£ï¼šèŒè´£P1ï¼ŒèŒè´£P2ã€‚å½“ç”±äºèŒè´£P1éœ€æ±‚å‘ç”Ÿæ”¹å˜è€Œéœ€è¦ä¿®æ”¹ç±»Tæ—¶ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´åŸæœ¬è¿è¡Œæ­£å¸¸çš„èŒè´£P2åŠŸèƒ½å‘ç”Ÿæ•…éšœã€‚</li><li>è§£å†³æ–¹æ¡ˆ<br>éµå¾ªå•ä¸€èŒè´£åŸåˆ™ã€‚åˆ†åˆ«å»ºç«‹ä¸¤ä¸ªç±»T1ã€T2ï¼Œä½¿T1å®ŒæˆèŒè´£P1åŠŸèƒ½ï¼ŒT2å®ŒæˆèŒè´£P2åŠŸèƒ½ã€‚è¿™æ ·ï¼Œå½“ä¿®æ”¹ç±»T1æ—¶ï¼Œä¸ä¼šä½¿èŒè´£P2å‘ç”Ÿæ•…éšœé£é™©ï¼›åŒç†ï¼Œå½“ä¿®æ”¹T2æ—¶ï¼Œä¹Ÿä¸ä¼šä½¿èŒè´£P1å‘ç”Ÿæ•…éšœé£é™©ã€‚</li></ul><p>ä½†æ˜¯ç”±äºèŒè´£æ‰©æ•£ä¼šå¯¼è‡´åœ¨å®é™…ä¸­å¾€å¾€ä¼šæœ‰æ‚–äºå•ä¸€èŒè´£</p><h3 id="é‡Œæ°ä»£æ¢åŸåˆ™-Liskov-Substitution-Principle-LSP"><a href="#é‡Œæ°ä»£æ¢åŸåˆ™-Liskov-Substitution-Principle-LSP" class="headerlink" title="é‡Œæ°ä»£æ¢åŸåˆ™(Liskov Substitution Principle LSP)"></a>é‡Œæ°ä»£æ¢åŸåˆ™(Liskov Substitution Principle LSP)</h3><ul><li>æ ¸å¿ƒ<br><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">æ‰€æœ‰å¼•ç”¨åŸºç±»çš„åœ°æ–¹å¿…é¡»èƒ½é€æ˜åœ°ä½¿ç”¨å…¶å­ç±»çš„å¯¹è±¡ã€‚</span></span></li><li>é—®é¢˜äº§ç”Ÿ<br>æœ‰ä¸€åŠŸèƒ½P1ï¼Œç”±ç±»Aå®Œæˆã€‚ç°éœ€è¦å°†åŠŸèƒ½P1è¿›è¡Œæ‰©å±•ï¼Œæ‰©å±•åçš„åŠŸèƒ½ä¸ºPï¼Œå…¶ä¸­Pç”±åŸæœ‰åŠŸèƒ½P1ä¸æ–°åŠŸèƒ½P2ç»„æˆã€‚æ–°åŠŸèƒ½Pç”±ç±»Açš„å­ç±»Bæ¥å®Œæˆï¼Œåˆ™å­ç±»Båœ¨å®Œæˆæ–°åŠŸèƒ½P2çš„åŒæ—¶ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´åŸæœ‰åŠŸèƒ½P1å‘ç”Ÿæ•…éšœã€‚</li><li>è§£å†³æ–¹æ¡ˆ<br>å½“ä½¿ç”¨ç»§æ‰¿æ—¶ï¼Œéµå¾ªé‡Œæ°æ›¿æ¢åŸåˆ™ã€‚ç±»Bç»§æ‰¿ç±»Aæ—¶ï¼Œé™¤æ·»åŠ æ–°çš„æ–¹æ³•å®Œæˆæ–°å¢åŠŸèƒ½P2å¤–ï¼Œå°½é‡ä¸è¦é‡å†™çˆ¶ç±»Açš„æ–¹æ³•ï¼Œä¹Ÿå°½é‡ä¸è¦é‡è½½çˆ¶ç±»Açš„æ–¹æ³•ã€‚</li></ul><p>ç»§æ‰¿åŒ…å«è¿™æ ·ä¸€å±‚å«ä¹‰ï¼šçˆ¶ç±»ä¸­å‡¡æ˜¯å·²ç»å®ç°å¥½çš„æ–¹æ³•ï¼ˆç›¸å¯¹äºæŠ½è±¡æ–¹æ³•è€Œè¨€ï¼‰ï¼Œå®é™…ä¸Šæ˜¯åœ¨è®¾å®šä¸€ç³»åˆ—çš„è§„èŒƒå’Œå¥‘çº¦ï¼Œè™½ç„¶å®ƒä¸å¼ºåˆ¶è¦æ±‚æ‰€æœ‰çš„å­ç±»å¿…é¡»éµä»è¿™äº›å¥‘çº¦ï¼Œä½†æ˜¯å¦‚æœå­ç±»å¯¹è¿™äº›éæŠ½è±¡æ–¹æ³•ä»»æ„ä¿®æ”¹ï¼Œå°±ä¼šå¯¹æ•´ä¸ªç»§æ‰¿ä½“ç³»é€ æˆç ´åã€‚è€Œé‡Œæ°æ›¿æ¢åŸåˆ™å°±æ˜¯è¡¨è¾¾äº†è¿™ä¸€å±‚å«ä¹‰ã€‚</p><p>ç»§æ‰¿ä½œä¸ºé¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§ä¹‹ä¸€ï¼Œåœ¨ç»™ç¨‹åºè®¾è®¡å¸¦æ¥å·¨å¤§ä¾¿åˆ©çš„åŒæ—¶ï¼Œä¹Ÿå¸¦æ¥äº†å¼Šç«¯ã€‚æ¯”å¦‚ä½¿ç”¨ç»§æ‰¿ä¼šç»™ç¨‹åºå¸¦æ¥ä¾µå…¥æ€§ï¼Œç¨‹åºçš„å¯ç§»æ¤æ€§é™ä½ï¼Œå¢åŠ äº†å¯¹è±¡é—´çš„è€¦åˆæ€§ï¼Œå¦‚æœä¸€ä¸ªç±»è¢«å…¶ä»–çš„ç±»æ‰€ç»§æ‰¿ï¼Œåˆ™å½“è¿™ä¸ªç±»éœ€è¦ä¿®æ”¹æ—¶ï¼Œå¿…é¡»è€ƒè™‘åˆ°æ‰€æœ‰çš„å­ç±»ï¼Œå¹¶ä¸”çˆ¶ç±»ä¿®æ”¹åï¼Œæ‰€æœ‰æ¶‰åŠåˆ°å­ç±»çš„åŠŸèƒ½éƒ½æœ‰å¯èƒ½ä¼šäº§ç”Ÿæ•…éšœã€‚</p><h3 id="æ¥å£éš”ç¦»åŸåˆ™-Interface-Segregation-Principle"><a href="#æ¥å£éš”ç¦»åŸåˆ™-Interface-Segregation-Principle" class="headerlink" title="æ¥å£éš”ç¦»åŸåˆ™(Interface Segregation Principle)"></a>æ¥å£éš”ç¦»åŸåˆ™(Interface Segregation Principle)</h3><ul><li>æ ¸å¿ƒ<br><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä¸åº”è¯¥ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£ï¼›ä¸€ä¸ªç±»å¯¹å¦ä¸€ä¸ªç±»çš„ä¾èµ–åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Š</span></span><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ã€‚</span></span></li><li>é—®é¢˜äº§ç”Ÿ<br><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ç±»Aé€šè¿‡æ¥å£Iä¾èµ–ç±»Bï¼Œç±»Cé€šè¿‡æ¥å£Iä¾èµ–ç±»Dï¼Œå¦‚æœæ¥å£Iå¯¹äºç±»Aå’Œç±»Bæ¥è¯´ä¸æ˜¯æœ€å°æ¥å£ï¼Œåˆ™ç±»Bå’Œç±»Då¿…é¡»å»å®ç°ä»–ä»¬ä¸éœ€è¦çš„æ–¹æ³•ã€‚</span></span></li><li>è§£å†³æ–¹æ¡ˆ<br><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">å°†è‡ƒè‚¿çš„æ¥å£Iæ‹†åˆ†ä¸ºç‹¬ç«‹çš„å‡ ä¸ªæ¥å£ï¼Œç±»Aå’Œç±»Cåˆ†åˆ«ä¸ä»–ä»¬éœ€è¦çš„æ¥å£å»ºç«‹ä¾èµ–å…³ç³»ã€‚ä¹Ÿå°±æ˜¯é‡‡ç”¨æ¥å£éš”ç¦»åŸåˆ™ã€‚</span></span></li></ul><p>æ¥å£éš”ç¦»åŸåˆ™è·Ÿä¹‹å‰çš„å•ä¸€èŒè´£åŸåˆ™å¾ˆç›¸ä¼¼ï¼Œå…¶å®ä¸ç„¶ã€‚å…¶ä¸€ï¼Œå•ä¸€èŒè´£åŸåˆ™åŸæ³¨é‡çš„æ˜¯èŒè´£ï¼›è€Œæ¥å£éš”ç¦»åŸåˆ™æ³¨é‡å¯¹æ¥å£ä¾èµ–çš„éš”ç¦»ã€‚å…¶äºŒï¼Œå•ä¸€èŒè´£åŸåˆ™ä¸»è¦æ˜¯çº¦æŸç±»ï¼Œå…¶æ¬¡æ‰æ˜¯æ¥å£å’Œæ–¹æ³•ï¼Œå®ƒé’ˆå¯¹çš„æ˜¯ç¨‹åºä¸­çš„å®ç°å’Œç»†èŠ‚ï¼›è€Œæ¥å£éš”ç¦»åŸåˆ™ä¸»è¦çº¦æŸæ¥å£æ¥å£ï¼Œä¸»è¦é’ˆå¯¹æŠ½è±¡ï¼Œé’ˆå¯¹ç¨‹åºæ•´ä½“æ¡†æ¶çš„æ„å»ºã€‚</p><p>é‡‡ç”¨æ¥å£éš”ç¦»åŸåˆ™å¯¹æ¥å£è¿›è¡Œçº¦æŸæ—¶ï¼Œè¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li>æ¥å£å°½é‡å°ï¼Œä½†æ˜¯è¦æœ‰é™åº¦ã€‚å¯¹æ¥å£è¿›è¡Œç»†åŒ–å¯ä»¥æé«˜ç¨‹åºè®¾è®¡çµæ´»æ€§æ˜¯ä¸æŒ£çš„äº‹å®ï¼Œä½†æ˜¯å¦‚æœè¿‡å°ï¼Œåˆ™ä¼šé€ æˆæ¥å£æ•°é‡è¿‡å¤šï¼Œä½¿è®¾è®¡å¤æ‚åŒ–ã€‚æ‰€ä»¥ä¸€å®šè¦é€‚åº¦ã€‚</li><li>ä¸ºä¾èµ–æ¥å£çš„ç±»å®šåˆ¶æœåŠ¡ï¼Œåªæš´éœ²ç»™è°ƒç”¨çš„ç±»å®ƒéœ€è¦çš„æ–¹æ³•ï¼Œå®ƒä¸éœ€è¦çš„æ–¹æ³•åˆ™éšè—èµ·æ¥ã€‚åªæœ‰ä¸“æ³¨åœ°ä¸ºä¸€ä¸ªæ¨¡å—æä¾›å®šåˆ¶æœåŠ¡ï¼Œæ‰èƒ½å»ºç«‹æœ€å°çš„ä¾èµ–å…³ç³»ã€‚</li><li>æé«˜å†…èšï¼Œå‡å°‘å¯¹å¤–äº¤äº’ã€‚ä½¿æ¥å£ç”¨æœ€å°‘çš„æ–¹æ³•å»å®Œæˆæœ€å¤šçš„äº‹æƒ…ã€‚</li></ul><p>è¿ç”¨æ¥å£éš”ç¦»åŸåˆ™ï¼Œä¸€å®šè¦é€‚åº¦ï¼Œæ¥å£è®¾è®¡çš„è¿‡å¤§æˆ–è¿‡å°éƒ½ä¸å¥½ã€‚è®¾è®¡æ¥å£çš„æ—¶å€™ï¼Œåªæœ‰å¤šèŠ±äº›æ—¶é—´å»æ€è€ƒå’Œç­¹åˆ’ï¼Œæ‰èƒ½å‡†ç¡®åœ°å®è·µè¿™ä¸€åŸåˆ™ã€‚</p><h3 id="è¿ªç±³ç‰¹åŸåˆ™-Law-of-Demeter-Least-Knowledge-Principle"><a href="#è¿ªç±³ç‰¹åŸåˆ™-Law-of-Demeter-Least-Knowledge-Principle" class="headerlink" title="è¿ªç±³ç‰¹åŸåˆ™(Law of Demeter/Least Knowledge Principle )"></a>è¿ªç±³ç‰¹åŸåˆ™(<span data-type="color" style="color:rgb(34, 34, 34)"><span data-type="background" style="background-color:rgb(255, 255, 255)">Law of Demeter/Least Knowledge Principle </span></span>)</h3><ul><li>æ ¸å¿ƒ<br><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">è¿ªç±³ç‰¹æ³•åˆ™åˆå«æœ€å°‘çŸ¥é“åŸåˆ™ï¼Œä¸€ä¸ªå¯¹è±¡åº”è¯¥å¯¹å…¶ä»–å¯¹è±¡ä¿æŒæœ€å°‘çš„äº†è§£ã€‚</span></span></li><li>é—®é¢˜äº§ç”Ÿ<br><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»è¶Šå¯†åˆ‡ï¼Œè€¦åˆåº¦è¶Šå¤§ï¼Œå½“ä¸€ä¸ªç±»å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå¯¹å¦ä¸€ä¸ªç±»çš„å½±å“ä¹Ÿè¶Šå¤§ã€‚</span></span></li><li>è§£å†³æ–¹æ¡ˆ<br><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">å°½é‡é™ä½ç±»ä¸ç±»ä¹‹é—´çš„è€¦åˆã€‚</span></span></li></ul><p><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">é€šä¿—çš„æ¥è®²ï¼Œå°±æ˜¯ä¸€ä¸ªç±»å¯¹è‡ªå·±ä¾èµ–çš„ç±»çŸ¥é“çš„è¶Šå°‘è¶Šå¥½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºè¢«ä¾èµ–çš„ç±»æ¥è¯´ï¼Œæ— è®ºé€»è¾‘å¤šä¹ˆå¤æ‚ï¼Œéƒ½å°½é‡åœ°çš„å°†é€»è¾‘å°è£…åœ¨ç±»çš„å†…éƒ¨ï¼Œå¯¹å¤–é™¤äº†æä¾›çš„publicæ–¹æ³•ï¼Œä¸å¯¹å¤–æ³„æ¼ä»»ä½•ä¿¡æ¯ï¼Œ</span></span><br><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">è¿ªç±³ç‰¹æ³•åˆ™è¿˜æœ‰ä¸€ä¸ªæ›´ç®€å•çš„å®šä¹‰ï¼šåªä¸ç›´æ¥çš„æœ‹å‹é€šä¿¡ã€‚é¦–å…ˆæ¥è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯ç›´æ¥çš„æœ‹å‹ï¼šæ¯ä¸ªå¯¹è±¡éƒ½ä¼šä¸å…¶ä»–å¯¹è±¡æœ‰è€¦åˆå…³ç³»ï¼Œåªè¦ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´æœ‰è€¦åˆå…³ç³»ï¼Œæˆ‘ä»¬å°±è¯´è¿™ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´æ˜¯æœ‹å‹å…³ç³»ã€‚è€¦åˆçš„æ–¹å¼å¾ˆå¤šï¼Œä¾èµ–ã€å…³è”ã€ç»„åˆã€èšåˆç­‰ã€‚å…¶ä¸­ï¼Œæˆ‘ä»¬ç§°å‡ºç°æˆå‘˜å˜é‡ã€æ–¹æ³•å‚æ•°ã€æ–¹æ³•è¿”å›å€¼ä¸­çš„ç±»ä¸ºç›´æ¥çš„æœ‹å‹ï¼Œè€Œå‡ºç°åœ¨å±€éƒ¨å˜é‡ä¸­çš„ç±»åˆ™ä¸æ˜¯ç›´æ¥çš„æœ‹å‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé™Œç”Ÿçš„ç±»æœ€å¥½ä¸è¦ä½œä¸ºå±€éƒ¨å˜é‡çš„å½¢å¼å‡ºç°åœ¨ç±»çš„å†…éƒ¨ã€‚</span></span></p><h3 id="ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependence-Inversion-Principleï¼‰"><a href="#ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependence-Inversion-Principleï¼‰" class="headerlink" title="ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependence Inversion Principleï¼‰"></a>ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependence Inversion Principleï¼‰</h3><ul><li>æ ¸å¿ƒ<br><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ï¼›æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼›ç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚</span></span></li><li>é—®é¢˜äº§ç”Ÿ<br>ç±»Aç›´æ¥ä¾èµ–ç±»Bï¼Œå‡å¦‚è¦å°†ç±»Aæ”¹ä¸ºä¾èµ–ç±»Cï¼Œåˆ™å¿…é¡»é€šè¿‡ä¿®æ”¹ç±»Açš„ä»£ç æ¥è¾¾æˆã€‚è¿™ç§åœºæ™¯ä¸‹ï¼Œç±»Aä¸€èˆ¬æ˜¯é«˜å±‚æ¨¡å—ï¼Œè´Ÿè´£å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ï¼›ç±»Bå’Œç±»Cæ˜¯ä½å±‚æ¨¡å—ï¼Œè´Ÿè´£åŸºæœ¬çš„åŸå­æ“ä½œï¼›å‡å¦‚ä¿®æ”¹ç±»Aï¼Œä¼šç»™ç¨‹åºå¸¦æ¥ä¸å¿…è¦çš„é£é™©ã€‚</li><li>è§£å†³æ–¹æ¡ˆ<br><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">å°†ç±»Aä¿®æ”¹ä¸ºä¾èµ–æ¥å£Iï¼Œç±»Bå’Œç±»Cå„è‡ªå®ç°æ¥å£Iï¼Œç±»Aé€šè¿‡æ¥å£Ié—´æ¥ä¸ç±»Bæˆ–è€…ç±»Cå‘ç”Ÿè”ç³»ï¼Œåˆ™ä¼šå¤§å¤§é™ä½ä¿®æ”¹ç±»Açš„å‡ ç‡ã€‚</span></span></li></ul><p>ä¾èµ–å€’ç½®åŸåˆ™åŸºäºè¿™æ ·ä¸€ä¸ªäº‹å®ï¼šç›¸å¯¹äºç»†èŠ‚çš„å¤šå˜æ€§ï¼ŒæŠ½è±¡çš„ä¸œè¥¿è¦ç¨³å®šçš„å¤šã€‚ä»¥æŠ½è±¡ä¸ºåŸºç¡€æ­å»ºèµ·æ¥çš„æ¶æ„æ¯”ä»¥ç»†èŠ‚ä¸ºåŸºç¡€æ­å»ºèµ·æ¥çš„æ¶æ„è¦ç¨³å®šçš„å¤šã€‚åœ¨javaä¸­ï¼ŒæŠ½è±¡æŒ‡çš„æ˜¯æ¥å£æˆ–è€…æŠ½è±¡ç±»ï¼Œç»†èŠ‚å°±æ˜¯å…·ä½“çš„å®ç°ç±»ï¼Œä½¿ç”¨æ¥å£æˆ–è€…æŠ½è±¡ç±»çš„ç›®çš„æ˜¯åˆ¶å®šå¥½è§„èŒƒå’Œå¥‘çº¦ï¼Œè€Œä¸å»æ¶‰åŠä»»ä½•å…·ä½“çš„æ“ä½œï¼ŒæŠŠå±•ç°ç»†èŠ‚çš„ä»»åŠ¡äº¤ç»™ä»–ä»¬çš„å®ç°ç±»å»å®Œæˆã€‚</p><p>ä¾èµ–å€’ç½®åŸåˆ™çš„æ ¸å¿ƒæ€æƒ³æ˜¯é¢å‘æ¥å£ç¼–ç¨‹ï¼Œ</p><h3 id="å¼€é—­åŸåˆ™-Open-Close-Principle"><a href="#å¼€é—­åŸåˆ™-Open-Close-Principle" class="headerlink" title="å¼€é—­åŸåˆ™(Open Close Principle)"></a>å¼€é—­åŸåˆ™(Open Close Principle)</h3><ul><li>æ ¸å¿ƒ<br><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä¸€ä¸ªè½¯ä»¶å®ä½“å¦‚ç±»ã€æ¨¡å—å’Œå‡½æ•°åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚</span></span></li><li>é—®é¢˜äº§ç”Ÿ<br><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">åœ¨è½¯ä»¶çš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œå› ä¸ºå˜åŒ–ã€å‡çº§å’Œç»´æŠ¤ç­‰åŸå› éœ€è¦å¯¹è½¯ä»¶åŸæœ‰ä»£ç è¿›è¡Œä¿®æ”¹æ—¶ï¼Œå¯èƒ½ä¼šç»™æ—§ä»£ç ä¸­å¼•å…¥é”™è¯¯ï¼Œä¹Ÿå¯èƒ½ä¼šä½¿æˆ‘ä»¬ä¸å¾—ä¸å¯¹æ•´ä¸ªåŠŸèƒ½è¿›è¡Œé‡æ„ï¼Œå¹¶ä¸”éœ€è¦åŸæœ‰ä»£ç ç»è¿‡é‡æ–°æµ‹è¯•ã€‚</span></span></li><li>è§£å†³æ–¹æ¡ˆ<br>å½“è½¯ä»¶éœ€è¦å˜åŒ–æ—¶ï¼Œå°½é‡é€šè¿‡æ‰©å±•è½¯ä»¶å®ä½“çš„è¡Œä¸ºæ¥å®ç°å˜åŒ–ï¼Œè€Œä¸æ˜¯é€šè¿‡ä¿®æ”¹å·²æœ‰çš„ä»£ç æ¥å®ç°å˜åŒ–ã€‚</li></ul><p><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">å¼€é—­åŸåˆ™æ— éå°±æ˜¯æƒ³è¡¨è¾¾è¿™æ ·ä¸€å±‚æ„æ€ï¼šç”¨æŠ½è±¡æ„å»ºæ¡†æ¶ï¼Œç”¨å®ç°æ‰©å±•ç»†èŠ‚ã€‚å› ä¸ºæŠ½è±¡çµæ´»æ€§å¥½ï¼Œé€‚åº”æ€§å¹¿ï¼Œåªè¦æŠ½è±¡çš„åˆç†ï¼Œå¯ä»¥åŸºæœ¬ä¿æŒè½¯ä»¶æ¶æ„çš„ç¨³å®šã€‚è€Œè½¯ä»¶ä¸­æ˜“å˜çš„ç»†èŠ‚ï¼Œæˆ‘ä»¬ç”¨ä»æŠ½è±¡æ´¾ç”Ÿçš„å®ç°ç±»æ¥è¿›è¡Œæ‰©å±•ï¼Œå½“è½¯ä»¶éœ€è¦å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦æ ¹æ®éœ€æ±‚é‡æ–°æ´¾ç”Ÿä¸€ä¸ªå®ç°ç±»æ¥æ‰©å±•å°±å¯ä»¥äº†ã€‚å½“ç„¶å‰ææ˜¯æˆ‘ä»¬çš„æŠ½è±¡è¦åˆç†ï¼Œè¦å¯¹éœ€æ±‚çš„å˜æ›´æœ‰å‰ç»æ€§å’Œé¢„è§æ€§æ‰è¡Œã€‚</span></span></p><h2 id="å‡ ä¸ªåŸåˆ™çš„å…³è”æ€§"><a href="#å‡ ä¸ªåŸåˆ™çš„å…³è”æ€§" class="headerlink" title="å‡ ä¸ªåŸåˆ™çš„å…³è”æ€§"></a>å‡ ä¸ªåŸåˆ™çš„å…³è”æ€§</h2><p><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ç”¨æŠ½è±¡æ„å»ºæ¡†æ¶ï¼Œç”¨å®ç°æ‰©å±•ç»†èŠ‚çš„æ³¨æ„äº‹é¡¹è€Œå·²ï¼š</span></span></p><ul><li><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">å•ä¸€èŒè´£åŸåˆ™å‘Šè¯‰æˆ‘ä»¬å®ç°ç±»è¦èŒè´£å•ä¸€ï¼›</span></span></li><li><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">é‡Œæ°æ›¿æ¢åŸåˆ™å‘Šè¯‰æˆ‘ä»¬ä¸è¦ç ´åç»§æ‰¿ä½“ç³»ï¼›</span></span></li><li><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä¾èµ–å€’ç½®åŸåˆ™å‘Šè¯‰æˆ‘ä»¬è¦é¢å‘æ¥å£ç¼–ç¨‹ï¼›</span></span></li><li><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">æ¥å£éš”ç¦»åŸåˆ™å‘Šè¯‰æˆ‘ä»¬åœ¨è®¾è®¡æ¥å£çš„æ—¶å€™è¦ç²¾ç®€å•ä¸€ï¼›</span></span></li><li><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">è¿ªç±³ç‰¹æ³•åˆ™å‘Šè¯‰æˆ‘ä»¬è¦é™ä½è€¦åˆã€‚</span></span><br><span data-type="color" style="color:rgb(0, 0, 0)"><span data-type="background" style="background-color:rgb(255, 255, 255)">è€Œå¼€é—­åŸåˆ™æ˜¯æ€»çº²ï¼Œä»–å‘Šè¯‰æˆ‘ä»¬è¦å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚</span></span></li></ul><h2 id="åˆ›å»ºå‹è®¾è®¡æ¨¡å¼-åˆ›å»ºå¯¹è±¡"><a href="#åˆ›å»ºå‹è®¾è®¡æ¨¡å¼-åˆ›å»ºå¯¹è±¡" class="headerlink" title="åˆ›å»ºå‹è®¾è®¡æ¨¡å¼(åˆ›å»ºå¯¹è±¡)"></a>åˆ›å»ºå‹è®¾è®¡æ¨¡å¼(åˆ›å»ºå¯¹è±¡)</h2><h3 id="å·¥å‚æ–¹æ³•-Factory-Method-Pattern"><a href="#å·¥å‚æ–¹æ³•-Factory-Method-Pattern" class="headerlink" title="å·¥å‚æ–¹æ³•(Factory Method Pattern)"></a>å·¥å‚æ–¹æ³•(Factory Method Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="90px"><br>      <col width="740px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Factory Method</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/169066ffce5cc3db?w=525&h=177&f=gif&s=4810" data-width="525"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/169066ffce5cc3db?w=525&h=177&f=gif&s=4810" width="525"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚Factory Method ä½¿ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°å…¶å­ç±»ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“ä¸€ä¸ªç±»ä¸çŸ¥é“å®ƒæ‰€å¿…é¡»åˆ›å»ºçš„å¯¹è±¡çš„ç±»çš„æ—¶å€™ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“ä¸€ä¸ªç±»å¸Œæœ›ç”±å®ƒçš„å­ç±»æ¥æŒ‡å®šå®ƒæ‰€åˆ›å»ºçš„å¯¹è±¡çš„æ—¶å€™ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“ç±»å°†åˆ›å»ºå¯¹è±¡çš„èŒè´£å§”æ‰˜ç»™å¤šä¸ªå¸®åŠ©å­ç±»ä¸­çš„æŸä¸€ä¸ªï¼Œå¹¶ä¸”ä½ å¸Œæœ›å°†å“ªä¸€ä¸ªå¸®åŠ©å­ç±»æ˜¯ä»£ç†è€…è¿™ä¸€ä¿¡æ¯å±€éƒ¨åŒ–çš„æ—¶å€™ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">åœ¨å·¥å‚æ–¹æ³•ä¸­ï¼Œç”¨æˆ·åªéœ€è¦çŸ¥é“æ‰€è¦äº§å“çš„å…·ä½“å·¥å‚ï¼Œæ— é¡»å…³ç³»å…·ä½“çš„åˆ›å»ºè¿‡ç¨‹ï¼Œç”šè‡³ä¸éœ€è¦å…·ä½“äº§å“ç±»çš„ç±»åã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p"> åœ¨ç³»ç»Ÿå¢åŠ æ–°çš„äº§å“æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ ä¸€ä¸ªå…·ä½“äº§å“ç±»å’Œå¯¹åº”çš„å®ç°å·¥å‚ï¼Œæ— éœ€å¯¹åŸå·¥å‚è¿›è¡Œä»»ä½•ä¿®æ”¹ï¼Œå¾ˆå¥½åœ°ç¬¦åˆäº†â€œå¼€é—­åŸåˆ™â€ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¯æ¬¡å¢åŠ ä¸€ä¸ªäº§å“æ—¶ï¼Œéƒ½éœ€è¦å¢åŠ ä¸€ä¸ªå…·ä½“ç±»å’Œå¯¹è±¡å®ç°å·¥å‚ï¼Œæ˜¯çš„ç³»ç»Ÿä¸­ç±»çš„ä¸ªæ•°æˆå€å¢åŠ ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ï¼ŒåŒæ—¶ä¹Ÿå¢åŠ äº†ç³»ç»Ÿå…·ä½“ç±»çš„ä¾èµ–ã€‚è¿™å¹¶ä¸æ˜¯ä»€ä¹ˆå¥½äº‹ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p"> ç®€å•å·¥å‚æ¨¡å¼çš„è¦ç‚¹å°±åœ¨äºå½“ä½ éœ€è¦ä»€ä¹ˆï¼Œåªéœ€è¦ä¼ å…¥ä¸€ä¸ªæ­£ç¡®çš„å‚æ•°ï¼Œå°±å¯ä»¥è·å–ä½ æ‰€éœ€è¦çš„å¯¹è±¡ï¼Œè€Œæ— é¡»çŸ¥é“å…¶åˆ›å»ºç»†èŠ‚ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p"> ç®€å•å·¥å‚æ¨¡å¼æœ€å¤§çš„ä¼˜ç‚¹åœ¨äºå®ç°å¯¹è±¡çš„åˆ›å»ºå’Œå¯¹è±¡çš„ä½¿ç”¨åˆ†ç¦»ï¼Œä½†æ˜¯å¦‚æœäº§å“è¿‡å¤šæ—¶ï¼Œä¼šå¯¼è‡´å·¥å‚ä»£ç éå¸¸å¤æ‚ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="æŠ½è±¡å·¥å‚-Abstract-Factory-Pattern"><a href="#æŠ½è±¡å·¥å‚-Abstract-Factory-Pattern" class="headerlink" title="æŠ½è±¡å·¥å‚(Abstract Factory Pattern)"></a>æŠ½è±¡å·¥å‚(Abstract Factory Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="94px"><br>      <col width="736px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Abstract Factory</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/169066ffce813741?w=568&h=253&f=gif&s=9088" data-width="568"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/169066ffce813741?w=568&h=253&f=gif&s=9088" width="568"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— éœ€æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸€ä¸ªç³»ç»Ÿè¦ç‹¬ç«‹äºå®ƒçš„äº§å“çš„åˆ›å»ºã€ç»„åˆå’Œè¡¨ç¤ºæ—¶ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸€ä¸ªç³»ç»Ÿè¦ç”±å¤šä¸ªäº§å“ç³»åˆ—ä¸­çš„ä¸€ä¸ªæ¥é…ç½®æ—¶ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“ä½ è¦å¼ºè°ƒä¸€ç³»åˆ—ç›¸å…³çš„äº§å“å¯¹è±¡çš„è®¾è®¡ä»¥ä¾¿è¿›è¡Œè”åˆä½¿ç”¨æ—¶ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“ä½ æä¾›ä¸€ä¸ªäº§å“ç±»åº“ï¼Œè€Œåªæƒ³æ˜¾ç¤ºå®ƒä»¬çš„æ¥å£è€Œä¸æ˜¯å®ç°æ—¶ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æŠ½è±¡å·¥å‚éš”ç¦»äº†å…·ä½“ç±»çš„ç”Ÿæˆï¼Œæ˜¯çš„å®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“ä»€ä¹ˆè¢«åˆ›å»ºã€‚æ‰€æœ‰çš„å…·ä½“å·¥å‚éƒ½å®ç°äº†æŠ½è±¡å·¥å‚ä¸­å®šä¹‰çš„å…¬å…±æ¥å£ï¼Œå› æ­¤åªéœ€è¦æ”¹å˜å…·ä½“å·¥å‚çš„å®ä¾‹ï¼Œå°±å¯ä»¥åœ¨æŸç§ç¨‹åº¦ä¸Šæ”¹å˜æ•´ä¸ªè½¯ä»¶ç³»ç»Ÿçš„è¡Œä¸ºã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“ä¸€ä¸ªäº§å“æ—ä¸­çš„å¤šä¸ªå¯¹è±¡è¢«è®¾è®¡æˆä¸€èµ·å·¥ä½œæ—¶ï¼Œå®ƒèƒ½å¤Ÿä¿è¯å®¢æˆ·ç«¯å§‹ç»ˆåªä½¿ç”¨åŒä¸€ä¸ªäº§å“æ—ä¸­çš„å¯¹è±¡ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ·»åŠ æ–°çš„è¡Œä¸ºæ—¶æ¯”è¾ƒéº»çƒ¦ã€‚å¦‚æœéœ€è¦æ·»åŠ ä¸€ä¸ªæ–°äº§å“æ—å¯¹è±¡æ—¶ï¼Œéœ€è¦æ›´æ”¹æ¥å£åŠå…¶ä¸‹æ‰€æœ‰å­ç±»ï¼Œè¿™å¿…ç„¶ä¼šå¸¦æ¥å¾ˆå¤§çš„éº»çƒ¦ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æŠ½è±¡å·¥å‚æ¨¡å¼ä¸­ä¸»è¦çš„ä¼˜ç‚¹åœ¨äºå…·ä½“ç±»çš„éš”ç¦»ï¼Œæ˜¯çš„å®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“ä»€ä¹ˆè¢«åˆ›å»ºäº†ã€‚å…¶ç¼ºç‚¹åœ¨äºå¢åŠ æ–°çš„ç­‰çº§äº§å“ç»“æ„æ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦ä¿®æ”¹æ¥å£åŠå…¶æ‰€æœ‰å­ç±»ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="ç”Ÿæˆå™¨-å»ºé€ è€…æ¨¡å¼-Builder-Pattern"><a href="#ç”Ÿæˆå™¨-å»ºé€ è€…æ¨¡å¼-Builder-Pattern" class="headerlink" title="ç”Ÿæˆå™¨/å»ºé€ è€…æ¨¡å¼(Builder Pattern)"></a>ç”Ÿæˆå™¨/å»ºé€ è€…æ¨¡å¼(Builder Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="100px"><br>      <col width="730px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Builder</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/169066ffcfb3a6e6?w=568&h=200&f=gif&s=4696" data-width="568"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/169066ffcfb3a6e6?w=568&h=200&f=gif&s=4696" width="568"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“åˆ›å»ºå¤æ‚å¯¹è±¡çš„ç®—æ³•åº”è¯¥ç‹¬ç«‹äºè¯¥å¯¹è±¡çš„ç»„æˆéƒ¨åˆ†ä»¥åŠå®ƒä»¬çš„è£…é…æ–¹å¼æ—¶ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“æ„é€ è¿‡ç¨‹å¿…é¡»å…è®¸è¢«æ„é€ çš„å¯¹è±¡æœ‰ä¸åŒçš„è¡¨ç¤ºæ—¶ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å°†å¤æ‚äº§å“çš„åˆ›å»ºæ­¥éª¤åˆ†è§£åœ¨ä¸åŒçš„æ–¹æ³•ä¸­ï¼Œä½¿å¾—åˆ›å»ºè¿‡ç¨‹æ›´åŠ æ¸…æ™°ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿæ›´åŠ ç²¾ç¡®çš„æ§åˆ¶å¤æ‚å¯¹è±¡çš„äº§ç”Ÿè¿‡ç¨‹ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å°†äº§å“çš„åˆ›å»ºè¿‡ç¨‹ä¸äº§å“æœ¬èº«åˆ†ç¦»å¼€æ¥ï¼Œå¯ä»¥ä½¿ç”¨ç›¸åŒçš„åˆ›å»ºè¿‡ç¨‹æ¥å¾—åˆ°ä¸åŒçš„äº§å“ã€‚ä¹Ÿå°±è¯´ç»†èŠ‚ä¾èµ–æŠ½è±¡ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¯ä¸€ä¸ªå…·ä½“å»ºé€ è€…éƒ½ç›¸å¯¹ç‹¬ç«‹ï¼Œè€Œä¸å…¶ä»–çš„å…·ä½“å»ºé€ è€…æ— å…³ï¼Œå› æ­¤å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ›¿æ¢å…·ä½“å»ºé€ è€…æˆ–å¢åŠ æ–°çš„å…·ä½“å»ºé€ è€…ï¼Œç”¨æˆ·ä½¿ç”¨ä¸åŒçš„å…·ä½“å»ºé€ è€…å³å¯å¾—åˆ°ä¸åŒçš„äº§å“å¯¹è±¡ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å»ºé€ è€…æ¨¡å¼æ‰€åˆ›å»ºçš„äº§å“ä¸€èˆ¬å…·æœ‰è¾ƒå¤šçš„å…±åŒç‚¹ï¼Œå…¶ç»„æˆéƒ¨åˆ†ç›¸ä¼¼ï¼Œå¦‚æœäº§å“ä¹‹é—´çš„å·®å¼‚æ€§å¾ˆå¤§ï¼Œåˆ™ä¸é€‚åˆä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼Œå› æ­¤å…¶ä½¿ç”¨èŒƒå›´å—åˆ°ä¸€å®šçš„é™åˆ¶ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¦‚æœäº§å“çš„å†…éƒ¨å˜åŒ–å¤æ‚ï¼Œå¯èƒ½ä¼šå¯¼è‡´éœ€è¦å®šä¹‰å¾ˆå¤šå…·ä½“å»ºé€ è€…ç±»æ¥å®ç°è¿™ç§å˜åŒ–ï¼Œå¯¼è‡´ç³»ç»Ÿå˜å¾—å¾ˆåºå¤§ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å»ºé€ è€…æ¨¡å¼æ˜¯å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ç»™å°è£…èµ·æ¥ï¼Œå®¢æˆ·åªéœ€è¦çŸ¥é“å¯ä»¥åˆ©ç”¨å¯¹è±¡åæˆ–è€…ç±»å‹å°±èƒ½å¤Ÿå¾—åˆ°ä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡å®ä¾‹ï¼Œè€Œä¸éœ€è¦å…³å¿ƒå¯¹è±¡çš„å…·ä½“åˆ›å»ºè¿‡ç¨‹ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å»ºé€ è€…æ¨¡å¼å°†å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ä¸å¯¹è±¡æœ¬èº«éš”ç¦»å¼€äº†ï¼Œä½¿å¾—ç»†èŠ‚ä¾èµ–äºæŠ½è±¡ï¼Œç¬¦åˆä¾èµ–å€’ç½®åŸåˆ™ã€‚å¯ä»¥ä½¿ç”¨ç›¸åŒçš„åˆ›å»ºè¿‡ç¨‹æ¥åˆ›å»ºä¸åŒçš„äº§å“å¯¹è±¡ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="åŸå‹æ¨¡å¼-Prototype-Pattern"><a href="#åŸå‹æ¨¡å¼-Prototype-Pattern" class="headerlink" title="åŸå‹æ¨¡å¼(Prototype Pattern)"></a>åŸå‹æ¨¡å¼(Prototype Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="105px"><br>      <col width="725px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Prototype</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/169066ffcef96639?w=518&h=242&f=gif&s=5229" data-width="518"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/169066ffcef96639?w=518&h=242&f=gif&s=5229" width="518"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“è¦å®ä¾‹åŒ–çš„ç±»æ˜¯åœ¨è¿è¡Œæ—¶åˆ»æŒ‡å®šæ—¶ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡åŠ¨æ€è£…è½½ï¼›æˆ–è€…</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸ºäº†é¿å…åˆ›å»ºä¸€ä¸ªä¸äº§å“ç±»å±‚æ¬¡å¹³è¡Œçš„å·¥å‚ç±»å±‚æ¬¡æ—¶ï¼›æˆ–è€…</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“ä¸€ä¸ªç±»çš„å®ä¾‹åªèƒ½æœ‰å‡ ä¸ªä¸åŒçŠ¶æ€ç»„åˆä¸­çš„ä¸€ç§æ—¶ã€‚å»ºç«‹ç›¸åº”æ•°ç›®çš„åŸå‹å¹¶å…‹éš†å®ƒä»¬å¯èƒ½æ¯”æ¯æ¬¡ç”¨åˆé€‚çš„çŠ¶æ€æ‰‹å·¥å®ä¾‹åŒ–è¯¥ç±»æ›´æ–¹ä¾¿ä¸€äº›ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¦‚æœåˆ›å»ºæ–°çš„å¯¹è±¡æ¯”è¾ƒå¤æ‚æ—¶ï¼Œå¯ä»¥åˆ©ç”¨åŸå‹æ¨¡å¼ç®€åŒ–å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¤Ÿæé«˜æ•ˆç‡ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¯ä»¥ä½¿ç”¨æ·±å…‹éš†ä¿æŒå¯¹è±¡çš„çŠ¶æ€ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">åŸå‹æ¨¡å¼æä¾›äº†ç®€åŒ–çš„åˆ›å»ºç»“æ„ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">åœ¨å®ç°æ·±å…‹éš†çš„æ—¶å€™å¯èƒ½éœ€è¦æ¯”è¾ƒå¤æ‚çš„ä»£ç ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">éœ€è¦ä¸ºæ¯ä¸€ä¸ªç±»é…å¤‡ä¸€ä¸ªå…‹éš†æ–¹æ³•ï¼Œè€Œä¸”è¿™ä¸ªå…‹éš†æ–¹æ³•éœ€è¦å¯¹ç±»çš„åŠŸèƒ½è¿›è¡Œé€šç›˜è€ƒè™‘ï¼Œè¿™å¯¹å…¨æ–°çš„ç±»æ¥è¯´ä¸æ˜¯å¾ˆéš¾ï¼Œä½†å¯¹å·²æœ‰çš„ç±»è¿›è¡Œæ”¹é€ æ—¶ï¼Œä¸ä¸€å®šæ˜¯ä»¶å®¹æ˜“çš„äº‹ï¼Œå¿…é¡»ä¿®æ”¹å…¶æºä»£ç ï¼Œè¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">åŸå‹æ¨¡å¼å‘å®¢æˆ·éšè—äº†åˆ›å»ºå¯¹è±¡çš„å¤æ‚æ€§ã€‚å®¢æˆ·åªéœ€è¦çŸ¥é“è¦åˆ›å»ºå¯¹è±¡çš„ç±»å‹ï¼Œç„¶åé€šè¿‡è¯·æ±‚å°±å¯ä»¥è·å¾—å’Œè¯¥å¯¹è±¡ä¸€æ¨¡ä¸€æ ·çš„æ–°å¯¹è±¡ï¼Œæ— é¡»çŸ¥é“å…·ä½“çš„åˆ›å»ºè¿‡ç¨‹ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å…‹éš†åˆ†ä¸ºæµ…å…‹éš†å’Œæ·±å…‹éš†ä¸¤ç§ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æˆ‘ä»¬è™½ç„¶å¯ä»¥åˆ©ç”¨åŸå‹æ¨¡å¼æ¥è·å¾—ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä½†æœ‰æ—¶å¯¹è±¡çš„å¤åˆ¶å¯èƒ½ä¼šç›¸å½“çš„å¤æ‚ï¼Œæ¯”å¦‚æ·±å…‹éš†ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="å•ä¾‹æ¨¡å¼-Singleton-Pattern"><a href="#å•ä¾‹æ¨¡å¼-Singleton-Pattern" class="headerlink" title="å•ä¾‹æ¨¡å¼(Singleton Pattern)"></a>å•ä¾‹æ¨¡å¼(Singleton Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="110px"><br>      <col width="720px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Singleton</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/169066ffd087c1e5?w=394&h=146&f=gif&s=3706" data-width="394"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/169066ffd087c1e5?w=394&h=146&f=gif&s=3706" width="394"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“ç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹è€Œä¸”å®¢æˆ·å¯ä»¥ä»ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„è®¿é—®ç‚¹è®¿é—®å®ƒæ—¶ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“è¿™ä¸ªå”¯ä¸€å®ä¾‹åº”è¯¥æ˜¯é€šè¿‡å­ç±»åŒ–å¯æ‰©å±•çš„ï¼Œå¹¶ä¸”å®¢æˆ·åº”è¯¥æ— éœ€æ›´æ”¹ä»£ç å°±èƒ½ä½¿ç”¨ä¸€ä¸ªæ‰©å±•çš„å®ä¾‹æ—¶ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">èŠ‚çº¦äº†ç³»ç»Ÿèµ„æºã€‚ç”±äºç³»ç»Ÿä¸­åªå­˜åœ¨ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œå¯¹ä¸ä¸€äº›éœ€è¦é¢‘ç¹åˆ›å»ºå’Œé”€æ¯å¯¹è±¡çš„ç³»ç»Ÿè€Œè¨€ï¼Œå• ä¾‹æ¨¡å¼æ— ç–‘èŠ‚çº¦äº†ç³»ç»Ÿèµ„æºå’Œæé«˜äº†ç³»ç»Ÿçš„æ€§èƒ½ã€‚<br>              </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å› ä¸ºå•ä¾‹ç±»å°è£…äº†å®ƒçš„å”¯ä¸€å®ä¾‹ï¼Œæ‰€ä»¥å®ƒå¯ä»¥ä¸¥æ ¼æ§åˆ¶å®¢æˆ·æ€æ ·ä»¥åŠä½•æ—¶è®¿é—®å®ƒã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç”±äºå•ä¾‹æ¨¡å¼ä¸­æ²¡æœ‰æŠ½è±¡å±‚ï¼Œå› æ­¤å•ä¾‹ç±»çš„æ‰©å±•æœ‰å¾ˆå¤§çš„å›°éš¾ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å•ä¾‹ç±»çš„èŒè´£è¿‡é‡ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè¿èƒŒäº†â€œå•ä¸€èŒè´£åŸåˆ™â€ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å•ä¾‹æ¨¡å¼ä¸­ç¡®ä¿ç¨‹åºä¸­ä¸€ä¸ªç±»æœ€å¤šåªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å•ä¾‹æ¨¡å¼çš„æ„é€ å™¨æ˜¯ç§æœ‰äº†ï¼Œè€Œä¸”å®ƒå¿…é¡»è¦æä¾›å®ä¾‹çš„å…¨å±€è®¿é—®ç‚¹ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å•ä¾‹æ¨¡å¼å¯èƒ½ä¼šå› ä¸ºå¤šçº¿ç¨‹çš„é—®é¢˜è€Œå¸¦æ¥å®‰å…¨éšæ‚£ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BetterSingleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">BetterSingleton2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BetterSingleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Singleton.BETTER_SINGLETON;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>â€‹ <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</span><br><span class="line">      <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span>  BetterSingleton BETTER_SINGLETON = <span class="keyword">new</span> BetterSingleton();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºå‹è®¾è®¡æ¨¡å¼å°ç»“"><a href="#åˆ›å»ºå‹è®¾è®¡æ¨¡å¼å°ç»“" class="headerlink" title="åˆ›å»ºå‹è®¾è®¡æ¨¡å¼å°ç»“"></a>åˆ›å»ºå‹è®¾è®¡æ¨¡å¼å°ç»“</h3><table><thead><tr><th style="text-align:left"><strong>æ¨¡å¼</strong></th><th>åœºæ™¯å‘æ•£</th><th style="text-align:left"><strong>ä¸€å¥è¯æ¦‚æ‹¬</strong></th></tr></thead><tbody><tr><td style="text-align:left">å·¥å‚æ–¹æ³•(Factory Method)</td><td>newå¤ªå¤šå¦‚ä½•ç®¡ç†</td><td style="text-align:left">ç”Ÿäº§ç³»åˆ—äº§å“ã€‚</td></tr><tr><td style="text-align:left">æŠ½è±¡å·¥å‚(Abstract Factory)</td><td>newå¤ªå¤šå¦‚ä½•ç®¡ç†</td><td style="text-align:left">ä¸€æ¬¡ç”Ÿäº§å¤šä¸ªä¸åŒäº§å“ã€‚</td></tr><tr><td style="text-align:left">ç”Ÿæˆå™¨(Builder)</td><td>è½¦æ‰‹é€‰è½¦</td><td style="text-align:left">ç”Ÿäº§æœ‰å¾ˆå¤šç»„ä»¶çš„äº§å“ã€‚</td></tr><tr><td style="text-align:left">åŸå‹(Prototype)</td><td>å¤åˆ¶ä¸èƒ½å¾ˆéš¾</td><td style="text-align:left">å…‹éš†å¯¹è±¡ã€‚</td></tr><tr><td style="text-align:left">å•ä»¶(Singleton)</td><td>å¦‚ä½•ç®¡ç†å…¨å±€ä¿¡æ¯</td><td style="text-align:left">å…¨å±€åªæœ‰ä¸€ä¸ªã€‚</td></tr></tbody></table><h2 id="ç»“æ„å‹è®¾è®¡æ¨¡å¼-å¤„ç†ç±»æˆ–è€…å¯¹è±¡çš„ç»„åˆ"><a href="#ç»“æ„å‹è®¾è®¡æ¨¡å¼-å¤„ç†ç±»æˆ–è€…å¯¹è±¡çš„ç»„åˆ" class="headerlink" title="ç»“æ„å‹è®¾è®¡æ¨¡å¼(å¤„ç†ç±»æˆ–è€…å¯¹è±¡çš„ç»„åˆ)"></a>ç»“æ„å‹è®¾è®¡æ¨¡å¼(å¤„ç†ç±»æˆ–è€…å¯¹è±¡çš„ç»„åˆ)</h2><h3 id="æ¡¥æ¥æ¨¡å¼-Bridge-Pattern"><a href="#æ¡¥æ¥æ¨¡å¼-Bridge-Pattern" class="headerlink" title="æ¡¥æ¥æ¨¡å¼(Bridge Pattern)"></a>æ¡¥æ¥æ¨¡å¼(Bridge Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="131px"><br>      <col width="699px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Bridge</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/169066ffd161b914?w=600&h=246&f=gif&s=5880" data-width="600"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/169066ffd161b914?w=600&h=246&f=gif&s=5880" width="600"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬éƒ½å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¦‚æœä¸€ä¸ªç³»ç»Ÿéœ€è¦åœ¨æ„ä»¶çš„æŠ½è±¡åŒ–è§’è‰²å’Œå…·ä½“åŒ–è§’è‰²ä¹‹é—´å¢åŠ æ›´å¤šçš„çµæ´»æ€§ï¼Œé¿å…åœ¨ä¸¤ä¸ªå±‚æ¬¡ä¹‹é—´å»ºç«‹é™æ€çš„ç»§æ‰¿è”ç³»ï¼Œé€šè¿‡æ¡¥æ¥æ¨¡å¼å¯ä»¥ä½¿å®ƒä»¬åœ¨æŠ½è±¡å±‚å»ºç«‹ä¸€ä¸ªå…³è”å…³ç³»ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¯¹äºé‚£äº›ä¸å¸Œæœ›ä½¿ç”¨ç»§æ‰¿æˆ–å› ä¸ºå¤šå±‚æ¬¡ç»§æ‰¿å¯¼è‡´ç³»ç»Ÿç±»çš„ä¸ªæ•°æ€¥å‰§å¢åŠ çš„ç³»ç»Ÿï¼Œæ¡¥æ¥æ¨¡å¼å°¤ä¸ºé€‚ç”¨</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸€ä¸ªç±»å­˜åœ¨ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œä¸”è¿™ä¸¤ä¸ªç»´åº¦éƒ½éœ€è¦è¿›è¡Œæ‰©å±•ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">åˆ†ç¦»æŠ½è±¡æ¥å£åŠå…¶å®ç°éƒ¨åˆ†ã€‚æé«˜äº†æ¯”ç»§æ‰¿æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¡¥æ¥æ¨¡å¼æé«˜äº†ç³»ç»Ÿçš„å¯æ‰©å……æ€§ï¼Œåœ¨ä¸¤ä¸ªå˜åŒ–ç»´åº¦ä¸­ä»»æ„æ‰©å±•ä¸€ä¸ªç»´åº¦ï¼Œéƒ½ä¸éœ€è¦ä¿®æ”¹åŸæœ‰ç³»ç»Ÿã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å®ç°ç»†èŠ‚å¯¹å®¢æˆ·é€æ˜ï¼Œå¯ä»¥å¯¹ç”¨æˆ·éšè—å®ç°ç»†èŠ‚ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¡¥æ¥æ¨¡å¼çš„å¼•å…¥ä¼šå¢åŠ ç³»ç»Ÿçš„ç†è§£ä¸è®¾è®¡éš¾åº¦ï¼Œç”±äºèšåˆå…³è”å…³ç³»å»ºç«‹åœ¨æŠ½è±¡å±‚ï¼Œè¦æ±‚å¼€å‘è€…é’ˆå¯¹æŠ½è±¡è¿›è¡Œè®¾è®¡ä¸ç¼–ç¨‹ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¡¥æ¥æ¨¡å¼è¦æ±‚æ­£ç¡®è¯†åˆ«å‡ºç³»ç»Ÿä¸­ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œå› æ­¤å…¶ä½¿ç”¨èŒƒå›´å…·æœ‰ä¸€å®šçš„å±€é™æ€§ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¡¥æ¥æ¨¡å¼å®ç°äº†æŠ½è±¡åŒ–ä¸å®ç°åŒ–çš„è„±è€¦ã€‚ä»–ä»¬ä¸¤ä¸ªäº’ç›¸ç‹¬ç«‹ï¼Œä¸ä¼šå½±å“åˆ°å¯¹æ–¹ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¯¹äºä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œä½¿ç”¨æ¡¥æ¥æ¨¡å¼å†é€‚åˆä¸è¿‡äº†ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¯¹äºâ€œå…·ä½“çš„æŠ½è±¡ç±»â€æ‰€åšçš„æ”¹å˜ï¼Œæ˜¯ä¸ä¼šå½±å“åˆ°å®¢æˆ·ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="è½»é‡æ¨¡å¼-äº«å…ƒæ¨¡å¼-FlyWeightPattern"><a href="#è½»é‡æ¨¡å¼-äº«å…ƒæ¨¡å¼-FlyWeightPattern" class="headerlink" title="è½»é‡æ¨¡å¼/äº«å…ƒæ¨¡å¼(FlyWeightPattern)"></a>è½»é‡æ¨¡å¼/äº«å…ƒæ¨¡å¼(FlyWeightPattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="130px"><br>      <col width="700px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Flyweight</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/169066fff2baad07?w=598&h=369&f=gif&s=9534" data-width="598"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/169066fff2baad07?w=598&h=369&f=gif&s=9534" width="598"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">è¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸€ä¸ªåº”ç”¨ç¨‹åºä½¿ç”¨äº†å¤§é‡çš„å¯¹è±¡ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å®Œå…¨ç”±äºä½¿ç”¨å¤§é‡çš„å¯¹è±¡ï¼Œé€ æˆå¾ˆå¤§çš„å­˜å‚¨å¼€é”€ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¯¹è±¡çš„å¤§å¤šæ•°çŠ¶æ€éƒ½å¯å˜ä¸ºå¤–éƒ¨çŠ¶æ€ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¦‚æœåˆ é™¤å¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ç›¸å¯¹è¾ƒå°‘çš„å…±äº«å¯¹è±¡å–ä»£å¾ˆå¤šç»„å¯¹è±¡ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">åº”ç”¨ç¨‹åºä¸ä¾èµ–äºå¯¹è±¡æ ‡è¯†ã€‚ç”±äºF l y w e i g h t å¯¹è±¡å¯ä»¥è¢«å…±äº«ï¼Œå¯¹äºæ¦‚å¿µä¸Šæ˜æ˜¾æœ‰åˆ«çš„å¯¹è±¡ï¼Œæ ‡è¯†æµ‹è¯•å°†è¿”å›çœŸå€¼ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">äº«å…ƒæ¨¡å¼çš„ä¼˜ç‚¹åœ¨äºå®ƒèƒ½å¤Ÿæå¤§çš„å‡å°‘ç³»ç»Ÿä¸­å¯¹è±¡çš„ä¸ªæ•°ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">äº«å…ƒæ¨¡å¼ç”±äºä½¿ç”¨äº†å¤–éƒ¨çŠ¶æ€ï¼Œå¤–éƒ¨çŠ¶æ€ç›¸å¯¹ç‹¬ç«‹ï¼Œä¸ä¼šå½±å“åˆ°å†…éƒ¨çŠ¶æ€ï¼Œæ‰€ä»¥äº«å…ƒæ¨¡å¼ä½¿å¾—äº«å…ƒå¯¹è±¡èƒ½å¤Ÿåœ¨ä¸åŒçš„ç¯å¢ƒè¢«å…±äº«ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç”±äºäº«å…ƒæ¨¡å¼éœ€è¦åŒºåˆ†å¤–éƒ¨çŠ¶æ€å’Œå†…éƒ¨çŠ¶æ€ï¼Œä½¿å¾—åº”ç”¨ç¨‹åºåœ¨æŸç§ç¨‹åº¦ä¸Šæ¥è¯´æ›´åŠ å¤æ‚åŒ–äº†ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸ºäº†ä½¿å¯¹è±¡å¯ä»¥å…±äº«ï¼Œäº«å…ƒæ¨¡å¼éœ€è¦å°†äº«å…ƒå¯¹è±¡çš„çŠ¶æ€å¤–éƒ¨åŒ–ï¼Œè€Œè¯»å–å¤–éƒ¨çŠ¶æ€ä½¿å¾—è¿è¡Œæ—¶é—´å˜é•¿ã€‚ </div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">äº«å…ƒæ¨¡å¼å¯ä»¥æå¤§åœ°å‡å°‘ç³»ç»Ÿä¸­å¯¹è±¡çš„æ•°é‡ã€‚ä½†æ˜¯å®ƒå¯èƒ½ä¼šå¼•èµ·ç³»ç»Ÿçš„é€»è¾‘æ›´åŠ å¤æ‚åŒ–ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">äº«å…ƒæ¨¡å¼çš„æ ¸å¿ƒåœ¨äºäº«å…ƒå·¥å‚ï¼Œå®ƒä¸»è¦ç”¨æ¥ç¡®ä¿åˆç†åœ°å…±äº«äº«å…ƒå¯¹è±¡ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å†…éƒ¨çŠ¶æ€ä¸ºä¸å˜å…±äº«éƒ¨åˆ†ï¼Œå­˜å‚¨äºäº«å…ƒäº«å…ƒå¯¹è±¡å†…éƒ¨ï¼Œè€Œå¤–éƒ¨çŠ¶æ€æ˜¯å¯å˜éƒ¨åˆ†ï¼Œå®ƒåº”å½“ç”±å®¢æˆ·ç«¯æ¥è´Ÿè´£ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="å¤–è§‚æ¨¡å¼-Facade-Pattern"><a href="#å¤–è§‚æ¨¡å¼-Facade-Pattern" class="headerlink" title="å¤–è§‚æ¨¡å¼(Facade Pattern)"></a>å¤–è§‚æ¨¡å¼(Facade Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="130px"><br>      <col width="700px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Facade</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/169066fff3c18dd3?w=476&h=185&f=gif&s=3356" data-width="476"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/169066fff3c18dd3?w=476&h=185&f=gif&s=3356" width="476"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢ï¼ŒF a c a d e æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“ä½ è¦ä¸ºä¸€ä¸ªå¤æ‚å­ç³»ç»Ÿæä¾›ä¸€ä¸ªç®€å•æ¥å£æ—¶ã€‚å­ç³»ç»Ÿå¾€å¾€å› ä¸ºä¸æ–­æ¼”åŒ–è€Œå˜å¾—è¶Šæ¥è¶Šå¤æ‚ã€‚å¤§å¤šæ•°æ¨¡å¼ä½¿ç”¨æ—¶éƒ½ä¼šäº§ç”Ÿæ›´å¤šæ›´å°çš„ç±»ã€‚è¿™ä½¿å¾—å­ç³»ç»Ÿæ›´å…·å¯é‡ç”¨æ€§ï¼Œä¹Ÿæ›´å®¹æ˜“å¯¹å­ç³»ç»Ÿè¿›è¡Œå®šåˆ¶ï¼Œä½†è¿™ä¹Ÿç»™é‚£äº›ä¸éœ€è¦å®šåˆ¶å­ç³»ç»Ÿçš„ç”¨æˆ·å¸¦æ¥ä¸€äº›ä½¿ç”¨ä¸Šçš„å›°éš¾ã€‚F a c a d e å¯ä»¥æä¾›ä¸€ä¸ªç®€å•çš„ç¼ºçœè§†å›¾ï¼Œè¿™ä¸€è§†å›¾å¯¹å¤§å¤šæ•°ç”¨æˆ·æ¥è¯´å·²ç»è¶³å¤Ÿï¼Œè€Œé‚£äº›éœ€è¦æ›´å¤šçš„å¯å®šåˆ¶æ€§çš„ç”¨æˆ·å¯ä»¥è¶Šè¿‡f a c a d e å±‚ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å®¢æˆ·ç¨‹åºä¸æŠ½è±¡ç±»çš„å®ç°éƒ¨åˆ†ä¹‹é—´å­˜åœ¨ç€å¾ˆå¤§çš„ä¾èµ–æ€§ã€‚å¼•å…¥f a c a d e å°†è¿™ä¸ªå­ç³»ç»Ÿä¸å®¢æˆ·ä»¥åŠå…¶ä»–çš„å­ç³»ç»Ÿåˆ†ç¦»ï¼Œå¯ä»¥æé«˜å­ç³»ç»Ÿçš„ç‹¬ç«‹æ€§å’Œå¯ç§»æ¤æ€§ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“ä½ éœ€è¦æ„å»ºä¸€ä¸ªå±‚æ¬¡ç»“æ„çš„å­ç³»ç»Ÿæ—¶ï¼Œä½¿ç”¨f a c a d e æ¨¡å¼å®šä¹‰å­ç³»ç»Ÿä¸­æ¯å±‚çš„å…¥å£ç‚¹ã€‚å¦‚æœå­ç³»ç»Ÿä¹‹é—´æ˜¯ç›¸äº’ä¾èµ–çš„ï¼Œä½ å¯ä»¥è®©å®ƒä»¬ä»…é€šè¿‡f a c a d e è¿›è¡Œé€šè®¯ï¼Œä»è€Œç®€åŒ–äº†å®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¼•å…¥å¤–è§‚æ¨¡å¼ï¼Œæ˜¯å®¢æˆ·å¯¹å­ç³»ç»Ÿçš„ä½¿ç”¨å˜å¾—ç®€å•äº†ï¼Œå‡å°‘äº†ä¸å­ç³»ç»Ÿçš„å…³è”å¯¹è±¡ï¼Œå®ç°äº†å­ç³»ç»Ÿä¸å®¢æˆ·ä¹‹é—´çš„æ¾è€¦åˆå…³ç³»ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">åªæ˜¯æä¾›äº†ä¸€ä¸ªè®¿é—®å­ç³»ç»Ÿçš„ç»Ÿä¸€å…¥å£ï¼Œå¹¶ä¸å½±å“ç”¨æˆ·ç›´æ¥ä½¿ç”¨å­ç³»ç»Ÿç±»</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">é™ä½äº†å¤§å‹è½¯ä»¶ç³»ç»Ÿä¸­çš„ç¼–è¯‘ä¾èµ–æ€§ï¼Œå¹¶ç®€åŒ–äº†ç³»ç»Ÿåœ¨ä¸åŒå¹³å°ä¹‹é—´çš„ç§»æ¤è¿‡ç¨‹</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸èƒ½å¾ˆå¥½åœ°é™åˆ¶å®¢æˆ·ä½¿ç”¨å­ç³»ç»Ÿç±»ï¼Œå¦‚æœå¯¹å®¢æˆ·è®¿é—®å­ç³»ç»Ÿç±»åšå¤ªå¤šçš„é™åˆ¶åˆ™å‡å°‘äº†å¯å˜æ€§å’Œçµæ´»æ€§</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">åœ¨ä¸å¼•å…¥æŠ½è±¡å¤–è§‚ç±»çš„æƒ…å†µä¸‹ï¼Œå¢åŠ æ–°çš„å­ç³»ç»Ÿå¯èƒ½éœ€è¦ä¿®æ”¹å¤–è§‚ç±»æˆ–å®¢æˆ·ç«¯çš„æºä»£ç ï¼Œè¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p"> å¤–è§‚æ¨¡å¼çš„ä¸»è¦ä¼˜ç‚¹å°±åœ¨äºå‡å°‘äº†å®¢æˆ·ä¸å­ç³»ç»Ÿä¹‹é—´çš„å…³è”å¯¹è±¡ï¼Œä½¿ç”¨å®¢æˆ·å¯¹å­ç³»ç»Ÿçš„ä½¿ç”¨å˜å¾—ç®€å•äº†ï¼Œä¹Ÿå®ç°äº†å®¢æˆ·ç«¯ä¸å­ç³»ç»Ÿä¹‹é—´çš„æ¾è€¦åˆå…³ç³»ã€‚å®ƒçš„ç¼ºç‚¹å°±åœ¨äºè¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¦‚æœéœ€è¦å®ç°ä¸€ä¸ªå¤–è§‚æ¨¡å¼ï¼Œéœ€è¦å°†å­ç³»ç»Ÿç»„åˆè¿›å¤–è§‚ä¸­ï¼Œç„¶åå°†å·¥ä½œå§”æ‰˜ç»™å­ç³»ç»Ÿæ‰§è¡Œã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="è£…é¥°è€…æ¨¡å¼-Decorator-Pattern"><a href="#è£…é¥°è€…æ¨¡å¼-Decorator-Pattern" class="headerlink" title="è£…é¥°è€…æ¨¡å¼(Decorator Pattern)"></a>è£…é¥°è€…æ¨¡å¼(Decorator Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="134px"><br>      <col width="696px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Decorator</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/1690670008f047fb?w=645&h=285&f=gif&s=7475" data-width="645"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/1690670008f047fb?w=645&h=285&f=gif&s=7475" width="645"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚å°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼ŒD e c o r a t o r æ¨¡å¼ç›¸æ¯”ç”Ÿæˆå­ç±»æ›´ä¸ºçµæ´»ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">åœ¨ä¸å½±å“å…¶ä»–å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œä»¥åŠ¨æ€ã€é€æ˜çš„æ–¹å¼ç»™å•ä¸ªå¯¹è±¡æ·»åŠ èŒè´£ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¤„ç†é‚£äº›å¯ä»¥æ’¤æ¶ˆçš„èŒè´£ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“ä¸èƒ½é‡‡ç”¨ç”Ÿæˆå­ç±»çš„æ–¹æ³•è¿›è¡Œæ‰©å……æ—¶ã€‚ä¸€ç§æƒ…å†µæ˜¯ï¼Œå¯èƒ½æœ‰å¤§é‡ç‹¬ç«‹çš„æ‰©å±•ï¼Œä¸ºæ”¯æŒæ¯ä¸€ç§ç»„åˆå°†äº§ç”Ÿå¤§é‡çš„å­ç±»ï¼Œä½¿å¾—å­ç±»æ•°ç›®å‘ˆçˆ†ç‚¸æ€§å¢é•¿ã€‚å¦ä¸€ç§æƒ…å†µå¯èƒ½æ˜¯å› ä¸ºç±»å®šä¹‰è¢«éšè—ï¼Œæˆ–ç±»å®šä¹‰ä¸èƒ½ç”¨äºç”Ÿæˆå­ç±»ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è£…é¥°è€…æ¨¡å¼å¯ä»¥æä¾›æ¯”ç»§æ‰¿æ›´å¤šçš„çµæ´»æ€§</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¯ä»¥é€šè¿‡ä¸€ç§åŠ¨æ€çš„æ–¹å¼æ¥æ‰©å±•ä¸€ä¸ªå¯¹è±¡çš„åŠŸèƒ½ï¼Œåœ¨è¿è¡Œæ—¶é€‰æ‹©ä¸åŒçš„è£…é¥°å™¨ï¼Œä»è€Œå®ç°ä¸åŒçš„è¡Œä¸ºã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">é€šè¿‡ä½¿ç”¨ä¸åŒçš„å…·ä½“è£…é¥°ç±»ä»¥åŠè¿™äº›è£…é¥°ç±»çš„æ’åˆ—ç»„åˆï¼Œå¯ä»¥åˆ›é€ å‡ºå¾ˆå¤šä¸åŒè¡Œä¸ºçš„ç»„åˆã€‚å¯ä»¥ä½¿ç”¨å¤šä¸ªå…·ä½“è£…é¥°ç±»æ¥è£…é¥°åŒä¸€å¯¹è±¡ï¼Œå¾—åˆ°åŠŸèƒ½æ›´ä¸ºå¼ºå¤§çš„å¯¹è±¡ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å…·ä½“æ„ä»¶ç±»ä¸å…·ä½“è£…é¥°ç±»å¯ä»¥ç‹¬ç«‹å˜åŒ–ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦å¢åŠ æ–°çš„å…·ä½“æ„ä»¶ç±»å’Œå…·ä½“è£…é¥°ç±»ï¼Œåœ¨ä½¿ç”¨æ—¶å†å¯¹å…¶è¿›è¡Œç»„åˆï¼ŒåŸæœ‰ä»£ç æ— é¡»æ”¹å˜ï¼Œç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¼šäº§ç”Ÿå¾ˆå¤šçš„å°å¯¹è±¡ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚æ€§</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è¿™ç§æ¯”ç»§æ‰¿æ›´åŠ çµæ´»æœºåŠ¨çš„ç‰¹æ€§ï¼Œä¹ŸåŒæ—¶æ„å‘³ç€è£…é¥°æ¨¡å¼æ¯”ç»§æ‰¿æ›´åŠ æ˜“äºå‡ºé”™ï¼Œæ’é”™ä¹Ÿå¾ˆå›°éš¾ï¼Œå¯¹äºå¤šæ¬¡è£…é¥°çš„å¯¹è±¡ï¼Œè°ƒè¯•æ—¶å¯»æ‰¾é”™è¯¯å¯èƒ½éœ€è¦é€çº§æ’æŸ¥ï¼Œè¾ƒä¸ºçƒ¦çã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è£…é¥°è€…æ¨¡å¼æ„å‘³ç€ä¸€ç¾¤è£…é¥°è€…ç±»ï¼Œè¿™äº›ç±»ç”¨æ¥åŒ…è£…å…·ä½“ç»„ä»¶</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è£…é¥°è€…å¯ä»¥åœ¨è¢«è£…é¥°è€…çš„è¡Œä¸ºå‰é¢æˆ–è€…åé¢åŠ ä¸Šè‡ªå·±çš„è¡Œä¸ºï¼Œç”šè‡³å¯ä»¥å°†è¢«è£…é¥°è€…çš„è¡Œä¸ºæ•´ä¸ªå–ä»£æ‰ï¼Œä»è€Œè¾¾åˆ°ç‰¹å®šçš„ç›®çš„ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¯ä»¥ç”¨å¤šä¸ªè£…é¥°è€…åŒ…è£…ä¸€ä¸ªç»„ä»¶ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è£…é¥°è€…ä¸€èˆ¬å¯¹äºç»„ä»¶çš„å®¢æˆ·æ˜¯é€æ˜çš„ï¼Œé™¤éå®¢æˆ·ç¨‹åºä¾èµ–äºç»„ä»¶çš„å…·ä½“ç±»å‹ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è£…é¥°è€…ä¼šå¯¼è‡´è®¾è®¡ä¸­å‡ºç°è®¸å¤šçš„å°å¯¹è±¡ï¼Œå¦‚æœè¿‡åº¦çš„ä½¿ç”¨ï¼Œä¼šè®©ç³»ç»Ÿå˜å¾—æ›´åŠ å¤æ‚ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è£…é¥°è€…å’Œè¢«è£…é¥°è€…å¯¹è±¡æœ‰ç›¸åŒçš„è¶…ç±»å‹ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="ç»„åˆæ¨¡å¼-Composite-Pattern"><a href="#ç»„åˆæ¨¡å¼-Composite-Pattern" class="headerlink" title="ç»„åˆæ¨¡å¼(Composite Pattern)"></a>ç»„åˆæ¨¡å¼(Composite Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="139px"><br>      <col width="691px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Composite</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/169067000a66785d?w=571&h=257&f=gif&s=6139" data-width="571"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/169067000a66785d?w=571&h=257&f=gif&s=6139" width="571"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤º?éƒ¨åˆ†-æ•´ä½“?çš„å±‚æ¬¡ç»“æ„ã€‚C o m p o s i t e ä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä½ æƒ³è¡¨ç¤ºå¯¹è±¡çš„éƒ¨åˆ†-æ•´ä½“å±‚æ¬¡ç»“æ„ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä½ å¸Œæœ›ç”¨æˆ·å¿½ç•¥ç»„åˆå¯¹è±¡ä¸å•ä¸ªå¯¹è±¡çš„ä¸åŒï¼Œç”¨æˆ·å°†ç»Ÿä¸€åœ°ä½¿ç”¨ç»„åˆç»“æ„ä¸­çš„æ‰€æœ‰å¯¹è±¡ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¯ä»¥æ¸…æ¥šåœ°å®šä¹‰åˆ†å±‚æ¬¡çš„å¤æ‚å¯¹è±¡ï¼Œè¡¨ç¤ºå¯¹è±¡çš„å…¨éƒ¨æˆ–éƒ¨åˆ†å±‚æ¬¡ï¼Œä½¿å¾—å¢åŠ æ–°æ„ä»¶ä¹Ÿæ›´å®¹æ˜“ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å®¢æˆ·ç«¯è°ƒç”¨ç®€å•ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸€è‡´çš„ä½¿ç”¨ç»„åˆç»“æ„æˆ–å…¶ä¸­å•ä¸ªå¯¹è±¡ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å®šä¹‰äº†åŒ…å«å¶å­å¯¹è±¡å’Œå®¹å™¨å¯¹è±¡çš„ç±»å±‚æ¬¡ç»“æ„ï¼Œå¶å­å¯¹è±¡å¯ä»¥è¢«ç»„åˆæˆæ›´å¤æ‚çš„å®¹å™¨å¯¹è±¡ï¼Œè€Œè¿™ä¸ªå®¹å™¨å¯¹è±¡åˆå¯ä»¥è¢«ç»„åˆï¼Œè¿™æ ·ä¸æ–­é€’å½’ä¸‹å»ï¼Œå¯ä»¥å½¢æˆå¤æ‚çš„æ ‘å½¢ç»“æ„ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ›´å®¹æ˜“åœ¨ç»„åˆä½“å†…åŠ å…¥å¯¹è±¡æ„ä»¶ï¼Œå®¢æˆ·ç«¯ä¸å¿…å› ä¸ºåŠ å…¥äº†æ–°çš„å¯¹è±¡æ„ä»¶è€Œæ›´æ”¹åŸæœ‰ä»£ç ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä½¿è®¾è®¡å˜å¾—æ›´åŠ æŠ½è±¡ï¼Œå¯¹è±¡çš„ä¸šåŠ¡è§„åˆ™å¦‚æœå¾ˆå¤æ‚ï¼Œåˆ™å®ç°ç»„åˆæ¨¡å¼å…·æœ‰å¾ˆå¤§æŒ‘æˆ˜æ€§ï¼Œè€Œä¸”ä¸æ˜¯æ‰€æœ‰çš„æ–¹æ³•éƒ½ä¸å¶å­å¯¹è±¡å­ç±»éƒ½æœ‰å…³è”ï¼Œä¼šæœ‰å†—ä½™ä»£ç </div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p"> ç»„åˆæ¨¡å¼ç”¨äºå°†å¤šä¸ªå¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºâ€œæ•´ä½“-éƒ¨åˆ†â€çš„ç»“æ„å±‚æ¬¡ã€‚ç»„åˆæ¨¡å¼å¯¹å•ä¸ªå¯¹è±¡ï¼ˆå¶å­å¯¹è±¡ï¼‰å’Œç»„åˆå¯¹è±¡ï¼ˆå®¹å™¨å¯¹è±¡ï¼‰çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç»„åˆå¯¹è±¡çš„å…³é”®åœ¨äºå®ƒå®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡æ„å»ºç±»ï¼Œå®ƒæ—¢å¯è¡¨ç¤ºå¶å­å¯¹è±¡ï¼Œä¹Ÿå¯è¡¨ç¤ºå®¹å™¨å¯¹è±¡ï¼Œå®¢æˆ·ä»…ä»…éœ€è¦é’ˆå¯¹è¿™ä¸ªæŠ½è±¡æ„å»ºè¿›è¡Œç¼–ç¨‹ï¼Œæ— é¡»çŸ¥é“ä»–æ˜¯å¶å­å¯¹è±¡è¿˜æ˜¯å®¹å™¨å¯¹è±¡ï¼Œéƒ½æ˜¯ä¸€è‡´å¯¹å¾…ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p"> ç»„åˆæ¨¡å¼è™½ç„¶èƒ½å¤Ÿéå¸¸å¥½åœ°å¤„ç†å±‚æ¬¡ç»“æ„ï¼Œä¹Ÿä½¿å¾—å®¢æˆ·ç«¯ç¨‹åºå˜å¾—ç®€å•ï¼Œä½†æ˜¯å®ƒä¹Ÿä½¿å¾—è®¾è®¡å˜å¾—æ›´åŠ æŠ½è±¡ï¼Œè€Œä¸”ä¹Ÿå¾ˆéš¾å¯¹å®¹å™¨ä¸­çš„æ„ä»¶ç±»å‹è¿›è¡Œé™åˆ¶ï¼Œè¿™ä¼šå¯¼è‡´åœ¨å¢åŠ æ–°çš„æ„ä»¶æ—¶ä¼šäº§ç”Ÿä¸€äº›é—®é¢˜ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="ä»£ç†æ¨¡å¼-Proxy-Pattern"><a href="#ä»£ç†æ¨¡å¼-Proxy-Pattern" class="headerlink" title="ä»£ç†æ¨¡å¼(Proxy Pattern)"></a>ä»£ç†æ¨¡å¼(Proxy Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="140px"><br>      <col width="690px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Proxy</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/169067000f5e737e?w=540&h=226&f=gif&s=4257" data-width="540"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/169067000f5e737e?w=540&h=226&f=gif&s=4257" width="540"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸å¸Œæœ›æŸäº›ç±»è¢«ç›´æ¥è®¿é—®ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è®¿é—®ä¹‹å‰å¸Œæœ›å…ˆè¿›è¡Œä¸€äº›é¢„å¤„ç†ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¸Œæœ›å¯¹è¢«è®¿é—®çš„å¯¹è±¡è¿›è¡Œå†…å­˜ã€æƒé™ç­‰æ–¹é¢çš„æ§åˆ¶ã€‚ æ¨¡å¼ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä»£ç†æ¨¡å¼èƒ½å¤Ÿåè°ƒè°ƒç”¨è€…å’Œè¢«è°ƒç”¨è€…ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šé™ä½äº†ç³»ç»Ÿçš„è€¦åˆåº¦ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä»£ç†å¯¹è±¡å¯ä»¥åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸­ä»‹çš„ä½œç”¨ï¼Œè¿™æ ·èµ·åˆ°äº†çš„ä½œç”¨å’Œä¿æŠ¤äº†ç›®æ ‡å¯¹è±¡çš„</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç”±äºåœ¨å®¢æˆ·ç«¯å’ŒçœŸå®ä¸»é¢˜ä¹‹é—´å¢åŠ äº†ä»£ç†å¯¹è±¡ï¼Œå› æ­¤æœ‰äº›ç±»å‹çš„ä»£ç†æ¨¡å¼å¯èƒ½ä¼šé€ æˆè¯·æ±‚çš„å¤„ç†é€Ÿåº¦å˜æ…¢ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å®ç°ä»£ç†æ¨¡å¼éœ€è¦é¢å¤–çš„å·¥ä½œï¼Œæœ‰äº›ä»£ç†æ¨¡å¼çš„å®ç°éå¸¸å¤æ‚ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä»£ç†æ¨¡å¼æ˜¯é€šè¿‡ä½¿ç”¨å¼•ç”¨ä»£ç†å¯¹è±¡æ¥è®¿é—®çœŸå®å¯¹è±¡ï¼Œåœ¨è¿™é‡Œä»£ç†å¯¹è±¡å……å½“ç”¨äºè¿æ¥å®¢æˆ·ç«¯å’ŒçœŸå®å¯¹è±¡çš„ä¸­ä»‹è€…ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä»£ç†æ¨¡å¼ä¸»è¦ç”¨äºè¿œç¨‹ä»£ç†ã€è™šæ‹Ÿä»£ç†å’Œä¿æŠ¤ä»£ç†ã€‚å…¶ä¸­ä¿æŠ¤ä»£ç†å¯ä»¥è¿›è¡Œè®¿é—®æƒé™æ§åˆ¶ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="é€‚é…å™¨æ¨¡å¼-Adapter-Pattern"><a href="#é€‚é…å™¨æ¨¡å¼-Adapter-Pattern" class="headerlink" title="é€‚é…å™¨æ¨¡å¼(Adapter Pattern)"></a>é€‚é…å™¨æ¨¡å¼(Adapter Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="150px"><br>      <col width="680px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Adapter</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/169067001155f956?w=524&h=197&f=gif&s=4173" data-width="524"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/169067001155f956?w=524&h=197&f=gif&s=4173" width="524"><br>            </div><pre><code>        &lt;div data-type=&quot;image&quot; data-display=&quot;block&quot; data-align=&quot;center&quot; data-src=&quot;http://www.uml.org.cn/chanpin/intro/WebHelp/Adapter_Class.gif&quot; data-width=&quot;543&quot;&gt;          &lt;img src=&quot;http://www.uml.org.cn/chanpin/intro/WebHelp/Adapter_Class.gif&quot; width=&quot;543&quot; /&gt;        &lt;/div&gt;      &lt;/div&gt;    &lt;/td&gt;  &lt;/tr&gt;  &lt;tr&gt;    &lt;td rowspan=&quot;1&quot; colSpan=&quot;1&quot;&gt;      &lt;div data-type=&quot;p&quot;&gt;åŠ¨æœº&lt;/div&gt;    &lt;/td&gt;    &lt;td rowspan=&quot;1&quot; colSpan=&quot;1&quot;&gt;      &lt;div data-type=&quot;p&quot;&gt;å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ã€‚Adapter æ¨¡å¼ä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚&lt;/div&gt;    &lt;/td&gt;  &lt;/tr&gt;  &lt;tr&gt;    &lt;td rowspan=&quot;1&quot; colSpan=&quot;1&quot;&gt;      &lt;div data-type=&quot;p&quot;&gt;é€‚ç”¨æ€§&lt;/div&gt;    &lt;/td&gt;    &lt;td rowspan=&quot;1&quot; colSpan=&quot;1&quot;&gt;      &lt;ul data-type=&quot;unordered-list&quot;&gt;        &lt;li data-type=&quot;list-item&quot; data-list-type=&quot;unordered-list&quot;&gt;          &lt;div data-type=&quot;p&quot;&gt;ä½ æƒ³ä½¿ç”¨ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç±»ï¼Œè€Œå®ƒçš„æ¥å£ä¸ç¬¦åˆä½ çš„éœ€æ±‚ã€‚&lt;/div&gt;        &lt;/li&gt;        &lt;li data-type=&quot;list-item&quot; data-list-type=&quot;unordered-list&quot;&gt;          &lt;div data-type=&quot;p&quot;&gt;ä½ æƒ³åˆ›å»ºä¸€ä¸ªå¯ä»¥å¤ç”¨çš„ç±»ï¼Œè¯¥ç±»å¯ä»¥ä¸å…¶ä»–ä¸ç›¸å…³çš„ç±»æˆ–ä¸å¯é¢„è§çš„ç±»ï¼ˆå³é‚£äº›æ¥å£å¯èƒ½ä¸ä¸€å®šå…¼å®¹çš„ç±»ï¼‰ååŒå·¥ä½œã€‚&lt;/div&gt;        &lt;/li&gt;        &lt;li data-type=&quot;list-item&quot; data-list-type=&quot;unordered-list&quot;&gt;          &lt;div data-type=&quot;p&quot;&gt;ï¼ˆä»…é€‚ç”¨äºå¯¹è±¡Adapter ï¼‰ä½ æƒ³ä½¿ç”¨ä¸€äº›å·²ç»å­˜åœ¨çš„å­ç±»ï¼Œä½†æ˜¯ä¸å¯èƒ½å¯¹æ¯ä¸€ä¸ªéƒ½è¿›è¡Œå­ç±»åŒ–ä»¥åŒ¹é…å®ƒä»¬çš„æ¥å£ã€‚å¯¹è±¡é€‚é…å™¨å¯ä»¥é€‚é…å®ƒçš„çˆ¶ç±»æ¥å£ã€‚&lt;/div&gt;        &lt;/li&gt;      &lt;/ul&gt;    &lt;/td&gt;  &lt;/tr&gt;  &lt;tr height=&quot;34px&quot;&gt;    &lt;td rowspan=&quot;1&quot; colSpan=&quot;1&quot;&gt;      &lt;div data-type=&quot;p&quot;&gt;ä¼˜ç‚¹&lt;/div&gt;    &lt;/td&gt;    &lt;td rowspan=&quot;1&quot; colSpan=&quot;1&quot;&gt;      &lt;ul data-type=&quot;unordered-list&quot;&gt;        &lt;li data-type=&quot;list-item&quot; data-list-type=&quot;unordered-list&quot;&gt;          &lt;div data-type=&quot;p&quot;&gt;å°†ç›®æ ‡ç±»å’Œé€‚é…è€…ç±»è§£è€¦ï¼Œé€šè¿‡ä½¿ç”¨é€‚é…å™¨è®©ä¸å…¼å®¹çš„æ¥å£å˜æˆäº†å…¼å®¹ï¼Œè®©å®¢æˆ·ä»å®ç°çš„æ¥å£è§£è€¦ã€‚&lt;/div&gt;        &lt;/li&gt;        &lt;li data-type=&quot;list-item&quot; data-list-type=&quot;unordered-list&quot;&gt;          &lt;div data-type=&quot;p&quot;&gt;å¢åŠ äº†ç±»çš„é€æ˜æ€§å’Œå¤ç”¨æ€§ï¼Œå°†å…·ä½“çš„å®ç°å°è£…åœ¨é€‚é…è€…ç±»ä¸­ï¼Œå¯¹äºå®¢æˆ·ç«¯ç±»æ¥è¯´æ˜¯é€æ˜çš„ï¼Œè€Œä¸”æé«˜äº†é€‚é…è€…çš„å¤ç”¨æ€§ã€‚&lt;/div&gt;        &lt;/li&gt;        &lt;li data-type=&quot;list-item&quot; data-list-type=&quot;unordered-list&quot;&gt;          &lt;div data-type=&quot;p&quot;&gt;çµæ´»æ€§å’Œæ‰©å±•æ€§éƒ½éå¸¸å¥½åœ¨ä¸ä¿®æ”¹åŸæœ‰ä»£ç çš„åŸºç¡€ä¸Šå¢åŠ æ–°çš„é€‚é…å™¨ç±»ï¼Œç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚&lt;/div&gt;        &lt;/li&gt;      &lt;/ul&gt;    &lt;/td&gt;  &lt;/tr&gt;  &lt;tr height=&quot;34px&quot;&gt;    &lt;td rowspan=&quot;1&quot; colSpan=&quot;1&quot;&gt;      &lt;div data-type=&quot;p&quot;&gt;ç¼ºç‚¹&lt;/div&gt;    &lt;/td&gt;    &lt;td rowspan=&quot;1&quot; colSpan=&quot;1&quot;&gt;      &lt;ul data-type=&quot;unordered-list&quot;&gt;        &lt;li data-type=&quot;list-item&quot; data-list-type=&quot;unordered-list&quot;&gt;          &lt;div data-type=&quot;p&quot;&gt;è¿‡å¤šåœ°ä½¿ç”¨é€‚é…å™¨ï¼Œä¼šè®©ç³»ç»Ÿéå¸¸é›¶ä¹±ï¼Œä¸æ˜“æ•´ä½“è¿›è¡ŒæŠŠæ¡ã€‚æ¯”å¦‚ï¼Œæ˜æ˜çœ‹åˆ°è°ƒç”¨çš„æ˜¯ A æ¥å£ï¼Œå…¶å®å†…éƒ¨è¢«é€‚é…æˆäº† B æ¥å£çš„å®ç°ï¼Œä¸€ä¸ªç³»ç»Ÿå¦‚æœå¤ªå¤šå‡ºç°è¿™ç§æƒ…å†µï¼Œæ— å¼‚äºä¸€åœºç¾éš¾ã€‚&lt;/div&gt;        &lt;/li&gt;        &lt;li data-type=&quot;list-item&quot; data-list-type=&quot;unordered-list&quot;&gt;          &lt;div data-type=&quot;p&quot;&gt;å› æ­¤å¦‚æœä¸æ˜¯å¾ˆæœ‰å¿…è¦ï¼Œå¯ä»¥ä¸ä½¿ç”¨é€‚é…å™¨ï¼Œè€Œæ˜¯ç›´æ¥å¯¹ç³»ç»Ÿè¿›è¡Œé‡æ„ã€‚&lt;/div&gt;        &lt;/li&gt;      &lt;/ul&gt;    &lt;/td&gt;  &lt;/tr&gt;  &lt;tr height=&quot;34px&quot;&gt;    &lt;td rowspan=&quot;1&quot; colSpan=&quot;1&quot;&gt;      &lt;div data-type=&quot;p&quot;&gt;å°ç»“&lt;/div&gt;    &lt;/td&gt;    &lt;td rowspan=&quot;1&quot; colSpan=&quot;1&quot;&gt;      &lt;ul data-type=&quot;unordered-list&quot;&gt;        &lt;li data-type=&quot;list-item&quot; data-list-type=&quot;unordered-list&quot;&gt;          &lt;div data-type=&quot;p&quot;&gt;å½“æˆ‘ä»¬éœ€è¦ä½¿ç”¨çš„ä¸€ä¸ªç°æœ‰çš„ç±»ï¼Œä½†æ˜¯ä»–çš„æ¥å£å¹¶ä¸ç¬¦åˆæˆ‘ä»¬çš„éœ€æ±‚æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ã€‚&lt;/div&gt;        &lt;/li&gt;        &lt;li data-type=&quot;list-item&quot; data-list-type=&quot;unordered-list&quot;&gt;          &lt;div data-type=&quot;p&quot;&gt;é€‚é…å™¨æ¨¡å¼åˆ†ä¸ºç±»é€‚é…å™¨å’Œå¯¹è±¡é€‚é…å™¨ï¼Œå…¶ä¸­ç±»é€‚é…å™¨éœ€è¦ç”¨åˆ°å¤šé‡ç»§æ‰¿ã€‚&lt;/div&gt;        &lt;/li&gt;      &lt;/ul&gt;    &lt;/td&gt;  &lt;/tr&gt;&lt;/tbody&gt;</code></pre><p>  </p></div></td></tr></tbody></table><br></div><p></p><h3 id="ç»“æ„å‹è®¾è®¡æ¨¡å¼å°ç»“"><a href="#ç»“æ„å‹è®¾è®¡æ¨¡å¼å°ç»“" class="headerlink" title="ç»“æ„å‹è®¾è®¡æ¨¡å¼å°ç»“"></a>ç»“æ„å‹è®¾è®¡æ¨¡å¼å°ç»“</h3><table><thead><tr><th style="text-align:left">æ¨¡å¼</th><th>åœºæ™¯å‘æ•£</th><th style="text-align:left">ä¸€å¥è¯è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">æ¡¥(Bridge)</td><td>éº»çƒ¦çš„æ—¥å¿—è®°å½•</td><td style="text-align:left">å°†â€œæŠ½è±¡â€å’Œâ€œå®ç°â€è‡ªç”±æ­é…ã€‚</td></tr><tr><td style="text-align:left">è½»é‡(Flyweight)</td><td>æ£®æ—é‡Œçš„æ ‘å¤ªå¤šäº†</td><td style="text-align:left">è½»æ¾åœ°å¤„ç†â€œå¤§é‡â€å¯¹è±¡ã€‚</td></tr><tr><td style="text-align:left">å¤–è§‚(FacÌ§ade)</td><td>è¶…çº§æ‰‹æœº</td><td style="text-align:left">åŒæ—¶æä¾›ç®€å•æ¥å£å’Œå¤æ‚æ¥å£ã€‚</td></tr><tr><td style="text-align:left">è£…é¥°è€…(Decorator)</td><td>æ˜Ÿå·´å…‹çš„é¥®æ–™è®¡è¾ƒç³»ç»Ÿ</td><td style="text-align:left">ä¸æ”¹å˜æ¥å£ä½†è¦å¢å¼ºåŠŸèƒ½ã€‚</td></tr><tr><td style="text-align:left">ç»„åˆ(Composite)</td><td>è¶…é…·çš„ç»˜å›¾è½¯ä»¶</td><td style="text-align:left">ä¸ç®¡ä½ æ˜¯è€å­è¿˜æ˜¯å„¿å­ï¼Œéƒ½ä¸€æ ·å¤„ç†ã€‚</td></tr><tr><td style="text-align:left">ä»£ç†(Proxy)</td><td>æ‰¾ä¸­ä»‹ç§Ÿæˆ¿</td><td style="text-align:left">ä»£ç†è¦æ§åˆ¶ä½ çš„è®¿é—®ï¼ŒåŒæ—¶è®©ä½ çš„è®¿é—®æ›´èˆ’æœ ã€‚</td></tr><tr><td style="text-align:left">é€‚é…å™¨(Adapter)</td><td>è€æ‰ç‰™ç³»ç»Ÿçš„é‡ç”Ÿ</td><td style="text-align:left">ä¸æ”¹å˜åŠŸèƒ½ä½†è¦æ”¹å˜æ¥å£</td></tr></tbody></table><h2 id="è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼-ç±»ä¸å¯¹è±¡æ€æ ·çš„äº¤äº’å’Œåˆ†é…èŒè´£"><a href="#è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼-ç±»ä¸å¯¹è±¡æ€æ ·çš„äº¤äº’å’Œåˆ†é…èŒè´£" class="headerlink" title="è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼(ç±»ä¸å¯¹è±¡æ€æ ·çš„äº¤äº’å’Œåˆ†é…èŒè´£)"></a>è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼(ç±»ä¸å¯¹è±¡æ€æ ·çš„äº¤äº’å’Œåˆ†é…èŒè´£)</h2><h3 id="è§‚å¯Ÿè€…æ¨¡å¼-Observer-Pattern"><a href="#è§‚å¯Ÿè€…æ¨¡å¼-Observer-Pattern" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼(Observer Pattern)"></a>è§‚å¯Ÿè€…æ¨¡å¼(Observer Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="145px"><br>      <col width="685px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Observer</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/1690670017eda10c?w=615&h=243&f=gif&s=7719" data-width="615"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/1690670017eda10c?w=615&h=243&f=gif&s=7719" width="615"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»,å½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶, æ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“ä¸€ä¸ªæŠ½è±¡æ¨¡å‹æœ‰ä¸¤ä¸ªæ–¹é¢, å…¶ä¸­ä¸€ä¸ªæ–¹é¢ä¾èµ–äºå¦ä¸€æ–¹é¢ã€‚å°†è¿™äºŒè€…å°è£…åœ¨ç‹¬ç«‹çš„å¯¹è±¡ä¸­ä»¥ä½¿å®ƒä»¬å¯ä»¥å„è‡ªç‹¬ç«‹åœ°æ”¹å˜å’Œå¤ç”¨ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“å¯¹ä¸€ä¸ªå¯¹è±¡çš„æ”¹å˜éœ€è¦åŒæ—¶æ”¹å˜å…¶å®ƒå¯¹è±¡, è€Œä¸çŸ¥é“å…·ä½“æœ‰å¤šå°‘å¯¹è±¡æœ‰å¾…æ”¹å˜ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“ä¸€ä¸ªå¯¹è±¡å¿…é¡»é€šçŸ¥å…¶å®ƒå¯¹è±¡ï¼Œè€Œå®ƒåˆä¸èƒ½å‡å®šå…¶å®ƒå¯¹è±¡æ˜¯è°ã€‚æ¢è¨€ä¹‹, ä½ ä¸å¸Œæœ›è¿™äº›å¯¹è±¡æ˜¯ç´§å¯†è€¦åˆçš„ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´é€è€¦åˆï¼Œä»–ä»¬ä¾ç„¶å¯ä»¥äº¤äº’ï¼Œä½†æ˜¯ä¸å¤ªæ¸…æ¥šå½¼æ­¤çš„ç»†èŠ‚ã€‚è§‚å¯Ÿè€…æ¨¡å¼æä¾›äº†ä¸€ç§å¯¹è±¡è®¾è®¡ï¼Œè®©ä¸»é¢˜å’Œè§‚å¯Ÿè€…ä¹‹é—´é€è€¦åˆã€‚ä¸»é¢˜æ‰€çŸ¥é“åªæ˜¯ä¸€ä¸ªå…·ä½“çš„è§‚å¯Ÿè€…åˆ—è¡¨ï¼Œæ¯ä¸€ä¸ªå…·ä½“è§‚å¯Ÿè€…éƒ½ç¬¦åˆä¸€ä¸ªæŠ½è±¡è§‚å¯Ÿè€…çš„æ¥å£ã€‚ä¸»é¢˜å¹¶ä¸è®¤è¯†ä»»ä½•ä¸€ä¸ªå…·ä½“çš„è§‚å¯Ÿè€…ï¼Œå®ƒåªçŸ¥é“ä»–ä»¬éƒ½æœ‰ä¸€ä¸ªå…±åŒçš„æ¥å£ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è§‚å¯Ÿè€…æ¨¡å¼æ”¯æŒâ€œå¹¿æ’­é€šä¿¡â€ã€‚ä¸»é¢˜ä¼šå‘æ‰€æœ‰çš„è§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è§‚å¯Ÿè€…æ¨¡å¼ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€çš„è¦æ±‚ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¦‚æœä¸€ä¸ªè¢«è§‚å¯Ÿè€…å¯¹è±¡æœ‰å¾ˆå¤šçš„ç›´æ¥å’Œé—´æ¥çš„è§‚å¯Ÿè€…çš„è¯ï¼Œå°†æ‰€æœ‰çš„è§‚å¯Ÿè€…éƒ½é€šçŸ¥åˆ°ä¼šèŠ±è´¹å¾ˆå¤šæ—¶é—´ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¦‚æœåœ¨è§‚å¯Ÿè€…å’Œè§‚å¯Ÿç›®æ ‡ä¹‹é—´æœ‰å¾ªç¯ä¾èµ–çš„è¯ï¼Œè§‚å¯Ÿç›®æ ‡ä¼šè§¦å‘å®ƒä»¬ä¹‹é—´è¿› è¡Œå¾ªç¯è°ƒç”¨ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿå´©æºƒã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è§‚å¯Ÿè€…æ¨¡å¼æ²¡æœ‰ç›¸åº”çš„æœºåˆ¶è®©è§‚å¯Ÿè€…çŸ¥é“æ‰€è§‚å¯Ÿçš„ç›®æ ‡å¯¹è±¡æ˜¯æ€ä¹ˆå‘ç”Ÿå˜åŒ–çš„ï¼Œè€Œä»…ä»…åªæ˜¯çŸ¥é“è§‚å¯Ÿç›®æ ‡å‘ç”Ÿäº†å˜åŒ–ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†å¯¹è±¡ä¹‹é—´çš„ä¸€å¯¹å¤šå…³ç³»ã€‚å¤šä¸ªè§‚å¯Ÿè€…ç›‘å¬åŒä¸€ä¸ªè¢«è§‚å¯Ÿè€…ï¼Œå½“è¯¥è¢«è§‚å¯Ÿè€…çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è§‚å¯Ÿè€…æ¨¡å¼ä¸­åŒ…å«å››ä¸ªè§’è‰²ã€‚ä¸»é¢˜ï¼Œå®ƒæŒ‡è¢«è§‚å¯Ÿçš„å¯¹è±¡ã€‚å…·ä½“ä¸»é¢˜æ˜¯ä¸»é¢˜å­ç±»ï¼Œé€šå¸¸å®ƒåŒ…å«æœ‰ç»å¸¸å‘ç”Ÿæ”¹å˜çš„æ•°æ®ï¼Œå½“å®ƒçš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå‘å®ƒçš„å„ä¸ªè§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ï¼›è§‚å¯Ÿè€…ï¼Œå°†å¯¹è§‚å¯Ÿä¸»é¢˜çš„æ”¹å˜åšå‡ºååº”ï¼›å…·ä½“è§‚å¯Ÿè€…ä¸­ç»´æŠ¤ä¸€ä¸ªæŒ‡å‘å…·ä½“ç›®æ ‡å¯¹è±¡çš„å¼•ç”¨ï¼Œå®ƒå­˜å‚¨å…·ä½“è§‚å¯Ÿè€…çš„æœ‰å…³çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€éœ€è¦å’Œå…·ä½“ç›®æ ‡çš„çŠ¶æ€ä¿æŒä¸€è‡´ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="ç­–ç•¥æ¨¡å¼-Strategy-Pattern"><a href="#ç­–ç•¥æ¨¡å¼-Strategy-Pattern" class="headerlink" title="ç­–ç•¥æ¨¡å¼(Strategy Pattern)"></a>ç­–ç•¥æ¨¡å¼(Strategy Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="150px"><br>      <col width="680px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Strategy</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/16906700244d00fb?w=539&h=186&f=gif&s=5220" data-width="539"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/16906700244d00fb?w=539&h=186&f=gif&s=5220" width="539"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•,æŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥, å¹¶ä¸”ä½¿å®ƒä»¬å¯ç›¸äº’æ›¿æ¢ã€‚æœ¬æ¨¡å¼ä½¿å¾—ç®—æ³•å¯ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·è€Œå˜åŒ–ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è®¸å¤šç›¸å…³çš„ç±»ä»…ä»…æ˜¯è¡Œä¸ºæœ‰å¼‚ã€‚ç­–ç•¥æ¨¡å¼æä¾›äº†ä¸€ç§ç”¨å¤šä¸ªè¡Œä¸ºä¸­çš„ä¸€ä¸ªè¡Œä¸ºæ¥é…ç½®ä¸€ä¸ªç±»çš„æ–¹æ³•ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">éœ€è¦ä½¿ç”¨ä¸€ä¸ªç®—æ³•çš„ä¸åŒå˜ä½“ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç®—æ³•ä½¿ç”¨å®¢æˆ·ä¸åº”è¯¥çŸ¥é“çš„æ•°æ®ã€‚å¯ä½¿ç”¨ç­–ç•¥æ¨¡å¼ä»¥é¿å…æš´éœ²å¤æ‚çš„ã€ä¸ç®—æ³•ç›¸å…³çš„æ•°æ®ç»“æ„ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸€ä¸ªç±»å®šä¹‰äº†å¤šç§è¡Œä¸º, å¹¶ä¸”è¿™äº›è¡Œä¸ºåœ¨è¿™ä¸ªç±»çš„æ“ä½œä¸­ä»¥å¤šä¸ªæ¡ä»¶è¯­å¥çš„å½¢å¼å‡ºç°ã€‚å°†ç›¸å…³çš„æ¡ä»¶åˆ†æ”¯ç§»å…¥å®ƒä»¬å„è‡ªçš„S t r a t e g y ç±»ä¸­ä»¥ä»£æ›¿è¿™äº›æ¡ä»¶è¯­å¥ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç­–ç•¥æ¨¡å¼æä¾›äº†å¯¹â€œå¼€é—­åŸåˆ™â€çš„å®Œç¾æ”¯æŒï¼Œç”¨æˆ·å¯ä»¥åœ¨ä¸ä¿®æ”¹åŸæœ‰ç³»ç»Ÿçš„åŸºç¡€ä¸Šé€‰æ‹©ç®—æ³•æˆ–è¡Œä¸ºï¼Œä¹Ÿå¯ä»¥çµæ´»åœ°å¢åŠ æ–°çš„ç®—æ³•æˆ–è¡Œä¸ºã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç­–ç•¥æ¨¡å¼æä¾›äº†å¯ä»¥æ›¿æ¢ç»§æ‰¿å…³ç³»çš„åŠæ³•ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥é¿å…ä½¿ç”¨å¤šé‡æ¡ä»¶è½¬ç§»è¯­å¥ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å®¢æˆ·ç«¯å¿…é¡»çŸ¥é“æ‰€æœ‰çš„ç­–ç•¥ç±»ï¼Œå¹¶è‡ªè¡Œå†³å®šä½¿ç”¨å“ªä¸€ä¸ªç­–ç•¥ç±»ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç­–ç•¥æ¨¡å¼å°†é€ æˆäº§ç”Ÿå¾ˆå¤šç­–ç•¥ç±»ï¼Œ</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¦‚æœåœ¨ä¸€ä¸ªç³»ç»Ÿé‡Œé¢æœ‰è®¸å¤šç±»ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä»…åœ¨äºå®ƒä»¬çš„è¡Œä¸ºï¼Œé‚£ä¹ˆä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥åŠ¨æ€åœ°è®©ä¸€ä¸ªå¯¹è±¡åœ¨è®¸å¤šè¡Œä¸ºä¸­é€‰æ‹©ä¸€ç§è¡Œä¸ºã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ°åœ¨å‡ ç§ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¦‚æœä¸€ä¸ªå¯¹è±¡æœ‰å¾ˆå¤šçš„è¡Œä¸ºï¼Œå¦‚æœä¸ç”¨æ°å½“çš„æ¨¡å¼ï¼Œè¿™äº›è¡Œä¸ºå°±åªå¥½ä½¿ç”¨å¤šé‡çš„æ¡ä»¶é€‰æ‹©è¯­å¥æ¥å®ç°ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="è¿­ä»£å™¨æ¨¡å¼-Iterator-Pattern"><a href="#è¿­ä»£å™¨æ¨¡å¼-Iterator-Pattern" class="headerlink" title="è¿­ä»£å™¨æ¨¡å¼(Iterator Pattern)"></a>è¿­ä»£å™¨æ¨¡å¼(Iterator Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="152px"><br>      <col width="678px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Iterator</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/169067001fb0546f?w=560&h=276&f=gif&s=5453" data-width="560"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/169067001fb0546f?w=560&h=276&f=gif&s=5453" width="560"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­å„ä¸ªå…ƒç´ , è€Œåˆä¸éœ€æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡çš„å†…å®¹è€Œæ— éœ€æš´éœ²å®ƒçš„å†…éƒ¨è¡¨ç¤ºã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ”¯æŒå¯¹èšåˆå¯¹è±¡çš„å¤šç§éå†ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸ºéå†ä¸åŒçš„èšåˆç»“æ„æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£(å³, æ”¯æŒå¤šæ€è¿­ä»£)ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å®ƒæ”¯æŒä»¥ä¸åŒçš„æ–¹å¼éå†ä¸€ä¸ªèšåˆå¯¹è±¡ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è¿­ä»£å™¨ç®€åŒ–äº†èšåˆç±»ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">åœ¨åŒä¸€ä¸ªèšåˆä¸Šå¯ä»¥æœ‰å¤šä¸ªéå†ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">åœ¨è¿­ä»£å™¨æ¨¡å¼ä¸­ï¼Œå¢åŠ æ–°çš„èšåˆç±»å’Œè¿­ä»£å™¨ç±»éƒ½å¾ˆæ–¹ä¾¿ï¼Œæ— é¡»ä¿®æ”¹åŸæœ‰ä»£ç ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç”±äºè¿­ä»£å™¨æ¨¡å¼å°†å­˜å‚¨æ•°æ®å’Œéå†æ•°æ®çš„èŒè´£åˆ†ç¦»ï¼Œå¢åŠ æ–°çš„èšåˆç±»éœ€è¦å¯¹åº”å¢åŠ æ–°çš„è¿­ä»£å™¨ç±»ï¼Œç±»çš„ä¸ªæ•°æˆå¯¹å¢åŠ ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å°†éå†èšåˆå¯¹è±¡ä¸­æ•°æ®çš„è¡Œä¸ºæå–å‡ºæ¥ï¼Œå°è£…åˆ°ä¸€ä¸ªè¿­ä»£å™¨ä¸­ï¼Œé€šè¿‡ä¸“é—¨çš„è¿­ä»£å™¨æ¥éå†èšåˆå¯¹è±¡çš„å†…éƒ¨æ•°æ®ï¼Œè¿™å°±æ˜¯è¿­ä»£å™¨æ¨¡å¼çš„æœ¬è´¨ã€‚è¿­ä»£å™¨æ¨¡å¼æ˜¯â€œå•ä¸€èŒè´£åŸåˆ™â€çš„å®Œç¾ä½“ç°ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“ä½¿ç”¨è¿­ä»£å™¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¾èµ–èšåˆæä¾›éå†ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è¿­ä»£å™¨æä¾›äº†ä¸€ä¸ªé€šç”¨çš„æ¥å£ï¼Œè®©æˆ‘ä»¬éå†èšåˆçš„é¡¹ï¼Œæ”¾æˆ‘ä»¬ç¼–ç ä½¿ç”¨èšåˆé¡¹æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨å¤šæ€æœºåˆ¶ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="å‘½ä»¤æ¨¡å¼-Command-Pattern"><a href="#å‘½ä»¤æ¨¡å¼-Command-Pattern" class="headerlink" title="å‘½ä»¤æ¨¡å¼(Command Pattern)"></a>å‘½ä»¤æ¨¡å¼(Command Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="160px"><br>      <col width="670px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Command</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="left" data-src="https://user-gold-cdn.xitu.io/2019/2/19/1690670025102900?w=603&h=212&f=gif&s=4649" data-width="603"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/1690670025102900?w=603&h=212&f=gif&s=4649" width="603"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿ä½ å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼›å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯æ’¤æ¶ˆçš„æ“ä½œã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æŠ½è±¡å‡ºå¾…æ‰§è¡Œçš„åŠ¨ä½œä»¥å‚æ•°åŒ–æŸå¯¹è±¡ï¼Œä½ å¯ç”¨è¿‡ç¨‹è¯­è¨€ä¸­çš„å›è°ƒï¼ˆc a l l b a c k ï¼‰å‡½æ•°è¡¨è¾¾è¿™ç§å‚æ•°åŒ–æœºåˆ¶ã€‚æ‰€è°“å›è°ƒå‡½æ•°æ˜¯æŒ‡å‡½æ•°å…ˆåœ¨æŸå¤„æ³¨å†Œï¼Œè€Œå®ƒå°†åœ¨ç¨åæŸä¸ªéœ€è¦çš„æ—¶å€™è¢«è°ƒç”¨ã€‚C o m m a n d æ¨¡å¼æ˜¯å›è°ƒæœºåˆ¶çš„ä¸€ä¸ªé¢å‘å¯¹è±¡çš„æ›¿ä»£å“ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">åœ¨ä¸åŒçš„æ—¶åˆ»æŒ‡å®šã€æ’åˆ—å’Œæ‰§è¡Œè¯·æ±‚ã€‚ä¸€ä¸ªC o m m a n d å¯¹è±¡å¯ä»¥æœ‰ä¸€ä¸ªä¸åˆå§‹è¯·æ±‚æ— å…³çš„ç”Ÿå­˜æœŸã€‚å¦‚æœä¸€ä¸ªè¯·æ±‚çš„æ¥æ”¶è€…å¯ç”¨ä¸€ç§ä¸åœ°å€ç©ºé—´æ— å…³çš„æ–¹å¼è¡¨è¾¾ï¼Œé‚£ä¹ˆå°±å¯å°†è´Ÿè´£è¯¥è¯·æ±‚çš„å‘½ä»¤å¯¹è±¡ä¼ é€ç»™å¦ä¸€ä¸ªä¸åŒçš„è¿›ç¨‹å¹¶åœ¨é‚£å„¿å®ç°è¯¥è¯·æ±‚ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ”¯æŒå–æ¶ˆæ“ä½œã€‚C o m m a n d çš„E x c u t e æ“ä½œå¯åœ¨å®æ–½æ“ä½œå‰å°†çŠ¶æ€å­˜å‚¨èµ·æ¥ï¼Œåœ¨å–æ¶ˆæ“ä½œæ—¶è¿™ä¸ªçŠ¶æ€ç”¨æ¥æ¶ˆé™¤è¯¥æ“ä½œçš„å½±å“ã€‚C o m m a n d æ¥å£å¿…é¡»æ·»åŠ ä¸€ä¸ªU n e x e c u t e æ“ä½œï¼Œè¯¥æ“ä½œå–æ¶ˆä¸Šä¸€æ¬¡E x e c u t e è°ƒç”¨çš„æ•ˆæœã€‚æ‰§è¡Œçš„å‘½ä»¤è¢«å­˜å‚¨åœ¨ä¸€ä¸ªå†å²åˆ—è¡¨ä¸­ã€‚å¯é€šè¿‡å‘åå’Œå‘å‰éå†è¿™ä¸€åˆ—è¡¨å¹¶åˆ†åˆ«è°ƒç”¨U n e x e c u t e å’ŒE x e c u t e æ¥å®ç°é‡æ•°ä¸é™çš„å–æ¶ˆå’Œé‡åšã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ”¯æŒä¿®æ”¹æ—¥å¿—ï¼Œè¿™æ ·å½“ç³»ç»Ÿå´©æºƒæ—¶ï¼Œè¿™äº›ä¿®æ”¹å¯ä»¥è¢«é‡åšä¸€éã€‚åœ¨C o m m a n d æ¥å£ä¸­æ·»åŠ è£…è½½æ“ä½œå’Œå­˜å‚¨æ“ä½œï¼Œå¯ä»¥ç”¨æ¥ä¿æŒå˜åŠ¨çš„ä¸€ä¸ªä¸€è‡´çš„ä¿®æ”¹æ—¥å¿—ã€‚ä»å´©æºƒä¸­æ¢å¤çš„è¿‡ç¨‹åŒ…æ‹¬ä»ç£ç›˜ä¸­é‡æ–°è¯»å…¥è®°å½•ä¸‹æ¥çš„å‘½ä»¤å¹¶ç”¨E x e c u t e æ“ä½œé‡æ–°æ‰§è¡Œå®ƒä»¬ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç”¨æ„å»ºåœ¨åŸè¯­æ“ä½œä¸Šçš„é«˜å±‚æ“ä½œæ„é€ ä¸€ä¸ªç³»ç»Ÿã€‚è¿™æ ·ä¸€ç§ç»“æ„åœ¨æ”¯æŒäº‹åŠ¡( t r a n s a c t i o n )çš„ä¿¡æ¯ç³»ç»Ÿä¸­å¾ˆå¸¸è§ã€‚ä¸€ä¸ªäº‹åŠ¡å°è£…äº†å¯¹æ•°æ®çš„ä¸€ç»„å˜åŠ¨ã€‚C o m m a n d æ¨¡å¼æä¾›äº†å¯¹äº‹åŠ¡è¿›è¡Œå»ºæ¨¡çš„æ–¹æ³•ã€‚C o m m a n d æœ‰ä¸€ä¸ªå…¬å…±çš„æ¥å£ï¼Œä½¿å¾—ä½ å¯ä»¥ç”¨åŒä¸€ç§æ–¹å¼è°ƒç”¨æ‰€æœ‰çš„äº‹åŠ¡ã€‚åŒæ—¶ä½¿ç”¨è¯¥æ¨¡å¼ä¹Ÿæ˜“äºæ·»åŠ æ–°äº‹åŠ¡ä»¥æ‰©å±•ç³»ç»Ÿã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">é™ä½äº†ç³»ç»Ÿè€¦åˆåº¦</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ–°çš„å‘½ä»¤å¯ä»¥å¾ˆå®¹æ˜“æ·»åŠ åˆ°ç³»ç»Ÿä¸­å»ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä½¿ç”¨å‘½ä»¤æ¨¡å¼å¯èƒ½ä¼šå¯¼è‡´æŸäº›ç³»ç»Ÿæœ‰è¿‡å¤šçš„å…·ä½“å‘½ä»¤ç±»ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å‘½ä»¤æ¨¡å¼çš„æœ¬è´¨å°±æ˜¯å°†å‘½ä»¤å¯¹è±¡è¿›è¡Œå°è£…æ‰“åŒ…ï¼Œå°†å‘å‡ºå‘½ä»¤çš„è´£ä»»å’Œæ‰§è¡Œå‘½ä»¤çš„è´£ä»»è¿›è¡Œå‰²å¼€ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å‘½ä»¤æ¨¡å¼ä¸­å‘é€è€…åªéœ€è¦çŸ¥é“å¦‚ä½•å‘é€è¯·æ±‚å‘½ä»¤ï¼Œæ— é¡»å…³å¿ƒå‘½ä»¤æ‰§è¡Œå…·ä½“è¿‡ç¨‹ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">åœ¨å‘é€è€…å’Œæ¥æ”¶è€…ä¸¤è€…é—´æ˜¯é€šè¿‡å‘½ä»¤å¯¹è±¡è¿›è¡Œæ²Ÿé€šçš„ã€‚è¯·æ±‚å‘½ä»¤æœ¬èº«å°±å½“åšä¸€ä¸ªå¯¹è±¡åœ¨ä¸¤è€…é—´è¿›è¡Œä¼ é€’ï¼Œå®ƒå°è£…äº†æ¥æ”¶è€…å’Œä¸€ç»„åŠ¨ä½œã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p"> å‘½ä»¤æ¨¡å¼æ”¯æŒæ’¤é”€ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å‘½ä»¤æ¨¡å¼é˜Ÿåˆ—è¯·æ±‚å’Œæ—¥å¿—è¯·æ±‚ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="è®¿é—®è€…æ¨¡å¼-Visitor-Pattern"><a href="#è®¿é—®è€…æ¨¡å¼-Visitor-Pattern" class="headerlink" title="è®¿é—®è€…æ¨¡å¼(Visitor Pattern)"></a>è®¿é—®è€…æ¨¡å¼(Visitor Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="89px"><br>      <col width="668px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Visitor</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/16906700257347dc?w=536&h=417&f=gif&s=11308" data-width="536"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/16906700257347dc?w=536&h=417&f=gif&s=11308" width="536"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">è¡¨ç¤ºä¸€ä¸ªä½œç”¨äºæŸå¯¹è±¡ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œã€‚å®ƒä½¿ä½ å¯ä»¥åœ¨ä¸æ”¹å˜å„å…ƒç´ çš„ç±»çš„å‰æä¸‹å®šä¹‰ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°æ“ä½œã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸€ä¸ªå¯¹è±¡ç»“æ„åŒ…å«å¾ˆå¤šç±»å¯¹è±¡ï¼Œå®ƒä»¬æœ‰ä¸åŒçš„æ¥å£ï¼Œè€Œä½ æƒ³å¯¹è¿™äº›å¯¹è±¡å®æ–½ä¸€äº›ä¾èµ–äºå…¶å…·ä½“ç±»çš„æ“ä½œã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">éœ€è¦å¯¹ä¸€ä¸ªå¯¹è±¡ç»“æ„ä¸­çš„å¯¹è±¡è¿›è¡Œå¾ˆå¤šä¸åŒçš„å¹¶ä¸”ä¸ç›¸å…³çš„æ“ä½œï¼Œè€Œä½ æƒ³é¿å…è®©è¿™äº›æ“ä½œ?æ±¡æŸ“?è¿™äº›å¯¹è±¡çš„ç±»ã€‚Vi s i t o r ä½¿å¾—ä½ å¯ä»¥å°†ç›¸å…³çš„æ“ä½œé›†ä¸­èµ·æ¥å®šä¹‰åœ¨ä¸€ä¸ªç±»ä¸­ã€‚å½“è¯¥å¯¹è±¡ç»“æ„è¢«å¾ˆå¤šåº”ç”¨å…±äº«æ—¶ï¼Œç”¨Vi s i t o r æ¨¡å¼è®©æ¯ä¸ªåº”ç”¨ä»…åŒ…å«éœ€è¦ç”¨åˆ°çš„æ“ä½œã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å®šä¹‰å¯¹è±¡ç»“æ„çš„ç±»å¾ˆå°‘æ”¹å˜ï¼Œä½†ç»å¸¸éœ€è¦åœ¨æ­¤ç»“æ„ä¸Šå®šä¹‰æ–°çš„æ“ä½œã€‚æ”¹å˜å¯¹è±¡ç»“æ„ç±»éœ€è¦é‡å®šä¹‰å¯¹æ‰€æœ‰è®¿é—®è€…çš„æ¥å£ï¼Œè¿™å¯èƒ½éœ€è¦å¾ˆå¤§çš„ä»£ä»·ã€‚å¦‚æœå¯¹è±¡ç»“æ„ç±»ç»å¸¸æ”¹å˜ï¼Œé‚£ä¹ˆå¯èƒ½è¿˜æ˜¯åœ¨è¿™äº›ç±»ä¸­å®šä¹‰è¿™äº›æ“ä½œè¾ƒå¥½ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä½¿å¾—æ–°å¢æ–°çš„è®¿é—®æ“ä½œå˜å¾—æ›´åŠ ç®€å•ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">èƒ½å¤Ÿä½¿å¾—ç”¨æˆ·åœ¨ä¸ä¿®æ”¹ç°æœ‰ç±»çš„å±‚æ¬¡ç»“æ„ä¸‹ï¼Œå®šä¹‰è¯¥ç±»å±‚æ¬¡ç»“æ„çš„æ“ä½œã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å°†æœ‰å…³å…ƒç´ å¯¹è±¡çš„è®¿é—®è¡Œä¸ºé›†ä¸­åˆ°ä¸€ä¸ªè®¿é—®è€…å¯¹è±¡ä¸­ï¼Œè€Œä¸æ˜¯åˆ†æ•£æä¸€ä¸ªä¸ªçš„å…ƒç´ ç±»ä¸­ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¢åŠ æ–°çš„å…ƒç´ ç±»å¾ˆå›°éš¾ã€‚åœ¨è®¿é—®è€…æ¨¡å¼ä¸­ï¼Œæ¯å¢åŠ ä¸€ä¸ªæ–°çš„å…ƒç´ ç±»éƒ½æ„å‘³ç€è¦åœ¨æŠ½è±¡è®¿é—®è€…è§’è‰²ä¸­å¢åŠ ä¸€ä¸ªæ–°çš„æŠ½è±¡æ“ä½œï¼Œå¹¶åœ¨æ¯ä¸€ä¸ªå…·ä½“è®¿é—®è€…ç±»ä¸­å¢åŠ ç›¸åº”çš„å…·ä½“æ“ä½œï¼Œè¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€çš„è¦æ±‚ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç ´åå°è£…ã€‚å½“é‡‡ç”¨è®¿é—®è€…æ¨¡å¼çš„æ—¶å€™ï¼Œå°±ä¼šæ‰“ç ´ç»„åˆç±»çš„å°è£…ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">1.SomeClass çš„ Accept()æ–¹æ³•å°±æ˜¯è®¿é—®åŸæ¥ç±»çš„å°å£ï¼Œ Accept()æ–¹æ³•åªæœ‰ä¸€å¥ä»£ç ï¼Œå°±æ˜¯: visitor.NewMethod(this) ï¼Œè¿™æ˜¯è®¿é—®è€…æ¨¡å¼çš„ç²¾å¦™ä¹‹å¤„ã€‚ 2.SomeClass çš„æ–°åŠŸèƒ½é€šè¿‡å®ç° IVisitor æ¥å£çš„ç±»æ¥å®ç°ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è®¿é—®è€…æ¨¡å¼å°è£…äº†å¯¹è±¡ç»“æ„å…ƒç´ ä¹‹ä¸Šçš„æ“ä½œï¼Œä½¿å¾—æ–°å¢å…ƒç´ çš„æ“ä½œå˜å¾—éå¸¸ç®€å•ã€‚æ‰€ä»¥å®ƒæ¯”è¾ƒé€‚ç”¨äºé‚£ä¹ˆå¯¹è±¡ç»“æ„å¾ˆå°‘å˜åŒ–çš„ç±»ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è®¿é—®è€…æ¨¡å¼ä¸­å¯¹è±¡ç»“æ„å­˜å‚¨äº†ä¸åŒç±»å‹çš„å…ƒç´ å¯¹è±¡ï¼Œä»¥ä¾›ä¸åŒè®¿é—®è€…è®¿é—®ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="è§£é‡Šå™¨æ¨¡å¼-Interpreter-Pattern"><a href="#è§£é‡Šå™¨æ¨¡å¼-Interpreter-Pattern" class="headerlink" title="è§£é‡Šå™¨æ¨¡å¼(Interpreter Pattern)"></a>è§£é‡Šå™¨æ¨¡å¼(Interpreter Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="154px"><br>      <col width="596px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Interpreter</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/1690670030b73b10?w=450&h=242&f=gif&s=4615" data-width="450"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/1690670030b73b10?w=450&h=242&f=gif&s=4615" width="450"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»™å®šä¸€ä¸ªè¯­è¨€ï¼Œå®šä¹‰å®ƒçš„æ–‡æ³•çš„ä¸€ç§è¡¨ç¤ºï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨ï¼Œè¿™ä¸ªè§£é‡Šå™¨ä½¿ç”¨è¯¥è¡¨ç¤ºæ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å½“æœ‰ä¸€ä¸ªè¯­è¨€éœ€è¦è§£é‡Šæ‰§è¡Œ, å¹¶ä¸”ä½ å¯å°†è¯¥è¯­è¨€ä¸­çš„å¥å­è¡¨ç¤ºä¸ºä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘æ—¶ï¼Œå¯ä½¿ç”¨è§£é‡Šå™¨æ¨¡å¼ã€‚è€Œå½“å­˜åœ¨ä»¥ä¸‹æƒ…å†µæ—¶è¯¥æ¨¡å¼æ•ˆæœæœ€å¥½ï¼š</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è¯¥æ–‡æ³•ç®€å•å¯¹äºå¤æ‚çš„æ–‡æ³•, æ–‡æ³•çš„ç±»å±‚æ¬¡å˜å¾—åºå¤§è€Œæ— æ³•ç®¡ç†ã€‚æ­¤æ—¶è¯­æ³•åˆ†æç¨‹åºç”Ÿæˆå™¨è¿™æ ·çš„å·¥å…·æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚å®ƒä»¬æ— éœ€æ„å»ºæŠ½è±¡è¯­æ³•æ ‘å³å¯è§£é‡Šè¡¨è¾¾å¼, è¿™æ ·å¯ä»¥èŠ‚çœç©ºé—´è€Œä¸”è¿˜å¯èƒ½èŠ‚çœæ—¶é—´ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ•ˆç‡ä¸æ˜¯ä¸€ä¸ªå…³é”®é—®é¢˜æœ€é«˜æ•ˆçš„è§£é‡Šå™¨é€šå¸¸ä¸æ˜¯é€šè¿‡ç›´æ¥è§£é‡Šè¯­æ³•åˆ†ææ ‘å®ç°çš„, è€Œæ˜¯é¦–å…ˆå°†å®ƒä»¬è½¬æ¢æˆå¦ä¸€ç§å½¢å¼ã€‚ä¾‹å¦‚ï¼Œæ­£åˆ™è¡¨è¾¾å¼é€šå¸¸è¢«è½¬æ¢æˆçŠ¶æ€æœºã€‚ä½†å³ä½¿åœ¨è¿™ç§æƒ…å†µä¸‹, è½¬æ¢å™¨ä»å¯ç”¨è§£é‡Šå™¨æ¨¡å¼å®ç°, è¯¥æ¨¡å¼ä»æ˜¯æœ‰ç”¨çš„ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¯æ‰©å±•æ€§æ¯”è¾ƒå¥½ï¼Œçµæ´»ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¢åŠ äº†æ–°çš„è§£é‡Šè¡¨è¾¾å¼çš„æ–¹å¼ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ˜“äºå®ç°æ–‡æ³•ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ‰§è¡Œæ•ˆç‡æ¯”è¾ƒä½ï¼Œå¯åˆ©ç”¨åœºæ™¯æ¯”è¾ƒå°‘ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¯¹äºå¤æ‚çš„æ–‡æ³•æ¯”è¾ƒéš¾ç»´æŠ¤ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">åœ¨è§£é‡Šå™¨æ¨¡å¼ä¸­ç”±äºè¯­æ³•æ˜¯ç”±å¾ˆå¤šç±»è¡¨ç¤ºçš„ï¼Œæ‰€ä»¥å¯æ‰©å±•æ€§å¼ºã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è™½ç„¶è§£é‡Šå™¨çš„å¯æ‰©å±•æ€§å¼ºï¼Œä½†æ˜¯å¦‚æœè¯­æ³•è§„åˆ™çš„æ•°ç›®å¤ªå¤§çš„æ—¶å€™ï¼Œè¯¥æ¨¡å¼å¯èƒ½å°±ä¼šå˜å¾—å¼‚å¸¸å¤æ‚ã€‚æ‰€ä»¥è§£é‡Šå™¨æ¨¡å¼é€‚ç”¨äºæ–‡æ³•è¾ƒä¸ºç®€å•çš„ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">è§£é‡Šå™¨æ¨¡å¼å¯ä»¥å¤„ç†è„šæœ¬è¯­è¨€å’Œç¼–ç¨‹è¯­è¨€ã€‚å¸¸ç”¨äºè§£å†³æŸä¸€ç‰¹å®šç±»å‹çš„é—®é¢˜é¢‘ç¹å‘ç”Ÿæƒ…å†µã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="ä¸­ä»‹è€…æ¨¡å¼-Mediator-Pattern"><a href="#ä¸­ä»‹è€…æ¨¡å¼-Mediator-Pattern" class="headerlink" title="ä¸­ä»‹è€…æ¨¡å¼(Mediator Pattern)"></a>ä¸­ä»‹è€…æ¨¡å¼(Mediator Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="130px"><br>      <col width="620px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Mediator</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/1690670033512cc2?w=535&h=166&f=gif&s=3603" data-width="535"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/1690670033512cc2?w=535&h=166&f=gif&s=3603" width="535"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ã€‚ä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸€ç»„å¯¹è±¡ä»¥å®šä¹‰è‰¯å¥½ä½†æ˜¯å¤æ‚çš„æ–¹å¼è¿›è¡Œé€šä¿¡ã€‚äº§ç”Ÿçš„ç›¸äº’ä¾èµ–å…³ç³»ç»“æ„æ··ä¹±ä¸”éš¾ä»¥ç†è§£ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸€ä¸ªå¯¹è±¡å¼•ç”¨å…¶ä»–å¾ˆå¤šå¯¹è±¡å¹¶ä¸”ç›´æ¥ä¸è¿™äº›å¯¹è±¡é€šä¿¡,å¯¼è‡´éš¾ä»¥å¤ç”¨è¯¥å¯¹è±¡ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æƒ³å®šåˆ¶ä¸€ä¸ªåˆ†å¸ƒåœ¨å¤šä¸ªç±»ä¸­çš„è¡Œä¸ºï¼Œè€Œåˆä¸æƒ³ç”Ÿæˆå¤ªå¤šçš„å­ç±»ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p"> ç®€åŒ–äº†å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œå°†ç³»ç»Ÿçš„å„ä¸ªå¯¹è±¡ä¹‹é—´çš„ç›¸äº’å…³ç³»è¿›è¡Œå°è£…ï¼Œå°†å„ä¸ªåŒäº‹ç±»è§£è€¦ï¼Œä½¿ç³»ç»Ÿæˆä¸ºæ¾è€¦åˆç³»ç»Ÿã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p"> å‡å°‘äº†å­ç±»çš„ç”Ÿæˆã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¯ä»¥å‡å°‘å„åŒäº‹ç±»çš„è®¾è®¡ä¸å®ç°ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç”±äºä¸­ä»‹è€…å¯¹è±¡å°è£…äº†ç³»ç»Ÿä¸­å¯¹è±¡ä¹‹é—´çš„ç›¸äº’å…³ç³»ï¼Œå¯¼è‡´å…¶å˜å¾—éå¸¸å¤æ‚ï¼Œä½¿å¾—ç³»ç»Ÿç»´æŠ¤æ¯”è¾ƒå›°éš¾ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¯ä¸ªæ§ä»¶ä¸éœ€è¦ç›´æ¥å’Œåˆ«çš„æ§ä»¶æ‰“äº¤é“ï¼Œåªéœ€è¦çŸ¥é“ä¸­ä»‹è€…å°±å¯ä»¥äº†ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¯ä¸ªæ§ä»¶éƒ½éœ€è¦ä¿æŒä¿æŒä¸­ä»‹è€…çš„å¼•ç”¨ï¼Œè€Œä¸­ä»‹è€…ä¸ä¸€å®šéœ€è¦ä¿æŒæ¯ä¸ªæ§ä»¶çš„å¼•ç”¨</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">Mediator çš„ä»£ç å¯èƒ½å¾ˆå¤æ‚ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="å¤‡å¿˜å½•æ¨¡å¼-Memento-Pattern"><a href="#å¤‡å¿˜å½•æ¨¡å¼-Memento-Pattern" class="headerlink" title="å¤‡å¿˜å½•æ¨¡å¼(Memento Pattern)"></a>å¤‡å¿˜å½•æ¨¡å¼(Memento Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="129px"><br>      <col width="621px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Mediator</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/1690670033512cc2?w=535&h=166&f=gif&s=3603" data-width="535"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/1690670033512cc2?w=535&h=166&f=gif&s=3603" width="535"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ã€‚ä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸€ç»„å¯¹è±¡ä»¥å®šä¹‰è‰¯å¥½ä½†æ˜¯å¤æ‚çš„æ–¹å¼è¿›è¡Œé€šä¿¡ã€‚äº§ç”Ÿçš„ç›¸äº’ä¾èµ–å…³ç³»ç»“æ„æ··ä¹±ä¸”éš¾ä»¥ç†è§£ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸€ä¸ªå¯¹è±¡å¼•ç”¨å…¶ä»–å¾ˆå¤šå¯¹è±¡å¹¶ä¸”ç›´æ¥ä¸è¿™äº›å¯¹è±¡é€šä¿¡,å¯¼è‡´éš¾ä»¥å¤ç”¨è¯¥å¯¹è±¡ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æƒ³å®šåˆ¶ä¸€ä¸ªåˆ†å¸ƒåœ¨å¤šä¸ªç±»ä¸­çš„è¡Œä¸ºï¼Œè€Œåˆä¸æƒ³ç”Ÿæˆå¤ªå¤šçš„å­ç±»ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç»™ç”¨æˆ·æä¾›äº†ä¸€ç§å¯ä»¥æ¢å¤çŠ¶æ€çš„æœºåˆ¶ã€‚å¯ä»¥æ˜¯ç”¨æˆ·èƒ½å¤Ÿæ¯”è¾ƒæ–¹ä¾¿åœ°å›åˆ°æŸä¸ªå†å²çš„çŠ¶æ€ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å®ç°äº†ä¿¡æ¯çš„å°è£…ã€‚ä½¿å¾—ç”¨æˆ·ä¸éœ€è¦å…³å¿ƒçŠ¶æ€çš„ä¿å­˜ç»†èŠ‚ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¶ˆè€—èµ„æºã€‚å¦‚æœç±»çš„æˆå‘˜å˜é‡è¿‡å¤šï¼ŒåŠ¿å¿…ä¼šå ç”¨æ¯”è¾ƒå¤§çš„èµ„æºï¼Œè€Œä¸”æ¯ä¸€æ¬¡ä¿å­˜éƒ½ä¼šæ¶ˆè€—ä¸€å®šçš„å†…å­˜ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">åˆ°éœ€è¦ä¿å­˜å¯¹è±¡å¤šä¸ªçŠ¶æ€ï¼Œå¹¶ä¸”å¯ä»¥æ¢å¤åˆ°ä»»æ„çŠ¶æ€ï¼Œå¯è€ƒè™‘å¤‡å¿˜å½•æ¨¡å¼ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å°†å¯¹è±¡ã€å¯¹è±¡çŠ¶æ€å’ŒçŠ¶æ€çš„ä¿å­˜åŠæ³•åˆ†ç¦»ï¼Œè®¾è®¡ä¸Šä¼šæ›´åŠ çµæ´»ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä½†å¯¹è±¡å±æ€§çš„å¤‡ä»½ã€æ¢å¤ã€ä¿å­˜ç­‰åŠ¨ä½œï¼Œéƒ½æ˜¯å¯èƒ½æ¯”è¾ƒè€—æ—¶çš„ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¤‡å¿˜å½•æ¨¡å¼åªæ˜¯æä¾›äº†ä¿å­˜å¯¹è±¡çŠ¶æ€çš„ä¸€ç§è§£å†³æ–¹æ¡ˆæ¡†æ¶ ï¼ŒçœŸæ­£åº”ç”¨æ—¶è¿˜éœ€è¦è§£å†³è¿™äº› é—®é¢˜:1.å¦‚ä½•è®¾è®¡ Memento? 2.æ€æ ·ä¿å­˜å¤šä¸ªå¯¹è±¡? 3.æ€æ ·ä¿å­˜ç»„ç»‡æˆæ ‘ç»“æ„çš„å¤šä¸ªå¯¹è±¡?</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="æ¨¡æ¿æ–¹æ³•æ¨¡å¼-TemplateMethod-Pattern"><a href="#æ¨¡æ¿æ–¹æ³•æ¨¡å¼-TemplateMethod-Pattern" class="headerlink" title="æ¨¡æ¿æ–¹æ³•æ¨¡å¼(TemplateMethod Pattern)"></a>æ¨¡æ¿æ–¹æ³•æ¨¡å¼(TemplateMethod Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="152px"><br>      <col width="598px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Template Method</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/1690670043aff038?w=395&h=225&f=gif&s=4901" data-width="395"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/1690670043aff038?w=395&h=225&f=gif&s=4901" width="395"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚Te m p l a t e M e t h o d ä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç®—æ³•çš„éª¨æ¶æ˜¯ä¸å˜çš„ï¼Œä½†å…¶ä¸­çš„æ­¥éª¤å®ç°å¯èƒ½æœ‰å˜åŒ–ï¼Œè¿™æ—¶å¯åº”ç”¨æ¨¡æ¿æ–¹æ³•ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¨¡æ¿æ–¹æ³•æ¨¡å¼åœ¨å®šä¹‰äº†ä¸€ç»„ç®—æ³•ï¼Œå°†å…·ä½“çš„å®ç°äº¤ç”±å­ç±»è´Ÿè´£ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯ä¸€ç§ä»£ç å¤ç”¨çš„åŸºæœ¬æŠ€æœ¯ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¨¡æ¿æ–¹æ³•æ¨¡å¼å¯¼è‡´ä¸€ç§åå‘çš„æ§åˆ¶ç»“æ„ï¼Œé€šè¿‡ä¸€ä¸ªçˆ¶ç±»è°ƒç”¨å…¶å­ç±»çš„æ“ä½œï¼Œé€šè¿‡å¯¹å­ç±»çš„æ‰©å±•å¢åŠ æ–°çš„è¡Œä¸ºï¼Œç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¯ä¸€ä¸ªä¸åŒçš„å®ç°éƒ½éœ€è¦ä¸€ä¸ªå­ç±»æ¥å®ç°ï¼Œå¯¼è‡´ç±»çš„ä¸ªæ•°å¢åŠ ï¼Œæ˜¯çš„ç³»ç»Ÿæ›´åŠ åºå¤§ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¨¡æ¿æ–¹æ³•æ¨¡å¼å®šä¹‰äº†ç®—æ³•çš„æ­¥éª¤ï¼Œå°†è¿™äº›æ­¥éª¤çš„å®ç°å»¶è¿Ÿåˆ°äº†å­ç±»ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§ä»£ç å¤ç”¨çš„é‡è¦æŠ€å·§ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„æŠ½è±¡ç±»å¯ä»¥å®šä¹‰æŠ½è±¡æ–¹æ³•ã€å…·ä½“æ–¹æ³•å’Œé’©å­ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸ºäº†é˜²æ­¢å­ç±»æ”¹å˜ç®—æ³•çš„å®ç°æ­¥éª¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¨¡æ¿æ–¹æ³•å£°æ˜ä¸ºfinalã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="çŠ¶æ€æ¨¡å¼-State-Pattern"><a href="#çŠ¶æ€æ¨¡å¼-State-Pattern" class="headerlink" title="çŠ¶æ€æ¨¡å¼(State Pattern)"></a>çŠ¶æ€æ¨¡å¼(State Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="153px"><br>      <col width="597px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>State</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/1690670043f86963?w=472&h=190&f=gif&s=4128" data-width="472"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/1690670043f86963?w=472&h=190&f=gif&s=4128" width="472"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºã€‚å¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸€ä¸ªå¯¹è±¡çš„è¡Œä¸ºå–å†³äºå®ƒçš„çŠ¶æ€, å¹¶ä¸”å®ƒå¿…é¡»åœ¨è¿è¡Œæ—¶åˆ»æ ¹æ®çŠ¶æ€æ”¹å˜å®ƒçš„è¡Œä¸ºã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸€ä¸ªæ“ä½œä¸­å«æœ‰åºå¤§çš„å¤šåˆ†æ”¯çš„æ¡ä»¶è¯­å¥ï¼Œä¸”è¿™äº›åˆ†æ”¯ä¾èµ–äºè¯¥å¯¹è±¡çš„çŠ¶æ€ã€‚è¿™ä¸ªçŠ¶æ€é€šå¸¸ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªæšä¸¾å¸¸é‡è¡¨ç¤ºã€‚é€šå¸¸, æœ‰å¤šä¸ªæ“ä½œåŒ…å«è¿™ä¸€ç›¸åŒçš„æ¡ä»¶ç»“æ„ã€‚S t a t eæ¨¡å¼å°†æ¯ä¸€ä¸ªæ¡ä»¶åˆ†æ”¯æ”¾å…¥ä¸€ä¸ªç‹¬ç«‹çš„ç±»ä¸­ã€‚è¿™ä½¿å¾—ä½ å¯ä»¥æ ¹æ®å¯¹è±¡è‡ªèº«çš„æƒ…å†µå°†å¯¹è±¡çš„çŠ¶æ€ä½œä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸€å¯¹è±¡å¯ä»¥ä¸ä¾èµ–äºå…¶ä»–å¯¹è±¡è€Œç‹¬ç«‹å˜åŒ–ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å°è£…äº†è½¬æ¢è§„åˆ™ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æšä¸¾å¯èƒ½çš„çŠ¶æ€ï¼Œåœ¨æšä¸¾çŠ¶æ€ä¹‹å‰éœ€è¦ç¡®å®šçŠ¶æ€ç§ç±»ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å°†æ‰€æœ‰ä¸æŸä¸ªçŠ¶æ€æœ‰å…³çš„è¡Œä¸ºæ”¾åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œå¹¶ä¸”å¯ä»¥æ–¹ä¾¿åœ°å¢åŠ æ–°çš„çŠ¶æ€ï¼Œåªéœ€è¦æ”¹å˜å¯¹è±¡çŠ¶æ€å³å¯æ”¹å˜å¯¹è±¡çš„è¡Œä¸ºã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å…è®¸çŠ¶æ€è½¬æ¢é€»è¾‘ä¸çŠ¶æ€å¯¹è±¡åˆæˆä¸€ä½“ï¼Œè€Œä¸æ˜¯æŸä¸€ä¸ªå·¨å¤§çš„æ¡ä»¶è¯­å¥å—ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¯ä»¥è®©å¤šä¸ªç¯å¢ƒå¯¹è±¡å…±äº«ä¸€ä¸ªçŠ¶æ€å¯¹è±¡ï¼Œä»è€Œå‡å°‘ç³»ç»Ÿä¸­å¯¹è±¡çš„ä¸ªæ•°ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">çŠ¶æ€æ¨¡å¼çš„ä½¿ç”¨å¿…ç„¶ä¼šå¢åŠ ç³»ç»Ÿç±»å’Œå¯¹è±¡çš„ä¸ªæ•°ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">çŠ¶æ€æ¨¡å¼çš„ç»“æ„ä¸å®ç°éƒ½è¾ƒä¸ºå¤æ‚ï¼Œå¦‚æœä½¿ç”¨ä¸å½“å°†å¯¼è‡´ç¨‹åºç»“æ„å’Œä»£ç çš„æ··ä¹±ã€‚ </div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">çŠ¶æ€æ¨¡å¼å¯¹â€œå¼€é—­åŸåˆ™â€çš„æ”¯æŒå¹¶ä¸å¤ªå¥½ï¼Œå¯¹äºå¯ä»¥åˆ‡æ¢çŠ¶æ€çš„çŠ¶æ€æ¨¡å¼ï¼Œå¢åŠ æ–°çš„çŠ¶æ€ç±»éœ€è¦ä¿®æ”¹é‚£äº›è´Ÿè´£çŠ¶æ€è½¬æ¢çš„æºä»£ç ï¼Œå¦åˆ™æ— æ³•åˆ‡æ¢åˆ°æ–°å¢çŠ¶æ€ï¼›è€Œä¸”ä¿®æ”¹æŸä¸ªçŠ¶æ€ç±»çš„è¡Œä¸ºä¹Ÿéœ€ä¿®æ”¹å¯¹åº”ç±»çš„æºä»£ç ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">çŠ¶æ€æ¨¡å¼å…è®¸ä¸€ä¸ªå¯¹è±¡åŸºäºå†…éƒ¨çŠ¶æ€è€Œæ‹¥æœ‰ä¸åŒçš„è¡Œä¸ºã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">Contextä¼šå°†è¡Œä¸ºå§”æ‰˜ç»™å½“å‰çŠ¶æ€å¯¹è±¡ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">çŠ¶æ€æ¨¡å¼å¯¹â€œå¼€é—­åŸåˆ™â€æ”¯æŒä¸æ˜¯å¾ˆå¥½ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="è´£ä»»é“¾æ¨¡å¼-Chain-of-Responsibility-Pattern"><a href="#è´£ä»»é“¾æ¨¡å¼-Chain-of-Responsibility-Pattern" class="headerlink" title="è´£ä»»é“¾æ¨¡å¼(Chain of Responsibility Pattern)"></a>è´£ä»»é“¾æ¨¡å¼(Chain of Responsibility Pattern)</h3><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="156px"><br>      <col width="594px"><br>    </colgroup><br>    <tbody><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åç§°</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><strong>Chain of Responsibility</strong></div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç»“æ„</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p"><br>            <div data-type="image" data-display="block" data-align="center" data-src="https://user-gold-cdn.xitu.io/2019/2/19/169067004412f3b7?w=412&h=218&f=gif&s=3962" data-width="412"><br>              <img src="https://user-gold-cdn.xitu.io/2019/2/19/169067004412f3b7?w=412&h=218&f=gif&s=3962" width="412"><br>            </div><br>          </div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åŠ¨æœº</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</div><br>        </td><br>      </tr><br>      <tr><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">é€‚ç”¨æ€§</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">æœ‰å¤šä¸ªçš„å¯¹è±¡å¯ä»¥å¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œå“ªä¸ªå¯¹è±¡å¤„ç†è¯¥è¯·æ±‚è¿è¡Œæ—¶åˆ»è‡ªåŠ¨ç¡®å®šã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä½ æƒ³åœ¨ä¸æ˜ç¡®æŒ‡å®šæ¥æ”¶è€…çš„æƒ…å†µä¸‹ï¼Œå‘å¤šä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªæäº¤ä¸€ä¸ªè¯·æ±‚ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¯å¤„ç†ä¸€ä¸ªè¯·æ±‚çš„å¯¹è±¡é›†åˆåº”è¢«åŠ¨æ€æŒ‡å®šã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ä¼˜ç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">é™ä½è€¦åˆåº¦ã€‚å®ƒå°†è¯·æ±‚çš„å‘é€è€…å’Œæ¥å—è€…è§£è€¦ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç®€åŒ–äº†å¯¹è±¡ã€‚ä½¿å¾—å¯¹è±¡ä¸éœ€è¦çŸ¥é“é“¾çš„ç»“æ„ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¢å¼ºç»™å¯¹è±¡æŒ‡æ´¾èŒè´£çš„çµæ´»æ€§ã€‚é€šè¿‡æ”¹å˜é“¾å†…çš„æˆå‘˜æˆ–è€…è°ƒåŠ¨å®ƒä»¬çš„æ¬¡åºï¼Œå…è®¸åŠ¨æ€åœ°æ–°å¢æˆ–è€…åˆ é™¤è´£ä»»ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¢åŠ æ–°çš„è¯·æ±‚å¤„ç†ç±»å¾ˆæ–¹ä¾¿ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç¼ºç‚¹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ä¸èƒ½ä¿è¯è¯·æ±‚ä¸€å®šè¢«æ¥æ”¶ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">ç³»ç»Ÿæ€§èƒ½å°†å—åˆ°ä¸€å®šå½±å“ï¼Œè€Œä¸”åœ¨è¿›è¡Œä»£ç è°ƒè¯•æ—¶ä¸å¤ªæ–¹ä¾¿ï¼›å¯èƒ½ä¼šé€ æˆå¾ªç¯è°ƒç”¨</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¯èƒ½ä¸å®¹æ˜“è§‚å¯Ÿè¿è¡Œæ—¶çš„ç‰¹å¾ï¼Œæœ‰ç¢äºé™¤é”™ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å°ç»“</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <ul data-type="unordered-list"><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">èŒè´£é“¾æ¨¡å¼å°†è¯·æ±‚çš„å‘é€è€…å’Œæ¥å—è€…è§£è€¦äº†ã€‚å®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“è¯·æ±‚å¤„ç†è€…çš„æ˜ç¡®ä¿¡æ¯ï¼Œç”šè‡³ä¸éœ€è¦çŸ¥é“é“¾çš„ç»“æ„ï¼Œå®ƒåªéœ€è¦å°†è¯·æ±‚è¿›è¡Œå‘é€å³å¯ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">èŒè´£é“¾æ¨¡å¼èƒ½å¤Ÿéå¸¸æ–¹ä¾¿çš„åŠ¨æ€å¢åŠ æ–°èŒè´£æˆ–è€…åˆ é™¤èŒè´£ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚å¯èƒ½ä¼šå¾—ä¸åˆ°å¤„ç†ã€‚</div><br>            </li><br>            <li data-type="list-item" data-list-type="unordered-list"><br>              <div data-type="p">å¤„ç†è€…ä¸éœ€è¦çŸ¥é“é“¾çš„ç»“æ„ï¼Œåªéœ€è¦æ˜ç™½ä»–çš„åç»­è€…æ˜¯è°å°±å¯ä»¥äº†ã€‚è¿™æ ·å°±ç®€åŒ–äº†ç³»ç»Ÿä¸­çš„å¯¹è±¡ã€‚</div><br>            </li><br>          </ul><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><h3 id="è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼å°ç»“"><a href="#è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼å°ç»“" class="headerlink" title="è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼å°ç»“"></a>è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼å°ç»“</h3><table><thead><tr><th style="text-align:left">æ¨¡å¼</th><th>åœºæ™¯å‘æ•£</th><th style="text-align:left">ä¸€å¥è¯è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">è§‚å¯Ÿè€…(Observer)</td><td>åŒæ­¥æ›´æ–°çš„é—®é¢˜</td><td style="text-align:left">ä¸€å‘¼ç™¾åº”ã€‚</td></tr><tr><td style="text-align:left">ç­–ç•¥(Strategy)</td><td>è®¾è®¡ä½ çš„æˆ˜å£«</td><td style="text-align:left">åˆ†ç¦»ç®—æ³•ã€‚</td></tr><tr><td style="text-align:left">è¿­ä»£å™¨(Iterator)</td><td>é›†åˆè®¿é—®çš„çƒ¦æ¼</td><td style="text-align:left">ä»¥ä¸€è‡´çš„æ–¹å¼è®¿é—®é›†åˆï¼Œ â€œæ¾ç»‘ â€éå†ç®—æ³•ä»£ç ã€‚</td></tr><tr><td style="text-align:left">å‘½ä»¤(Command)</td><td>ç¥å¥‡çš„Doä¸Undo</td><td style="text-align:left">åˆ†ç¦»åŠŸèƒ½è°ƒç”¨è€…ä¸åŠŸèƒ½å®ç°è€…ã€‚</td></tr><tr><td style="text-align:left">è®¿é—®è€…(Visitor)</td><td>å¢åŠ æ–°æ–¹æ³•çš„çƒ¦æ¼</td><td style="text-align:left">ä¸æ”¹å˜å¯¹è±¡ç»“æ„å¢åŠ æ–°æ–¹æ³•ã€‚</td></tr><tr><td style="text-align:left">è§£é‡Šå™¨(Interpreter)</td><td>è¶…çº§è¡¨è¾¾è§£é‡Šå¼•æ“</td><td style="text-align:left">è¯­æ³•è§£é‡Šã€‚</td></tr><tr><td style="text-align:left">ä¸­ä»‹è€…(Mediator)</td><td>éº»çƒ¦çš„å¤šè§’å…³ç³»</td><td style="text-align:left">å¤„ç†å¤šå¯¹å¤šå…³ç³»ã€‚</td></tr><tr><td style="text-align:left">å¤‡å¿˜å½•(Memento)</td><td>å‡å¦‚ä¸€åˆ‡å¯ä»¥é‡æ¥</td><td style="text-align:left">ä¿å­˜å¯¹è±¡çš„å¤šä¸ªçŠ¶æ€å¹¶å¯ä»»æ„æ¢å¤ã€‚</td></tr><tr><td style="text-align:left">æ¨¡æ¿æ–¹æ³•(Template Method)</td><td>ä¸‡èƒ½çš„æ’åºå™¨</td><td style="text-align:left">å®šä¹‰å¥½æ¡†æ¶ç®—æ³• ï¼ŒæŸäº›æ­¥éª¤å¯è‡ªå·±å®šä¹‰ ã€‚</td></tr><tr><td style="text-align:left">çŠ¶æ€(State)</td><td>æ˜¯æ”»å‡»è¿˜æ˜¯é€ƒèµ°</td><td style="text-align:left">æ–¹ä¾¿åœ°å¤„ç†ä¸åŒçŠ¶æ€ä¸åŒè¡Œä¸ºï¼Œä»¥åŠçŠ¶æ€ä¹‹é—´çš„è½¬æ¢ã€‚</td></tr><tr><td style="text-align:left">è´£ä»»é“¾(Chain)</td><td>é‚®ä»¶è‡ªåŠ¨å¤„ç†ç³»ç»Ÿ</td><td style="text-align:left">ç”¨ä¸åŒçš„è§„åˆ™å»å¤„ç†è¯·æ±‚ã€‚</td></tr></tbody></table><h2 id="æ¨¡å¼æ¯”è¾ƒ"><a href="#æ¨¡å¼æ¯”è¾ƒ" class="headerlink" title="æ¨¡å¼æ¯”è¾ƒ"></a>æ¨¡å¼æ¯”è¾ƒ</h2><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="http://www.uml.org.cn/sjms/201211023.asp" target="_blank" rel="noopener">http://www.uml.org.cn/sjms/201211023.asp</a></li><li><a href="http://www.cnblogs.com/chenssy/p/3357683.html" target="_blank" rel="noopener">http://www.cnblogs.com/chenssy/p/3357683.html</a></li><li><a href="https://academy.realm.io/cn/posts/donn-felker-solid-part-1/" target="_blank" rel="noopener">https://academy.realm.io/cn/posts/donn-felker-solid-part-1/</a></li><li><a href="http://www.cnblogs.com/chenssy/p/3357683.html" target="_blank" rel="noopener">http://www.cnblogs.com/chenssy/p/3357683.html</a></li><li>ã€Šç¡¬å•ƒè®¾è®¡æ¨¡å¼ã€‹</li><li>ã€ŠHeadFirst è®¾è®¡æ¨¡å¼ã€‹</li><li><p>GoF ã€Šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹</p><pre><code>æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼Œä¸€èµ·å­¦ä¹ ï¼Œå…±åŒæé«˜~</code></pre><p><img src="https://user-gold-cdn.xitu.io/2019/2/18/168ff71fee39e5cf?w=304&amp;h=302&amp;f=jpeg&amp;s=46553" alt="å…¬ä¼—å·å°.jpg"></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h1 id=&quot;è®¾è®¡æ¨¡å¼ç²¾ç®€å›¾å†Œ&quot;&gt;&lt;a href=&quot;#è®¾è®¡æ¨¡å¼ç²¾ç®€å›¾å†Œ&quot; class=&quot;headerlink&quot; title=&quot;è®¾è®¡æ¨¡å¼ç²¾ç®€å›¾å†Œ&quot;&gt;&lt;/a&gt;è®¾è®¡æ¨¡å¼ç²¾ç®€å›¾å†Œ&lt;/h1
      
    
    </summary>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://xsfelvis.github.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://xsfelvis.github.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>Dartè¯­æ³•åŸºç¡€</title>
    <link href="https://xsfelvis.github.io/2019/01/13/Dart%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/"/>
    <id>https://xsfelvis.github.io/2019/01/13/Dartè¯­æ³•åŸºç¡€/</id>
    <published>2019-01-12T16:00:00.000Z</published>
    <updated>2019-01-13T14:46:12.554Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h1 id="Dartè¯­æ³•åŸºç¡€"><a href="#Dartè¯­æ³•åŸºç¡€" class="headerlink" title="Dartè¯­æ³•åŸºç¡€"></a>Dartè¯­æ³•åŸºç¡€</h1><h1 id="Dartè¯­è¨€ç®€ä»‹"><a href="#Dartè¯­è¨€ç®€ä»‹" class="headerlink" title="Dartè¯­è¨€ç®€ä»‹"></a>Dartè¯­è¨€ç®€ä»‹</h1><p>åœ¨Dartå®˜æ–¹ç½‘ç«™ä¸Šï¼Œå¯¹äºDartçš„æè¿°å¦‚ä¸‹ï¼š</p><blockquote><p>Developers at Google and elsewhere use Dart to create high-quality, mission-critical apps for iOS, Android, and the web. With features aimed at client-side development, Dart is a great fit for both mobile and web apps.<br>Googleå’Œå…¶ä»–åœ°æ–¹çš„ä¸€äº›å¼€å‘è€…ä½¿ç”¨Dartè¯­è¨€ä¸ºAndroidã€iOSå’Œwebæ„å»ºé«˜è´¨é‡ï¼Œå…³é”®ä»»åŠ¡çš„åº”ç”¨ç¨‹åºï¼Œé’ˆå¯¹å®¢æˆ·ç«¯å¼€å‘çš„ç‰¹ç‚¹ï¼ŒDartéå¸¸é€‚åˆç§»åŠ¨å’ŒWebåº”ç”¨ç¨‹åºã€‚</p></blockquote><p><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">Dartæ˜¯Googleæ¨å‡ºçš„ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Œæœ€åˆæ˜¯å¸Œæœ›å–ä»£Javascriptè¿è¡Œåœ¨æµè§ˆå™¨ç«¯ï¼Œåæ¥æ…¢æ…¢å‘å±•æˆå¯ä»¥å¼€å‘Androidã€iOSå’ŒWebç«¯Appçš„ä¸€é—¨é«˜è´¨é‡çš„ç¼–ç¨‹è¯­è¨€ï¼Œç›®å‰Dartçš„ç‰ˆæœ¬æ˜¯Dart2ï¼Œå®˜ç½‘æ˜¯ï¼š</span></span><a href="https://link.juejin.im/?target=https%3A%2F%2Fwww.dartlang.org%2F" target="_blank" rel="noopener">www.dartlang.org/</a></p><p>æ›´åŠ è¯¦ç»†çš„å¯ä»¥å‚è€ƒ</p><ul><li>è‹±æ–‡å®˜æ–¹æ–‡æ¡£ <a href="https://link.juejin.im/?target=https%3A%2F%2Fwww.dartlang.org%2F" target="_blank" rel="noopener">www.dartlang.org/</a></li><li>ä¸­æ–‡å®˜æ–¹æ–‡æ¡£ <a href="http://dart.goodev.org/guides/language" target="_blank" rel="noopener">http://dart.goodev.org/guides/language</a></li><li>åœ¨çº¿è”ç³» <a href="https://dartpad.dartlang.org/" target="_blank" rel="noopener">https://dartpad.dartlang.org/</a></li></ul><h1 id="æ ¸å¿ƒæ¦‚å¿µ"><a href="#æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="æ ¸å¿ƒæ¦‚å¿µ"></a>æ ¸å¿ƒæ¦‚å¿µ</h1><p>Dartè¯­è¨€åšé‡‡ä¼—é•¿ï¼Œåœ¨æˆ‘ä»¬å­¦ä¹ Dartæ—¶å€™éœ€è¦è®°ä½ä»¥ä¸‹æ ¸å¿ƒæ¦‚å¿µ</p><ul><li><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ï¼Œä¸€åˆ‡å¯¹è±¡éƒ½æ˜¯classçš„å®ä¾‹ï¼Œå“ªæ€•æ˜¯æ•°å­—ç±»å‹ã€æ–¹æ³•ç”šè‡³nulléƒ½æ˜¯å¯¹è±¡ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯ç»§æ‰¿è‡ª</span></span><code>Object</code></li><li><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">Dartæ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œä½†å˜é‡ç±»å‹æ˜¯å¯é€‰çš„å› ä¸ºDartå¯ä»¥è‡ªåŠ¨æ¨æ–­å˜é‡ç±»å‹</span></span></li><li>Dartæ”¯æŒèŒƒå‹ï¼Œ<code>List&lt;int&gt;</code>è¡¨ç¤ºä¸€ä¸ªæ•´å‹çš„æ•°æ®åˆ—è¡¨ï¼Œ<code>List&lt;dynamic&gt;</code>åˆ™æ˜¯ä¸€ä¸ªå¯¹è±¡çš„åˆ—è¡¨ï¼Œå…¶ä¸­å¯ä»¥è£…ä»»æ„å¯¹è±¡</li><li>Dartæ”¯æŒé¡¶å±‚æ–¹æ³•ï¼ˆå¦‚<code>main</code>æ–¹æ³•ï¼‰ï¼Œä¹Ÿæ”¯æŒç±»æ–¹æ³•æˆ–å¯¹è±¡æ–¹æ³•ï¼ŒåŒæ—¶ä½ ä¹Ÿå¯ä»¥åœ¨æ–¹æ³•å†…éƒ¨åˆ›å»ºæ–¹æ³•</li><li>Dartæ”¯æŒé¡¶å±‚å˜é‡ï¼Œä¹Ÿæ”¯æŒç±»å˜é‡æˆ–å¯¹è±¡å˜é‡</li><li><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">è·ŸJavaä¸åŒçš„æ˜¯ï¼ŒDartæ²¡æœ‰</span></span><code>public</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span><code>protected</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span><code>private</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ç­‰å…³é”®å­—ï¼Œå¦‚æœæŸä¸ªå˜é‡ä»¥ä¸‹åˆ’çº¿ï¼ˆ</span></span><code>_</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ï¼‰å¼€å¤´ï¼Œä»£è¡¨è¿™ä¸ªå˜é‡åœ¨åº“ä¸­æ˜¯ç§æœ‰çš„</span></span></li></ul><h1 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h1><h2 id="å£°æ˜å˜é‡çš„æ–¹å¼"><a href="#å£°æ˜å˜é‡çš„æ–¹å¼" class="headerlink" title="å£°æ˜å˜é‡çš„æ–¹å¼"></a>å£°æ˜å˜é‡çš„æ–¹å¼</h2><p>å¯ä»¥æ˜ç¡®æŒ‡å®šæŸä¸ªå˜é‡çš„ç±»å‹ï¼Œå¦‚<code>int</code> <code>bool</code> <code>String</code>ï¼Œä¹Ÿå¯ä»¥ç”¨<code>var</code>æˆ– <code>dynamic</code>æ¥å£°æ˜ä¸€ä¸ªå˜é‡ï¼ŒDartä¼šè‡ªåŠ¨æ¨æ–­å…¶æ•°æ®ç±»å‹ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">main() &#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">  int b = <span class="number">10</span>;</span><br><span class="line">  <span class="built_in">String</span> s = <span class="string">"hello"</span>;</span><br><span class="line">  dynamic c = <span class="number">0.5</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="finalå’Œconst"><a href="#finalå’Œconst" class="headerlink" title="finalå’Œconst"></a>finalå’Œconst</h2><p><code>final</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä¿®é¥°çš„å˜é‡æ˜¯ä¸å¯æ”¹å˜çš„ï¼Œè€Œ</span></span><code>const</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä¿®é¥°çš„è¡¨ç¤ºä¸€ä¸ªå¸¸é‡ï¼Œå£°æ˜æ™®é€šå˜é‡å¯ä»¥ä½¿ç”¨</span></span><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:#E9E9E9">var</span></span></p><h1 id="å†…ç½®æ•°æ®ç±»å‹"><a href="#å†…ç½®æ•°æ®ç±»å‹" class="headerlink" title="å†…ç½®æ•°æ®ç±»å‹"></a>å†…ç½®æ•°æ®ç±»å‹</h1><p>Dartæœ‰å¦‚ä¸‹å‡ ç§å†…å»ºçš„æ•°æ®ç±»å‹ï¼š</p><ul><li>numbers</li><li>strings</li><li>booleans</li><li>lists(æˆ–è€…æ˜¯arrays)</li><li>maps</li><li>runesï¼ˆUTF-32å­—ç¬¦é›†çš„å­—ç¬¦ï¼‰</li><li>symbols</li></ul><h2 id="String"><a href="#String" class="headerlink" title="String"></a>String</h2><ul><li>æ£€æµ‹ä¸¤ä¸ª String çš„å†…å®¹æ˜¯å¦ä¸€æ ·äº‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ == è¿›è¡Œæ¯”è¾ƒï¼›å¦‚æœè¦æµ‹è¯•ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼ˆindentity testï¼‰ï¼Œä½¿ç”¨ identical å‡½æ•°</li><li><ul><li>è¿›è¡Œæ‹¼æ¥</li></ul></li><li>\${} å­—ç¬¦ä¸²å†…è¡¨è¾¾å¼</li><li>ä¸‰ä¸ªå•å¼•å·æˆ–è€…åŒå¼•å·å¯ä»¥åˆ›å»ºå¤šè¡Œå­—ç¬¦ä¸²å¯¹è±¡</li></ul><h2 id="List"><a href="#List" class="headerlink" title="List"></a>List</h2><p><a href="http://dart.goodev.org/guides/libraries/library-tour#collections" target="_blank" rel="noopener">http://dart.goodev.org/guides/libraries/library-tour#collections</a></p><h3 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a List constructor.</span></span><br><span class="line"><span class="keyword">var</span> vegetables = <span class="keyword">new</span> List();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Or simply use a list literal.</span></span><br><span class="line"><span class="keyword">var</span> fruits = [<span class="string">'apples'</span>, <span class="string">'oranges'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//listæ˜¯æ³›å‹ç±»å‹ä¹Ÿå¯ä»¥æŒ‡å®šé‡Œé¢ä¿å­˜çš„ç±»å‹</span></span><br><span class="line"><span class="keyword">var</span> fruits = <span class="keyword">new</span> List&lt;<span class="built_in">String</span>&gt;();</span><br><span class="line">fruits.add(<span class="string">'apples'</span>);</span><br></pre></td></tr></table></figure><h3 id="æ ¸å¿ƒapi"><a href="#æ ¸å¿ƒapi" class="headerlink" title="æ ¸å¿ƒapi"></a>æ ¸å¿ƒapi</h3><ul><li>add</li><li>addAll</li><li>length</li><li>indexOf</li><li>sort</li></ul><h2 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h2><p><span data-type="color" style="color:rgb(82, 82, 82)"><span data-type="background" style="background-color:rgb(255, 255, 255)">mapæ˜¯ä¸€ä¸ªå…³è”é”®å’Œå€¼çš„å¯¹è±¡ã€‚é”®å’Œå€¼éƒ½å¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„å¯¹è±¡ã€‚æ¯ä¸ªé”®åªå‡ºç°ä¸€æ¬¡ï¼Œä½†æ˜¯æ‚¨å¯ä»¥å¤šæ¬¡ä½¿ç”¨ç›¸åŒçš„å€¼ã€‚Dartå¯¹mapçš„æ”¯æŒæ˜¯é€šè¿‡mapå­—é¢é‡å’Œmapç±»å‹æ¥æä¾›çš„ã€‚</span></span></p><h3 id="åˆå§‹åŒ–-1"><a href="#åˆå§‹åŒ–-1" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gifts = &#123;</span><br><span class="line"><span class="comment">// Keys      Values</span></span><br><span class="line">  <span class="string">'first'</span> : <span class="string">'partridge'</span>,</span><br><span class="line">  <span class="string">'second'</span>: <span class="string">'turtledoves'</span>,</span><br><span class="line">  <span class="string">'fifth'</span> : <span class="string">'golden rings'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> nobleGases = &#123;</span><br><span class="line"><span class="comment">// Keys  Values</span></span><br><span class="line">  <span class="number">2</span> :   <span class="string">'helium'</span>,</span><br><span class="line">  <span class="number">10</span>:   <span class="string">'neon'</span>,</span><br><span class="line">  <span class="number">18</span>:   <span class="string">'argon'</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//æ„é€ å‡½æ•°å®ç°</span></span><br><span class="line"><span class="keyword">var</span> gifts = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">gifts[<span class="string">'first'</span>] = <span class="string">'partridge'</span>;</span><br><span class="line">gifts[<span class="string">'second'</span>] = <span class="string">'turtledoves'</span>;</span><br><span class="line">gifts[<span class="string">'fifth'</span>] = <span class="string">'golden rings'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> nobleGases = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">nobleGases[<span class="number">2</span>] = <span class="string">'helium'</span>;</span><br><span class="line">nobleGases[<span class="number">10</span>] = <span class="string">'neon'</span>;</span><br><span class="line">nobleGases[<span class="number">18</span>] = <span class="string">'argon'</span>;</span><br></pre></td></tr></table></figure><h3 id="æ ¸å¿ƒapi-1"><a href="#æ ¸å¿ƒapi-1" class="headerlink" title="æ ¸å¿ƒapi"></a>æ ¸å¿ƒapi</h3><ul><li><p>æ·»åŠ </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gifts = &#123;<span class="string">'first'</span>: <span class="string">'partridge'</span>&#125;;</span><br><span class="line">gifts[<span class="string">'fourth'</span>] = <span class="string">'calling birds'</span>; <span class="comment">// Add a key-value pair</span></span><br></pre></td></tr></table></figure></li><li><p>è·å–mapå¯¹è±¡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gifts = &#123;<span class="string">'first'</span>: <span class="string">'partridge'</span>&#125;;</span><br><span class="line">assert(gifts[<span class="string">'first'</span>] == <span class="string">'partridge'</span>);</span><br></pre></td></tr></table></figure></li></ul><p>å¦‚æœæŸ¥æ‰¾çš„keyä¸å­˜åœ¨åˆ™è¿”å›null</p><ul><li>length è·å–mapä¸­é”®å€¼å¯¹çš„æ•°ç›®</li><li>containsKey</li><li>putIfAbsent()<br><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä½†æ˜¯åªæœ‰è¯¥ key åœ¨ map ä¸­ä¸å­˜åœ¨çš„æ—¶å€™æ‰è®¾ç½®è¿™ä¸ªå€¼ï¼Œå¦åˆ™ key çš„å€¼ä¿æŒä¸å˜</span></span></li></ul><h2 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h2><h3 id="åˆå§‹åŒ–-2"><a href="#åˆå§‹åŒ–-2" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h3><p><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>Set æ˜¯ä¸€ä¸ªæ— åºé›†åˆï¼Œé‡Œé¢ä¸èƒ½ä¿æŠ¤é‡å¤çš„æ•°æ®ã€‚ ç”±äºæ˜¯æ— åºçš„ï¼Œæ‰€ä»¥æ— æ³•é€šè¿‡ç´¢å¼•æ¥ä» set ä¸­è·å–æ•°æ®<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ingredients = <span class="keyword">new</span> <span class="built_in">Set</span>();</span><br><span class="line">ingredients.addAll([<span class="string">'gold'</span>, <span class="string">'titanium'</span>, <span class="string">'xenon'</span>]);</span><br><span class="line">assert(ingredients.length == <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Adding a duplicate item has no effect.</span></span><br><span class="line">ingredients.add(<span class="string">'gold'</span>);</span><br><span class="line">assert(ingredients.length == <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Remove an item from a set.</span></span><br><span class="line">ingredients.remove(<span class="string">'gold'</span>);</span><br><span class="line">assert(ingredients.length == <span class="number">2</span>);</span><br></pre></td></tr></table></figure></p><h3 id="æ ¸å¿ƒapi-2"><a href="#æ ¸å¿ƒapi-2" class="headerlink" title="æ ¸å¿ƒapi"></a>æ ¸å¿ƒapi</h3><ul><li><code>contains()</code><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>å’Œ <code>containsAll()</code><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>æ¥åˆ¤æ–­ set ä¸­æ˜¯å¦åŒ…å« ä¸€ä¸ªæˆ–è€…å¤šä¸ªå¯¹è±¡</li></ul><h2 id="å¸¸ç”¨é›†åˆå‡½æ•°"><a href="#å¸¸ç”¨é›†åˆå‡½æ•°" class="headerlink" title="å¸¸ç”¨é›†åˆå‡½æ•°"></a>å¸¸ç”¨é›†åˆå‡½æ•°</h2><ul><li><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>List å’Œ Set å®ç°äº† Iterable ,è™½ç„¶ Map æ²¡æœ‰å®ç° Iterableï¼Œä½†æ˜¯ Map çš„ keys å’Œ values å±æ€§å®ç°äº† Iterable</li><li>isEmpty</li><li><p><code>forEach()</code><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>å‡½æ•°å¯ä»¥éå†é›†åˆæ•°æ®ï¼Œåœ¨ Map ä¸Šä½¿ç”¨ <code>forEach()</code> çš„æ—¶å€™ï¼Œæ–¹æ³•éœ€è¦èƒ½ æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼ˆkey å’Œ valueï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var teas = [&apos;green&apos;, &apos;black&apos;, &apos;chamomile&apos;, &apos;earl grey&apos;];</span><br><span class="line"></span><br><span class="line">teas.forEach((tea) =&gt; print(&apos;I drink $tea&apos;));</span><br><span class="line">//map</span><br><span class="line">hawaiianBeaches.forEach((k, v) &#123;</span><br><span class="line">  print(&apos;I want to visit $k and swim at $v&apos;);</span><br><span class="line">  // I want to visit Oahu and swim at</span><br><span class="line">  // [Waikiki, Kailua, Waimanalo], etc.</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>å¯ä»¥ä½¿ç”¨ <code>map().toList()</code> æˆ–è€… <code>map().toSet()</code> æ¥ å¼ºåˆ¶ç«‹åˆ»æ‰§è¡Œ map çš„æ–¹æ³•ï¼š</p></li></ul><h1 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h1><h3 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h3><p>Dartæ˜¯ä¸€ä¸ªé¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œæ‰€ä»¥å³ä½¿æ˜¯å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿæœ‰ä¸€ç§ç±»å‹<code>Function</code>ï¼Œè¿™å°±æ„å‘³ç€å‡½æ•°å¯ä»¥èµ‹å€¼ç»™æŸä¸ªå˜é‡æˆ–è€…ä½œä¸ºå‚æ•°ä¼ ç»™å¦å¤–çš„å‡½æ•°ã€‚è™½ç„¶Dartæ¨èä½ ç»™å‡½æ•°åŠ ä¸Šè¿”å›å€¼ï¼Œä½†æ˜¯<strong>ä¸åŠ è¿”å›å€¼çš„å‡½æ•°åŒæ ·å¯ä»¥æ­£å¸¸å·¥ä½œ</strong>ï¼Œå¦å¤–ä½ è¿˜å¯ä»¥ç”¨<code>=&gt;</code>ä»£æ›¿<code>return</code>è¯­å¥<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// =&gt;æ˜¯returnè¯­å¥çš„ç®€å†™</span></span><br><span class="line">add3(a, b) =&gt; a + b;</span><br></pre></td></tr></table></figure></p><p>æ‰€æœ‰çš„å‡½æ•°éƒ½æœ‰è¿”å›å€¼ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®š<code>return</code>è¯­å¥ï¼Œé‚£ä¹ˆè¯¥å‡½æ•°çš„è¿”å›å€¼ä¸º<code>null</code>ã€‚</p><h3 id="å‘½åå‚æ•°ã€ä½ç½®å‚æ•°ã€å‚æ•°é»˜è®¤å€¼"><a href="#å‘½åå‚æ•°ã€ä½ç½®å‚æ•°ã€å‚æ•°é»˜è®¤å€¼" class="headerlink" title="å‘½åå‚æ•°ã€ä½ç½®å‚æ•°ã€å‚æ•°é»˜è®¤å€¼"></a>å‘½åå‚æ•°ã€ä½ç½®å‚æ•°ã€å‚æ•°é»˜è®¤å€¼</h3><ul><li>å‘½åå‚æ•°</li></ul><p><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä½¿ç”¨èŠ±æ‹¬å·å°†å‡½æ•°çš„å‚æ•°æ‹¬èµ·æ¥å°±æ˜¯å®šä¹‰äº†å‘½åå‚æ•°</span></span><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sayHello(&#123;<span class="built_in">String</span> name&#125;) &#123;</span><br><span class="line">  print(<span class="string">"hello, my name is $name"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sayHello2(&#123;<span class="attr">name</span>: <span class="built_in">String</span>&#125;) &#123;</span><br><span class="line">  print(<span class="string">"hello, my name is $name"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥ä»¥<code>{type paramName}</code>æˆ–è€…<code>{paramName: type}</code>ä¸¤ç§æ–¹å¼å£°æ˜å‚æ•°ï¼Œè€Œè°ƒç”¨å‘½åå‚æ•°æ—¶ï¼Œéœ€è¦ä»¥<code>funcName(paramName: paramValue)</code>çš„å½¢å¼è°ƒç”¨ã€‚<br>å¯ä»¥ä½¿ç”¨<code>@required</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">æ³¨è§£æ¥æ ‡è¯†ä¸€ä¸ªå‘½åå‚æ•°ï¼Œè¿™ä»£è¡¨è¯¥å‚æ•°æ˜¯å¿…é¡»çš„ï¼Œä½ ä¸ä¼ åˆ™ä¼šæŠ¥é”™</span></span></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Scrollbar(&#123;Key key, @required Widget child&#125;)</span><br></pre></td></tr></table></figure><ul><li>ä½ç½®å‚æ•°<br><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä½¿ç”¨ä¸­æ‹¬å·</span></span><code>[]</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">æ‹¬èµ·æ¥çš„å‚æ•°æ˜¯å‡½æ•°çš„ä½ç½®å‚æ•°ï¼Œä»£è¡¨è¯¥å‚æ•°å¯ä¼ å¯ä¸ä¼ ï¼Œä½ç½®å‚æ•°åªèƒ½æ”¾åœ¨å‡½æ•°çš„å‚æ•°åˆ—è¡¨çš„æœ€åé¢</span></span></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sayHello(<span class="built_in">String</span> name, int age, [<span class="built_in">String</span> hobby]) &#123; <span class="comment">// ä½ç½®å‚æ•°å¯ä»¥æœ‰å¤šä¸ªï¼Œæ¯”å¦‚[String a, int b]</span></span><br><span class="line">  StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">  sb.write(<span class="string">"hello, this is $name and I am $age years old"</span>);</span><br><span class="line">  <span class="keyword">if</span> (hobby != <span class="literal">null</span>) &#123;</span><br><span class="line">    sb.write(<span class="string">", my hobby is $hobby"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  print(sb.toString());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main() &#123;</span><br><span class="line">  <span class="comment">// hello, this is zhangsan and I am 20 years old</span></span><br><span class="line">  sayHello(<span class="string">"zhangsan"</span>, <span class="number">20</span>);</span><br><span class="line">  <span class="comment">// hello, this is zhangsan and I am 20 years old, my hobby is play football</span></span><br><span class="line">  sayHello(<span class="string">"zhangsan"</span>, <span class="number">20</span>, <span class="string">"play football"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å‚æ•°é»˜è®¤å€¼</li></ul><p><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">å¯ä»¥ä¸ºå‘½åå‚æ•°æˆ–è€…ä½ç½®å‚æ•°è®¾ç½®é»˜è®¤å€¼</span></span><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘½åå‚æ•°çš„é»˜è®¤å€¼</span></span><br><span class="line">int add(&#123;int a, int b = <span class="number">3</span>&#125;) &#123; <span class="comment">// ä¸èƒ½å†™æˆï¼šint add(&#123;a: int, b: int = 3&#125;)</span></span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½ç½®å‚æ•°çš„é»˜è®¤å€¼</span></span><br><span class="line">int sum(int a, int b, [int c = <span class="number">3</span>]) &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="å‡½æ•°ä½œä¸ºä¸€ç­‰æ–¹æ³•å¯¹è±¡"><a href="#å‡½æ•°ä½œä¸ºä¸€ç­‰æ–¹æ³•å¯¹è±¡" class="headerlink" title="å‡½æ•°ä½œä¸ºä¸€ç­‰æ–¹æ³•å¯¹è±¡"></a>å‡½æ•°ä½œä¸ºä¸€ç­‰æ–¹æ³•å¯¹è±¡</h3><p><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">å‡½æ•°ä½œä¸ºå‚æ•°ä¼ ç»™å¦ä¸€ä¸ªå‡½æ•°</span></span><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">printNum(int a) &#123;</span><br><span class="line">  print(<span class="string">"$a"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main() &#123;</span><br><span class="line">  <span class="comment">//  ä¾æ¬¡æ‰“å°ï¼š1,2,3</span></span><br><span class="line">  <span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">  arr.forEach(printNum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æˆ–è€…å°†å‡½æ•°èµ‹å€¼ç»™æŸä¸ªå˜é‡<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">printNum(int a) &#123;</span><br><span class="line">  print(<span class="string">"$a"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main() &#123;</span><br><span class="line">  <span class="keyword">var</span> f1 = printNum;</span><br><span class="line">  <span class="built_in">Function</span> f2 = printNum;</span><br><span class="line">  <span class="keyword">var</span> f3 = <span class="function">(<span class="params">int a</span>) =&gt;</span> print(<span class="string">"a = $a"</span>);</span><br><span class="line">  f1(<span class="number">1</span>);</span><br><span class="line">  f2(<span class="number">2</span>);</span><br><span class="line">  f3(<span class="number">6</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="åŒ¿åå‡½æ•°"><a href="#åŒ¿åå‡½æ•°" class="headerlink" title="åŒ¿åå‡½æ•°"></a>åŒ¿åå‡½æ•°</h2><ul><li><p><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)">åˆ›å»ºæ²¡æœ‰åå­—çš„æ–¹æ³•ï¼Œç§°ä¹‹ä¸º </span></span><em>åŒ¿åæ–¹æ³•</em><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ï¼Œæœ‰æ—¶å€™ä¹Ÿè¢«ç§°ä¸º </span></span><em>lambda</em><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>æˆ–è€… <em>closure é—­åŒ…</em><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ã€‚ ä½ å¯ä»¥æŠŠåŒ¿åæ–¹æ³•èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œ ç„¶åä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæ¯”å¦‚æ·»åŠ åˆ°é›†åˆæˆ–è€…ä»é›†åˆä¸­åˆ é™¤</span></span></p></li><li><p>åŒ¿åå‡½æ•°ç±»ä¼¼äº<code>Java</code>ä¸­çš„æ¥å£ï¼Œå¾€å¾€åœ¨æŸä¸ªå‡½æ•°çš„å‚æ•°ä¸ºå‡½æ•°æ—¶ä½¿ç”¨åˆ°ã€‚</p><h2 id="è¯æ³•é—­åŒ…"><a href="#è¯æ³•é—­åŒ…" class="headerlink" title="è¯æ³•é—­åŒ…"></a>è¯æ³•é—­åŒ…</h2><p>ä¸€ä¸ª <em>é—­åŒ…</em> æ˜¯ä¸€ä¸ªæ–¹æ³•å¯¹è±¡ï¼Œä¸ç®¡è¯¥å¯¹è±¡åœ¨ä½•å¤„è¢«è°ƒç”¨ï¼Œ è¯¥å¯¹è±¡éƒ½å¯ä»¥è®¿é—®å…¶ä½œç”¨åŸŸå†… çš„å˜é‡ã€‚</p></li></ul><p><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œ</span></span><code>makeAdder()</code><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>æ•è·åˆ°äº†å˜é‡ <code>addBy</code><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ã€‚ ä¸ç®¡ä½ åœ¨é‚£é‡Œæ‰§è¡Œ </span></span><code>makeAdder()</code><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>æ‰€è¿”å›çš„å‡½æ•°ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ <code>addBy</code><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>å‚æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span> makeAdder(num addBy) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">num i</span>) =&gt;</span> addBy + i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ“ä½œç¬¦"><a href="#æ“ä½œç¬¦" class="headerlink" title="æ“ä½œç¬¦"></a>æ“ä½œç¬¦</h1><table><thead><tr><th style="text-align:left">æè¿°</th><th style="text-align:left">æ“ä½œç¬¦</th></tr></thead><tbody><tr><td style="text-align:left">unary postfix</td><td style="text-align:left"><code><em>expr</em></code><code>++</code>    <code><em>expr</em></code><code>â€“</code>    <code>()</code>    <code>[]</code>    <code>.</code>    <code>?.</code></td></tr><tr><td style="text-align:left">unary prefix</td><td style="text-align:left"><code>-</code><code><em>expr</em></code>    <code>!</code><code><em>expr</em></code>    <code>~</code><code><em>expr</em></code>    <code>++</code><code><em>expr</em></code>    <code>â€“</code><code><em>expr</em></code></td></tr><tr><td style="text-align:left">multiplicative</td><td style="text-align:left"><code>*</code>    <code>/</code>    <code>%</code>  <code>~/</code></td></tr><tr><td style="text-align:left">additive</td><td style="text-align:left"><code>+</code>    <code>-</code></td></tr><tr><td style="text-align:left">shift</td><td style="text-align:left"><code>&lt;&lt;</code>    <code>&gt;&gt;</code></td></tr><tr><td style="text-align:left">bitwise AND</td><td style="text-align:left"><code>&amp;</code></td></tr><tr><td style="text-align:left">bitwise XOR</td><td style="text-align:left"><code>^</code></td></tr><tr><td style="text-align:left">bitwise OR</td><td style="text-align:left">`</td><td>`</td></tr><tr><td style="text-align:left">relational and type test</td><td style="text-align:left"><code>&gt;=</code>    <code>&gt;</code>    <code>&lt;=</code>    <code>&lt;</code>    <code>as</code>    <code>is</code>    <code>is!</code></td></tr><tr><td style="text-align:left">equality</td><td style="text-align:left"><code>==</code>    <code>!=</code></td></tr><tr><td style="text-align:left">logical AND</td><td style="text-align:left"><code>&amp;&amp;</code></td></tr><tr><td style="text-align:left">logical OR</td><td style="text-align:left">`</td><td></td><td>`</td></tr><tr><td style="text-align:left">if null</td><td style="text-align:left"><code>??</code></td></tr><tr><td style="text-align:left">conditional</td><td style="text-align:left"><code><em>expr1</em></code><code> ? </code><code><em>expr2</em></code><code> : </code><code><em>expr3</em></code></td></tr><tr><td style="text-align:left">cascade</td><td style="text-align:left"><code>..</code></td></tr><tr><td style="text-align:left">assignment</td><td style="text-align:left"><code>=</code>    <code>*=</code>    <code>/=</code>    <code>~/=</code>    <code>%=</code>    <code>+=</code>    <code>-=</code>    <code>&lt;&lt;=</code>    <code>&gt;&gt;=</code>    <code>&amp;=</code>    <code>^=</code>    `</td><td>=<code></code>??=`</td></tr></tbody></table><h3 id="ç±»å‹åˆ¤å®šæ“ä½œç¬¦"><a href="#ç±»å‹åˆ¤å®šæ“ä½œç¬¦" class="headerlink" title="ç±»å‹åˆ¤å®šæ“ä½œç¬¦"></a>ç±»å‹åˆ¤å®šæ“ä½œç¬¦</h3><p><code>as</code>ã€ <code>is</code>ã€ å’Œ <code>is!</code> æ“ä½œç¬¦æ˜¯åœ¨è¿è¡Œæ—¶åˆ¤å®šå¯¹è±¡ ç±»å‹çš„æ“ä½œç¬¦ï¼š</p><table><thead><tr><th style="text-align:left">æ“ä½œç¬¦</th><th style="text-align:left">è§£é‡Š</th></tr></thead><tbody><tr><td style="text-align:left"><code>as</code></td><td style="text-align:left">ç±»å‹è½¬æ¢</td></tr><tr><td style="text-align:left"><code>is</code></td><td style="text-align:left">å¦‚æœå¯¹è±¡æ˜¯æŒ‡å®šçš„ç±»å‹è¿”å› True</td></tr><tr><td style="text-align:left"><code>is!</code></td><td style="text-align:left">å¦‚æœå¯¹è±¡æ˜¯æŒ‡å®šçš„ç±»å‹è¿”å› False</td></tr></tbody></table><h3 id="èµ‹å€¼æ“ä½œç¬¦"><a href="#èµ‹å€¼æ“ä½œç¬¦" class="headerlink" title="èµ‹å€¼æ“ä½œç¬¦"></a>èµ‹å€¼æ“ä½œç¬¦</h3><p>ä½¿ç”¨ <code>=</code> æ“ä½œç¬¦æ¥èµ‹å€¼ã€‚ ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ª <code>??=</code> æ“ä½œç¬¦ç”¨æ¥æŒ‡å®š å€¼ä¸º null çš„å˜é‡çš„å€¼ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = value;   <span class="comment">// ç»™ a å˜é‡èµ‹å€¼</span></span><br><span class="line">b ??= value; <span class="comment">// å¦‚æœ b æ˜¯ nullï¼Œåˆ™èµ‹å€¼ç»™ bï¼›</span></span><br><span class="line">             <span class="comment">// å¦‚æœä¸æ˜¯ nullï¼Œåˆ™ b çš„å€¼ä¿æŒä¸å˜</span></span><br></pre></td></tr></table></figure></p><h3 id="æ¡ä»¶è¡¨è¾¾å¼"><a href="#æ¡ä»¶è¡¨è¾¾å¼" class="headerlink" title="æ¡ä»¶è¡¨è¾¾å¼"></a>æ¡ä»¶è¡¨è¾¾å¼</h3><p>Dart æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„æ“ä½œç¬¦å¯ä»¥ç”¨æ¥æ›¿ä»£ if-else è¯­å¥ï¼š</p><ul><li><p><code><em>condition</em></code><code> ? </code><code><em>expr1</em></code><code> : </code><code><em>expr2</em></code><br>å¦‚æœ <em>condition</em> æ˜¯ trueï¼Œæ‰§è¡Œ <em>expr1</em> (å¹¶è¿”å›æ‰§è¡Œçš„ç»“æœ)ï¼› å¦åˆ™æ‰§è¡Œ <em>expr2</em> å¹¶è¿”å›å…¶ç»“æœã€‚<br>å¦‚æœä½ éœ€è¦åŸºäºå¸ƒå°”è¡¨è¾¾å¼ çš„å€¼æ¥èµ‹å€¼ï¼Œ è€ƒè™‘ä½¿ç”¨ <code>?:</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> finalStatus = m.isFinal ? <span class="string">'final'</span> : <span class="string">'not final'</span>;</span><br></pre></td></tr></table></figure></li><li><p><code><em>expr1</em></code><code> ?? </code><code><em>expr2</em></code><br>å¦‚æœ <em>expr1</em> æ˜¯ non-nullï¼Œè¿”å›å…¶å€¼ï¼› å¦åˆ™æ‰§è¡Œ <em>expr2</em> å¹¶è¿”å›å…¶ç»“æœã€‚<br>å¦‚æœå¸ƒå°”è¡¨è¾¾å¼æ˜¯æµ‹è¯•å€¼æ˜¯å¦ä¸º nullï¼Œ è€ƒè™‘ä½¿ç”¨ <code>??</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> toString() =&gt; msg ?? <span class="keyword">super</span>.toString();</span><br></pre></td></tr></table></figure></li></ul><h3 id="çº§è”æ“ä½œç¬¦"><a href="#çº§è”æ“ä½œç¬¦" class="headerlink" title="çº§è”æ“ä½œç¬¦"></a>çº§è”æ“ä½œç¬¦</h3><p>çº§è”æ“ä½œç¬¦ (<code>..</code>) å¯ä»¥åœ¨åŒä¸€ä¸ªå¯¹è±¡ä¸Š è¿ç»­è°ƒç”¨å¤šä¸ªå‡½æ•°ä»¥åŠè®¿é—®æˆå‘˜å˜é‡ã€‚ ä½¿ç”¨çº§è”æ“ä½œç¬¦å¯ä»¥é¿å…åˆ›å»º ä¸´æ—¶å˜é‡ï¼Œ å¹¶ä¸”å†™å‡ºæ¥çš„ä»£ç çœ‹èµ·æ¥ æ›´åŠ æµç•…ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">querySelector(<span class="string">'#button'</span>) <span class="comment">// Get an object.</span></span><br><span class="line">  ..text = <span class="string">'Confirm'</span>   <span class="comment">// Use its members.</span></span><br><span class="line">  ..classes.add(<span class="string">'important'</span>)</span><br><span class="line">  ..onClick.listen(<span class="function">(<span class="params">e</span>) =&gt;</span> <span class="built_in">window</span>.alert(<span class="string">'Confirmed!'</span>));</span><br></pre></td></tr></table></figure></p><p>çº§è”è°ƒç”¨ä¹Ÿå¯ä»¥åµŒå¥—ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">final addressBook = (<span class="keyword">new</span> AddressBookBuilder()</span><br><span class="line">      ..name = <span class="string">'jenny'</span></span><br><span class="line">      ..email = <span class="string">'jenny@example.com'</span></span><br><span class="line">      ..phone = (<span class="keyword">new</span> PhoneNumberBuilder()</span><br><span class="line">            ..number = <span class="string">'415-555-0100'</span></span><br><span class="line">            ..label = <span class="string">'home'</span>)</span><br><span class="line">          .build())</span><br><span class="line">    .build();</span><br></pre></td></tr></table></figure></p><p>åœ¨æ–¹æ³•ä¸Šä½¿ç”¨çº§è”éœ€è¦ååˆ†å°å¿ƒï¼Œæ— æ³•å†voidä¸Šä½¿ç”¨çº§è”æ“ä½œç¬¦<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Does not work</span></span><br><span class="line"><span class="keyword">var</span> sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">sb.write(<span class="string">'foo'</span>)..write(<span class="string">'bar'</span>);</span><br></pre></td></tr></table></figure></p><h3 id="å…¶ä»–æ“ä½œç¬¦"><a href="#å…¶ä»–æ“ä½œç¬¦" class="headerlink" title="å…¶ä»–æ“ä½œç¬¦"></a>å…¶ä»–æ“ä½œç¬¦</h3><table><thead><tr><th style="text-align:left">Operator</th><th style="text-align:left">Name</th><th style="text-align:left">Meaning</th></tr></thead><tbody><tr><td style="text-align:left"><code>()</code></td><td style="text-align:left">ä½¿ç”¨æ–¹æ³•</td><td style="text-align:left">ä»£è¡¨è°ƒç”¨ä¸€ä¸ªæ–¹æ³•</td></tr><tr><td style="text-align:left"><code>[]</code></td><td style="text-align:left">è®¿é—® List</td><td style="text-align:left">è®¿é—® list ä¸­ç‰¹å®šä½ç½®çš„å…ƒç´ </td></tr><tr><td style="text-align:left"><code>.</code></td><td style="text-align:left">è®¿é—® Member</td><td style="text-align:left">è®¿é—®å…ƒç´ ï¼Œä¾‹å¦‚ <code>foo.bar</code> ä»£è¡¨è®¿é—® <code>foo</code> çš„ <code>bar</code> æˆå‘˜</td></tr><tr><td style="text-align:left"><code>?.</code></td><td style="text-align:left">æ¡ä»¶æˆå‘˜è®¿é—®</td><td style="text-align:left">å’Œ <code>.</code> ç±»ä¼¼ï¼Œä½†æ˜¯å·¦è¾¹çš„æ“ä½œå¯¹è±¡ä¸èƒ½ä¸º nullï¼Œä¾‹å¦‚ <code>foo?.bar</code> å¦‚æœ <code>foo</code> ä¸º null åˆ™è¿”å› nullï¼Œå¦åˆ™è¿”å› <code>bar</code> æˆå‘˜</td></tr></tbody></table><h1 id="æ§åˆ¶æµç¨‹"><a href="#æ§åˆ¶æµç¨‹" class="headerlink" title="æ§åˆ¶æµç¨‹"></a>æ§åˆ¶æµç¨‹</h1><p><code>if / else</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span><code>switch</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span><code>for /while</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span><code>try / catch</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">è¯­å¥è·Ÿ</span></span><code>Java</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä¸­éƒ½ç±»ä¼¼ï¼Œ</span></span><code>try / catch</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">è¯­å¥å¯èƒ½ç¨æœ‰ä¸åŒ</span></span></p><h3 id="try-catch"><a href="#try-catch" class="headerlink" title="try catch"></a>try catch</h3><p>æ•è·å¼‚å¸¸å¯ä»¥é¿å…å¼‚å¸¸ç»§ç»­ä¼ é€’ï¼ˆä½ é‡æ–°æŠ›å‡ºrethrowå¼‚å¸¸é™¤å¤–ï¼‰ã€‚ æ•è·å¼‚å¸¸ç»™ä½ ä¸€ä¸ªå¤„ç† è¯¥å¼‚å¸¸çš„æœºä¼šï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  breedMoreLlamas();</span><br><span class="line">&#125; on OutOfLlamasException &#123;</span><br><span class="line">  buyMoreLlamas();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºå¯ä»¥æŠ›å‡ºå¤šç§ç±»å‹å¼‚å¸¸çš„ä»£ç ï¼Œä½ å¯ä»¥æŒ‡å®š å¤šä¸ªæ•è·è¯­å¥ã€‚æ¯ä¸ªè¯­å¥åˆ†åˆ«å¯¹åº”ä¸€ä¸ªå¼‚å¸¸ç±»å‹ï¼Œ å¦‚æœæ•è·è¯­å¥æ²¡æœ‰æŒ‡å®šå¼‚å¸¸ç±»å‹ï¼Œåˆ™ è¯¥å¯ä»¥æ•è·ä»»ä½•å¼‚å¸¸ç±»å‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  breedMoreLlamas();</span><br><span class="line">&#125; on OutOfLlamasException &#123;</span><br><span class="line">  <span class="comment">// A specific exception</span></span><br><span class="line">  buyMoreLlamas();</span><br><span class="line">&#125; on Exception <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="comment">// Anything else that is an exception</span></span><br><span class="line">  print(<span class="string">'Unknown exception: $e'</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="comment">// No specified type, handles all</span></span><br><span class="line">  print(<span class="string">'Something really unknown: $e'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä½¿ç”¨ </span></span><code>on</code><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>æ¥æŒ‡å®šå¼‚å¸¸ç±»å‹ï¼Œä½¿ç”¨ <code>catch</code><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>æ¥ æ•è·å¼‚å¸¸å¯¹è±¡ã€‚<br>ä½¿ç”¨ <code>rethrow</code> å…³é”®å­—å¯ä»¥ æŠŠæ•è·çš„å¼‚å¸¸ç»™ é‡æ–°æŠ›å‡ºã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">final foo = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> misbehave() &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    foo = <span class="string">"You can't change a final variable's value."</span>;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    print(<span class="string">'misbehave() partially handled $&#123;e.runtimeType&#125;.'</span>);</span><br><span class="line">    rethrow; <span class="comment">// Allow callers to see the exception.</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    misbehave();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    print(<span class="string">'main() finished handling $&#123;e.runtimeType&#125;.'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="ç±»"><a href="#ç±»" class="headerlink" title="ç±»"></a>ç±»</h1><h2 id="ç±»çš„å®šä¹‰ä¸æ„é€ æ–¹æ³•"><a href="#ç±»çš„å®šä¹‰ä¸æ„é€ æ–¹æ³•" class="headerlink" title="ç±»çš„å®šä¹‰ä¸æ„é€ æ–¹æ³•"></a>ç±»çš„å®šä¹‰ä¸æ„é€ æ–¹æ³•</h2><p><code>Dart</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä¸­çš„ç±»æ²¡æœ‰è®¿é—®æ§åˆ¶ï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦ç”¨</span></span><code>private</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">, </span></span><code>protected</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">, </span></span><code>public</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ç­‰ä¿®é¥°æˆå‘˜å˜é‡æˆ–æˆå‘˜å‡½æ•°</span></span><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="built_in">String</span> name;</span><br><span class="line">  int age;</span><br><span class="line">  <span class="built_in">String</span> gender;</span><br><span class="line">  Person(<span class="keyword">this</span>.name, <span class="keyword">this</span>.age, <span class="keyword">this</span>.gender);</span><br><span class="line">  sayHello() &#123;</span><br><span class="line">    print(<span class="string">"hello, this is $name, I am $age years old, I am a $gender"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä¸Šé¢çš„</span></span><code>Person</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ç±»ä¸­æœ‰3ä¸ªæˆå‘˜å˜é‡ï¼Œä¸€ä¸ªæ„é€ æ–¹æ³•å’Œä¸€ä¸ªæˆå‘˜æ–¹æ³•ï¼Œçœ‹èµ·æ¥æ¯”è¾ƒå¥‡æ€ªçš„æ˜¯</span></span><code>Person</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">çš„æ„é€ æ–¹æ³•ï¼Œé‡Œé¢ä¼ å…¥çš„3ä¸ªå‚æ•°éƒ½æ˜¯</span></span><code>this.xxx</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ï¼Œè€Œä¸”æ²¡æœ‰å¤§æ‹¬å·</span></span><code>{}</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">åŒ…è£¹çš„æ–¹æ³•ä½“ï¼Œè¿™ç§è¯­æ³•æ˜¯Dartæ¯”è¾ƒç‹¬ç‰¹è€Œç®€æ´çš„æ„é€ æ–¹æ³•å£°æ˜æ–¹å¼ï¼Œå®ƒç­‰åŒäºä¸‹é¢çš„ä»£ç ï¼š</span></span><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Person(<span class="built_in">String</span> name, int age, <span class="built_in">String</span> gender) &#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">    <span class="keyword">this</span>.gender = gender;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ç”±äº</span></span><code>Dart</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä¸­çš„ç±»æ²¡æœ‰è®¿é—®æ§åˆ¶æƒé™ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç›´æ¥ç”¨</span></span><code>obj.var</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">çš„æ–¹å¼è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„æˆå‘˜å˜é‡ã€‚</span></span></p><h3 id="å‘½åæ„é€ å‡½æ•°"><a href="#å‘½åæ„é€ å‡½æ•°" class="headerlink" title="å‘½åæ„é€ å‡½æ•°"></a>å‘½åæ„é€ å‡½æ•°</h3><p>ä½¿ç”¨å‘½åæ„é€ å‡½æ•°å¯ä»¥ä¸ºä¸€ä¸ªç±»å®ç°å¤šä¸ªæ„é€ å‡½æ•°ï¼Œ æˆ–è€…ä½¿ç”¨å‘½åæ„é€ å‡½æ•°æ¥æ›´æ¸…æ™°çš„è¡¨æ˜ä½ çš„æ„å›¾ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">  num x, y;</span><br><span class="line">  Point(<span class="keyword">this</span>.x, <span class="keyword">this</span>.y);</span><br><span class="line">  <span class="comment">// ç±»çš„å‘½åæ„é€ æ–¹æ³•</span></span><br><span class="line">  Point.origin() &#123;</span><br><span class="line">    x = <span class="number">0</span>;</span><br><span class="line">    y = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main() &#123;</span><br><span class="line">  <span class="comment">// è°ƒç”¨Pointç±»çš„å‘½åæ„é€ æ–¹æ³•origin()</span></span><br><span class="line">  <span class="keyword">var</span> p = <span class="keyword">new</span> Point.origin();</span><br><span class="line">  <span class="keyword">var</span> p2 = <span class="keyword">new</span> Point(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="è°ƒç”¨è¶…ç±»æ„é€ å‡½æ•°"><a href="#è°ƒç”¨è¶…ç±»æ„é€ å‡½æ•°" class="headerlink" title="è°ƒç”¨è¶…ç±»æ„é€ å‡½æ•°"></a>è°ƒç”¨è¶…ç±»æ„é€ å‡½æ•°</h3><p>å­ç±»çš„æ„é€ å‡½æ•°ä¼šè‡ªåŠ¨è°ƒç”¨è¶…ç±»çš„ æ— åæ— å‚æ•°çš„é»˜è®¤æ„é€ å‡½æ•°ã€‚ è¶…ç±»çš„æ„é€ å‡½æ•°åœ¨å­ç±»æ„é€ å‡½æ•°ä½“å¼€å§‹æ‰§è¡Œçš„ä½ç½®è°ƒç”¨ã€‚ å¦‚æœæä¾›äº†ä¸€ä¸ª <a href="http://dart.goodev.org/guides/language/language-tour#initializer-list" target="_blank" rel="noopener">initializer list</a>ï¼ˆåˆå§‹åŒ–å‚æ•°åˆ—è¡¨ï¼‰ ï¼Œåˆ™åˆå§‹åŒ–å‚æ•°åˆ—è¡¨åœ¨è¶…ç±»æ„é€ å‡½æ•°æ‰§è¡Œä¹‹å‰æ‰§è¡Œã€‚ ä¸‹é¢æ˜¯æ„é€ å‡½æ•°æ‰§è¡Œé¡ºåºï¼š</p><ol><li>initializer listï¼ˆåˆå§‹åŒ–å‚æ•°åˆ—è¡¨ï¼‰</li><li>superclassâ€™s no-arg constructorï¼ˆè¶…ç±»çš„æ— åæ„é€ å‡½æ•°ï¼‰</li><li>main classâ€™s no-arg constructorï¼ˆä¸»ç±»çš„æ— åæ„é€ å‡½æ•°ï¼‰</li></ol><p>å¦‚æœè¶…ç±»æ²¡æœ‰æ— åæ— å‚æ•°æ„é€ å‡½æ•°ï¼Œ åˆ™ä½ éœ€è¦æ‰‹å·¥çš„è°ƒç”¨è¶…ç±»çš„å…¶ä»–æ„é€ å‡½æ•°ã€‚ åœ¨æ„é€ å‡½æ•°å‚æ•°åä½¿ç”¨å†’å· (<code>:</code>) å¯ä»¥è°ƒç”¨ è¶…ç±»æ„é€ å‡½æ•°ã€‚<br><code>Dart</code>ä¸­ä½¿ç”¨<code>extends</code>å…³é”®å­—åšç±»çš„ç»§æ‰¿ï¼Œå¦‚æœä¸€ä¸ªç±»åªæœ‰å‘½åçš„æ„é€ æ–¹æ³•ï¼Œåœ¨ç»§æ‰¿æ—¶éœ€è¦æ³¨æ„ï¼Œå¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Human</span> </span>&#123;</span><br><span class="line">  <span class="built_in">String</span> name;</span><br><span class="line">  Human.fromJson(<span class="built_in">Map</span> data) &#123;</span><br><span class="line">    print(<span class="string">"Human's fromJson constructor"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Man</span> <span class="keyword">extends</span> <span class="title">Human</span> </span>&#123;</span><br><span class="line">  Man.fromJson(<span class="built_in">Map</span> data) : <span class="keyword">super</span>.fromJson(data) &#123;</span><br><span class="line">    print(<span class="string">"Man's fromJson constructor"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="é‡å®šå‘æ„é€ å‡½æ•°"><a href="#é‡å®šå‘æ„é€ å‡½æ•°" class="headerlink" title="é‡å®šå‘æ„é€ å‡½æ•°"></a>é‡å®šå‘æ„é€ å‡½æ•°</h3><p>æœ‰æ—¶å€™ä¸€ä¸ªæ„é€ å‡½æ•°ä¼šè°ƒåŠ¨ç±»ä¸­çš„å…¶ä»–æ„é€ å‡½æ•°ã€‚ ä¸€ä¸ªé‡å®šå‘æ„é€ å‡½æ•°æ˜¯æ²¡æœ‰ä»£ç çš„ï¼Œåœ¨æ„é€ å‡½æ•°å£°æ˜åï¼Œä½¿ç”¨ å†’å·è°ƒç”¨å…¶ä»–æ„é€ å‡½æ•°ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">  num x;</span><br><span class="line">  num y;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// The main constructor for this class.</span></span><br><span class="line">  Point(<span class="keyword">this</span>.x, <span class="keyword">this</span>.y);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Delegates to the main constructor.</span></span><br><span class="line">  Point.alongXAxis(num x) : <span class="keyword">this</span>(x, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="æŠ½è±¡ç±»å’ŒæŠ½è±¡æ–¹æ³•"><a href="#æŠ½è±¡ç±»å’ŒæŠ½è±¡æ–¹æ³•" class="headerlink" title="æŠ½è±¡ç±»å’ŒæŠ½è±¡æ–¹æ³•"></a>æŠ½è±¡ç±»å’ŒæŠ½è±¡æ–¹æ³•</h2><p><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä½¿ç”¨abstractä¿®é¥°ä¸€ä¸ªç±»ï¼Œåˆ™è¿™ä¸ªç±»æ˜¯æŠ½è±¡ç±»ï¼Œ</span></span><br><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)"><strong>æŠ½è±¡ç±»ä¸­å¯ä»¥æœ‰æŠ½è±¡æ–¹æ³•å’ŒéæŠ½è±¡æ–¹æ³•</strong></span></span><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ï¼ŒæŠ½è±¡æ–¹æ³•æ²¡æœ‰æ–¹æ³•ä½“ï¼Œéœ€è¦å­ç±»å»å®ç°ï¼Œå¦‚ä¸‹ä»£ç ï¼š</span></span><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">abstract <span class="class"><span class="keyword">class</span> <span class="title">Doer</span> </span>&#123;</span><br><span class="line">  <span class="comment">// æŠ½è±¡æ–¹æ³•ï¼Œæ²¡æœ‰æ–¹æ³•ä½“ï¼Œéœ€è¦å­ç±»å»å®ç°</span></span><br><span class="line">  <span class="keyword">void</span> doSomething();</span><br><span class="line">  <span class="comment">// æ™®é€šçš„æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">void</span> greet() &#123;</span><br><span class="line">    print(<span class="string">"hello world!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EffectiveDoer</span> <span class="keyword">extends</span> <span class="title">Doer</span> </span>&#123;</span><br><span class="line">  <span class="comment">// å®ç°äº†çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">void</span> doSomething() &#123;</span><br><span class="line">    print(<span class="string">"I'm doing something..."</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="æšä¸¾ç±»"><a href="#æšä¸¾ç±»" class="headerlink" title="æšä¸¾ç±»"></a>æšä¸¾ç±»</h2><p>æšä¸¾ç±»å‹é€šå¸¸ç§°ä¹‹ä¸º <em>enumerations</em> æˆ–è€… <em>enums</em>ï¼Œ æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»ï¼Œç”¨æ¥è¡¨ç°ä¸€ä¸ªå›ºå®š æ•°ç›®çš„å¸¸é‡ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">enum Color &#123;</span><br><span class="line">  red,</span><br><span class="line">  green,</span><br><span class="line">  blue</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><ul><li>æšä¸¾ç±»å‹ä¸­çš„æ¯ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ª <code>index</code> getter å‡½æ•°ï¼Œ è¯¥å‡½æ•°è¿”å›è¯¥å€¼åœ¨æšä¸¾ç±»å‹å®šä¹‰ä¸­çš„ä½ç½®ï¼ˆä» 0 å¼€å§‹ï¼‰ã€‚ ä¾‹å¦‚ï¼Œç¬¬ä¸€ä¸ªæšä¸¾å€¼çš„ä½ç½®ä¸º 0ï¼Œ ç¬¬äºŒä¸ªä¸º 1.</li><li>æšä¸¾çš„ <code>values</code> å¸¸é‡å¯ä»¥è¿”å› æ‰€æœ‰çš„æšä¸¾å€¼ã€‚</li></ul><p>æšä¸¾ç±»å‹å…·æœ‰å¦‚ä¸‹çš„é™åˆ¶ï¼š</p><ul><li>æ— æ³•ç»§æ‰¿æšä¸¾ç±»å‹ã€æ— æ³•ä½¿ç”¨ mix inã€æ— æ³•å®ç°ä¸€ä¸ªæšä¸¾ç±»å‹</li><li>æ— æ³•æ˜¾ç¤ºçš„åˆå§‹åŒ–ä¸€ä¸ªæšä¸¾ç±»å‹</li></ul><h2 id="Mixins-ä¸ºç±»æ·»åŠ æ–°çš„åŠŸèƒ½"><a href="#Mixins-ä¸ºç±»æ·»åŠ æ–°çš„åŠŸèƒ½" class="headerlink" title="Mixins ä¸ºç±»æ·»åŠ æ–°çš„åŠŸèƒ½"></a>Mixins ä¸ºç±»æ·»åŠ æ–°çš„åŠŸèƒ½</h2><p>Mixins æ˜¯ä¸€ç§åœ¨å¤šç±»ç»§æ‰¿ä¸­é‡ç”¨ ä¸€ä¸ªç±»ä»£ç çš„æ–¹æ³•ã€‚ä½¿ç”¨ with å…³é”®å­—åé¢ä¸ºä¸€ä¸ªæˆ–è€…å¤šä¸ª mixin åå­—æ¥ä½¿ç”¨ mixinã€‚ ä¸‹é¢æ˜¯ç¤ºä¾‹æ˜¾ç¤ºäº†å¦‚ä½•ä½¿ç”¨ mixinï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  a() &#123;</span><br><span class="line">    print(<span class="string">"A's a()"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  b() &#123;</span><br><span class="line">    print(<span class="string">"B's b()"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨withå…³é”®å­—ï¼Œè¡¨ç¤ºç±»Cæ˜¯ç”±ç±»Aå’Œç±»Bæ··åˆè€Œæ„æˆ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>= A <span class="keyword">with</span> B;</span><br><span class="line"></span><br><span class="line">main() &#123;</span><br><span class="line">  C c = <span class="keyword">new</span> C();</span><br><span class="line">  c.a(); <span class="comment">// A's a()</span></span><br><span class="line">  c.b(); <span class="comment">// B's b()</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="é™æ€æˆå‘˜å˜é‡-å’Œ-é™æ€æˆå‘˜æ–¹æ³•"><a href="#é™æ€æˆå‘˜å˜é‡-å’Œ-é™æ€æˆå‘˜æ–¹æ³•" class="headerlink" title="é™æ€æˆå‘˜å˜é‡ å’Œ é™æ€æˆå‘˜æ–¹æ³•"></a>é™æ€æˆå‘˜å˜é‡ å’Œ é™æ€æˆå‘˜æ–¹æ³•</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç±»çš„é™æ€æˆå‘˜å˜é‡å’Œé™æ€æˆå‘˜æ–¹æ³•</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cons</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">const</span> name = <span class="string">"zhangsan"</span>;</span><br><span class="line">  <span class="keyword">static</span> sayHello() &#123;</span><br><span class="line">    print(<span class="string">"hello, this is $&#123;Cons.name&#125;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main() &#123;</span><br><span class="line">  Cons.sayHello(); <span class="comment">// hello, this is zhangsan</span></span><br><span class="line">  print(Cons.name); <span class="comment">// zhangsan</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ³›å‹"><a href="#æ³›å‹" class="headerlink" title="æ³›å‹"></a>æ³›å‹</h1><p><a href="http://dart.goodev.org/guides/language/language-tour#generics%E6%B3%9B%E5%9E%8B" target="_blank" rel="noopener">http://dart.goodev.org/guides/language/language-tour#generics%E6%B3%9B%E5%9E%8B</a></p><p>ä½¿ç”¨æ³›å‹å¯ä»¥å‡å°‘å†—ä½™çš„ä»£ç ï¼Œ<span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>æ³›å‹å¯ä»¥åœ¨å¤šç§ç±»å‹ä¹‹é—´å®šä¹‰åŒä¸€ä¸ªå®ç°ï¼Œåœ¨Dartä¸­Dart çš„æ³›å‹ç±»å‹æ˜¯å›ºåŒ–çš„ï¼Œåœ¨è¿è¡Œæ—¶æœ‰ä¹Ÿ å¯ä»¥åˆ¤æ–­å…·ä½“çš„ç±»å‹ã€‚ä¾‹å¦‚åœ¨è¿è¡Œæ—¶ï¼ˆç”šè‡³æ˜¯æˆäº§æ¨¡å¼ï¼‰ ä¹Ÿå¯ä»¥æ£€æµ‹é›†åˆé‡Œé¢çš„å¯¹è±¡ç±»å‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> names = <span class="keyword">new</span> List&lt;<span class="built_in">String</span>&gt;();</span><br><span class="line">names.addAll([<span class="string">'Seth'</span>, <span class="string">'Kathy'</span>, <span class="string">'Lars'</span>]);</span><br><span class="line">print(names is List&lt;<span class="built_in">String</span>&gt;); <span class="comment">// true</span></span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªè·ŸJavaä¸­æ˜¯ä¸åŒçš„ Java ä¸­çš„æ³›å‹ä¿¡æ¯æ˜¯ç¼–è¯‘æ—¶çš„ï¼Œæ³›å‹ä¿¡æ¯åœ¨è¿è¡Œæ—¶æ˜¯ä¸çº¯åœ¨çš„ã€‚ åœ¨ Java ä¸­ä½ å¯ä»¥æµ‹è¯•ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸º Listï¼Œ ä½†æ˜¯ä½ æ— æ³•æµ‹è¯•ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸º List<string>ã€‚</string></p><h2 id="é™åˆ¶å‹æ³›å‹"><a href="#é™åˆ¶å‹æ³›å‹" class="headerlink" title="é™åˆ¶å‹æ³›å‹"></a>é™åˆ¶å‹æ³›å‹</h2><p><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä½¿ç”¨ </span></span><code>extends</code><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>å¯ä»¥å®ç°è¿™ä¸ªåŠŸèƒ½<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// T must be SomeBaseClass or one of its descendants.</span><br><span class="line">class Foo&lt;T extends SomeBaseClass&gt; &#123;...&#125;</span><br><span class="line"></span><br><span class="line">class Extender extends SomeBaseClass &#123;...&#125;</span><br><span class="line"></span><br><span class="line">void main() &#123;</span><br><span class="line">  // It's OK to use SomeBaseClass or any of its subclasses inside &lt;&gt;.</span><br><span class="line">  var someBaseClassFoo = new Foo&lt;SomeBaseClass&gt;();</span><br><span class="line">  var extenderFoo = new Foo&lt;Extender&gt;();</span><br><span class="line"></span><br><span class="line">  // It's also OK to use no &lt;&gt; at all.</span><br><span class="line">  var foo = new Foo();</span><br><span class="line"></span><br><span class="line">  // Specifying any non-SomeBaseClass type results in a warning and, in</span><br><span class="line">  // checked mode, a runtime error.</span><br><span class="line">  // var objectFoo = new Foo&lt;Object&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="æ³›å‹å‡½æ•°"><a href="#æ³›å‹å‡½æ•°" class="headerlink" title="æ³›å‹å‡½æ•°"></a>æ³›å‹å‡½æ•°</h2><p>ä¸€å¼€å§‹ï¼Œæ³›å‹åªèƒ½åœ¨ Dart ç±»ä¸­ä½¿ç”¨ã€‚ æ–°çš„è¯­æ³•ä¹Ÿæ”¯æŒåœ¨å‡½æ•°å’Œæ–¹æ³•ä¸Šä½¿ç”¨æ³›å‹äº†ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">T first&lt;T&gt;(List&lt;T&gt; ts) &#123;</span><br><span class="line">  <span class="comment">// ...Do some initial work or error checking, then...</span></span><br><span class="line">  T tmp ?= ts[<span class="number">0</span>];</span><br><span class="line">  <span class="comment">// ...Do some additional checking or processing...</span></span><br><span class="line">  <span class="keyword">return</span> tmp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œçš„ <code>first</code> (<code>&lt;T&gt;</code>) æ³›å‹å¯ä»¥åœ¨å¦‚ä¸‹åœ°æ–¹ä½¿ç”¨ å‚æ•° <code>T</code> ï¼š</p><ul><li>å‡½æ•°çš„è¿”å›å€¼ç±»å‹ (<code>T</code>).</li><li>å‚æ•°çš„ç±»å‹ (<code>List&lt;T&gt;</code>).</li><li>å±€éƒ¨å˜é‡çš„ç±»å‹ (<code>T tmp</code>).</li></ul><h1 id="åº“çš„å¯è§æ€§"><a href="#åº“çš„å¯è§æ€§" class="headerlink" title="åº“çš„å¯è§æ€§"></a>åº“çš„å¯è§æ€§</h1><ul><li><p>æ™®é€šå¼•ç”¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo.dart</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./util.dart'</span>;</span><br><span class="line"></span><br><span class="line">main() &#123;</span><br><span class="line">  print(add(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>aså…³é”®å­— è®¾ç½®å‰ç¼€</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:lib1/lib1.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:lib2/lib2.dart'</span> <span class="keyword">as</span> lib2;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Uses Element from lib1.</span></span><br><span class="line">Element element1 = Element();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Uses Element from lib2.</span></span><br><span class="line">lib2.Element element2 = lib2.Element();</span><br></pre></td></tr></table></figure></li><li><p>show hide å…³é”®å­—å¯¼å…¥åŒ…çš„éƒ¨åˆ†åŠŸèƒ½</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åªå¯¼å…¥foo</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:lib1/lib1.dart'</span> show foo;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥é™¤äº†fooçš„æ‰€æœ‰å…¶ä»–éƒ¨åˆ†</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:lib2/lib2.dart'</span> hide foo;</span><br></pre></td></tr></table></figure></li><li><p><span data-type="color" style="color:rgb(255, 80, 44)"><span data-type="background" style="background-color:rgb(255, 245, 245)">deferred as </span></span>æ‡’åŠ è½½</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:greetings/hello.dart'</span> deferred <span class="keyword">as</span> hello;</span><br></pre></td></tr></table></figure></li></ul><h1 id="å¼‚æ­¥"><a href="#å¼‚æ­¥" class="headerlink" title="å¼‚æ­¥"></a>å¼‚æ­¥</h1><p><code>Dart</code>æä¾›äº†ç±»ä¼¼ES7ä¸­çš„<code>async</code> <code>await</code>ç­‰å¼‚æ­¥æ“ä½œï¼Œè¿™ç§å¼‚æ­¥æ“ä½œåœ¨Flutterå¼€å‘ä¸­ä¼šç»å¸¸é‡åˆ°ï¼Œæ¯”å¦‚ç½‘ç»œæˆ–å…¶ä»–IOæ“ä½œï¼Œæ–‡ä»¶é€‰æ‹©ç­‰éƒ½éœ€è¦ç”¨åˆ°å¼‚æ­¥çš„çŸ¥è¯†ã€‚<code>async</code>å’Œ<code>await</code>å¾€å¾€æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œå¦‚æœä¸€ä¸ªæ–¹æ³•ä¸­æœ‰è€—æ—¶çš„æ“ä½œï¼Œä½ éœ€è¦å°†è¿™ä¸ªæ–¹æ³•è®¾ç½®æˆ<code>async</code>ï¼Œå¹¶ç»™å…¶ä¸­çš„è€—æ—¶æ“ä½œåŠ ä¸Š<code>await</code>å…³é”®å­—ï¼Œå¦‚æœè¿™ä¸ªæ–¹æ³•æœ‰è¿”å›å€¼ï¼Œä½ éœ€è¦å°†è¿”å›å€¼å¡åˆ°<code>Future</code>ä¸­å¹¶è¿”å›ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Future checkVersion() <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> version = <span class="keyword">await</span> lookUpVersion();</span><br><span class="line">  <span class="comment">// Do something with version</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ›´å¤šè¯·è§ <a href="https://segmentfault.com/a/1190000014396421" target="_blank" rel="noopener">https://segmentfault.com/a/1190000014396421</a></p><h1 id="å¯è°ƒç”¨ç±»"><a href="#å¯è°ƒç”¨ç±»" class="headerlink" title="å¯è°ƒç”¨ç±»"></a>å¯è°ƒç”¨ç±»</h1><p>å¦‚æœ Dart ç±»å®ç°äº† <code>call()</code> å‡½æ•°åˆ™ å¯ä»¥å½“åšæ–¹æ³•æ¥è°ƒç”¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WannabeFunction</span> </span>&#123;</span><br><span class="line">  call(<span class="built_in">String</span> a, <span class="built_in">String</span> b, <span class="built_in">String</span> c) =&gt; <span class="string">'$a $b $c!'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main() &#123;</span><br><span class="line">  <span class="keyword">var</span> wf = <span class="keyword">new</span> WannabeFunction();</span><br><span class="line">  <span class="keyword">var</span> out = wf(<span class="string">"Hi"</span>,<span class="string">"there,"</span>,<span class="string">"gang"</span>);</span><br><span class="line">  print(<span class="string">'$out'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å…ƒæ•°æ®"><a href="#å…ƒæ•°æ®" class="headerlink" title="å…ƒæ•°æ®"></a>å…ƒæ•°æ®</h1><p>ä½¿ç”¨å…ƒæ•°æ®ç»™ä½ çš„ä»£ç æ·»åŠ å…¶ä»–é¢å¤–ä¿¡æ¯ã€‚ å…ƒæ•°æ®æ³¨è§£æ˜¯ä»¥ <code>@</code> å­—ç¬¦å¼€å¤´ï¼Œåé¢æ˜¯ä¸€ä¸ªç¼–è¯‘æ—¶ å¸¸é‡(ä¾‹å¦‚ <code>deprecated</code>)æˆ–è€… è°ƒç”¨ä¸€ä¸ªå¸¸é‡æ„é€ å‡½æ•°ã€‚<br><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)">æœ‰ä¸‰ä¸ªæ³¨è§£æ‰€æœ‰çš„ Dart ä»£ç éƒ½å¯ä»¥ä½¿ç”¨ï¼š </span></span><code>@deprecated</code><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ã€ </span></span><code>@override</code><span data-type="color" style="color:rgb(17, 17, 17)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ã€ å’Œ </span></span><code>@proxy</code></p><p>ä½ è¿˜å¯ä»¥å®šä¹‰è‡ªå·±çš„å…ƒæ•°æ®æ³¨è§£ã€‚ ä¸‹é¢çš„ç¤ºä¾‹å®šä¹‰äº†ä¸€ä¸ªå¸¦æœ‰ä¸¤ä¸ªå‚æ•°çš„ @todo æ³¨è§£ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">library todo;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">todo</span> </span>&#123;</span><br><span class="line">  final <span class="built_in">String</span> who;</span><br><span class="line">  final <span class="built_in">String</span> what;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> todo(<span class="keyword">this</span>.who, <span class="keyword">this</span>.what);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'todo.dart'</span>;</span><br><span class="line"></span><br><span class="line">@todo(<span class="string">'seth'</span>, <span class="string">'make this do something'</span>)</span><br><span class="line"><span class="keyword">void</span> doSomething() &#123;</span><br><span class="line">  print(<span class="string">'do something'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å…ƒæ•°æ®å¯ä»¥åœ¨ libraryã€ classã€ typedefã€ type parameterã€ constructorã€ factoryã€ functionã€ fieldã€ parameterã€æˆ–è€… variable å£°æ˜ä¹‹å‰ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨ import æˆ–è€… export æŒ‡ä»¤ä¹‹å‰ä½¿ç”¨ã€‚ ä½¿ç”¨åå°„å¯ä»¥åœ¨è¿è¡Œæ—¶è·å–å…ƒæ•°æ® ä¿¡æ¯ã€‚</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ul><li>ä¸­æ–‡å®˜æ–¹æ–‡æ¡£ <a href="http://dart.goodev.org/guides/language" target="_blank" rel="noopener">http://dart.goodev.org/guides/language</a></li><li><a href="https://juejin.im/post/5b5005866fb9a04fea589561#heading-14" target="_blank" rel="noopener">https://juejin.im/post/5b5005866fb9a04fea589561#heading-14</a></li><li><a href="https://juejin.im/post/5bcc8527f265da0aff17729a#heading-2" target="_blank" rel="noopener">https://juejin.im/post/5bcc8527f265da0aff17729a#heading-2</a></li><li><a href="https://segmentfault.com/a/1190000014396421" target="_blank" rel="noopener">https://segmentfault.com/a/1190000014396421</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h1 id=&quot;Dartè¯­æ³•åŸºç¡€&quot;&gt;&lt;a href=&quot;#Dartè¯­æ³•åŸºç¡€&quot; class=&quot;headerlink&quot; title=&quot;Dartè¯­æ³•åŸºç¡€&quot;&gt;&lt;/a&gt;Dartè¯­æ³•åŸºç¡€&lt;/h1
      
    
    </summary>
    
      <category term="Dart" scheme="https://xsfelvis.github.io/categories/Dart/"/>
    
    
      <category term="Dart" scheme="https://xsfelvis.github.io/tags/Dart/"/>
    
      <category term="Dartè¯­æ³•åŸºç¡€" scheme="https://xsfelvis.github.io/tags/Dart%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>Flutterä¸­æ¶ˆæ¯ä¼ é€’</title>
    <link href="https://xsfelvis.github.io/2019/01/12/%20Flutter%E4%B8%AD%E6%B6%88%E6%81%AF%E4%BC%A0%E9%80%92/"/>
    <id>https://xsfelvis.github.io/2019/01/12/ Flutterä¸­æ¶ˆæ¯ä¼ é€’/</id>
    <published>2019-01-11T16:00:00.000Z</published>
    <updated>2019-01-12T12:29:44.649Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h1 id="Flutterä¸­æ¶ˆæ¯ä¼ é€’"><a href="#Flutterä¸­æ¶ˆæ¯ä¼ é€’" class="headerlink" title="Flutterä¸­æ¶ˆæ¯ä¼ é€’"></a>Flutterä¸­æ¶ˆæ¯ä¼ é€’</h1><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨nativeå¼€å‘ä¸­æ¶ˆæ¯ä¼ é€’æœ‰å¤šç§æ‰‹æ®µï¼Œç³»ç»Ÿçš„å¹¿æ’­ï¼Œç¬¬ä¸‰æ–¹çš„eventbusç­‰ï¼Œåœ¨flutterä¸­ä¼šæœ‰å“ªäº›æ‰‹æ®µå‘¢ï¼Ÿæœ¬ç¯‡å°†ä¼šä»‹ç»</p><h1 id="Flutterä¸­çš„æ¶ˆæ¯ä¼ é€’"><a href="#Flutterä¸­çš„æ¶ˆæ¯ä¼ é€’" class="headerlink" title="Flutterä¸­çš„æ¶ˆæ¯ä¼ é€’"></a>Flutterä¸­çš„æ¶ˆæ¯ä¼ é€’</h1><h2 id="InheritedWidget"><a href="#InheritedWidget" class="headerlink" title="InheritedWidget"></a>InheritedWidget</h2><p><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">InheritedWidgetæ˜¯Flutterä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªåŠŸèƒ½å‹Widgetï¼Œå®ƒå¯ä»¥é«˜æ•ˆçš„å°†æ•°æ®åœ¨</span></span><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)"><strong>Widgetæ ‘ä¸­å‘ä¸‹ä¼ é€’ã€å…±äº«</strong></span></span><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ï¼Œè¿™åœ¨ä¸€äº›éœ€è¦åœ¨Widgetæ ‘ä¸­å…±äº«æ•°æ®çš„åœºæ™¯ä¸­éå¸¸æ–¹ä¾¿ï¼Œ æˆ‘ä»¬ç»å¸¸é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œé€šè¿‡</span></span><code>BuildContext</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">,å¯ä»¥æ‹¿åˆ°</span></span><code>Theme</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">å’Œ</span></span><code>MediaQuery</code></p><blockquote><p>InheritedWidgetå’ŒReactä¸­çš„contextåŠŸèƒ½ç±»ä¼¼ï¼Œå’Œé€çº§ä¼ é€’æ•°æ®ç›¸æ¯”ï¼Œå®ƒä»¬èƒ½å®ç°ç»„ä»¶è·¨çº§ä¼ é€’æ•°æ®ã€‚InheritedWidgetçš„åœ¨Widgetæ ‘ä¸­æ•°æ®ä¼ é€’æ–¹å‘æ˜¯ä»ä¸Šåˆ°ä¸‹çš„ï¼Œè¿™å’ŒNotificationçš„ä¼ é€’æ–¹å‘æ­£å¥½ç›¸åã€‚</p></blockquote><p><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">åœ¨ä»‹ç»StatefulWidgetæ—¶ï¼Œæˆ‘ä»¬æåˆ°Stateå¯¹è±¡æœ‰ä¸€ä¸ªå›è°ƒ</span></span><code>didChangeDependencies</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ï¼Œå®ƒä¼šåœ¨â€œä¾èµ–â€å‘ç”Ÿå˜åŒ–æ—¶è¢«Flutter Frameworkè°ƒç”¨ã€‚è€Œè¿™ä¸ªâ€œä¾èµ–â€æŒ‡çš„å°±æ˜¯æ˜¯å¦ä½¿ç”¨äº†çˆ¶widgetä¸­InheritedWidgetçš„æ•°æ®ï¼Œå¦‚æœä½¿ç”¨äº†ï¼Œåˆ™ä»£è¡¨æœ‰ä¾èµ–ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨åˆ™ä»£è¡¨æ²¡æœ‰ä¾èµ–ã€‚è¿™ç§æœºåˆ¶å¯ä»¥ä½¿å­ç»„ä»¶åœ¨æ‰€ä¾èµ–çš„ä¸»é¢˜ã€localeç­‰å‘ç”Ÿå˜åŒ–æ—¶æœ‰æœºä¼šæ¥åšä¸€äº›äº‹æƒ… </span></span>æ¯”å¦‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¾—åˆ°çŠ¶æ€æ çš„é«˜åº¦</span></span><br><span class="line">var statusBarHeight = MediaQuery.of(context).padding.top;</span><br><span class="line"><span class="comment">//å¤åˆ¶åˆå¹¶å‡ºæ–°çš„ä¸»é¢˜</span></span><br><span class="line">var copyTheme =Theme.of(context).copyWith(primaryColor: Colors.blue);</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨InheritedWidget"><a href="#ä½¿ç”¨InheritedWidget" class="headerlink" title="ä½¿ç”¨InheritedWidget"></a>ä½¿ç”¨<span data-type="color" style="color:rgb(74, 74, 74)"><span data-type="background" style="background-color:rgb(255, 255, 255)">InheritedWidget</span></span></h3><p>ä¸»è¦æ¶‰åŠ2éƒ¨åˆ†å·¥ä½œé‡</p><ul><li>åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ª InheritedWidget çš„ç±»ï¼Œä½¿ç”¨æ—¶å°†å…¶æ’å…¥ Widget æ ‘</li><li>é€šè¿‡ BuildContext å¯¹è±¡æä¾›çš„ inheritFromWidgetOfExactType æ–¹æ³•æŸ¥æ‰¾ Widget æ ‘ä¸­æœ€è¿‘çš„ä¸€ä¸ªç‰¹å®šç±»å‹çš„ InheritedWidget ç±»çš„å®ä¾‹</li></ul><p>å…±äº«æ•°æ®ç±»<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">InheritedContext</span> <span class="keyword">extends</span> <span class="title">InheritedWidget</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//æ•°æ®</span></span><br><span class="line">  <span class="keyword">final</span> InheritedTestModel inheritedTestModel;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//ç‚¹å‡»+å·çš„æ–¹æ³•</span></span><br><span class="line">  <span class="function"><span class="keyword">final</span> <span class="title">Function</span><span class="params">()</span> increment</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//ç‚¹å‡»-å·çš„æ–¹æ³•</span></span><br><span class="line">  <span class="function"><span class="keyword">final</span> <span class="title">Function</span><span class="params">()</span> reduce</span>;</span><br><span class="line"></span><br><span class="line">  InheritedContext(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.inheritedTestModel,</span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.increment,</span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.reduce,</span><br><span class="line">    <span class="meta">@required</span> Widget child,</span><br><span class="line">  &#125;) : <span class="keyword">super</span>(key: key, child: child);</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">static</span> InheritedContext <span class="title">of</span><span class="params">(BuildContext context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> context.inheritFromWidgetOfExactType(InheritedContext);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//æ˜¯å¦é‡å»ºwidgetå°±å–å†³äºæ•°æ®æ˜¯å¦ç›¸åŒ</span></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="function">bool <span class="title">updateShouldNotify</span><span class="params">(InheritedContext oldWidget)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> inheritedTestModel != oldWidget.inheritedTestModel;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨widgetä¸­ä½¿ç”¨å…±äº«æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomerWidgetB</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="function">Widget <span class="title">build</span><span class="params">(BuildContext context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> inheritedContext = InheritedContext.of(context);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> inheritedTestModel = inheritedContext.inheritedTestModel;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Padding(</span><br><span class="line">      padding: <span class="keyword">const</span> EdgeInsets.only(left: <span class="number">10.0</span>, top: <span class="number">10.0</span>, right: <span class="number">10.0</span>),</span><br><span class="line">      child: <span class="keyword">new</span> Text(</span><br><span class="line">        <span class="string">'å½“å‰count:$&#123;inheritedTestModel.count&#125;'</span>,</span><br><span class="line">        style: <span class="keyword">new</span> TextStyle(fontSize: <span class="number">20.0</span>),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ ‘ä¸­ä»ä¸Šå‘ä¸‹ä¼ é€’</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line"><span class="function">Widget <span class="title">build</span><span class="params">(BuildContext context)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> InheritedContext(</span><br><span class="line">      inheritedTestModel: inheritedTestModel,</span><br><span class="line">      increment: _incrementCount,</span><br><span class="line">      reduce: _reduceCount,</span><br><span class="line">      child: <span class="keyword">new</span> Scaffold(</span><br><span class="line">        appBar: <span class="keyword">new</span> AppBar(</span><br><span class="line">          title: <span class="keyword">new</span> Text(<span class="string">'InheritedWidgetTest'</span>),</span><br><span class="line">        ),</span><br><span class="line">        body: <span class="keyword">new</span> Column(</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line">            <span class="keyword">new</span> Padding(</span><br><span class="line">              padding: <span class="keyword">const</span> EdgeInsets.only(left: <span class="number">10.0</span>, top: <span class="number">10.0</span>, right: <span class="number">10.0</span>),</span><br><span class="line">              child: <span class="keyword">new</span> Text(<span class="string">'æˆ‘ä»¬å¸¸ä½¿ç”¨çš„\nTheme.of(context).textTheme\nMediaQuery.of(context).sizeç­‰\nå°±æ˜¯é€šè¿‡InheritedWidgetå®ç°çš„'</span>,</span><br><span class="line">                style: <span class="keyword">new</span> TextStyle(fontSize: <span class="number">20.0</span>),),</span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">new</span> CustomerWidgetA(),</span><br><span class="line">            <span class="keyword">new</span> CustomerWidgetB(),</span><br><span class="line">            <span class="keyword">new</span> CustomerWidgetC(),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“ä»£ç å¯ä»¥æŸ¥çœ‹</p><h3 id="å¸¸è§é”™è¯¯"><a href="#å¸¸è§é”™è¯¯" class="headerlink" title="å¸¸è§é”™è¯¯"></a>å¸¸è§é”™è¯¯</h3><blockquote><p>MediaQuery.of() called with a context that does not contain a MediaQuery</p></blockquote><p>è§ss <a href="https://stackoverflow.com/questions/50214338/flutter-error-mediaquery-of-called-with-a-context-that-does-not-contain-a-med" target="_blank" rel="noopener">https://stackoverflow.com/questions/50214338/flutter-error-mediaquery-of-called-with-a-context-that-does-not-contain-a-med</a><br><span data-type="color" style="color:rgb(36, 39, 41)"><span data-type="background" style="background-color:rgb(255, 255, 255)">You need a </span></span><code>MaterialApp</code><span data-type="color" style="color:rgb(36, 39, 41)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>or a <code>WidgetsApp</code><span data-type="color" style="color:rgb(36, 39, 41)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>arround your widget. They provide the <code>MediaQuery</code><span data-type="color" style="color:rgb(36, 39, 41)"><span data-type="background" style="background-color:rgb(255, 255, 255)">. When you call </span></span><code>.of(context)</code></p><h2 id="Notification"><a href="#Notification" class="headerlink" title="Notification"></a>Notification</h2><p>notification è·ŸinheritedWidgetæ°æ°ç›¸åï¼Œæ˜¯ä» å­èŠ‚ç‚¹å‘çˆ¶èŠ‚ç‚¹å‘é€æ¶ˆæ¯<span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">åœ¨Widgetæ ‘ä¸­ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥åˆ†å‘é€šçŸ¥ï¼Œé€šçŸ¥ä¼šæ²¿ç€å½“å‰èŠ‚ç‚¹ï¼ˆcontextï¼‰å‘ä¸Šä¼ é€’ï¼Œæ‰€æœ‰çˆ¶èŠ‚ç‚¹éƒ½å¯ä»¥é€šè¿‡NotificationListeneræ¥ç›‘å¬é€šçŸ¥ï¼ŒFlutterä¸­ç§°è¿™ç§é€šçŸ¥ç”±å­å‘çˆ¶çš„ä¼ é€’ä¸ºâ€œé€šçŸ¥å†’æ³¡â€ï¼ˆNotification Bubblingï¼‰ã€‚Flutterä¸­å¾ˆå¤šåœ°æ–¹ä½¿ç”¨äº†é€šçŸ¥ï¼Œå¦‚å¯æ»šåŠ¨(Scrollable) Widgetä¸­æ»‘åŠ¨æ—¶å°±ä¼šåˆ†å‘ScrollNotificationï¼Œè€ŒScrollbaræ­£æ˜¯é€šè¿‡ç›‘å¬ScrollNotificationæ¥ç¡®å®šæ»šåŠ¨æ¡ä½ç½®çš„ã€‚</span></span></p><h3 id="ä½¿ç”¨Notification"><a href="#ä½¿ç”¨Notification" class="headerlink" title="ä½¿ç”¨Notification"></a>ä½¿ç”¨Notification</h3><ul><li>è‡ªå®šä¹‰é€šçŸ¥<br><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">è¦ç»§æ‰¿è‡ªNotificationç±»</span></span></li><li>åˆ†å‘é€šçŸ¥<br><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">Notificationæœ‰ä¸€ä¸ª</span></span><code>dispatch(context)</code><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">æ–¹æ³•ï¼Œå®ƒæ˜¯ç”¨äºåˆ†å‘é€šçŸ¥çš„ï¼Œæˆ‘ä»¬è¯´è¿‡contextå®é™…ä¸Šå°±æ˜¯æ“ä½œElementçš„ä¸€ä¸ªæ¥å£ï¼Œå®ƒä¸Elementæ ‘ä¸Šçš„èŠ‚ç‚¹æ˜¯å¯¹åº”çš„ï¼Œé€šçŸ¥ä¼šä»contextå¯¹åº”çš„ElementèŠ‚ç‚¹å‘ä¸Šå†’æ³¡ã€‚</span></span></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomerNotification</span> <span class="keyword">extends</span> <span class="title">Notification</span> </span>&#123;</span><br><span class="line">  CustomerNotification(<span class="keyword">this</span>.msg);</span><br><span class="line">  <span class="keyword">final</span> String msg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NotificationStudyState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">NotificationStudy</span>&gt; </span>&#123;</span><br><span class="line">  String _msg = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="function">Widget <span class="title">build</span><span class="params">(BuildContext context)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ç›‘å¬é€šçŸ¥</span></span><br><span class="line">    <span class="keyword">return</span> NotificationListener&lt;CustomerNotification&gt;(</span><br><span class="line">      onNotification: (notification) &#123;</span><br><span class="line">        setState(() &#123;</span><br><span class="line">          _msg += notification.msg + <span class="string">"  "</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">      child: Center(</span><br><span class="line">        child: Column(</span><br><span class="line">          mainAxisSize: MainAxisSize.min,</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line"><span class="comment">//          RaisedButton(</span></span><br><span class="line"><span class="comment">//           onPressed: () =&gt; CustomerNotification("Hello NotificationStudy").dispatch(context),</span></span><br><span class="line"><span class="comment">//           child: Text("Send Notification"),</span></span><br><span class="line"><span class="comment">//          ),</span></span><br><span class="line">            Builder(</span><br><span class="line">              builder: (context) &#123;</span><br><span class="line">                <span class="keyword">return</span> RaisedButton(</span><br><span class="line">                  <span class="comment">//æŒ‰é’®ç‚¹å‡»æ—¶åˆ†å‘é€šçŸ¥</span></span><br><span class="line">                  onPressed: () =&gt; CustomerNotification(<span class="string">"Hello NotificationStudy"</span>).dispatch(context),</span><br><span class="line">                  child: Text(<span class="string">"Send Notification"</span>),</span><br><span class="line">                );</span><br><span class="line">              &#125;,</span><br><span class="line">            ),</span><br><span class="line">            Text(_msg)</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><span data-type="color" style="color:rgb(133, 133, 133)"><span data-type="background" style="background-color:rgb(255, 255, 255)">æ³¨æ„ï¼šä»£ç ä¸­æ³¨é‡Šçš„éƒ¨åˆ†æ˜¯ä¸èƒ½æ­£å¸¸å·¥ä½œçš„ï¼Œå› ä¸ºè¿™ä¸ª</span></span><code>context</code><span data-type="color" style="color:rgb(133, 133, 133)"><span data-type="background" style="background-color:rgb(255, 255, 255)">æ˜¯æ ¹Contextï¼Œè€ŒNotificationListeneræ˜¯ç›‘å¬çš„å­æ ‘ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡</span></span><code>Builder</code><span data-type="color" style="color:rgb(133, 133, 133)"><span data-type="background" style="background-color:rgb(255, 255, 255)">æ¥æ„å»ºRaisedButtonï¼Œæ¥è·å¾—æŒ‰é’®ä½ç½®çš„contextã€‚</span></span></p><p>ä»¥ä¸Šä»£ç  å‚è§ <a href="https://github.com/xsfelvis/learnflutter/tree/a2824a6d0db70fe3d4c92609cbd172ec7854ab3f/lib/demo6" target="_blank" rel="noopener">https://github.com/xsfelvis/learnflutter/tree/a2824a6d0db70fe3d4c92609cbd172ec7854ab3f/lib/demo6</a></p><h2 id="äº‹ä»¶æ€»çº¿"><a href="#äº‹ä»¶æ€»çº¿" class="headerlink" title="äº‹ä»¶æ€»çº¿"></a>äº‹ä»¶æ€»çº¿</h2><p>ç›®å‰åœ¨å·²ç»æœ‰äº†ä¸€ä¸ªeventbusæ’ä»¶</p><p><a href="https://pub.flutter-io.cn/packages/event_bus#-readme-tab-" target="_blank" rel="noopener">https://pub.flutter-io.cn/packages/event_bus#-readme-tab-</a></p><p>ç”¨æ³•è·ŸåŸç”Ÿeventbusç±»ä¼¼</p><ul><li><p>å¼•å…¥</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:event_bus/event_bus.dart'</span>;</span><br><span class="line"></span><br><span class="line">EventBus eventBus = <span class="keyword">new</span> EventBus();</span><br></pre></td></tr></table></figure></li><li><p>ç›‘å¬äº‹ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">eventBus.on().listen((event) &#123; </span><br><span class="line">    print(event.runtimeType);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>å‘é€äº‹ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eventBus.fire(event);</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h1 id=&quot;Flutterä¸­æ¶ˆæ¯ä¼ é€’&quot;&gt;&lt;a href=&quot;#Flutterä¸­æ¶ˆæ¯ä¼ é€’&quot; class=&quot;headerlink&quot; title=&quot;Flutterä¸­æ¶ˆæ¯ä¼ é€’&quot;&gt;&lt;/a&gt;
      
    
    </summary>
    
      <category term="Flutter" scheme="https://xsfelvis.github.io/categories/Flutter/"/>
    
    
      <category term="Flutter" scheme="https://xsfelvis.github.io/tags/Flutter/"/>
    
      <category term="Flutteræ¶ˆæ¯ä¼ é€’" scheme="https://xsfelvis.github.io/tags/Flutter%E6%B6%88%E6%81%AF%E4%BC%A0%E9%80%92/"/>
    
  </entry>
  
  <entry>
    <title>flutterä¸­çš„è·¯ç”±</title>
    <link href="https://xsfelvis.github.io/2018/12/15/2018-12-15flutter%E4%B8%AD%E7%9A%84%E8%B7%AF%E7%94%B1/"/>
    <id>https://xsfelvis.github.io/2018/12/15/2018-12-15flutterä¸­çš„è·¯ç”±/</id>
    <published>2018-12-15T06:42:34.365Z</published>
    <updated>2018-12-15T06:42:34.365Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è·¯ç”±æ˜¯nativeä¸­åº”ç”¨çš„æ¯”è¾ƒå¤šï¼Œç‰¹åˆ«æ˜¯ç»„ä»¶åŒ–çš„å·¥ç¨‹ä¸­ï¼Œæ›´æ˜¯ç”¨æ¥è§£è€¦çš„åˆ©å™¨ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æœ‰é˜¿é‡Œçš„ARouterç­‰ï¼Œè·¯ç”±è¿™ä¸€æ€æƒ³ä¹Ÿæ˜¯å€Ÿé‰´å‰ç«¯è€Œæ¥ï¼Œæ¯”å¦‚webä¸­é¡µé¢è·³è½¬å°±æ˜¯ä¸€ä¸ªurlå°±åˆ°äº†ä¸€ä¸ªæ–°çš„é¡µé¢ï¼ŒFlutteræ—¢ç„¶æ˜¯æ–°ä¸€ä»£çš„è·¨ç«¯æ–¹æ¡ˆï¼Œè€Œä¸”ä»RNå€Ÿé‰´äº†ä¸å°‘æ€æƒ³ï¼Œè·¯ç”±å½“ç„¶ä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„ï¼Œæœ¬ç¯‡å°†äº†è§£ä¸‹Flutterçš„è·¯ç”±</p><h1 id="Flutterçš„è·¯ç”±"><a href="#Flutterçš„è·¯ç”±" class="headerlink" title="Flutterçš„è·¯ç”±"></a>Flutterçš„è·¯ç”±</h1><p>åœ¨Flutterä¸­æ”¯æŒæ‰€æœ‰è·¯ç”±åœºæ™¯ï¼Œ<span data-type="color" style="color:rgb(47, 47, 47)"><span data-type="background" style="background-color:rgb(255, 255, 255)">pushã€popé¡µé¢ï¼Œé¡µé¢é—´çš„å‚æ•°ä¼ é€’ç­‰ç­‰ã€‚flutteré‡Œé¢çš„è·¯ç”±å¯ä»¥åˆ†æˆä¸¤ç§ï¼Œ</span></span></p><ul><li><span data-type="color" style="color:rgb(47, 47, 47)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä¸€ç§æ˜¯ç›´æ¥æ³¨å†Œï¼Œä¸èƒ½ä¼ é€’å‚æ•°ï¼Œå¯ä»¥ç§° ä¸ºé™æ€è·¯ç”±</span></span></li><li><span data-type="color" style="color:rgb(47, 47, 47)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä¸€ç§è¦è‡ªå·±æ„é€ å®ä¾‹ï¼Œå¯ä»¥ä¼ é€’å‚æ•°ï¼Œå¯ä»¥ç§°ä¸º åŠ¨æ€è·¯ç”±ã€‚</span></span></li></ul><h2 id="é™æ€è·¯ç”±"><a href="#é™æ€è·¯ç”±" class="headerlink" title="é™æ€è·¯ç”±"></a>é™æ€è·¯ç”±</h2><p>åœ¨<span data-type="color" style="color:rgb(52, 73, 94)">åˆ›å»ºæ—¶å°±å·²ç»æ˜ç¡®çŸ¥é“äº†è¦è·³è½¬çš„é¡µé¢å’Œå€¼ï¼Œ</span><span data-type="color" style="color:rgb(47, 47, 47)"><span data-type="background" style="background-color:rgb(255, 255, 255)">åœ¨æ–°å»ºä¸€ä¸ªMDé£æ ¼çš„Appçš„æ—¶å€™ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªrouteså‚æ•°æ¥å®šä¹‰è·¯ç”±ã€‚ä½†æ˜¯è¿™é‡Œå®šä¹‰çš„è·¯ç”±æ˜¯é™æ€çš„ï¼Œå®ƒä¸å¯ä»¥å‘ä¸‹ä¸€ä¸ªé¡µé¢ä¼ é€’å‚æ•°</span></span></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line"><span class="function">Widget <span class="title">build</span><span class="params">(BuildContext context)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> MaterialApp(</span><br><span class="line">    title: <span class="string">'Flutter Demo'</span>,</span><br><span class="line">    theme: <span class="keyword">new</span> ThemeData(</span><br><span class="line">      primarySwatch: Colors.blue,</span><br><span class="line">    ),</span><br><span class="line">    <span class="comment">//æ³¨å†Œè·¯ç”±è¡¨</span></span><br><span class="line">    routes: &#123;</span><br><span class="line">      <span class="string">"router/static_page"</span>: (context) =&gt; StaticRoute(),</span><br><span class="line">    &#125;,</span><br><span class="line">    home: <span class="keyword">new</span> MyHomePage(title: <span class="string">'Flutter Demo Home Page'</span>),</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡routesè¿™ä¸ªå±æ€§æ³¨å†Œå¥½è·³è½¬çš„é¡µé¢å³key-valueï¼Œä¸Šé¢çš„ä»£ç ä¸­ </p><p>keyï¼šrouter/static_page    value: StaticRouter<br>ç„¶åä½¿ç”¨çš„æ—¶å€™ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">FlatButton(</span><br><span class="line">  child: Text(<span class="string">"open static router"</span>),</span><br><span class="line">  textColor: Colors.blue,</span><br><span class="line">  onPressed: () &#123;</span><br><span class="line">    Navigator.pushNamed(context, <span class="string">"router/static_page"</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€è·¯ç”±"><a href="#åŠ¨æ€è·¯ç”±" class="headerlink" title="åŠ¨æ€è·¯ç”±"></a>åŠ¨æ€è·¯ç”±</h2><p><span data-type="color" style="color:rgb(47, 47, 47)"><span data-type="background" style="background-color:rgb(255, 255, 255)">å½“éœ€è¦å‘ä¸‹ä¸€ä¸ªé¡µé¢ä¼ é€’å‚æ•°æ—¶ï¼Œè¦ç”¨åˆ°æ‰€è°“çš„åŠ¨æ€è·¯ç”±ï¼Œè‡ªå·±ç”Ÿæˆé¡µé¢å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥ä¼ é€’è‡ªå·±æƒ³è¦çš„å‚æ•°ã€‚</span></span></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">FlatButton(</span><br><span class="line">  child: Text(<span class="string">"open dynamic router"</span>),</span><br><span class="line">  textColor: Colors.blue,</span><br><span class="line">  onPressed: () &#123;</span><br><span class="line">    Navigator.push(context, MaterialPageRoute(</span><br><span class="line">        builder: (context) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">new</span> EchoRoute(<span class="string">"ä¼ å…¥è·³è½¬å‚æ•°"</span>);</span><br><span class="line">        &#125;));</span><br><span class="line">    æˆ–è€…</span><br><span class="line">    Navigator.ofï¼ˆ(context).push(MaterialPageRoute(</span><br><span class="line">        builder: (context) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">new</span> EchoRoute(<span class="string">"ä¼ å…¥è·³è½¬å‚æ•°"</span>);</span><br><span class="line">        &#125;));</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="ç‚¹å‡»è¿”å›"><a href="#ç‚¹å‡»è¿”å›" class="headerlink" title="ç‚¹å‡»è¿”å›"></a>ç‚¹å‡»è¿”å›</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> RaisedButton(</span><br><span class="line">  child: <span class="keyword">new</span> Text(<span class="string">"ç‚¹æˆ‘è¿”å›"</span>),</span><br><span class="line">  onPressed: () &#123;</span><br><span class="line">    Navigator.of(context).pop();</span><br><span class="line">  &#125;,</span><br><span class="line">  color: Colors.blue,</span><br><span class="line">  highlightColor: Colors.lightBlue,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥åœ¨å‰ä¸€ä¸ªé¡µé¢æ¥å—ç¬¬äºŒä¸ªé¡µé¢çš„è¿”å›å€¼<br>åœ¨ç¬¬ä¸€ä¸ªé¡µé¢è·³è½¬æ—¶å€™åŠ ä¸Šfutrueæ¥æ¥æ”¶<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">FlatButton(</span><br><span class="line">  child: Text(<span class="string">"open dynamic router"</span>),</span><br><span class="line">  textColor: Colors.blue,</span><br><span class="line">  onPressed: () &#123;</span><br><span class="line">    Future future = Navigator.push(context,</span><br><span class="line">        MaterialPageRoute(builder: (context) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> EchoRoute(<span class="string">"ä¼ å…¥è·³è½¬å‚æ•°"</span>);</span><br><span class="line">    &#125;));</span><br><span class="line">    <span class="comment">//æ¥æ”¶åŠ¨æ€é¡µé¢è¿”å›æ—¶ä¼ å›çš„å€¼</span></span><br><span class="line">    future.then((value) &#123;</span><br><span class="line">      showDialog(</span><br><span class="line">          context: context,</span><br><span class="line">          child: <span class="keyword">new</span> AlertDialog(</span><br><span class="line">            title: <span class="keyword">new</span> Text(value),</span><br><span class="line">          ));</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure></p><p>åœ¨EchoRouteé¡µé¢ è¿”å›æ—¶ä½¿ç”¨å¸¦å‚æ•°çš„popæ–¹æ³•<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> RaisedButton(</span><br><span class="line">                child: <span class="keyword">new</span> Text(<span class="string">"ç‚¹æˆ‘è¿”å›"</span>),</span><br><span class="line">                onPressed: () &#123;</span><br><span class="line"><span class="comment">//                  Navigator.of(context).pop();</span></span><br><span class="line">                  Navigator.of(context).pop(<span class="string">"æˆ‘æ˜¯æ¥è‡ªdymamic å…³é—­çš„è¿”å›å€¼"</span>);</span><br><span class="line">                &#125;,</span><br><span class="line">                color: Colors.blue,</span><br><span class="line">                highlightColor: Colors.lightBlue,</span><br><span class="line">              )</span><br></pre></td></tr></table></figure></p><p>è¿™æ ·å°±ä¼šåœ¨å…³é—­EchoRouteå›åˆ°è·³è½¬å‰é¡µé¢æ—¶å¼¹å‡ºdialogæ”¶åˆ°EchoRouteä¼ æ¥çš„å‚æ•°</p><h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><p><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">Navigatorçš„èŒè´£æ˜¯è´Ÿè´£ç®¡ç†Routeçš„ï¼Œç®¡ç†æ–¹å¼å°±æ˜¯åˆ©ç”¨ä¸€ä¸ªæ ˆä¸åœå‹å…¥å¼¹å‡ºï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥æ›¿æ¢å…¶ä¸­æŸä¸€ä¸ªRouteã€‚è€ŒRouteä½œä¸ºä¸€ä¸ªç®¡ç†å•å…ƒï¼Œä¸»è¦è´Ÿè´£åˆ›å»ºå¯¹åº”çš„ç•Œé¢ï¼Œå“åº”Navigatorå‹å…¥è·¯ç”±å’Œå¼¹å‡ºè·¯ç”±</span></span></p><p>å…¥æ ˆï¼š</p><ul><li>ä½¿ç”¨Navigator.of(context).pushName(â€œpathâ€œ)æˆ–è€…Navigator.pushName(context,â€œpathâ€œ)å¯ä»¥è¿›è¡Œé™æ€è·¯ç”±çš„è·³è½¬å‰ææ˜¯éœ€è¦åœ¨routeå±æ€§é‡Œé¢æ³¨å†Œ</li><li>ä½¿ç”¨push(Route)å¯ä»¥è¿›è¡Œæ€è·¯ç”±çš„è·³è½¬ï¼ŒåŠ¨æ€è·¯ç”±å¯ä»¥ä¼ å…¥æœªçŸ¥æ•°æ®</li></ul><p>å‡ºæ ˆ</p><ul><li>ä½¿ç”¨pop()å¯ä»¥è¿›è¡Œè·¯ç”±çš„å‡ºæ ˆå¹¶ä¸”å¯ä»¥ä¼ é€’å‚æ•°</li><li>å¯ä»¥ä½¿ç”¨Futureæ¥æ”¶ä¸Šä¸ªé¡µé¢è¿”å›çš„å€¼ã€‚</li></ul><p>ä»£ç åœ¨ <a href="https://github.com/xsfelvis/learnflutter/blob/e7bd2e29c1b39c8ea19e06bfebb6e7d55b9ab42a/lib/demo4/demo4main.dart" target="_blank" rel="noopener">https://github.com/xsfelvis/learnflutter/blob/e7bd2e29c1b39c8ea19e06bfebb6e7d55b9ab42a/lib/demo4/demo4main.dart</a></p><p># </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;è·¯ç”±æ˜¯nativeä¸­åº”ç”¨çš„æ¯”è¾ƒå¤šï¼Œç‰¹åˆ«æ˜¯
      
    
    </summary>
    
      <category term="Flutter" scheme="https://xsfelvis.github.io/categories/Flutter/"/>
    
    
      <category term="è·¯ç”±" scheme="https://xsfelvis.github.io/tags/%E8%B7%AF%E7%94%B1/"/>
    
      <category term="Flutter" scheme="https://xsfelvis.github.io/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>dio+json_serializableä»ç½‘ç»œè¯·æ±‚åˆ°æ•°æ®è§£æ</title>
    <link href="https://xsfelvis.github.io/2018/12/08/dio+json_serializable%E8%AF%B7%E6%B1%82%E5%88%B0%E8%A7%A3%E6%9E%90%E6%95%B0%E6%8D%AE/"/>
    <id>https://xsfelvis.github.io/2018/12/08/dio+json_serializableè¯·æ±‚åˆ°è§£ææ•°æ®/</id>
    <published>2018-12-07T16:00:00.000Z</published>
    <updated>2018-12-08T12:01:25.280Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç½‘ç»œè¯·æ±‚åˆ°æ•°æ®è§£ææ˜¯ä¸€ä¸ªappå¿…ä¸å¯å°‘çš„æµç¨‹ä¹‹ä¸€ï¼Œåœ¨flutterå®˜ç½‘ä¸­ç›®å‰ä¸»è¦æ˜¯ä»‹ç» è‡ªå¸¦çš„<a href="https://flutterchina.club/networking/" target="_blank" rel="noopener">Http</a>è¯·æ±‚+<a href="https://flutterchina.club/json/" target="_blank" rel="noopener">Jsonè§£æ</a> ä½†æ˜¯ä¹Ÿæ¨èäº†æ›´å¥½çš„ç½‘è·¯è¯·æ±‚åˆ°ç»„åˆçš„æ–¹å¼ dio å’Œ json_serializableï¼Œæœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»è¿™ä¸¤ä¸ªæ–¹å¼çš„ä½¿ç”¨ï¼Œæºç åœ¨ç»“å°¾</p><h1 id="dio"><a href="#dio" class="headerlink" title="dio"></a>dio</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>packageåœ°å€ <a href="https://pub.flutter-io.cn/packages/dio" target="_blank" rel="noopener">https://pub.flutter-io.cn/packages/dio</a>ï¼Œ<br>æ·»åŠ ä¾èµ–</p><blockquote><p><span data-type="color" style="color:rgb(51, 51, 51)">dependencies:  </span><br>    <strong>dio: </strong><strong><span data-type="color" style="color:rgb(221, 17, 68)">^1.0.9</span></strong><br>æ”¯æŒäº†<span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">æ”¯æŒRestful APIã€FormDataã€æ‹¦æˆªå™¨ã€è¯·æ±‚å–æ¶ˆã€Cookieç®¡ç†ã€æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½ã€è¶…æ—¶ç­‰</span></span><br>Performing a <code>GET</code> request: ç®€å•çš„ä½¿ç”¨å¦‚ä¸‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Response response;</span><br><span class="line">response=await dio.get(<span class="string">"/test?id=12&amp;name=wendu"</span>)</span><br><span class="line">print(response.data.toString());</span><br><span class="line"><span class="comment">// Optionally the request above could also be done as</span></span><br><span class="line">response=await dio.get(<span class="string">"/test"</span>,data:&#123;<span class="string">"id"</span>:<span class="number">12</span>,<span class="string">"name"</span>:<span class="string">"wendu"</span>&#125;)</span><br><span class="line">print(response.data.toString());</span><br></pre></td></tr></table></figure><p>Performing a <code>POST</code> request:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response=await dio.post(<span class="string">"/test"</span>,data:&#123;<span class="string">"id"</span>:<span class="number">12</span>,<span class="string">"name"</span>:<span class="string">"wendu"</span>&#125;)</span><br></pre></td></tr></table></figure><p>Performing multiple concurrent requests:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response= await Future.wait([dio.post(<span class="string">"/info"</span>),dio.get(<span class="string">"/token"</span>)]);</span><br></pre></td></tr></table></figure><p>Downloading a file:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response=await dio.download(<span class="string">"https://www.google.cn/"</span>,<span class="string">"./xx.html"</span>)</span><br></pre></td></tr></table></figure><p>Sending FormData:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FormData formData = <span class="keyword">new</span> FormData.from(&#123;</span><br><span class="line">   <span class="string">"name"</span>: <span class="string">"wendux"</span>,</span><br><span class="line">   <span class="string">"age"</span>: <span class="number">25</span>,</span><br><span class="line">&#125;);</span><br><span class="line">response = await dio.post(<span class="string">"/info"</span>, data: formData)</span><br></pre></td></tr></table></figure><p>Uploading multiple files to server by FormData:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">FormData formData = <span class="keyword">new</span> FormData.from(&#123;</span><br><span class="line">   <span class="string">"name"</span>: <span class="string">"wendux"</span>,</span><br><span class="line">   <span class="string">"age"</span>: <span class="number">25</span>,</span><br><span class="line">   <span class="string">"file1"</span>: <span class="keyword">new</span> UploadFileInfo(<span class="keyword">new</span> File(<span class="string">"./upload.txt"</span>), <span class="string">"upload1.txt"</span>),</span><br><span class="line">   <span class="comment">// upload with bytes (List&lt;int&gt;) </span></span><br><span class="line">   <span class="string">"file2"</span>: <span class="keyword">new</span> UploadFileInfo.fromBytes(utf8.encode(<span class="string">"hello world"</span>),<span class="string">"word.txt"</span>),</span><br><span class="line">   <span class="comment">// Pass multiple files within an Array </span></span><br><span class="line">   <span class="string">"files"</span>: [</span><br><span class="line">      <span class="keyword">new</span> UploadFileInfo(<span class="keyword">new</span> File(<span class="string">"./example/upload.txt"</span>), <span class="string">"upload.txt"</span>),</span><br><span class="line">      <span class="keyword">new</span> UploadFileInfo(<span class="keyword">new</span> File(<span class="string">"./example/upload.txt"</span>), <span class="string">"upload.txt"</span>)</span><br><span class="line">    ]</span><br><span class="line">&#125;);</span><br><span class="line">response = await dio.post(<span class="string">"/info"</span>, data: formData)</span><br></pre></td></tr></table></figure><p>æ›´å¤šå¯ä»¥å‚è€ƒä½œè€…çš„<a href="https://juejin.im/post/5b04c954f265da0b9c10fb61" target="_blank" rel="noopener">è¯´æ˜æ–‡ç« </a>ä»¥åŠ <a href="https://github.com/flutterchina/dio/tree/flutter/example" target="_blank" rel="noopener">example</a></p><p>å¹¶ä¸”ç”±äºflutteråŸç”Ÿçš„ç½‘ç»œåº“httpä¸æ”¯æŒcharlesæŠ“åŒ…ï¼Œè¿™ä¸ªåº“å¯ä»¥ä½¿ç”¨è®¾ç½®ä»£ç†æ¥è¾¾åˆ°æŠ“åŒ…çš„ç›®çš„ï¼Œipè‡ªå·±æ›¿æ¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dio.onHttpClientCreate = (HttpClient client) &#123;</span><br><span class="line">  client.findProxy = (uri) &#123;</span><br><span class="line">    <span class="comment">//proxy all request to localhost:8888</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"PROXY yourIP:yourPort"</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯æŠ“åŒ…äº†ã€‚</p><h2 id="ç½‘ç»œè¯·æ±‚å°è£…ä½¿ç”¨"><a href="#ç½‘ç»œè¯·æ±‚å°è£…ä½¿ç”¨" class="headerlink" title="ç½‘ç»œè¯·æ±‚å°è£…ä½¿ç”¨"></a>ç½‘ç»œè¯·æ±‚å°è£…ä½¿ç”¨</h2><p>ç®€å•å°è£…ä½¿æˆ‘ä»¬æ›´åŠ å®¹æ˜“çš„ä½¿ç”¨ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">_request</span><span class="params">(String url, Function callBack,</span></span></span><br><span class="line"><span class="function"><span class="params">      &#123;String method,</span></span></span><br><span class="line"><span class="function"><span class="params">      Map&lt;String, String&gt; params,</span></span></span><br><span class="line"><span class="function"><span class="params">      Function errorCallBack&#125;)</span> async </span>&#123;</span><br><span class="line"><span class="comment">//    dio.onHttpClientCreate = (HttpClient client) &#123;</span></span><br><span class="line"><span class="comment">//      client.findProxy = (uri) &#123;</span></span><br><span class="line"><span class="comment">//        //proxy all request to localhost:8888</span></span><br><span class="line"><span class="comment">//        return "PROXY 172.23.235.153:8888";</span></span><br><span class="line"><span class="comment">//      &#125;;</span></span><br><span class="line"><span class="comment">//    &#125;;</span></span><br><span class="line">    String errorMsg = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">int</span> statusCode;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      Response response;</span><br><span class="line">      <span class="keyword">if</span> (method == GET) &#123;</span><br><span class="line">        <span class="keyword">if</span> (params != <span class="keyword">null</span> &amp;&amp; params.isNotEmpty) &#123;</span><br><span class="line">          StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">"?"</span>);</span><br><span class="line">          params.forEach((key, value) &#123;</span><br><span class="line">            sb.write(<span class="string">"$key"</span> + <span class="string">"="</span> + <span class="string">"$value"</span> + <span class="string">"&amp;"</span>);</span><br><span class="line">          &#125;);</span><br><span class="line">          String paramStr = sb.toString();</span><br><span class="line">          paramStr = paramStr.substring(<span class="number">0</span>, paramStr.length - <span class="number">1</span>);</span><br><span class="line">          url += paramStr;</span><br><span class="line">        &#125;</span><br><span class="line">        response = await dio.get(url);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method == POST) &#123;</span><br><span class="line">        <span class="keyword">if</span> (params != <span class="keyword">null</span> &amp;&amp; params.isNotEmpty) &#123;</span><br><span class="line">          response = await dio.post(url, data: params);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          response = await dio.post(url);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      statusCode = response.statusCode;</span><br><span class="line">      <span class="keyword">if</span> (statusCode &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        errorMsg = <span class="string">"ç½‘ç»œè¯·æ±‚é”™è¯¯,çŠ¶æ€ç :"</span> + statusCode.toString();</span><br><span class="line">        _handError(errorCallBack, errorMsg);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (callBack != <span class="keyword">null</span>) &#123;</span><br><span class="line">        String res2Json  = json.encode(response.data);</span><br><span class="line">        Map&lt;String,dynamic&gt; map=json.decode(res2Json);</span><br><span class="line">        callBack(map[<span class="string">"data"</span>]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (exception) &#123;</span><br><span class="line">      _handError(errorCallBack, exception.toString());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>è¯¦ç»†çš„å¯ä»¥å‚è€ƒæºç <a href="https://github.com/xsfelvis/learnflutter/blob/047fb2c9cc08334c1adcc7b7892ebfe28a2cf13f/lib/demo3/utils/net/HttpCore.dart" target="_blank" rel="noopener">https://github.com/xsfelvis/learnflutter/blob/047fb2c9cc08334c1adcc7b7892ebfe28a2cf13f/lib/demo3/utils/net/HttpCore.dart</a></p><p>ä½¿ç”¨å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HttpCore.instance.get(Api.HOME_BANNER, (data) &#123;</span><br><span class="line">  List&lt;BannerData&gt; banners = getBannersList(data);</span><br><span class="line">  setState(() &#123;</span><br><span class="line">    slideData = banners;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;, errorCallBack: (errorMsg) &#123;</span><br><span class="line">  print(<span class="string">"error:"</span> + errorMsg);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="å‘"><a href="#å‘" class="headerlink" title="å‘"></a>å‘</h2><p>åœ¨å°è£…ç½‘ç»œåº“çš„çš„æ—¶å€™å‘ç° åº•å±‚ response.data[â€˜dataâ€™]æ—¶å€™å½“æ˜¯ä¸€ä¸ª<a href="ttp://www.wanandroid.com/banner/json" target="_blank" rel="noopener">jsonarray</a>æ—¶å€™ç«Ÿç„¶æ— æ³•ç›´æ¥å–å‡ºâ€™dataâ€™,â€Stirng not subType of Index â€œé”™è¯¯ï¼ŒåŸå› æ˜¯ æ­¤æ—¶æ‹¿åˆ°çš„ä¸æ˜¯ä¸€ä¸ªjsonæ•°æ®ï¼Œæ²¡æœ‰åŒå¼•å·çš„å‡jsonæ•°æ®ï¼Œä½†æ˜¯åœ¨<a href="http://www.wanandroid.com/article/list/1/json" target="_blank" rel="noopener">jsonobject</a>å´å¯ä»¥ï¼Œè§£å†³å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (callBack != <span class="keyword">null</span>) &#123;</span><br><span class="line">  String res2Json  = json.encode(response.data);</span><br><span class="line">  Map&lt;String,dynamic&gt; map=json.decode(res2Json);</span><br><span class="line">  callBack(map[<span class="string">"data"</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="json-serializable"><a href="#json-serializable" class="headerlink" title="json_serializable"></a>json_serializable</h1><h3 id="ç®€ä»‹-1"><a href="#ç®€ä»‹-1" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>packageåœ°å€ <a href="https://pub.flutter-io.cn/packages/json_serializable" target="_blank" rel="noopener">https://pub.flutter-io.cn/packages/json_serializable</a><br>æ·»åŠ ä¾èµ–</p><blockquote><p><span data-type="color" style="color:rgb(51, 51, 51)">dependencies:  </span><br>    <strong>json_serializable: </strong><strong><span data-type="color" style="color:rgb(221, 17, 68)">^2.0.0 </span></strong><br>dev_dependencies<br>    build_runner: ^1.1.2<br>    json_serializable: ^2.0.0</p></blockquote><p>è¿™ä¸ªæ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œä¹‹å‰çš„ç›¸å½“äºjsonæ•°æ®ä¸€ä¸ªä¸ªé€šè¿‡keyè§£å‡ºæ¥ï¼ˆå…³äºè‡ªå¸¦çš„jsonè§£æå¯ä»¥å‚è€ƒ <a href="https://juejin.im/post/5b5d782ae51d45191c7e7fb3#heading-7" target="_blank" rel="noopener">https://juejin.im/post/5b5d782ae51d45191c7e7fb3#heading-7</a>ï¼‰ï¼Œä¸ä»…è€—æ—¶è€Œä¸”å®¹æ˜“å‡ºé”™ï¼Œjson_serializable è®©æˆ‘ä»¬ç›´æ¥ååºåˆ—åŒ–æˆå¯¹è±¡ç›´æ¥ä½¿ç”¨ç±»ä¼¼äºGsonï¼Œè€Œä¸”è¿˜æä¾›äº†<a href="https://caijinglong.github.io/json2dart/index_ch.html" target="_blank" rel="noopener">ä¸€ä¸ªå·¥å…·</a>æ¥è‡ªåŠ¨å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆä»£ç ï¼Œç®€å•å¿«æ·è€Œä¸”ä¸å®¹æ˜“å‡ºé”™</p><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>ä»¥json</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"data"</span>:&#123;</span><br><span class="line">        <span class="attr">"curPage"</span>:<span class="number">2</span>,</span><br><span class="line">        <span class="attr">"datas"</span>:[</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"apkLink"</span>:<span class="string">""</span>,</span><br><span class="line">                <span class="attr">"author"</span>:<span class="string">"é¸¿æ´‹"</span>,</span><br><span class="line">                <span class="attr">"chapterId"</span>:<span class="number">410</span>,</span><br><span class="line">                <span class="attr">"chapterName"</span>:<span class="string">"ç‰åˆšè¯´"</span>,</span><br><span class="line">                <span class="attr">"collect"</span>:<span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"courseId"</span>:<span class="number">13</span>,</span><br><span class="line">                <span class="attr">"desc"</span>:<span class="string">""</span>,</span><br><span class="line">                <span class="attr">"envelopePic"</span>:<span class="string">""</span>,</span><br><span class="line">                <span class="attr">"fresh"</span>:<span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"id"</span>:<span class="number">7604</span>,</span><br><span class="line">                <span class="attr">"link"</span>:<span class="string">"https://mp.weixin.qq.com/s/cCZKmqKrdCn63eWTbOuANw"</span>,</span><br><span class="line">                <span class="attr">"niceDate"</span>:<span class="string">"2018-12-03"</span>,</span><br><span class="line">                <span class="attr">"origin"</span>:<span class="string">""</span>,</span><br><span class="line">                <span class="attr">"projectLink"</span>:<span class="string">""</span>,</span><br><span class="line">                <span class="attr">"publishTime"</span>:<span class="number">1543830090000</span>,</span><br><span class="line">                <span class="attr">"superChapterId"</span>:<span class="number">408</span>,</span><br><span class="line">                <span class="attr">"superChapterName"</span>:<span class="string">"å…¬ä¼—å·"</span>,</span><br><span class="line">                <span class="attr">"tags"</span>:[</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="attr">"name"</span>:<span class="string">"å…¬ä¼—å·"</span>,</span><br><span class="line">                        <span class="attr">"url"</span>:<span class="string">"/wxarticle/list/410/1"</span></span><br><span class="line">                    &#125;</span><br><span class="line">                ],</span><br><span class="line">                <span class="attr">"title"</span>:<span class="string">"åœ¨ Retrofit å’Œ OkHttp ä¸­ä½¿ç”¨ç½‘ç»œç¼“å­˜ï¼Œæé«˜è®¿é—®æ•ˆç‡"</span>,</span><br><span class="line">                <span class="attr">"type"</span>:<span class="number">0</span>,</span><br><span class="line">                <span class="attr">"userId"</span>:<span class="number">-1</span>,</span><br><span class="line">                <span class="attr">"visible"</span>:<span class="number">1</span>,</span><br><span class="line">                <span class="attr">"zan"</span>:<span class="number">0</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">"apkLink"</span>:<span class="string">""</span>,</span><br><span class="line">                <span class="attr">"author"</span>:<span class="string">"é¸¿æ´‹"</span>,</span><br><span class="line">                <span class="attr">"chapterId"</span>:<span class="number">408</span>,</span><br><span class="line">                <span class="attr">"chapterName"</span>:<span class="string">"é¸¿æ´‹"</span>,</span><br><span class="line">                <span class="attr">"collect"</span>:<span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"courseId"</span>:<span class="number">13</span>,</span><br><span class="line">                <span class="attr">"desc"</span>:<span class="string">""</span>,</span><br><span class="line">                <span class="attr">"envelopePic"</span>:<span class="string">""</span>,</span><br><span class="line">                <span class="attr">"fresh"</span>:<span class="literal">false</span>,</span><br><span class="line">                <span class="attr">"id"</span>:<span class="number">7605</span>,</span><br><span class="line">                <span class="attr">"link"</span>:<span class="string">"https://mp.weixin.qq.com/s/r3AWeYafyMEc1-g8BWEHBg"</span>,</span><br><span class="line">                <span class="attr">"niceDate"</span>:<span class="string">"2018-12-03"</span>,</span><br><span class="line">                <span class="attr">"origin"</span>:<span class="string">""</span>,</span><br><span class="line">                <span class="attr">"projectLink"</span>:<span class="string">""</span>,</span><br><span class="line">                <span class="attr">"publishTime"</span>:<span class="number">1543766400000</span>,</span><br><span class="line">                <span class="attr">"superChapterId"</span>:<span class="number">408</span>,</span><br><span class="line">                <span class="attr">"superChapterName"</span>:<span class="string">"å…¬ä¼—å·"</span>,</span><br><span class="line">                <span class="attr">"tags"</span>:[</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="attr">"name"</span>:<span class="string">"å…¬ä¼—å·"</span>,</span><br><span class="line">                        <span class="attr">"url"</span>:<span class="string">"/wxarticle/list/408/1"</span></span><br><span class="line">                    &#125;</span><br><span class="line">                ],</span><br><span class="line">                <span class="attr">"title"</span>:<span class="string">"é UI çº¿ç¨‹èƒ½è°ƒç”¨ View.invalidate()ï¼Ÿ"</span>,</span><br><span class="line">                <span class="attr">"type"</span>:<span class="number">0</span>,</span><br><span class="line">                <span class="attr">"userId"</span>:<span class="number">-1</span>,</span><br><span class="line">                <span class="attr">"visible"</span>:<span class="number">1</span>,</span><br><span class="line">                <span class="attr">"zan"</span>:<span class="number">0</span></span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">"offset"</span>:<span class="number">20</span>,</span><br><span class="line">        <span class="attr">"over"</span>:<span class="literal">false</span>,</span><br><span class="line">        <span class="attr">"pageCount"</span>:<span class="number">289</span>,</span><br><span class="line">        <span class="attr">"size"</span>:<span class="number">20</span>,</span><br><span class="line">        <span class="attr">"total"</span>:<span class="number">5779</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"errorCode"</span>:<span class="number">0</span>,</span><br><span class="line">    <span class="attr">"errorMsg"</span>:<span class="string">""</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºä¾‹ï¼Œæˆ‘ä»¬é¦–å…ˆæ‰¾åˆ°å®é™…æ•°æ®ä¿¡æ¯ï¼Œå› ä¸ºå¼‚errorcode ä¹‹ç±»çš„å¤„ç†å·²åœ¨ä¸Šé¢çš„å°è£…ç½‘ç»œè¯·æ±‚ä¸­å¤„ç†äº†ï¼Œè¿™é‡Œéœ€è¦å…³æ³¨ å®é™…å†…å®¹ä¼ é€’è€… â€œdataâ€é‡Œé¢çš„æ•°æ®ï¼Œå°†ä¸Šé¢è¿™ä¸ªdataé‡Œé¢çš„jsonObjectï¼Œä»data è¿™ä¸ªkeyåé¢åŒ…æ‹¬å¤§æ‹¬å·ä¸€èµ·å¤åˆ¶åˆ°ä¸Šé¢çš„ä»£ç ç”Ÿæˆå·¥å…·ç½‘é¡µé‡Œé¢ï¼Œæˆªå›¾å¦‚ä¸‹</p><p><img src="https://cdn.nlark.com/yuque/0/2018/png/215777/1544266913529-762efea8-b8e9-4d65-b7a1-67599f277055.png" alt="image.png | left | 747x341"></p><p>ç„¶å<span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">å½“å‰é¡¹ç›®çš„ç›®å½•ä¸‹è¿è¡Œ</span></span><br><code>flutter packages pub run build_runner build</code></p><p>ç„¶å°±å¯ä»¥å¾—åˆ°news.g.dartæ–‡ä»¶</p><p>ç„¶ååœ¨ä½¿ç”¨ä¸­é€šè¿‡è·å–å¯¹è±¡å±æ€§çš„æ–¹å¼å°±å¯ä»¥ç›´æ¥æ‹¿åˆ°æˆ‘ä»¬å…³æ³¨çš„å­—æ®µäº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  è·å–Newsæ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">_getNewsList</span><span class="params">(<span class="keyword">int</span> curpage)</span> </span>&#123;</span><br><span class="line">  var url = Api.HOME_ARTICLE + curpage.toString() + <span class="string">"/json"</span>;</span><br><span class="line">  HttpCore.instance.get(url, (data) &#123;</span><br><span class="line">    News news = News.fromJson(data);</span><br><span class="line">    List&lt;Datas&gt; newsDatas = news.datas;</span><br><span class="line">    setState(() &#123;</span><br><span class="line">      listData = newsDatas;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><h4 id="è‡ªå®šä¹‰å­—æ®µçš„å¤„ç†"><a href="#è‡ªå®šä¹‰å­—æ®µçš„å¤„ç†" class="headerlink" title="è‡ªå®šä¹‰å­—æ®µçš„å¤„ç†"></a>è‡ªå®šä¹‰å­—æ®µçš„å¤„ç†</h4><p><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">æˆ‘ä»¬å¯ä»¥é€šè¿‡JsonKeyè‡ªå®šä¹‰å‚æ•°è¿›è¡Œæ³¨é‡Šå¹¶è‡ªå®šä¹‰å‚æ•°æ¥è‡ªå®šä¹‰å„ä¸ªå­—æ®µã€‚ä¾‹å¦‚:æ˜¯å¦å…è®¸å­—æ®µä¸ºç©ºç­‰ã€‚</span></span><strong>æ³¨æ„ï¼Œè¿™é‡Œä¸åŠ ä»»ä½•JsonKeyé»˜è®¤å…è®¸ç©ºjsonå­—æ®µã€‚</strong><br>æ¯”å¦‚è§£æå­—æ®µæœ‰ä¸ªæ¨ªçº¿ï¼Œ<span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">è€Œdartä¸­åªå…è®¸å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ä½œä¸ºå˜é‡åã€‚æ‰€ä»¥æˆ‘ä»¬å¿…é¡»å¯¹å®ƒè¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚@JsonKey(name=&quot;Nicehash-CNHeavy&quot;)æ¥è§£æmapï¼Œé€šå¸¸è‡ªåŠ¨ç”Ÿæˆä»£ç çš„å·¥å…·å·²ç»å¯ä»¥å¸®åŠ©æˆ‘ä»¬è§£å†³äº†</span></span></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JsonKey</span>(name: <span class="string">'off-set'</span>)</span><br><span class="line"><span class="keyword">int</span> offset;</span><br></pre></td></tr></table></figure><h1 id="å®è·µ"><a href="#å®è·µ" class="headerlink" title="å®è·µ"></a>å®è·µ</h1><p>æ•ˆæœå¦‚ä¸‹å›¾</p><p><img src="https://cdn.nlark.com/yuque/0/2018/png/215777/1544267293376-274ccea1-1b3b-457c-8150-04fd795f6909.png" alt="image.png | left | 250x515.9574468085107"></p><p>æ¥å£æ¥è‡ª <a href="http://www.wanandroid.com/blog/show/2" target="_blank" rel="noopener">ç©Androidçš„å¼€æ”¾æ¥å£</a></p><p>ä»£ç åœ¨<a href="https://github.com/xsfelvis/learnflutter" target="_blank" rel="noopener"> learnflutter</a> çš„demo3</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;ç½‘ç»œè¯·æ±‚åˆ°æ•°æ®è§£ææ˜¯ä¸€ä¸ªappå¿…ä¸å¯å°‘çš„
      
    
    </summary>
    
      <category term="Flutter" scheme="https://xsfelvis.github.io/categories/Flutter/"/>
    
    
      <category term="Flutter" scheme="https://xsfelvis.github.io/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Flutterå…¥å‘æŒ‡å—</title>
    <link href="https://xsfelvis.github.io/2018/12/01/Flutter%E5%85%A5%E5%9D%91%E6%8C%87%E5%8D%97/"/>
    <id>https://xsfelvis.github.io/2018/12/01/Flutterå…¥å‘æŒ‡å—/</id>
    <published>2018-11-30T16:00:00.000Z</published>
    <updated>2018-12-01T14:09:58.365Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬æ–‡æ˜¯ä¸€ä¸ªçº¯Flutteré¡¹ç›®ï¼Œä¸»è¦é€šè¿‡å®ç°ç½‘ç»œè¯·æ±‚æ–°é—»è¡¨å±•ç¤ºä»¥åŠè·³è½¬webviewè¯¦æƒ…é¡µï¼Œæ¥åˆæ­¥æ„Ÿå—äº†ä¸€ä¸‹æœ€è¿‘å¾ˆç«çš„Flutter</p><p><img src="https://cdn.nlark.com/yuque/0/2018/png/215777/1543666189481-c2561294-1f65-4191-b487-8a8e7675d3ba.png" alt="image.png | left | 200x348.28660436137073"></p><p>ä»£ç åœ¨ <a href="https://github.com/xsfelvis/learnflutter.git" target="_blank" rel="noopener">æºç åœ°å€</a> éƒ¨åˆ†ä»£ç å‚è€ƒ <a href="https://github.com/zhangjianli/flutter_news" target="_blank" rel="noopener">https://github.com/zhangjianli/flutter_news</a></p><h1 id="å®‰è£…ç¯å¢ƒ"><a href="#å®‰è£…ç¯å¢ƒ" class="headerlink" title="å®‰è£…ç¯å¢ƒ"></a>å®‰è£…ç¯å¢ƒ</h1><p>å¯ä»¥å‚è€ƒ <a href="https://flutterchina.club/setup-macos/" target="_blank" rel="noopener">Flutterä¸­æ–‡ç½‘</a> æˆ‘ä½¿ç”¨çš„æ˜¯AndroidStudioï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ä¸‹è½½ä¸‹æ¥çš„flutter sdk åœ¨ä¼šè‡ªåŠ¨ä¸‹è½½dart sdk å…·ä½“åœ¨ flutter/bin/cache/dark-sdkå¾€å¾€åœ¨å¯¼å…¥æ–°å·¥ç¨‹æ—¶å€™éœ€è¦è®¾ç½®dart sdk æ³¨æ„è®¾ç½®ä¸€ä¸‹å°±å¥½</p><h1 id="Dart"><a href="#Dart" class="headerlink" title="Dart"></a>Dart</h1><p>Flutterçš„å¼€å‘è¯­è¨€é‡‡ç”¨Dartï¼Œè¿™æ˜¯ä¸€é—¨å¾ˆæ£’çš„è¯­è¨€ï¼Œé›†åˆäº†ç°ä»£è¯­è¨€çš„å¾ˆå¤šä¼˜ç‚¹ï¼Œå­¦ä¹ äº†ä¸€ä¸‹ä¹‹åæ„Ÿè§‰æœ‰javaçš„å½±å­ï¼Œä¹Ÿæœ‰es6çš„å½±å­ï¼Œå†™èµ·æ¥å¾ˆç®€ç»ƒ,Dartæœ‰ä¸ª<a href="http://dart.goodev.org/guides/language/language-tour#operators%E6%93%8D%E4%BD%9C%E7%AC%A6" target="_blank" rel="noopener">å®˜æ–¹å­¦ä¹ ç½‘ç«™</a></p><h1 id="Flutterä¹‹å¸ƒå±€"><a href="#Flutterä¹‹å¸ƒå±€" class="headerlink" title="Flutterä¹‹å¸ƒå±€"></a>Flutterä¹‹å¸ƒå±€</h1><p>æ¯”å¦‚å®ç°ä¸€ä¸ªå¦‚ä¸‹çš„å¸ƒå±€</p><p><img src="https://cdn.nlark.com/yuque/0/2018/png/215777/1543669524555-f934cfa0-42a7-438f-ac6a-6237b9118896.png" alt="stack.png | center | 150x150"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyHomePageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyHomePage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="function">Widget <span class="title">build</span><span class="params">(BuildContext context)</span> </span>&#123;</span><br><span class="line">    var stack = <span class="keyword">new</span> Stack(</span><br><span class="line">      alignment: <span class="function"><span class="keyword">const</span> <span class="title">Alignment</span><span class="params">(<span class="number">0.6</span>, <span class="number">0.6</span>)</span>,</span></span><br><span class="line"><span class="function">      children: [</span></span><br><span class="line"><span class="function">        new <span class="title">CircleAvatar</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">          backgroundImage: new AssetImage(<span class="string">'images/pic.jpg'</span>)</span>,</span></span><br><span class="line"><span class="function">          radius: 100.0,</span></span><br><span class="line"><span class="function">        ),</span></span><br><span class="line"><span class="function">        new <span class="title">Container</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">          decoration: new BoxDecoration(</span></span></span><br><span class="line"><span class="function"><span class="params">            color: Colors.black45,</span></span></span><br><span class="line"><span class="function"><span class="params">          )</span>,</span></span><br><span class="line"><span class="function">          child: new <span class="title">Text</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="string">'Mia B'</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">            style: new TextStyle(</span></span></span><br><span class="line"><span class="function"><span class="params">              fontSize: <span class="number">20.0</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">              fontWeight: FontWeight.bold,</span></span></span><br><span class="line"><span class="function"><span class="params">              color: Colors.white,</span></span></span><br><span class="line"><span class="function"><span class="params">            )</span>,</span></span><br><span class="line"><span class="function">          ),</span></span><br><span class="line"><span class="function">        ),</span></span><br><span class="line"><span class="function">      ],</span></span><br><span class="line"><span class="function">    )</span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹ä¸€çœ‹å…¶å®æŒºæ‡µé€¼çš„ï¼Œ</p><p>è¦è®°ä½ä¸€ç‚¹åœ¨Flutterä¸­ä¸€åˆ‡çš†ä¸ºâ€™<a href="https://flutterchina.club/widgets/layout/" target="_blank" rel="noopener">Widget</a>â€˜ï¼Œ<span data-type="color" style="color:rgb(26, 26, 26)"><span data-type="background" style="background-color:rgb(255, 255, 255)">åœ¨flutterçš„ä¸–ç•Œé‡Œï¼ŒåŒ…æ‹¬views,view controllers,layoutsç­‰åœ¨å†…çš„æ¦‚å¿µéƒ½å»ºç«‹åœ¨Widgetä¹‹ä¸Šã€‚widgetæ˜¯flutteråŠŸèƒ½çš„æŠ½è±¡æè¿°,æŒæ¡Flutterçš„åŸºç¡€å°±æ˜¯å­¦ä¼šä½¿ç”¨widgetå¼€å§‹</span></span>ç”šè‡³ä¸€ä¸ªpaddingå°±æ˜¯ä¸€ä¸ªwidgetï¼Œå®˜ç½‘æ˜¯æŒ‰ç…§å­å…ƒç´ æ¥åˆ†ç±»çš„</p><ul><li>å•ä¸ªå­å…ƒç´ ï¼ˆchildï¼‰çš„å¸ƒå±€ï¼ŒåŒ…æ‹¬Containerã€Paddingç­‰<code>18</code>ç§ï¼ˆç›®å‰æ˜¯2018å¹´12æœˆ1æ—¥ï¼Œåç»­æˆ‘æƒ³è‚¯å®šä¼šå¢åŠ çš„ï¼‰ï¼›</li><li>å¤šä¸ªå­å…ƒç´ ï¼ˆchildrenï¼‰çš„å¸ƒå±€ï¼ŒåŒ…æ‹¬Rowã€Columnç­‰<code>11</code>ç§ï¼›</li><li>layout helperï¼Œä¾‹å¦‚ListView.Builderï¼Œåœ¨å…ƒç´ å¤šçš„æ—¶å€™ï¼Œç”¨è¿™ç§æ–¹å¼æ›´åŠ çš„é«˜æ•ˆï¼Œç±»ä¼¼Androidçš„RecyclerViewï¼Œæœ‰è‡ªåŠ¨çš„å›æ”¶æœºåˆ¶ã€‚è¿™ç§ä¸¥æ ¼æ„ä¹‰ä¸Šä¸èƒ½ç®—æ˜¯ä¸€ä¸ªç§ç±»ï¼Œæˆ‘è§‰å¾—è¿™ç§helperä¼šè¶Šæ¥è¶Šå¤šã€‚</li></ul><p>å¸¸è§æœ‰çš„<span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">å…¶ä¸­å¸¸ç”¨æœ‰ </span></span><em>Containerã€Paddingã€Centerã€Flexã€Stackã€Rowã€Columnã€ListView</em><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> </span></span>ç­‰</p><div class="bi-table"><br>  <table><br>    <colgroup><br>      <col width="auto"><br>      <col width="auto"><br>    </colgroup><br>    <tbody><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç±»å‹</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">ç‰¹ç‚¹</div><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">Container</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åªæœ‰ä¸€ä¸ªå­ Widgetã€‚é»˜è®¤å……æ»¡ï¼ŒåŒ…å«äº†paddingã€marginã€colorã€å®½é«˜ã€decoration ç­‰é…ç½®ã€‚<br>          </div><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">Padding</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åªæœ‰ä¸€ä¸ªå­ Widgetã€‚åªç”¨äºè®¾ç½®Paddingï¼Œå¸¸ç”¨äºåµŒå¥—childï¼Œç»™childè®¾ç½®paddingã€‚<br>          </div><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">Center </div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åªæœ‰ä¸€ä¸ªå­ Widgetã€‚åªç”¨äºå±…ä¸­æ˜¾ç¤ºï¼Œå¸¸ç”¨äºåµŒå¥—childï¼Œç»™childè®¾ç½®å±…ä¸­ã€‚<br>          </div><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">Expanded</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">åªæœ‰ä¸€ä¸ªå­ Widgetã€‚åœ¨ Column å’Œ Row ä¸­å……æ»¡ã€‚</div><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">Stack </div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å¯ä»¥æœ‰å¤šä¸ªå­ Widgetã€‚ å­Widgetå †å åœ¨ä¸€èµ·ã€‚ (ç±»ä¼¼Androidçš„ FrameLayout)</div><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">Column</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å¯ä»¥æœ‰å¤šä¸ªå­ Widgetã€‚å‚ç›´å¸ƒå±€ã€‚ (ç±»ä¼¼Androidçš„ LinearLayout vertical)</div><br>        </td><br>      </tr><br>      <tr height="34px"><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">Row</div><br>        </td><br>        <td rowspan="1" colspan="1"><br>          <div data-type="p">å¯ä»¥æœ‰å¤šä¸ªå­ Widgetã€‚æ°´å¹³å¸ƒå±€ã€‚ (ç±»ä¼¼Androidçš„ LinearLayout horizon)</div><br>        </td><br>      </tr><br>    </tbody><br>  </table><br></div><p>è¿™å¸ƒå±€å†™èµ·æ¥ç¡®å®å¾ˆé…¸çˆ½ï¼Œä¸è¿‡ç»Ÿä¸€æ¸²æŸ“æ•ˆç‡æ›´é«˜ï¼Œä½†æ˜¯æŒæ¡èµ·æ¥æ¯”è¾ƒè´¹äº‹ï¼Œæ„Ÿè§‰å¹³å°ä¾§çš„ä¸€äº›æˆæœ¬è½¬å«åˆ°å¼€å‘è€…èº«ä¸Šï¼Œä¸çŸ¥é“åæœŸæœ‰æ²¡æœ‰ç±»ä¼¼xmlè¿™ç§å¸ƒå±€å•ç‹¬å‰¥ç¦»å‡ºæ¥çš„å®ç°ã€‚</p><h2 id="widgetè¯¦è§£"><a href="#widgetè¯¦è§£" class="headerlink" title="widgetè¯¦è§£"></a>widgetè¯¦è§£</h2><p>ä¸€åˆ‡çš†ä¸ºwidgetï¼Œä¸»è¦åˆ†ä¸ºä¸¤ç±» <span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">StatefulWidget(æœ‰çŠ¶æ€)</span></span>å’Œ <span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">StatelessWidget(æ— çŠ¶æ€)</span></span></p><ul><li><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">StatefulWidget(æœ‰çŠ¶æ€)</span></span><br><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">å¦‚æœä¸€ä¸ªæ§ä»¶éœ€è¦åŠ¨æ€çš„å»æ”¹å˜æˆ–è€…ç›¸åº”ä¸€äº›çŠ¶æ€ï¼Œä¾‹å¦‚ç‚¹å‡»æ€ã€è‰²å€¼ã€å†…å®¹åŒºåŸŸç­‰ï¼Œé‚£ä¹ˆä¸€èˆ¬éƒ½æ˜¯ç»§æ‰¿è‡ªStatefulWidgetï¼Œå¸¸è§çš„æœ‰CheckBoxã€AppBarã€TabBarç­‰</span></span></li><li><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">StatelessWidget(æ— çŠ¶æ€)</span></span><br><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">å¦‚æœä¸€ä¸ªæ§ä»¶è‡ªèº«çŠ¶æ€ä¸ä¼šå»æ”¹å˜ï¼Œåˆ›å»ºäº†å°±ç›´æ¥æ˜¾ç¤ºï¼Œä¸ä¼šæœ‰è‰²å€¼ã€å¤§å°æˆ–è€…å…¶ä»–å±æ€§çš„å˜åŒ–ï¼Œè¿™ç§widgetä¸€èˆ¬éƒ½æ˜¯ç»§æ‰¿è‡ªStatelessWidgetï¼Œå¸¸è§çš„æœ‰Containerã€ScrollViewç­‰</span></span></li></ul><p>StatefulWidgetå’ŒStatelessWidgetå¦‚ä¸‹æ‰€ç¤º</p><p><img src="https://cdn.nlark.com/yuque/0/2018/png/215777/1543671041809-a8dbbd7b-8372-4d53-9a6c-c852f3123920.png" alt="image.png | left | 747x214"></p><p><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ä¸€ä¸ªStatelessWidgetå¯ä»¥ç”¨å¤šä¸ªä¸åŒçš„BuildContextæ„å»ºï¼Œè€Œä¸€ä¸ªStatefulWidgetä¼šä¸ºæ¯ä¸ªBuildContextåˆ›å»ºä¸€ä¸ªStateå¯¹è±¡</span></span></p><p>å¯¹äºStatelessWidgetï¼Œbuildæ–¹æ³•ä¼šåœ¨å¦‚ä¸‹ä¸‰ç§æƒ…å†µä¸‹è°ƒç”¨ï¼Œ</p><ol><li>widgetç¬¬ä¸€æ¬¡è¢«æ’å…¥åˆ°æ ‘ä¸­ï¼›</li><li>widgetçš„çˆ¶èŠ‚ç‚¹æ›´æ”¹äº†é…ç½®ï¼ˆconfigurationï¼‰ï¼›</li><li>widgetä¾èµ–çš„InheritedWidgetæ”¹å˜äº†;</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Frog</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">const</span> <span class="title">Frog</span><span class="params">(&#123; Key key &#125;)</span> : <span class="title">super</span><span class="params">(key: key)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="function">Widget <span class="title">build</span><span class="params">(BuildContext context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Container(color: <span class="function"><span class="keyword">const</span> <span class="title">Color</span><span class="params">(<span class="number">0xFF2DBD3A</span>)</span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>StatefulWidgetçš„ä¸¤ä¸ªä¸»è¦ç±»åˆ«ï¼š</p><ul><li>åœ¨initStateä¸­åˆ›å»ºèµ„æºï¼Œåœ¨disposeä¸­é”€æ¯ï¼Œä½†æ˜¯ä¸ä¾èµ–äºInheritedWidgetæˆ–è€…è°ƒç”¨setStateæ–¹æ³•ï¼Œè¿™ç±»widgetåŸºæœ¬ä¸Šç”¨åœ¨ä¸€ä¸ªåº”ç”¨æˆ–è€…é¡µé¢çš„rootï¼›</li><li>ä½¿ç”¨setStateæˆ–è€…ä¾èµ–äºInheritedWidgetï¼Œè¿™ç§ä¼šåœ¨ç”Ÿå‘½å‘¨æœŸä¸­ä¼šè¢«é‡å»ºï¼ˆrebuildï¼‰å¾ˆå¤šæ¬¡ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">YellowBird</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">const</span> <span class="title">YellowBird</span><span class="params">(&#123; Key key &#125;)</span> : <span class="title">super</span><span class="params">(key: key)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="function">_YellowBirdState <span class="title">createState</span><span class="params">()</span> </span>=&gt; <span class="keyword">new</span> _YellowBirdState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_YellowBirdState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">YellowBird</span>&gt; </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="function">Widget <span class="title">build</span><span class="params">(BuildContext context)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Container(color: <span class="function"><span class="keyword">const</span> <span class="title">Color</span><span class="params">(<span class="number">0xFFFFE306</span>)</span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="State"><a href="#State" class="headerlink" title="State"></a>State</h2><p>çŠ¶æ€æœ‰ä½•ä½œç”¨å‘¢</p><ul><li>åœ¨widgetæ„å»ºçš„æ—¶å€™å¯ä»¥è¢«åŒæ­¥è¯»å–ï¼›</li><li><p>åœ¨widgetçš„ç”Ÿå‘½å‘¨æœŸä¸­å¯èƒ½ä¼šè¢«æ”¹å˜ã€‚</p><h3 id="Stateç”Ÿå‘½å‘¨æœŸ"><a href="#Stateç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Stateç”Ÿå‘½å‘¨æœŸ"></a>Stateç”Ÿå‘½å‘¨æœŸ</h3><p>å¯¹åº”çš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹</p></li><li><p>createdï¼šå½“Stateå¯¹è±¡è¢«åˆ›å»ºæ—¶å€™ï¼ŒState.initStateæ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼›</p></li><li>initializedï¼šå½“Stateå¯¹è±¡è¢«åˆ›å»ºï¼Œä½†è¿˜æ²¡æœ‰å‡†å¤‡æ„å»ºæ—¶ï¼ŒState.didChangeDependenciesåœ¨è¿™ä¸ªæ—¶å€™ä¼šè¢«è°ƒç”¨ï¼›</li><li>readyï¼šStateå¯¹è±¡å·²ç»å‡†å¤‡å¥½äº†æ„å»ºï¼ŒState.disposeæ²¡æœ‰è¢«è°ƒç”¨çš„æ—¶å€™ï¼›</li><li>defunctï¼šState.disposeè¢«è°ƒç”¨åï¼ŒStateå¯¹è±¡ä¸èƒ½å¤Ÿè¢«æ„å»º</li></ul><p><img src="https://cdn.nlark.com/yuque/0/2018/png/215777/1543671683971-29e23732-0120-4cd7-a8d1-019a3ba5510b.png" alt="image.png | left | 747x391"></p><p>å®Œæ•´ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š</p><ul><li>åˆ›å»ºä¸€ä¸ªStateå¯¹è±¡æ—¶ï¼Œä¼šè°ƒç”¨StatefulWidget.createStateï¼›</li><li>å’Œä¸€ä¸ªBuildContextç›¸å…³è”ï¼Œå¯ä»¥è®¤ä¸ºè¢«åŠ è½½äº†ï¼ˆmountedï¼‰ï¼›</li><li>è°ƒç”¨initStateï¼›</li><li>è°ƒç”¨didChangeDependenciesï¼›</li><li>ç»è¿‡ä¸Šè¿°æ­¥éª¤ï¼ŒStateå¯¹è±¡è¢«å®Œå…¨çš„åˆå§‹åŒ–äº†ï¼Œè°ƒç”¨buildï¼›</li><li>å¦‚æœæœ‰éœ€è¦ï¼Œä¼šè°ƒç”¨didUpdateWidgetï¼›</li><li>å¦‚æœå¤„åœ¨å¼€å‘æ¨¡å¼ï¼Œçƒ­åŠ è½½ä¼šè°ƒç”¨reassembleï¼›</li><li>å¦‚æœå®ƒçš„å­æ ‘ï¼ˆsubtreeï¼‰åŒ…å«éœ€è¦è¢«ç§»é™¤çš„Stateå¯¹è±¡ï¼Œä¼šè°ƒç”¨deactivateï¼›</li><li>è°ƒç”¨dispose,Stateå¯¹è±¡ä»¥åéƒ½ä¸ä¼šè¢«æ„å»ºï¼›</li><li>å½“è°ƒç”¨äº†dispose,Stateå¯¹è±¡å¤„äºæœªåŠ è½½ï¼ˆunmountedï¼‰ï¼Œå·²ç»è¢«disposeçš„Stateå¯¹è±¡æ²¡æœ‰åŠæ³•è¢«é‡æ–°åŠ è½½ï¼ˆremountï¼‰ã€‚</li></ul><h3 id="setState"><a href="#setState" class="headerlink" title="setState"></a>setState</h3><p><span data-type="color" style="color:rgb(51, 51, 51)"><span data-type="background" style="background-color:rgb(255, 255, 255)">å½“ä¿®æ”¹çŠ¶æ€æ—¶ï¼Œè°ƒç”¨setState widgetä¼šè¢«æ›´æ–°</span></span></p><h2 id="å¦‚ä½•å¸ƒå±€"><a href="#å¦‚ä½•å¸ƒå±€" class="headerlink" title="å¦‚ä½•å¸ƒå±€"></a>å¦‚ä½•å¸ƒå±€</h2><p>æ¯ä¸ªé¡µé¢è®¾è®¡éƒ½ä¸ä¸€æ ·ï¼Œç›¸åŒé¡µé¢å¯é€‰æ‹©çš„å¸ƒå±€æ–¹å¼ä¹Ÿä¸ä¸€æ ·ï¼Œå¯ä»¥å‚è€ƒä¸‹<a href="https://link.juejin.im?target=https%3A%2F%2Fflutterchina.club%2Ftutorials%2Flayout%2F%23common-layout-widgets" target="_blank" rel="noopener">Flutterå®˜æ–¹çš„å¸ƒå±€æ•™ç¨‹</a>ã€‚æ•´ä¸ªè¿‡ç¨‹ï¼ŒåŸºæœ¬ä¸ŠæŒ‰ç…§æ‹†è§£ã€ç»„ä»¶å°è£…ã€å…·ä½“å¸ƒå±€è¿™ä¸‰æ­¥æ¥çš„ã€‚</p><h1 id="Flutterä¹‹ç½‘ç»œè¯·æ±‚"><a href="#Flutterä¹‹ç½‘ç»œè¯·æ±‚" class="headerlink" title="Flutterä¹‹ç½‘ç»œè¯·æ±‚"></a>Flutterä¹‹ç½‘ç»œè¯·æ±‚</h1><p>åœ¨Androidå¼€å‘è€…æˆ‘ä»¬å¯ä»¥ä½¿ç”¨okHttpï¼ŒFlutterç»™æˆ‘ä»¬å°è£…å¥½äº†ï¼Œåœ¨pubspec.yamlæ–‡ä»¶ä¸­æ¥å…¥ç½‘ç»œä¾èµ–åº“ï¼Œç›¸å½“äºgradleçš„dependencyï¼Œå¯ä»¥åœ¨ <a href="https://pub.flutter-io.cn/flutter/packages?q=http" target="_blank" rel="noopener">åŒ…æŸ¥æ‰¾</a> ä¸­æ‰¾åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œåœ¨pubspec.yamlæ¥å…¥æ—¶å€™ä¸»è¦ç©ºæ ¼å°±å¥½<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">dependencies:</span><br><span class="line">  flutter:</span><br><span class="line">    sdk: flutter</span><br><span class="line"></span><br><span class="line">  json_annotation: ^2.0.0</span><br><span class="line">  flutter_webview_plugin: ^0.3.0+2</span><br><span class="line">  http: ^0.12.0</span><br><span class="line"></span><br><span class="line">  # The following adds the Cupertino Icons font to your application.</span><br><span class="line">  # Use with the CupertinoIcons class for iOS style icons.</span><br><span class="line">  cupertino_icons: ^0.1.2</span><br></pre></td></tr></table></figure></p><p>å…·ä½“ä½¿ç”¨èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NewsApi</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">static</span> Future&lt;NewsList&gt; <span class="title">getHeadlines</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">      &#123;String category: <span class="string">"general"</span>, <span class="keyword">int</span> page: <span class="number">0</span>&#125;)</span> async </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> response = await http.get(</span><br><span class="line">        <span class="string">"https://newsapi.org/v2/top-headlines?country=us&amp;apiKey=$apikey&amp;page=$page&amp;category=$category"</span>);</span><br><span class="line">    <span class="keyword">return</span> compute(parseResult, response.body);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">static</span> NewsList <span class="title">parseResult</span><span class="params">(String respond)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> NewsList.fromJson(json.decode(respond));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“å¯ä»¥å­¦ä¹ å®˜ç½‘ <a href="https://flutterchina.club/networking/" target="_blank" rel="noopener">åœ¨Flutterä¸­å‘èµ·HTTPç½‘ç»œè¯·æ±‚</a></p><h1 id="Flutterä¹‹æ•°æ®è§£æ"><a href="#Flutterä¹‹æ•°æ®è§£æ" class="headerlink" title="Flutterä¹‹æ•°æ®è§£æ"></a>Flutterä¹‹æ•°æ®è§£æ</h1><p>å®˜ç½‘ä¹Ÿç»™äº†ååºåˆ—åŒ–çš„æ–¹æ³•ä½†æ˜¯æ„Ÿè§‰æ¯”è¾ƒå¤è€ï¼Œå°±è·Ÿjsonä¸€æ ·æ‹¿åˆ°msgä¸€ä¸ªä¸ªè§£æï¼Œæœ‰ä¸ªæ›´å¥½çš„æ–¹å¼ç›´æ¥ååºåˆ—åŒ–æˆå¯¹è±¡ï¼Œåé¢ä½¿ç”¨æ›´åŠ å¿«æ·</p><p>é¦–å…ˆéœ€è¦æ·»åŠ ä¾èµ–</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dependencies:</span><br><span class="line">  â€¦â€¦</span><br><span class="line">  json_annotation: ^2.0.0</span><br><span class="line">dev_dependencies:</span><br><span class="line">  â€¦â€¦</span><br><span class="line">  build_runner: ^1.1.2</span><br><span class="line">  json_serializable: ^2.0.0</span><br></pre></td></tr></table></figure><p>å…·ä½“ç”¨æ³•å¯ä»¥å‚è€ƒ <a href="https://juejin.im/post/5b5f00e7e51d45190571172f#heading-13" target="_blank" rel="noopener">https://juejin.im/post/5b5f00e7e51d45190571172f#heading-13</a></p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ul><li><a href="https://flutterchina.club/setup-macos/" target="_blank" rel="noopener">Flutterä¸­æ–‡ç½‘</a></li><li><a href="https://juejin.im/post/5b09fe716fb9a07aa114a6d9" target="_blank" rel="noopener">https://juejin.im/post/5b09fe716fb9a07aa114a6d9</a></li><li><a href="https://juejin.im/post/5b5192c4e51d4519115d0d8f#heading-7" target="_blank" rel="noopener">https://juejin.im/post/5b5192c4e51d4519115d0d8f#heading-7</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;æœ¬æ–‡æ˜¯ä¸€ä¸ªçº¯Flutteré¡¹ç›®ï¼Œä¸»è¦é€šè¿‡
      
    
    </summary>
    
      <category term="Flutter" scheme="https://xsfelvis.github.io/categories/Flutter/"/>
    
    
      <category term="Flutter" scheme="https://xsfelvis.github.io/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>Gradleè¿›é˜¶</title>
    <link href="https://xsfelvis.github.io/2018/10/19/gradle%E8%BF%9B%E9%98%B6/"/>
    <id>https://xsfelvis.github.io/2018/10/19/gradleè¿›é˜¶/</id>
    <published>2018-10-18T16:00:00.000Z</published>
    <updated>2018-10-19T14:12:41.126Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><h2 id="Groovy-åŸºç¡€"><a href="#Groovy-åŸºç¡€" class="headerlink" title="Groovy åŸºç¡€"></a>Groovy åŸºç¡€</h2><ul><li><a href="https://gradle.org/" target="_blank" rel="noopener">å®˜ç½‘</a></li><li><a href="https://blog.csdn.net/yanbober/article/details/49047515" target="_blank" rel="noopener">Groovyè„šæœ¬åŸºç¡€å…¨æ”»ç•¥</a></li></ul><h2 id="Gradle-DSL-åŸºç¡€"><a href="#Gradle-DSL-åŸºç¡€" class="headerlink" title="Gradle DSL åŸºç¡€"></a>Gradle DSL åŸºç¡€</h2><p><a href="https://docs.gradle.org/current/dsl/index.html" target="_blank" rel="noopener">DSL</a></p><h2 id="Android-DSL-åŸºç¡€"><a href="#Android-DSL-åŸºç¡€" class="headerlink" title="Android DSL åŸºç¡€"></a>Android DSL åŸºç¡€</h2><p><a href="http://google.github.io/android-gradle-dsl/current/index.html" target="_blank" rel="noopener">ASL</a></p><h2 id="è‡ªå®šä¹‰æ’ä»¶å¼€å‘"><a href="#è‡ªå®šä¹‰æ’ä»¶å¼€å‘" class="headerlink" title="è‡ªå®šä¹‰æ’ä»¶å¼€å‘"></a>è‡ªå®šä¹‰æ’ä»¶å¼€å‘</h2><h3 id="ä¸‰ç§æ–¹å¼"><a href="#ä¸‰ç§æ–¹å¼" class="headerlink" title="ä¸‰ç§æ–¹å¼"></a>ä¸‰ç§æ–¹å¼</h3><table><thead><tr><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Build script</td><td>æŠŠæ’ä»¶å†™åœ¨ build.gradle æ–‡ä»¶ä¸­ï¼Œä¸€èˆ¬ç”¨äºç®€å•çš„é€»è¾‘ï¼Œåªåœ¨è¯¥ build.gradle æ–‡ä»¶ä¸­å¯è§</td></tr><tr><td>buildSrc é¡¹ç›®</td><td>å°†æ’ä»¶æºä»£ç æ”¾åœ¨ rootProjectDir/buildSrc/src/main/groovy ä¸­ï¼Œåªå¯¹è¯¥é¡¹ç›®ä¸­å¯è§ï¼Œé€‚ç”¨äºé€»è¾‘è¾ƒä¸ºå¤æ‚</td></tr><tr><td>ç‹¬ç«‹é¡¹ç›®</td><td>ä¸€ä¸ªç‹¬ç«‹çš„ Groovy å’Œ Java é¡¹ç›®ï¼Œå¯ä»¥æŠŠè¿™ä¸ªé¡¹ç›®æ‰“åŒ…æˆ Jar æ–‡ä»¶åŒ…ï¼Œä¸€ä¸ª Jar æ–‡ä»¶åŒ…è¿˜å¯ä»¥åŒ…å«å¤šä¸ªæ’ä»¶å…¥å£ï¼Œå°†æ–‡ä»¶åŒ…å‘å¸ƒåˆ°æ‰˜ç®¡å¹³å°ä¸Šï¼Œä¾›å…¶ä»–äººä½¿ç”¨ã€‚æœ¬æ–‡å°†ç€é‡ä»‹ç»æ­¤ç±»ã€‚</td></tr></tbody></table><p>å…·ä½“ä»æ’ä»¶å¼€å‘å¯ä»¥å‚è€ƒ</p><ul><li><a href="https://xsfelvis.github.io/2018/06/09/%E8%AF%91%E6%96%87_Writing%20Custom%20Plugins/">Writing Custom Plugins</a></li><li><a href="http://blog.bugtags.com/2016/03/28/embrace-android-studio-gradle-plugin/" target="_blank" rel="noopener">æ‹¥æŠ± Android Studio ä¹‹äº”ï¼šGradle æ’ä»¶å¼€å‘</a></li></ul><h2 id="æ ¸å¿ƒæ¦‚å¿µ"><a href="#æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="æ ¸å¿ƒæ¦‚å¿µ"></a>æ ¸å¿ƒæ¦‚å¿µ</h2><blockquote><p><a href="https://docs.gradle.org/current/javadoc/org/gradle/api/DomainObjectCollection.html" target="_blank" rel="noopener">NamedDomainObjectContainer</a></p></blockquote><p>ä½¿ç”¨NamedDomainObjectContainer ç®€ç§°NODC è¿™æ˜¯ä¸€ä¸ªå®¹çº³objectçš„å®¹å™¨,DomainObjectCollection å¯ä»¥ç›´æ¥è®¿é—®æ‰€æœ‰å¯¹è±¡ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯å®ƒçš„å†…éƒ¨ä½¿ç”¨SortedSetå®ç°çš„ï¼Œå†…éƒ¨å¯¹è±¡çš„nameæ˜¯uniqueçš„ï¼Œè€Œä¸”æ˜¯æŒ‰nameè¿›è¡Œæ’åºçš„ã€‚é€šå¸¸åˆ›å»ºNDOCçš„æ–¹æ³•å°±æ˜¯è°ƒç”¨,è°ƒç”¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;T&gt; [NamedDomainObjectContainer] &lt;T&gt; container(Class&lt;T&gt; type)</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯<code>type</code>æœ‰ä¸€ä¸ªè¦æ±‚ï¼šå¿…é¡»æœ‰ä¸€ä¸ªpublicçš„æ„é€ å‡½æ•°ï¼Œæ¥å—stringä½œä¸ºä¸€ä¸ªå‚æ•°</p><p>æ¯”å¦‚åœ¨buildScriptä¸­ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡å°±éœ€è¦ä½¿ç”¨NamedDomainObjectContainer </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NamedDomainObjectContainer&lt;Book&gt; bookContainer = mProject.container(Book.class,</span><br><span class="line">               new BookFactory(mInstantiator));</span><br></pre></td></tr></table></figure><p>å…·ä½“å¯ä»¥å‚çœ‹<a href="https://github.com/xsfelvis/GradlePluginStudy/blob/1c39de3500e02db7d2b9a7facd0c88d7f2e0dc8f/complexscriptdsl/src/main/java/com/dev/complexdsl/ComplexDSLPlugin.java" target="_blank" rel="noopener">æ„é€ å¯¹è±¡</a></p><blockquote><p>è·å– debugè¿˜æ˜¯release</p></blockquote><ul><li>variant.name.capitalize()è¿™ä¸ªå°±æ˜¯è·å–çš„å­—ç¬¦ä¸²æ˜¯debug è¿˜æ˜¯release</li><li>variant.buildType.name.capitalize() è·å–buildType</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def preDexTask = project.tasks.findByName(&quot;preDex$&#123;variant.name.capitalize()&#125;&quot;)</span><br><span class="line">def dexTask = project.tasks.findByName(&quot;dex$&#123;variant.name.capitalize()&#125;&quot;)</span><br><span class="line">def proguardTask = project.tasks.findByName(&quot;proguard$&#123;variant.name.capitalize()&#125;&quot;)</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯nuwaçƒ­ä¿®å¤çš„æºç ä»–äº‹å…ˆå®šä¹‰å¥½äº†è¿™äº›ä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡å°±æ˜¯æŠŠå­—èŠ‚ç æ–‡ä»¶æ‰“åŒ…æˆdexæ–‡ä»¶çš„ä»»åŠ¡ï¼Œä¸Šé¢çš„ä»£ç æ„æ€å°±æ˜¯è·å–è¿™äº›ä»»åŠ¡çš„åå­—ã€‚ï¼ˆå°±æ˜¯apply plugin: â€˜com.android.applicationâ€™é‡Œé¢çš„ä»»åŠ¡ï¼‰ã€‚ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å®šä¹‰çš„ä»»åŠ¡åç§°åˆ†åˆ«æ˜¯ï¼ˆpreDex${variant.name.capitalize()}ï¼‰ï¼ˆdex${variant.name.capitalize()}ï¼‰ï¼ˆproguard${variant.name.capitalize()}ï¼‰ï¼ˆ$è¿™ä¸ªç¬¦å·å°±æ˜¯æ‹¼æ¥å­—ç¬¦ä¸²çš„æ„æ€å’Œkotlinä¸€æ ·</p><h2 id="project-beforeEvaluate-project-afterEvaluate"><a href="#project-beforeEvaluate-project-afterEvaluate" class="headerlink" title="project.beforeEvaluate/project.afterEvaluate"></a>project.beforeEvaluate/project.afterEvaluate</h2><p>è¿™é‡Œåœ¨æ™®åŠä¸€ä¸ªå°çŸ¥è¯†ï¼Œé¡¹ç›®ä¸­gradleæ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šå…ˆè§£æsetting.gradle,ç„¶åæ˜¯build.gradle,å¦‚æœæƒ³åœ¨è§£æbuild.gradleä¹‹å‰åšç‚¹äº‹ï¼Œå¯ä»¥ä½¿ç”¨project.beforeEvaluateå¦‚æœæƒ³åœ¨è§£æbuild.gradleä¹‹ååšç‚¹äº‹å¯ä»¥project.afterEvaluateã€‚</p><h2 id="å¸¸ç”¨æ“ä½œ"><a href="#å¸¸ç”¨æ“ä½œ" class="headerlink" title="å¸¸ç”¨æ“ä½œ"></a>å¸¸ç”¨æ“ä½œ</h2><h3 id="åŠ è½½task"><a href="#åŠ è½½task" class="headerlink" title="åŠ è½½task"></a>åŠ è½½task</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">if (!imgDirectories.empty) &#123;</span><br><span class="line">                project.task(type: ImgOptimizerTask, overwrite: true, Constants.TASK_NAME.</span><br><span class="line">                        concat(project.name.capitalize()).concat(variant.buildType.name.capitalize())) &#123;</span><br><span class="line">                    it.group = &quot;optimize&quot;</span><br><span class="line">                    it.description = &quot;Optimize $&#123;variant.buildType.name&#125; images&quot;</span><br><span class="line">                    it.imgDirs = imgDirectories</span><br><span class="line">                    it.triggerSize = ext.triggerSize</span><br><span class="line">                    it.suffix = ext.suffix</span><br><span class="line">                    it.type = ext.type</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><p>å…³äºTaskçš„åˆ›å»ºå‚æ•° å‚è€ƒ <a href="https://docs.gradle.org/current/dsl/org.gradle.api.Project.html#N14C11" target="_blank" rel="noopener">Project</a></p><h3 id="è¯»å–åˆ—è¡¨-åˆ—è¡¨é•¿åº¦ä¸å®š"><a href="#è¯»å–åˆ—è¡¨-åˆ—è¡¨é•¿åº¦ä¸å®š" class="headerlink" title="è¯»å–åˆ—è¡¨ åˆ—è¡¨é•¿åº¦ä¸å®š"></a>è¯»å–åˆ—è¡¨ åˆ—è¡¨é•¿åº¦ä¸å®š</h3><p>æ¯”å¦‚è·å–ä¸€ä¸ªpersonçš„åˆ—è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class HelloPlugin implements Plugin&lt;Project&gt; &#123;</span><br><span class="line">    @Override</span><br><span class="line">    void apply(Project project) &#123;</span><br><span class="line">        //åˆ›å»ºä¸€ä¸ªå®¹å™¨ </span><br><span class="line">        NamedDomainObjectContainer&lt;Person&gt; persons = project.container(Person)</span><br><span class="line">        //å°†å®¹å™¨æ·»åŠ ä¸ºextension </span><br><span class="line">        project.extensions.add(&apos;team&apos;, persons)</span><br><span class="line">        def task = project.task(&apos;showTeam&apos;) &#123;</span><br><span class="line">            group &apos;junli&apos; doLast &#123; def team1 = project.extensions.getByName(&apos;team&apos;) println team1 &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ·»åŠ å­æ’ä»¶"><a href="#æ·»åŠ å­æ’ä»¶" class="headerlink" title="æ·»åŠ å­æ’ä»¶"></a>æ·»åŠ å­æ’ä»¶</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// apply the maven publish plugin and dynamic dependency resolve plugin to all the sub projects</span><br><span class="line">project.subprojects &#123;</span><br><span class="line">    it.plugins.apply(MavenPublishPlugin)</span><br><span class="line">    it.plugins.apply(DependencyResolvePlugin)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="hookèµ„æº"><a href="#hookèµ„æº" class="headerlink" title="hookèµ„æº"></a>hookèµ„æº</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">task hookAssets &#123;</span><br><span class="line">  afterEvaluate &#123;</span><br><span class="line">    tasks.findByName(&quot;packageDebug&quot;).doFirst &#123; task -&gt;</span><br><span class="line">      copy &#123;</span><br><span class="line">        from &quot;$&#123;projectDir.absolutePath&#125;/test.png&quot;</span><br><span class="line">        into &quot;$&#123;task.assets.asPath&#125;&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li><p>åœ¨ project afterEvaluate ä¹‹åæ‰¾åˆ° packageDebug task</p></li><li><p>ä¸å¦¨åœ¨ app ç›®å½•ä¸‹æ”¾å…¥ä¸€ä¸ª test.pngï¼Œä½¿ç”¨ copy {} é—­åŒ…ï¼Œfrom å¡«å…¥çš„å‚æ•°ä¸º test.png çš„è·¯å¾„ï¼Œinto å¡«å…¥çš„å‚æ•°ä¸ºè¾“å‡ºçš„è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯ assets çš„è·¯å¾„ã€‚</p></li></ol><h3 id="install-amp-amp-launch-apk"><a href="#install-amp-amp-launch-apk" class="headerlink" title="install &amp;&amp; launch apk"></a>install &amp;&amp; launch apk</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">task installAndRun(dependsOn: &apos;assembleDebug&apos;) &#123;</span><br><span class="line">  doFirst &#123;</span><br><span class="line">    exec &#123;</span><br><span class="line">      workingDir &quot;$&#123;buildDir&#125;/outputs/apk/debug&quot;</span><br><span class="line">      commandLine &apos;adb&apos;, &apos;install&apos;, &apos;-r&apos;, &apos;app-debug.apk&apos;</span><br><span class="line">    &#125;</span><br><span class="line">    exec &#123;</span><br><span class="line">      def path = &quot;$&#123;buildDir&#125;/intermediates/manifests/full/debug/AndroidManifest.xml&quot;</span><br><span class="line">      // xml è§£æ</span><br><span class="line">      def parser = new XmlParser(false, false).parse(new File(path))</span><br><span class="line">      // application ä¸‹çš„æ¯ä¸€ä¸ª activity ç»“ç‚¹</span><br><span class="line">      parser.application.activity.each &#123; activity -&gt;</span><br><span class="line">        // activity ä¸‹çš„æ¯ä¸€ä¸ª intent-filter ç»“ç‚¹</span><br><span class="line">        activity.&apos;intent-filter&apos;.each &#123; filter -&gt;</span><br><span class="line">          // intent-filter ä¸‹çš„ action ç»“ç‚¹ä¸­çš„ @android:name åŒ…å« android.intent.action.MAIN</span><br><span class="line">          if (filter.action.@&quot;android:name&quot;.contains(&quot;android.intent.action.MAIN&quot;)) &#123;</span><br><span class="line">            def targetActivity = activity.@&quot;android:name&quot;</span><br><span class="line">            commandLine &apos;adb&apos;, &apos;shell&apos;, &apos;am&apos;, &apos;start&apos;, &apos;-n&apos;,</span><br><span class="line">                &quot;$&#123;android.defaultConfig.applicationId&#125;/$&#123;targetActivity&#125;&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="apkå˜ä½“"><a href="#apkå˜ä½“" class="headerlink" title="apkå˜ä½“"></a>apkå˜ä½“</h3><p>æ ¹æ®å®˜æ–¹æ–‡æ¡£å¯ä»¥çŸ¥é“å¼€å‘è€…å¯ä»¥é€šè¿‡ android.applicationVariants.all è·å–åˆ°å½“å‰æ‰€æœ‰çš„ apk å˜ä½“ï¼Œè¯¥å˜ä½“çš„ç±»å‹ä¸º ApplicationVariantï¼Œå…¶çˆ¶ç±» BaseVariantOutput ä¸­å« name å­—æ®µï¼Œè¯¥å­—æ®µå®é™…ä¸Šå°±æ˜¯å½“å‰å˜ä½“çš„åå­—ï¼Œé‚£ä¹ˆå…¶å®åªéœ€è¦åˆ¤æ–­è¯¥ name å­—æ®µæ˜¯å¦åŒ…å« release å…³é”®å­—å³å¯ã€‚</p><ol><li>ä»£ç è§£æ</li></ol><p><code>åŠŸèƒ½</code></p><p>åœ¨ app ç›®å½•ä¸‹åˆ›å»º pic æ–‡ä»¶å¤¹ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªåä¸º test çš„ png å›¾ç‰‡ï¼Œhook apk æ‰“åŒ…æµç¨‹å°†è¯¥å›¾ç‰‡æ·»åŠ å…¥ apk çš„ assets æ–‡ä»¶å¤¹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">class HookAssetsPlugin implements Plugin&lt;Project&gt; &#123;</span><br><span class="line">  @Override</span><br><span class="line">  void apply(Project project) &#123;</span><br><span class="line">    project.afterEvaluate &#123;</span><br><span class="line">      project.plugins.withId(&apos;com.android.application&apos;) &#123;</span><br><span class="line">        project.android.applicationVariants.all &#123; ApplicationVariant variant -&gt;</span><br><span class="line">          variant.outputs.each &#123; ApkVariantOutput variantOutput -&gt;</span><br><span class="line">            if (variantOutput.name.equalsIgnoreCase(&quot;release&quot;)) &#123;</span><br><span class="line">              variantOutput.packageApplication.doFirst &#123; PackageApplication task -&gt;</span><br><span class="line">                project.copy &#123;</span><br><span class="line">                  from &quot;$&#123;project.projectDir.absolutePath&#125;/pic/test.png&quot;</span><br><span class="line">                  into &quot;$&#123;task.assets.asPath&#125;&quot;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è§£æç‚¹</p></blockquote><ol><li>åœ¨ project.afterEvaluate é—­åŒ…ä¸­æ‰èƒ½è·å–åˆ°å½“å‰ project ä¸­çš„æ‰€æœ‰ task ã€‚</li><li>é€šè¿‡ project.plugins.withId(â€˜com.android.applicationâ€™) ç¡®ä¿å½“å‰ project æ˜¯ Android app project è€Œä¸æ˜¯ Android library projectï¼Œä»¥æ­¤æ¥é¿å…æ— æ•ˆæ“ä½œ</li><li>é€šè¿‡ project.android.applicationVariants.all è·å–æ‰€æœ‰å˜ä½“ä¿¡æ¯ã€‚</li><li>åœ¨æ—¥å¸¸å¼€å‘ä¸­å¯»æ‰¾ task çš„æ–¹å¼å¯èƒ½æ›´å¤šçš„æ˜¯ä½¿ç”¨ project.tasks.findByName(name)/project.tasks.getByName(name)</li></ol><h3 id="è·å–ä¾èµ–é…ç½®"><a href="#è·å–ä¾èµ–é…ç½®" class="headerlink" title="è·å–ä¾èµ–é…ç½®"></a>è·å–ä¾èµ–é…ç½®</h3><p><a href="https://github.com/easilycoder/EasyDependency" target="_blank" rel="noopener">EasyDenpendency</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">// add the extension config</span><br><span class="line">        NamedDomainObjectContainer&lt;DependencyResolveExt&gt; dependencyResolveContainer = targetProject.container(DependencyResolveExt.class)</span><br><span class="line">        targetProject.extensions.add(&quot;dynamicDependency&quot;, dependencyResolveContainer)</span><br><span class="line"></span><br><span class="line">        targetProject.afterEvaluate &#123;</span><br><span class="line">            Map&lt;Project, DependencyResolveExt&gt; resolveExtMap = new HashMap&lt;&gt;()</span><br><span class="line">            targetProject.configurations.all &#123; Configuration configuration -&gt;</span><br><span class="line">                if (configuration.dependencies.size() == 0) &#123;</span><br><span class="line">                    return</span><br><span class="line">                &#125;</span><br><span class="line">                configuration.dependencies.all &#123; dependency -&gt;</span><br><span class="line">                    if (dependency instanceof DefaultProjectDependency) &#123;</span><br><span class="line">                        def projectName = dependency.dependencyProject.name</span><br><span class="line">                        def dependencyResolveExt = dependencyResolveContainer.find &#123;</span><br><span class="line">                            it.name == projectName</span><br><span class="line">                        &#125;</span><br><span class="line">                        if (dependencyResolveExt != null &amp;&amp; !dependencyResolveExt.debuggable) &#123;</span><br><span class="line">                            resolveExtMap.put(dependency.dependencyProject, dependencyResolveExt)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            targetProject.configurations.all &#123;</span><br><span class="line">                resolutionStrategy &#123;</span><br><span class="line">                    dependencySubstitution &#123;</span><br><span class="line">                        resolveExtMap.each &#123; key, value -&gt;</span><br><span class="line">                            substitute project(&quot;$&#123;key.path&#125;&quot;) with module(&quot;$&#123;value.groupId&#125;:$&#123;getArtifactName(key, value.artifactId)&#125;:$&#123;value.version&#125;&quot;)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h2 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h2&gt;&lt;h2 id=&quot;Groovy-åŸºç¡€&quot;&gt;&lt;a h
      
    
    </summary>
    
      <category term="Gradle" scheme="https://xsfelvis.github.io/categories/Gradle/"/>
    
    
      <category term="Gradle" scheme="https://xsfelvis.github.io/tags/Gradle/"/>
    
  </entry>
  
  <entry>
    <title>ä¸Šä¼ Jcenter</title>
    <link href="https://xsfelvis.github.io/2018/10/11/Jcenter/"/>
    <id>https://xsfelvis.github.io/2018/10/11/Jcenter/</id>
    <published>2018-10-10T16:00:00.000Z</published>
    <updated>2018-10-14T06:08:06.035Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h1 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h1><p>Jcenteræä¾›äº†ä¸€ä¸ªæ–¹ä¾¿ä½¿ç”¨è‡ªå·±å¼€æºåº“çš„ä¸€ä¸ªå¹³å° åœ¨Androidä¸­ä½¿ç”¨ complieå¼•ç”¨å³å¯ï¼Œç›®å‰å¾ˆå¤šæ–‡ç« éƒ½æ˜¯é€šè¿‡<code>gradle-bintray-plugin</code>è¿™ä¸ªæ’ä»¶ï¼Œä¸è¿‡<code>bintray-release</code>è¿™ä¸ªæ’ä»¶æ›´åŠ äººæ€§åŒ–ï¼Œæœ¬ç¯‡å°†è®°å½•ä½¿ç”¨è¿™ä¸ªæ’ä»¶å¦‚ä½•ä¸Šä¼ åˆ°Jcenterä¸Š</p><h1 id="0x01-æ³¨å†Œbintray-comè´¦å·"><a href="#0x01-æ³¨å†Œbintray-comè´¦å·" class="headerlink" title="0x01 æ³¨å†Œbintray.comè´¦å·"></a>0x01 æ³¨å†Œbintray.comè´¦å·</h1><ul><li>Step 1</li></ul><p>å®˜ç½‘æ³¨å†Œè´¦å· <a href="https://bintray.comï¼Œåˆ‡è®°ç‚¹å‡»å³è¾¹çš„For" target="_blank" rel="noopener">https://bintray.comï¼Œåˆ‡è®°ç‚¹å‡»å³è¾¹çš„For</a> an Open Source Accountï¼Œä¸ªäººç‰ˆæœ¬<br>(ä¼ä¸šç‰ˆ åŠ å…¥æˆ–è€…åˆ›å»ºç»„ç»‡æ‰å¯ä»¥å»ºç«‹è‡ªå·±çš„ä»“åº“ï¼Œæ¯”è¾ƒéº»çƒ¦)</p><p><img src="https://upload-images.jianshu.io/upload_images/6968064-d2afdefd754a26a2.png" alt="æ³¨å†Œ"></p><ul><li>Step 2</li></ul><p>æ³¨å†Œå®Œä¹‹å è¿›å…¥ Edit profile æŸ¥çœ‹è‡ªå·±çš„APIKeyï¼Œè¿™æ˜¯ä¸Šä¼ æ—¶å€™éœ€è¦ç”¨åˆ°</p><h1 id="0x02-é¡¹ç›®é…ç½®"><a href="#0x02-é¡¹ç›®é…ç½®" class="headerlink" title="0x02 é¡¹ç›®é…ç½®"></a>0x02 é¡¹ç›®é…ç½®</h1><ul><li>æ ¹gradle</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">buildscript &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath &apos;com.android.tools.build:gradle:2.3.1&apos;</span><br><span class="line"></span><br><span class="line">        classpath &apos;com.novoda:bintray-release:0.8.0&apos;//æ·»åŠ </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">allprojects &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">        maven&#123;url &quot;https://jitpack.io&quot;&#125;</span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line">    tasks.withType(Javadoc) &#123;</span><br><span class="line">        options.addStringOption(&apos;Xdoclint:none&apos;, &apos;-quiet&apos;)</span><br><span class="line">        options.addStringOption(&apos;encoding&apos;, &apos;UTF-8&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">task clean(type: Delete) &#123;</span><br><span class="line">    delete rootProject.buildDir</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//ç»Ÿä¸€å£°æ˜é…ç½®</span><br><span class="line">ext &#123;</span><br><span class="line">    userOrg = &apos;androidxsf&apos; //bintray.comç”¨æˆ·å </span><br><span class="line">    groupId = &apos;com.xsfdev&apos; //jcenterä¸Šçš„è·¯å¾„</span><br><span class="line">    uploadName = &apos;android-basiclib-apifactory&apos;</span><br><span class="line">    publishVersion = &apos;1.0.0&apos; //ç‰ˆæœ¬å·</span><br><span class="line">    desc = &apos;Request code can be generated automatically&apos; //æè¿°</span><br><span class="line">    website = &apos;https://github.com/HouXiaohu/androidbasiclib&apos; //ç½‘ç«™ï¼Œä¸é‡è¦ï¼›å°½é‡æ¨¡æ‹Ÿgithubä¸Šçš„åœ°å€</span><br><span class="line">    licences = [&apos;Apache-2.0&apos;] //å¼€æºåè®®</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>éœ€è¦ä¸Šä¼ çš„å„ä¸ªModuleä¸­å¼•å…¥</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">apply plugin: &apos;com.novoda.bintray-release&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//æ·»åŠ </span><br><span class="line">publish &#123;</span><br><span class="line">    artifactId = &apos;complexcriptdsl&apos;</span><br><span class="line">    userOrg = rootProject.userOrg</span><br><span class="line">    groupId = rootProject.groupId</span><br><span class="line">    uploadName = rootProject.uploadName</span><br><span class="line">    publishVersion = rootProject.publishVersion</span><br><span class="line">    desc = rootProject.description</span><br><span class="line">    website = rootProject.website</span><br><span class="line">    licences = rootProject.licences</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="0x03-æ‰§è¡Œä¸Šä¼ "><a href="#0x03-æ‰§è¡Œä¸Šä¼ " class="headerlink" title="0x03 æ‰§è¡Œä¸Šä¼ "></a>0x03 æ‰§è¡Œä¸Šä¼ </h1><p><code>./gradlew bintrayUpload -PbintrayUser = androidxsf(ä½ çš„ç”¨æˆ·å) -PbintrayKey = 1f8b6d3da641fe0f34d531c1811774c***(ä½ çš„APIKey) -PdryRun = false</code></p><p>æ­¤æ—¶å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸Šä¼ çš„é¡¹ç›®äº†,ä½ å¯ä»¥ç‚¹å‡»è¿›å»çœ‹è¯¥åº“çš„ä¸€äº›ä¿¡æ¯ï¼Œä½†æ˜¯æ³¨æ„æ­¤æ—¶è¿˜ä¸èƒ½å¤Ÿç›´æ¥è¢«å¼•ç”¨ã€‚</p><p>ç‚¹å‡»è¿›å»è¯¥åº“ï¼ŒæŒ‰ç…§ä¸‹å›¾ï¼Œç‚¹å‡»Add To jcenter</p><h1 id="0x04-å…¶ä»–"><a href="#0x04-å…¶ä»–" class="headerlink" title="0x04 å…¶ä»–"></a>0x04 å…¶ä»–</h1><p>ä½ éœ€è¦ç­‰å¾…bintrayçš„å·¥ä½œäººå‘˜å®¡æ ¸ï¼Œå®¡æ ¸é€šè¿‡ä¼šç»™ä½ å‘é€ç«™å†…Messageï¼Œå¹¶ä¸”Add to Jcenteré‚£ä¸ªæŒ‰é’®å°±å°æ—¶äº†ï¼Œæ­¤å¤–ä½ è¿˜å¯ä»¥æ ¹æ®ä½ ä¸Šä¼ çš„groupId,è®¿é—®è¯¥ç½‘ç«™<code>https://jcenter.bintray.com/</code>ä½ çš„groupIdä¾‹å¦‚<code>https://jcenter.bintray.com/com/com.xsfdev/</code></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æœ€åæ€»ç»“ä¸‹æ•´ä¸ªè¿‡ç¨‹ï¼Œå…¶å®éå¸¸ç®€å•ï¼š</p><ul><li>ç”³è¯·è´¦å·</li><li>å¼•å…¥bintray-releaseï¼Œåœ¨éœ€è¦ä¸Šä¼ çš„moduleé‡Œé¢å¡«å†™ç›¸å…³publishçš„ä¿¡æ¯</li><li>è°ƒç”¨ä¸Šä¼ çš„å‘½ä»¤</li><li>Add to Jcenteræäº¤å®¡æ ¸</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h1 id=&quot;0x00-å‰è¨€&quot;&gt;&lt;a href=&quot;#0x00-å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;0x00 å‰è¨€&quot;&gt;&lt;/a&gt;0x00 å‰è¨€&lt;/h1&gt;&lt;p&gt;
      
    
    </summary>
    
      <category term="å·¥å…·" scheme="https://xsfelvis.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="Jcenter" scheme="https://xsfelvis.github.io/tags/Jcenter/"/>
    
  </entry>
  
  <entry>
    <title>Spiçš„åŸºæœ¬ä½¿ç”¨</title>
    <link href="https://xsfelvis.github.io/2018/06/11/spi/"/>
    <id>https://xsfelvis.github.io/2018/06/11/spi/</id>
    <published>2018-06-10T16:00:00.000Z</published>
    <updated>2018-06-11T11:20:15.907Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><ul><li>ä»€ä¹ˆæ˜¯spi</li></ul><p>SPI ï¼ˆService Provider Interfaceï¼‰å±äº<code>åŠ¨æ€åŠ è½½æ¥å£å®ç°ç±»</code>çš„çš„ä¸€é¡¹æŠ€æœ¯ï¼Œæ˜¯JDKå†…ç½®çš„ä¸€ç§æœåŠ¡æä¾›å‘ç°æœºåˆ¶ï¼Œä½¿ç”¨ServiceLoaderå»åŠ è½½æ¥å£å¯¹åº”çš„å®ç°ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨å…³æ³¨å®ç°ç±»ï¼ŒServiceLoaderä¼šå‘Šè¯‰æˆ‘ä»¬ã€‚<a href="https://docs.oracle.com/javase/tutorial/sound/SPI-intro.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>æè¿°ä¸ºï¼š<code>ä¸ºæŸä¸ªæ¥å£å¯»æ‰¾æœåŠ¡çš„æœºåˆ¶,ç±»ä¼¼IOCæ€æƒ³ï¼Œå°†è£…é…çš„æ§åˆ¶æƒäº¤ç»™ServiceLoaderã€‚</code></p><ul><li>è§£å†³é—®é¢˜</li></ul><p>åªæä¾›æœåŠ¡æ¥å£ï¼Œå…·ä½“æœåŠ¡ç”±å…¶ä»–ç»„ä»¶å®ç°ï¼Œæ¥å£å’Œå…·ä½“å®ç°åˆ†ç¦»ï¼ˆç±»ä¼¼æ¡¥æ¥ï¼‰ï¼ŒåŒæ—¶èƒ½å¤Ÿ<code>é€šè¿‡ç³»ç»Ÿçš„ServiceLoader</code>æ‹¿åˆ°è¿™äº›å®ç°ç±»çš„é›†åˆï¼Œç»Ÿä¸€å¤„ç†ï¼Œè¿™æ ·åœ¨ç»„ä»¶åŒ–ä¸­å¾€å¾€ä¼šå¸¦æ¥å¾ˆå¤šä¾¿åˆ©ï¼ŒSPIæœºåˆ¶å¯ä»¥å®ç°ä¸åŒæ¨¡å—ä¹‹é—´æ–¹ä¾¿çš„é¢å‘æ¥å£ç¼–ç¨‹ï¼Œæ‹’ç»äº†ç¡¬ç¼–ç çš„æ–¹å¼ï¼Œè§£è€¦æ•ˆæœå¾ˆå¥½</p><blockquote><p>å³ç›¸å½“äºåˆ¶å®šæ ‡å‡†ï¼Œç„¶åä¸åŒå®ç°æ–¹ç”¨ä¸åŒçš„æ–¹å¼å®ç°æ ‡å‡†ä¾›ä½¿ç”¨æ–¹ä½¿ç”¨,å¹¶ä¸”å¯ä»¥åŠ¨æ€åŠ è½½</p></blockquote><h1 id="åœ¨Androidä¸­å¦‚ä½•ä½¿ç”¨"><a href="#åœ¨Androidä¸­å¦‚ä½•ä½¿ç”¨" class="headerlink" title="åœ¨Androidä¸­å¦‚ä½•ä½¿ç”¨"></a>åœ¨Androidä¸­å¦‚ä½•ä½¿ç”¨</h1><p>ä¸Šé¢è¯´çš„å¯èƒ½æ¯”è¾ƒæŠ½è±¡ï¼Œä¸‹é¢å°†ç»“åˆä¾‹å­è¯´æ˜ä¸‹åœ¨Androidä¸­çš„è¿ç”¨ã€‚</p><p>è¿™ç§æœºåˆ¶åœ¨ä½¿ç”¨èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•,ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li><p>å®šä¹‰æ¥å£å’Œæ¥å£çš„å®ç°ç±»</p></li><li><p>åˆ›å»ºresources/META-INF/servicesç›®å½•</p></li><li><p>åœ¨ä¸Šè¿°Serviceç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªä»¥æ¥å£å(ç±»çš„å…¨å) å‘½åçš„æ–‡ä»¶, å…¶å†…å®¹æ˜¯å®ç°ç±»çš„ç±»å (ç±»çš„å…¨å)ã€‚</p></li></ul><blockquote><p>åœ¨servicesç›®å½•ä¸‹åˆ›å»ºçš„æ–‡ä»¶æ˜¯com.binglumeng.spidemo.IService æ–‡ä»¶ä¸­çš„å†…å®¹ä¸ºAnimalæ¥å£çš„å®ç°ç±», å¯èƒ½æ˜¯com.binglumeng.spidemo.AService</p></blockquote><ul><li>åœ¨javaä»£ç ä¸­ä½¿ç”¨ServcieLoaderæ¥åŠ¨æ€åŠ è½½å¹¶è°ƒç”¨å†…éƒ¨æ–¹æ³•.</li></ul><p>ä¸»å·¥ç¨‹å’Œç»„ä»¶ä¹‹é—´ä¸€äº›â€œæœåŠ¡â€çš„é…ç½®</p><p><img src="http://p927u2n0k.bkt.clouddn.com/spiblog-%20%E6%A8%A1%E5%9D%97%E4%BE%9D%E8%B5%96.png" alt="ç¤ºæ„å›¾"></p><h2 id="å®šä¹‰æ¥å£"><a href="#å®šä¹‰æ¥å£" class="headerlink" title="å®šä¹‰æ¥å£"></a>å®šä¹‰æ¥å£</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IDisplay</span> </span>&#123;</span><br><span class="line">    <span class="function">String <span class="title">display</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸»å·¥ç¨‹å’Œbdisplay æ¨¡å—ä¸­çš„å®ç°è¯¥æ¥å£</p><h2 id="åˆ›å»ºspiæè¿°æ–‡ä»¶"><a href="#åˆ›å»ºspiæè¿°æ–‡ä»¶" class="headerlink" title="åˆ›å»ºspiæè¿°æ–‡ä»¶"></a>åˆ›å»ºspiæè¿°æ–‡ä»¶</h2><p>åœ¨å·¥ç¨‹çš„mainç›®å½•ä¸‹æ–°å»ºç›®å½•resources/META-INF/servicesï¼Œ<code>ä»¥æœåŠ¡æ¥å£åä¸ºæ–‡ä»¶åæ–°å»ºspiæè¿°æ–‡ä»¶ï¼Œå†…å®¹ä¸ºå…·ä½“çš„æœåŠ¡å®ç°ç±»æƒé™å®šåï¼Œå¯ä»¥æœ‰å¤šä¸ª</code></p><p>æ–‡ä»¶ç»“æ„å¦‚ä¸‹</p><p><img src="http://p927u2n0k.bkt.clouddn.com/1528702141671.jpg" alt="æ–‡ä»¶ç»“æ„"></p><h2 id="åŠ è½½ä¸åŒæœåŠ¡"><a href="#åŠ è½½ä¸åŒæœåŠ¡" class="headerlink" title="åŠ è½½ä¸åŒæœåŠ¡"></a>åŠ è½½ä¸åŒæœåŠ¡</h2><p>é€šè¿‡ServiceLoaderæ¥åŠ è½½æ¥å£çš„ä¸åŒå®ç°ç±»ï¼Œç„¶åä¼šå¾—åˆ°è¿­ä»£å™¨ï¼Œåœ¨è¿­ä»£å™¨ä¸­å¯ä»¥æ‹¿åˆ°ä¸åŒå®ç°ç±»å…¨é™å®šåï¼Œç„¶åé€šè¿‡åå°„åŠ¨æ€åŠ è½½å®ä¾‹å°±å¯ä»¥è°ƒç”¨displayæ–¹æ³•äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ServiceLoader&lt;Display&gt; loader = ServiceLoader.load(IDisplay.class);</span><br><span class="line">mIterator =loader.iterator(); </span><br><span class="line"><span class="keyword">while</span>(mIterator.hasNext())&#123;</span><br><span class="line">    mIterator.next().display();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h1><p>æ„Ÿè§‰æœ‰ç‚¹å¾ˆç¥å¥‡</p><blockquote><p>ServiceLoader<display> loader = ServiceLoader.load(Display.class);</display></p></blockquote><p>å°±å¯ä»¥æ‹¿åˆ°<code>Display.class</code>æ¥å£çš„æ‰€æœ‰å®ç°ç±»äº†, amazingï¼(æ„Ÿè§‰è¿™é‡Œè·ŸRetriftä½¿ç”¨æœ‰ç‚¹ç±»ä¼¼)ä¸‹é¢æ¥åˆ†æä¸€ä¸‹è¿™ä¸ªèƒŒååˆ°åº•éšè—äº†ä»€ä¹ˆ</p><p>æ ¸å¿ƒç±» <code>ServiceLoader.java</code></p><p><img src="http://p927u2n0k.bkt.clouddn.com/Blog-ServiceLoader.png" alt="ServiceLoader"></p><p>å…ˆçœ‹ä¸‹å‡ ä¸ªé‡è¦çš„æˆå‘˜å˜é‡</p><ul><li>PREFIXå°±æ˜¯é…ç½®æ–‡ä»¶æ‰€åœ¨çš„åŒ…ç›®å½•è·¯å¾„ï¼›</li><li>serviceå°±æ˜¯æ¥å£åç§°ï¼Œåœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­å°±æ˜¯Displayï¼›</li><li>loaderå°±æ˜¯ç±»åŠ è½½å™¨ï¼Œå…¶å®æœ€ç»ˆéƒ½æ˜¯é€šè¿‡åå°„åŠ è½½å®ä¾‹ï¼›</li><li>providerså°±æ˜¯ä¸åŒå®ç°ç±»çš„ç¼“å­˜ï¼Œkeyå°±æ˜¯å®ç°ç±»çš„å…¨é™å®šåï¼Œvalueå°±æ˜¯å®ç°ç±»çš„å®ä¾‹</li><li>lookupIteratorå°±æ˜¯å†…éƒ¨ç±»LazyIteratorçš„å®ä¾‹ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String PREFIX = <span class="string">"META-INF/services/"</span>; </span><br><span class="line"><span class="comment">// The class or interface representing the service being loaded </span></span><br><span class="line"><span class="keyword">private</span> Class&lt;S&gt; service; </span><br><span class="line"><span class="comment">// The class loader used to locate, load, and instantiate providers </span></span><br><span class="line"><span class="keyword">private</span> ClassLoader loader; </span><br><span class="line"><span class="comment">// Cached providers, in instantiation order </span></span><br><span class="line"><span class="keyword">private</span> LinkedHashMap&lt;String,S&gt; providers = <span class="keyword">new</span> LinkedHashMap&lt;&gt;(); </span><br><span class="line"><span class="comment">// The current lazy-lookup iterator </span></span><br><span class="line"><span class="keyword">private</span> LazyIterator lookupIterator;</span><br></pre></td></tr></table></figure><p>ä¹‹å‰spiåŠ è½½çš„ä¸‰ä¸ªå…³é”®æ­¥éª¤</p><ul><li>ServiceLoader<display> loader = ServiceLoader.load(IDisplay.class);</display></li><li>mIterator =loader.iterator(); </li><li>while(mIterator.hasNext()){<br>  mIterator.next().display();<br>}</li></ul><h2 id="è·å–å®ç°æ¥å£é›†åˆ"><a href="#è·å–å®ç°æ¥å£é›†åˆ" class="headerlink" title="è·å–å®ç°æ¥å£é›†åˆ"></a>è·å–å®ç°æ¥å£é›†åˆ</h2><p>ServiceLoaderæä¾›äº†ä¸¤ä¸ªé™æ€çš„loadæ–¹æ³•,å¦‚æœæˆ‘ä»¬æ²¡æœ‰ä¼ å…¥ç±»åŠ è½½å™¨ï¼ŒServiceLoaderä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬è·å¾—ä¸€ä¸ªå½“å‰çº¿ç¨‹çš„ç±»åŠ è½½å™¨ï¼Œæœ€ç»ˆéƒ½æ˜¯è°ƒç”¨æ„é€ å‡½æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;S&gt; <span class="function">ServiceLoader&lt;S&gt; <span class="title">load</span><span class="params">(Class&lt;S&gt; service)</span> </span>&#123;</span><br><span class="line">    ClassLoader cl = Thread.currentThread().getContextClassLoader();</span><br><span class="line">    <span class="keyword">return</span> ServiceLoader.load(service, cl);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;S&gt; <span class="function">ServiceLoader&lt;S&gt; <span class="title">load</span><span class="params">(Class&lt;S&gt; service,</span></span></span><br><span class="line"><span class="function"><span class="params">                                            ClassLoader loader)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ServiceLoader&lt;&gt;(service, loader);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„é€ å‡½æ•°ä¸­æœ‰ä¸€ä¸ªé‡è¦çš„å‡½æ•°<code>reload</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reload</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    providers.clear();</span><br><span class="line">    lookupIterator = <span class="keyword">new</span> LazyIterator(service, loader);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="title">LazyIterator</span><span class="params">(Class&lt;S&gt; service, ClassLoader loader)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.service = service;</span><br><span class="line">    <span class="keyword">this</span>.loader = loader;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥çœ‹åˆ°å½“æˆ‘ä»¬load classä¹‹åå¹¶æ²¡æœ‰å¾—åˆ°ä»€ä¹ˆå®ç°ç±»ï¼Œé‚£ä¹ˆåœ¨ä½•æ—¶åŠ è½½çš„å‘¢ï¼Ÿ</p><h2 id="æ‡’åŠ è½½"><a href="#æ‡’åŠ è½½" class="headerlink" title="æ‡’åŠ è½½"></a>æ‡’åŠ è½½</h2><p>é‚£ä¹ˆservice provideråœ¨ä»€ä¹ˆåœ°æ–¹è¿›è¡ŒåŠ è½½ï¼Ÿæˆ‘ä»¬æ¥ç€çœ‹ç¬¬äºŒä¸ªæ­¥éª¤loader.iterator(),</p><ul><li>é¦–å…ˆä¼šåˆ°providersä¸­å»æŸ¥æ‰¾æœ‰æ²¡æœ‰å­˜åœ¨çš„å®ä¾‹ï¼Œæœ‰å°±ç›´æ¥è¿”å›ï¼Œæ²¡æœ‰å†åˆ°LazyIteratorä¸­æŸ¥æ‰¾</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Iterator&lt;S&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Iterator&lt;S&gt;() &#123;</span><br><span class="line"></span><br><span class="line">        Iterator&lt;Map.Entry&lt;String,S&gt;&gt; knownProviders</span><br><span class="line">            = providers.entrySet().iterator();</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (knownProviders.hasNext())</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            <span class="keyword">return</span> lookupIterator.hasNext();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> S <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (knownProviders.hasNext())</span><br><span class="line">                <span class="keyword">return</span> knownProviders.next().getValue();</span><br><span class="line">            <span class="keyword">return</span> lookupIterator.next();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®å°±æ˜¯è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ã€‚æˆ‘ä»¬çœ‹ä¸‹å®˜æ–¹æ–‡æ¡£çš„è§£é‡Š,è¿™ä¸ªå°±æ˜¯æ‡’åŠ è½½å®ç°çš„åœ°æ–¹ï¼Œ<br>ç„¦ç‚¹èšç„¦åœ¨<code>LazyIterator</code>ä¸Š</p><ul><li>hasNext()</li></ul><ol><li>é¦–å…ˆæ‹¿åˆ°é…ç½®æ–‡ä»¶åfullName,æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­æ˜¯com.example.Display</li><li>é€šè¿‡ç±»åŠ è½½å™¨è·å¾—æ‰€æœ‰æ¨¡å—çš„é…ç½®æ–‡ä»¶Enumeration<url> configs configs</url></li><li>ä¾æ¬¡æ‰«ææ¯ä¸ªé…ç½®æ–‡ä»¶çš„å†…å®¹ï¼Œè¿”å›é…ç½®æ–‡ä»¶å†…å®¹Iterator<string> pendingï¼Œæ¯ä¸ªé…ç½®æ–‡ä»¶ä¸­å¯èƒ½æœ‰å¤šä¸ªå®ç°ç±»çš„å…¨é™å®šåï¼Œæ‰€ä»¥pendingä¹Ÿæ˜¯ä¸ªè¿­ä»£å™¨ã€‚</string></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nextName != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (configs == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//é¦–å…ˆæ‹¿åˆ°é…ç½®æ–‡ä»¶åfullName</span></span><br><span class="line">            String fullName = PREFIX + service.getName();</span><br><span class="line">            <span class="keyword">if</span> (loader == <span class="keyword">null</span>)</span><br><span class="line">            configs = ClassLoader.getSystemResources(fullName);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                configs = loader.getResources(fullName);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException x) &#123;</span><br><span class="line">        fail(service, <span class="string">"Error locating configuration files"</span>, x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ((pending == <span class="keyword">null</span>) || !pending.hasNext()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!configs.hasMoreElements()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ä¾æ¬¡æ‰«ææ¯ä¸ªé…ç½®æ–‡ä»¶çš„å†…å®¹ï¼Œè¿”å›é…ç½®æ–‡ä»¶å†…å®¹Iterator&lt;String&gt; pending</span></span><br><span class="line">        pending = parse(service, configs.nextElement());</span><br><span class="line">    &#125;</span><br><span class="line">    nextName = pending.next();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Tips</p></blockquote><p>å…³äº ClassLoader.getSystemResources(fullName)å¯ä»¥æŸ¥é˜…</p><ul><li><a href="http://zyjustin9.iteye.com/blog/2022654" target="_blank" rel="noopener">Javaç›®å½•æ€»ç»“ï¼ˆä¸ƒ.è·¯å¾„çš„è·å–äºŒâ€”â€”ClassLoaderçš„ä½¿ç”¨ï¼‰</a></li><li><a href="https://blog.csdn.net/walkerjong/article/details/13019671" target="_blank" rel="noopener">Class.getResource() å’Œ ClassLoader.getResource() çš„åŒºåˆ«</a></li></ul><ul><li>next()</li></ul><p>åœ¨ä¸Šé¢hasNext()æ–¹æ³•ä¸­æ‹¿åˆ°çš„nextNameå°±æ˜¯å®ç°ç±»çš„å…¨é™å®šåï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å»çœ‹çœ‹å…·ä½“å®ä¾‹åŒ–å·¥ä½œçš„åœ°æ–¹next():</p><ul><li>1.é¦–å…ˆæ ¹æ®nextNameï¼ŒClass.forNameåŠ è½½æ‹¿åˆ°å…·ä½“å®ç°ç±»çš„classå¯¹è±¡</li><li>2.Class.newInstance()å®ä¾‹åŒ–æ‹¿åˆ°å…·ä½“å®ç°ç±»çš„å®ä¾‹å¯¹è±¡</li><li>3.å°†å®ä¾‹å¯¹è±¡è½¬æ¢service.castä¸ºæ¥å£</li><li>4.å°†å®ä¾‹å¯¹è±¡æ”¾åˆ°ç¼“å­˜ä¸­ï¼Œproviders.put(cn, p)ï¼Œkeyå°±æ˜¯å®ç°ç±»çš„å…¨é™å®šåï¼Œvalueæ˜¯å®ä¾‹å¯¹è±¡ã€‚</li><li>5.è¿”å›å®ä¾‹å¯¹è±¡</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> S <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!hasNext()) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">    &#125;</span><br><span class="line">    String cn = nextName;</span><br><span class="line">    nextName = <span class="keyword">null</span>;</span><br><span class="line">    Class&lt;?&gt; c = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//é¦–å…ˆæ ¹æ®nextNameï¼ŒClass.forNameåŠ è½½æ‹¿åˆ°å…·ä½“å®ç°ç±»çš„classå¯¹è±¡</span></span><br><span class="line">        c = Class.forName(cn, <span class="keyword">false</span>, loader);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException x) &#123;</span><br><span class="line">        fail(service,</span><br><span class="line">             <span class="string">"Provider "</span> + cn + <span class="string">" not found"</span>, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!service.isAssignableFrom(c)) &#123;</span><br><span class="line">        ClassCastException cce = <span class="keyword">new</span> ClassCastException(</span><br><span class="line">                service.getCanonicalName() + <span class="string">" is not assignable from "</span> + c.getCanonicalName());</span><br><span class="line">        fail(service,</span><br><span class="line">             <span class="string">"Provider "</span> + cn  + <span class="string">" not a subtype"</span>, cce);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//å°†å®ä¾‹å¯¹è±¡è½¬æ¢service.castä¸ºæ¥å£</span></span><br><span class="line">        S p = service.cast(c.newInstance());</span><br><span class="line">        <span class="comment">//å°†å®ä¾‹å¯¹è±¡æ”¾åˆ°ç¼“å­˜ä¸­ï¼Œproviders.put(cn, p)ï¼Œkeyå°±æ˜¯å®ç°ç±»çš„å…¨é™å®šåï¼Œvalueæ˜¯å®ä¾‹å¯¹è±¡</span></span><br><span class="line">        providers.put(cn, p);</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable x) &#123;</span><br><span class="line">        fail(service,</span><br><span class="line">        <span class="string">"Provider "</span> + cn + <span class="string">" could not be instantiated: "</span> + x, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> Error();          <span class="comment">// This cannot happen</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>Spiçš„ä¼˜ç¼ºç‚¹</p><ul><li>ä¼˜ç‚¹</li></ul><p>åªæä¾›æœåŠ¡æ¥å£ï¼Œå…·ä½“æœåŠ¡ç”±å…¶ä»–ç»„ä»¶å®ç°ï¼Œæ¥å£å’Œå…·ä½“å®ç°åˆ†ç¦»ï¼ŒåŒæ—¶èƒ½å¤Ÿé€šè¿‡ç³»ç»Ÿçš„ServiceLoaderæ‹¿åˆ°è¿™äº›å®ç°ç±»çš„é›†åˆï¼Œç»Ÿä¸€å¤„ç†ã€‚</p><ul><li>ç¼ºç‚¹</li></ul><ol><li>Javaä¸­SPIæ˜¯éšjarå‘å¸ƒçš„ï¼Œæ¯ä¸ªä¸åŒçš„jaréƒ½å¯ä»¥åŒ…å«ä¸€ç³»åˆ—çš„SPIé…ç½®ï¼Œè€ŒAndroidå¹³å°ä¸Šï¼Œåº”ç”¨åœ¨æ„å»ºçš„æ—¶å€™æœ€ç»ˆä¼šå°†æ‰€æœ‰çš„jaråˆå¹¶ï¼Œè¿™æ ·å¾ˆå®¹æ˜“é€ æˆç›¸åŒçš„SPIå†²çªï¼Œå¸¸è§çš„é—®é¢˜æ˜¯DuplicatedZipEntryExceptionå¼‚å¸¸</li><li>è¯»å–SPIé…ç½®ä¿¡æ¯æ˜¯åœ¨è¿è¡Œæ—¶ä»jaråŒ…ä¸­è¯»å–ï¼Œç”±äºapkæ˜¯ç­¾è¿‡åçš„ï¼Œåœ¨ä»jarä¸­è¯»å–çš„æ—¶å€™ï¼Œç­¾åæ ¡éªŒçš„è€—æ—¶é—®é¢˜ä¼šé€ æˆæ€§èƒ½æŸå¤±</li></ol><h1 id="åç»­å¯ä»¥æ”¹è¿›çš„ç‚¹"><a href="#åç»­å¯ä»¥æ”¹è¿›çš„ç‚¹" class="headerlink" title="åç»­å¯ä»¥æ”¹è¿›çš„ç‚¹"></a>åç»­å¯ä»¥æ”¹è¿›çš„ç‚¹</h1><p>Javaä¸­ä½¿ç”¨ServiceLoaderå»è¯»å–SPIé…ç½®ä¿¡æ¯æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªè¯»å–é…ç½®ä¿¡æ¯æå‰ï¼Œåœ¨ç¼–è¯‘æ—¶å€™å°±æå®šï¼Œé€šè¿‡gradleæ’ä»¶ï¼Œå»æ‰«æclassæ–‡ä»¶ï¼Œæ‰¾åˆ°å…·ä½“çš„æœåŠ¡ç±»ï¼ˆå¯ä»¥é€šè¿‡æ ‡æ³¨æ¥ç¡®å®šï¼‰ï¼Œç„¶åç”Ÿæˆæ–°çš„javaæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸­åŒ…å«äº†å…·ä½“çš„å®ç°ç±»ã€‚è¿™æ ·ç¨‹åºåœ¨è¿è¡Œæ—¶ï¼Œå°±å·²ç»çŸ¥é“äº†æ‰€æœ‰çš„å…·ä½“æœåŠ¡ç±»ï¼Œç¼ºç‚¹å°±æ˜¯ç¼–è¯‘æ—¶é—´ä¼šåŠ é•¿ï¼Œè‡ªå·±éœ€è¦é‡æ–°å†™ä¸€å¥—è¯»å–SPIä¿¡æ¯ã€ç”Ÿæˆjavaæ–‡ä»¶ç­‰é€»è¾‘ã€‚</p><p>ç»è¿‡ä¼˜åŒ–åï¼ŒSPIå·²ç»åç¦»äº†åŸæœ¬çš„åˆè¡·ï¼Œä½†æ˜¯å¯ä»¥åšæ›´å¤šçš„äº‹ï¼Œå¯ä»¥å°†ä¸šåŠ¡æœåŠ¡åˆ†ç¦»ï¼Œé€šè¿‡SPIæ‰¾åˆ°ä¸šåŠ¡æœåŠ¡å…¥å£ï¼Œä¸šåŠ¡ç»„ä»¶åŒ–ï¼ŒæŠ½æˆå•ç‹¬çš„aarï¼Œç‹¬ç«‹æˆå·¥ç¨‹ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h1 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;ä»€ä¹ˆæ˜¯spi&lt;/li&gt;
&lt;/
      
    
    </summary>
    
      <category term="spi" scheme="https://xsfelvis.github.io/categories/spi/"/>
    
    
      <category term="spi" scheme="https://xsfelvis.github.io/tags/spi/"/>
    
  </entry>
  
  <entry>
    <title>Gradleåœ¨Androidä¸­çš„å¸¸ç”¨ç‚¹</title>
    <link href="https://xsfelvis.github.io/2018/06/10/Gradle%E5%9C%A8Android%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%82%B9/"/>
    <id>https://xsfelvis.github.io/2018/06/10/Gradleåœ¨Androidä¸­å¸¸ç”¨ç‚¹/</id>
    <published>2018-06-09T16:00:00.000Z</published>
    <updated>2018-06-10T14:25:59.220Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>æœ¬ç¯‡ä¸»è¦ä»‹ç»Gradleåœ¨Androidå¼€å‘ä¸­çš„ä¸€äº›å¸¸ç”¨çš„æŠ€å·§</p><h1 id="è®¾ç½®ç¼–è¯‘ç±»å‹"><a href="#è®¾ç½®ç¼–è¯‘ç±»å‹" class="headerlink" title="è®¾ç½®ç¼–è¯‘ç±»å‹"></a>è®¾ç½®ç¼–è¯‘ç±»å‹</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">android&#123;</span><br><span class="line"></span><br><span class="line">  buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled <span class="keyword">true</span>  <span class="comment">//æ‰“å¼€æ··æ·†</span></span><br><span class="line">            <span class="function">proguardFiles <span class="title">getDefaultProguardFile</span><span class="params">(<span class="string">'proguard-android.txt'</span>)</span>, 'proguard-rules.pro'</span></span><br><span class="line"><span class="function">        &#125;</span></span><br><span class="line"><span class="function">        debug </span>&#123;</span><br><span class="line">            minifyEnabled <span class="keyword">false</span> <span class="comment">//å…³é—­æ··æ·†</span></span><br><span class="line">            <span class="function">proguardFiles <span class="title">getDefaultProguardFile</span><span class="params">(<span class="string">'proguard-android.txt'</span>)</span>, 'proguard-rules.pro'</span></span><br><span class="line"><span class="function">        &#125;</span></span><br><span class="line"><span class="function">    &#125;</span></span><br><span class="line"><span class="function"> &#125;</span></span><br></pre></td></tr></table></figure><p>é€šå¸¸æˆ‘ä»¬éœ€è¦ç»™QAæ‰“å‡ºä¸€ä¸ªå¸¦è°ƒè¯•åŠŸèƒ½çš„releaseåŒ…ï¼Œè¿™æ—¶å°±å¯ä»¥åœ¨è¿™ä¸ªé‡Œé¢åŠ ä¸Šæ–°çš„type</p><h1 id="productFlavors-å¤šæ¸ é“æ‰“åŒ…"><a href="#productFlavors-å¤šæ¸ é“æ‰“åŒ…" class="headerlink" title="productFlavors å¤šæ¸ é“æ‰“åŒ…"></a>productFlavors å¤šæ¸ é“æ‰“åŒ…</h1><p>AndroidManifest.xml é‡Œè®¾ç½®åŠ¨æ€æ¸ é“å˜é‡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;meta-data</span><br><span class="line">android:name=<span class="string">"UMENG_CHANNEL"</span></span><br><span class="line">android:value=<span class="string">"$&#123;UMENG_CHANNEL_VALUE&#125;"</span>/&gt;</span><br></pre></td></tr></table></figure><p>åœ¨ build.gradle è®¾ç½® productFlavors , è¿™é‡Œå‡å®šæˆ‘ä»¬éœ€è¦æ‰“åŒ…çš„æ¸ é“ä¸ºé…·å®‰å¸‚åœºã€360ã€å°ç±³ã€ç™¾åº¦ã€è±Œè±†èšã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">android &#123;  </span><br><span class="line"></span><br><span class="line">    productFlavors &#123;</span><br><span class="line">        kuan &#123;</span><br><span class="line">            manifestPlaceholders = [UMENG_CHANNEL_VALUE: <span class="string">"kuan"</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        xiaomi &#123;</span><br><span class="line">            manifestPlaceholders = [UMENG_CHANNEL_VALUE: <span class="string">"xiaomi"</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        qh360 &#123;</span><br><span class="line">            manifestPlaceholders = [UMENG_CHANNEL_VALUE: <span class="string">"qh360"</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        baidu &#123;</span><br><span class="line">            manifestPlaceholders = [UMENG_CHANNEL_VALUE: <span class="string">"baidu"</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        wandoujia &#123;</span><br><span class="line">            manifestPlaceholders = [UMENG_CHANNEL_VALUE: <span class="string">"wandoujia"</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ–è€…æ‰¹é‡ä¿®æ”¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">android &#123;  </span><br><span class="line"></span><br><span class="line">    productFlavors &#123;</span><br><span class="line">        kuan &#123;&#125;</span><br><span class="line">        xiaomi &#123;&#125;</span><br><span class="line">        qh360 &#123;&#125;</span><br><span class="line">        baidu &#123;&#125;</span><br><span class="line">        wandoujia &#123;&#125;</span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">    productFlavors.all &#123; </span><br><span class="line">        flavor -&gt; flavor.manifestPlaceholders = [UMENG_CHANNEL_VALUE: name] </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å¤šæ¸ é“è®¾ç½®åŒ…å"><a href="#å¤šæ¸ é“è®¾ç½®åŒ…å" class="headerlink" title="å¤šæ¸ é“è®¾ç½®åŒ…å"></a>å¤šæ¸ é“è®¾ç½®åŒ…å</h1><p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åˆ†æ¸ é“è®¾ç½® applicationId ã€å‹ç›Ÿçš„ appkey ã€å‹ç›Ÿæ¸ é“å·ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">productFlavors &#123;</span><br><span class="line">        google &#123;</span><br><span class="line">            applicationId <span class="string">"com.wifi.cool"</span></span><br><span class="line">            manifestPlaceholders = [                </span><br><span class="line">                    UMENG_APPKEY_VALUE : <span class="string">"456789456789"</span>,</span><br><span class="line">                    UMENG_CHANNEL_VALUE: <span class="string">"google"</span>,            </span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        baidu&#123;</span><br><span class="line">            applicationId <span class="string">'com.wifi.hacker'</span></span><br><span class="line">            manifestPlaceholders = [</span><br><span class="line">                    UMENG_APPKEY_VALUE     : <span class="string">"123456789789"</span>,</span><br><span class="line">                    UMENG_CHANNEL_VALUE    : <span class="string">"baidu"</span>,          </span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h1 id="Signing-ç­¾å"><a href="#Signing-ç­¾å" class="headerlink" title="Signing ç­¾å"></a>Signing ç­¾å</h1><p>åœ¨ android æ ‡ç­¾ä¸‹æ·»åŠ  signingConfigs æ ‡ç­¾ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    signingConfigs &#123;</span><br><span class="line">        config &#123;</span><br><span class="line">            keyAlias <span class="string">'yiba'</span></span><br><span class="line">            keyPassword <span class="string">'123456'</span></span><br><span class="line">            <span class="function">storeFile <span class="title">file</span><span class="params">(<span class="string">'C:/work/Key.jks'</span>)</span></span></span><br><span class="line"><span class="function">            storePassword '1234567'</span></span><br><span class="line"><span class="function">        &#125;</span></span><br><span class="line"><span class="function">    &#125;</span></span><br><span class="line"><span class="function"> &#125;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥åœ¨release å’Œ debugåŒ…ä¸­å®šä¹‰ç­¾å</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    signingConfigs &#123;</span><br><span class="line">        config &#123;</span><br><span class="line">            keyAlias <span class="string">'yiba'</span></span><br><span class="line">            keyPassword <span class="string">'123456'</span></span><br><span class="line">            <span class="function">storeFile <span class="title">file</span><span class="params">(<span class="string">'C:/work/Key.jks'</span>)</span></span></span><br><span class="line"><span class="function">            storePassword '1234567'</span></span><br><span class="line"><span class="function">        &#125;</span></span><br><span class="line"><span class="function">    &#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    buildTypes </span>&#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled <span class="keyword">false</span></span><br><span class="line">            <span class="function">proguardFiles <span class="title">getDefaultProguardFile</span><span class="params">(<span class="string">'proguard-android.txt'</span>)</span>, 'proguard-rules.pro'</span></span><br><span class="line"><span class="function">            signingConfig signingConfigs.config</span></span><br><span class="line"><span class="function">        &#125;</span></span><br><span class="line"><span class="function">        debug </span>&#123;</span><br><span class="line">            minifyEnabled <span class="keyword">false</span></span><br><span class="line">            <span class="function">proguardFiles <span class="title">getDefaultProguardFile</span><span class="params">(<span class="string">'proguard-android.txt'</span>)</span>, 'proguard-rules.pro'</span></span><br><span class="line"><span class="function">            signingConfig signingConfigs.config</span></span><br><span class="line"><span class="function">        &#125;</span></span><br><span class="line"><span class="function">    &#125;</span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure><h1 id="ä¾èµ–ç®¡ç†"><a href="#ä¾èµ–ç®¡ç†" class="headerlink" title="ä¾èµ–ç®¡ç†"></a>ä¾èµ–ç®¡ç†</h1><h2 id="ä¾èµ–jaråŒ…"><a href="#ä¾èµ–jaråŒ…" class="headerlink" title="ä¾èµ–jaråŒ…"></a>ä¾èµ–jaråŒ…</h2><ul><li>1ã€æŠŠ jar åŒ…æ”¾åœ¨ libs ç›®å½•ä¸‹</li><li>2ã€åœ¨ build.gradle ä¸­æ·»åŠ ä¾èµ–</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">   <span class="function">compile <span class="title">files</span><span class="params">(<span class="string">'libs/xxx.jar'</span>)</span></span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="ä¾èµ–aar"><a href="#ä¾èµ–aar" class="headerlink" title="ä¾èµ–aar"></a>ä¾èµ–aar</h2><ul><li>1ã€æŠŠ aar åŒ…æ”¾åˆ° libs ç›®å½•ä¸‹</li><li>2ã€åœ¨ build.gradle ä¸­æ·»åŠ ä¾èµ–</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">repositories &#123;</span><br><span class="line">    flatDir &#123;</span><br><span class="line">        dirs <span class="string">'libs'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    compile(name:<span class="string">'YibaAnalytics-release'</span>, ext:<span class="string">'aar'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦æ˜¯aaréœ€è¦è¢«å¤šä¸ªmoduleä¾èµ–æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¡¹ç›®çš„æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œæ¯”å¦‚å« aar ç›®å½•ï¼Œç„¶åæŠŠæˆ‘ä»¬çš„ aar åŒ…æ”¾è¿›å»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> flatDir &#123;</span><br><span class="line">     dirs <span class="string">'../aar'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ’é™¤ä¾èµ–å…¼å®¹åŒ…"><a href="#æ’é™¤ä¾èµ–å…¼å®¹åŒ…" class="headerlink" title="æ’é™¤ä¾èµ–å…¼å®¹åŒ…"></a>æ’é™¤ä¾èµ–å…¼å®¹åŒ…</h2><p>æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰€ä¾èµ–çš„é¡¹ç›®/æ¨¡å—ä¼šå¼•å…¥å¤šä¸ªä¼ é€’æ€§ä¾èµ–ã€‚è€Œå…¶ä¸­éƒ¨åˆ†çš„ä¼ é€’æ€§ä¾èµ–æˆ‘ä»¬æ˜¯ä¸éœ€è¦çš„ï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨excludeæ’é™¤éƒ¨åˆ†çš„ä¼ é€’æ€§ä¾èµ–ï¼Œå¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">compile(<span class="string">'com.google.firebase:firebase-ads:11.0.4'</span>, &#123;</span><br><span class="line">      exclude group: <span class="string">'com.android.support'</span>   <span class="comment">//æ’é™¤v7 , v4 åŒ…</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="å¼ºåˆ¶ä½¿ç”¨æŒ‡å®šçš„ä¾èµ–ç‰ˆæœ¬"><a href="#å¼ºåˆ¶ä½¿ç”¨æŒ‡å®šçš„ä¾èµ–ç‰ˆæœ¬" class="headerlink" title="å¼ºåˆ¶ä½¿ç”¨æŒ‡å®šçš„ä¾èµ–ç‰ˆæœ¬"></a>å¼ºåˆ¶ä½¿ç”¨æŒ‡å®šçš„ä¾èµ–ç‰ˆæœ¬</h2><p>Gradleé€šè¿‡é€‰æ‹©ä¾èµ–å…³ç³»å›¾ä¸­æ‰¾åˆ°çš„æœ€æ–°ç‰ˆæœ¬æ¥è§£å†³ä»»ä½•ä¾èµ–ç‰ˆæœ¬å†²çªã€‚ å¯æ˜¯æœ‰çš„æ—¶å€™ï¼ŒæŸäº›é¡¹ç›®ä¼šéœ€è¦ä½¿ç”¨ä¸€ä¸ªè¾ƒè€çš„ç‰ˆæœ¬å·ä½œä¸ºä¾èµ–ã€‚è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥å¼ºåˆ¶æŒ‡å®šæŸä¸€ä¸ªç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation <span class="string">'org.apache.httpcomponents:httpclient:4.5.4'</span></span><br><span class="line">    <span class="comment">// å‡è®¾commons-codecçš„æœ€æ–°ç‰ˆæœ¬æ˜¯1.10</span></span><br><span class="line">    implementation(<span class="string">'commons-codec:commons-codec:1.9'</span>) &#123;</span><br><span class="line">        force = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¦æ­¢ä¼ é€’æ€§ä¾èµ–"><a href="#ç¦æ­¢ä¼ é€’æ€§ä¾èµ–" class="headerlink" title="ç¦æ­¢ä¼ é€’æ€§ä¾èµ–"></a>ç¦æ­¢ä¼ é€’æ€§ä¾èµ–</h2><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    implementation(<span class="string">'com.google.guava:guava:23.0'</span>) &#123;</span><br><span class="line">        transitive = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æºç ä¾èµ–"><a href="#æºç ä¾èµ–" class="headerlink" title="æºç ä¾èµ–"></a>æºç ä¾èµ–</h2><p>è¦æ˜¯æˆ‘ä»¬è‡ªå·±å·¥ç¨‹ä¸‹çš„moduleç›´æ¥ä¾èµ–è¿›æ¥å³å¯ï¼Œæœ‰æ—¶å€™éœ€è¦ä»åˆ«çš„è·¯å¾„ä¸‹ä¾èµ–moduleæºç </p><ul><li>1ã€å°†å¯¹åº”çš„åº“çš„æºç downä¸‹æ¥ï¼Œè®°å½•ä¸‹æ”¾ç½®çš„è·¯å¾„</li><li>2ã€åœ¨setting.gradleæ–‡ä»¶ä¸­ï¼Œè¿›è¡Œåº“çš„æºç å¼•å…¥ (è¿™é‡Œä»¥é¡¹ç›®å¤–åŒçº§ç›®å½•)</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//æ–°å¢ä¾èµ–</span></span><br><span class="line">include <span class="string">':outmodule'</span></span><br><span class="line">project(<span class="string">':outmodule'</span>).projectDir = <span class="keyword">new</span> File(settingsDir, <span class="string">'../Sdk/Sdk-Android/product/outmodule'</span>)</span><br></pre></td></tr></table></figure><p>Tipsï¼š</p><p>è‹¥æ˜¯ä¸»å·¥ç¨‹ä½¿ç”¨äº†Flavorè¿™é‡Œä¹Ÿè¦ä½¿ç”¨å¯¹åº”çš„Flavor</p><h2 id="å…¨å±€ç»Ÿä¸€ä¿¡æ¯é…ç½®"><a href="#å…¨å±€ç»Ÿä¸€ä¿¡æ¯é…ç½®" class="headerlink" title="å…¨å±€ç»Ÿä¸€ä¿¡æ¯é…ç½®"></a>å…¨å±€ç»Ÿä¸€ä¿¡æ¯é…ç½®</h2><p>æœ‰æ—¶å€™å¤šä¸ªmoudleéœ€è¦ä¾èµ–ä¸åŒçš„ç‰ˆæœ¬ï¼Œæœ‰æ—¶å€™å°±ä¼šå‡ºç°ä¸€äº›ç¼–è¯‘å¼‚å¸¸ï¼Œè€Œä¸”é›¶æ•£çš„ç‰ˆæœ¬å·ä¹Ÿæ˜¯ä¸å¥½ç®¡ç†çš„ï¼Œå¦‚ï¼šcompileSdkVersionã€buildToolsVersionã€androidTestCompile ç­‰ã€‚</p><h3 id="åˆ†ç±»å±æ€§é…ç½®"><a href="#åˆ†ç±»å±æ€§é…ç½®" class="headerlink" title="åˆ†ç±»å±æ€§é…ç½®"></a>åˆ†ç±»å±æ€§é…ç½®</h3><ul><li>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªgradleé…ç½®æ–‡ä»¶config.gradleï¼Œé¡¹ç›®ä¸­æ‰€æœ‰çš„ä¾èµ–åªè¦åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ç»Ÿä¸€é…ç½®å³å¯ã€‚æ ¼å¼å¦‚ä¸‹(å†…å®¹æ ¹æ®éœ€è¦è¿›è¡Œä¿®æ”¹)ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ext &#123;</span><br><span class="line">    </span><br><span class="line">    compileSdkVersion: <span class="number">24</span>,</span><br><span class="line">    buildToolsVersion: <span class="string">"24.0.2"</span>,</span><br><span class="line">    applicationId    : <span class="string">"com.carme.carmerchant"</span>,</span><br><span class="line">    minSdkVersion    : <span class="number">15</span>,</span><br><span class="line">    targetSdkVersion : <span class="number">22</span>,</span><br><span class="line">    versionCode      : <span class="number">3</span>,</span><br><span class="line">    versionName      : <span class="string">"1.0.3"</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    dependencies = [</span><br><span class="line">            <span class="string">"test"</span>                  : <span class="string">"junit:junit:4.12"</span>,</span><br><span class="line">            <span class="string">"appcompat-v7"</span>          : <span class="string">"com.android.support:appcompat-v7:25.0.0"</span>,</span><br><span class="line">            <span class="string">"support-v4"</span>            : <span class="string">"com.android.support:support-v4:25.0.0"</span>,</span><br><span class="line">            <span class="string">"support_design"</span>        : <span class="string">"com.android.support:design:25.0.0"</span>,</span><br><span class="line">            <span class="string">"rxjava"</span>                : <span class="string">"io.reactivex:rxjava:1.2.0"</span>,</span><br><span class="line">            <span class="string">"rxandroid"</span>             : <span class="string">"io.reactivex:rxandroid:1.2.1"</span>,</span><br><span class="line">            <span class="string">"retrofit"</span>              : <span class="string">"com.squareup.retrofit2:retrofit:2.1.0"</span>,</span><br><span class="line">            <span class="string">"converter-gson"</span>        : <span class="string">"com.squareup.retrofit2:converter-gson:2.1.0"</span>,</span><br><span class="line">            <span class="string">"adapter-rxjava"</span>        : <span class="string">"com.squareup.retrofit2:adapter-rxjava:2.1.0"</span>,</span><br><span class="line">            <span class="string">"multidex"</span>              : <span class="string">"com.android.support:multidex:1.0.1"</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å…¶æ¬¡åœ¨æ ¹ç›®å½•çš„build.gradleæ–‡ä»¶ä¸­æ·»åŠ å†…å®¹ï¼ˆapply from:â€config.gradleâ€ï¼‰ï¼Œæ‰€æœ‰çš„moduleéƒ½å¯ä»¥ä»è¿™ä¸ªï¼ˆconfig.gradleï¼‰é…ç½®æ–‡ä»¶é‡Œè¯»å–å…¬å…±å‚æ•°ã€‚</li><li>åœ¨å„ä¸ªmoduleç›®å½•ä¸‹çš„build.gradleæ–‡ä»¶ä¸­ä½¿ç”¨å¦‚ä¸‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">android &#123;  </span><br><span class="line">      compileSdkVersion rootProject .ext.android.compileSdkVersion</span><br><span class="line">      buildToolsVersion rootProject .ext.android.buildToolsVersion</span><br><span class="line">      defaultConfig &#123;</span><br><span class="line">          applicationId rootProject .ext.android.applicationId</span><br><span class="line">          minSdkVersion rootProject .ext.android.minSdkVersion</span><br><span class="line">          targetSdkVersion rootProject .ext.android.targetSdkVersion</span><br><span class="line">          versionCode rootProject .ext.android.versionCode</span><br><span class="line">          versionName rootProject .ext.android.versionName</span><br><span class="line">      &#125;</span><br><span class="line">      ...</span><br><span class="line">      &#125;  </span><br><span class="line">      dependencies &#123;</span><br><span class="line">          ...</span><br><span class="line">          compile rootProject .ext.dependencies[ <span class="string">"design"</span>]</span><br><span class="line">          compile rootProject .ext.dependencies[ <span class="string">"appcompat-v7"</span>]</span><br><span class="line">          compile rootProject .ext.dependencies[ <span class="string">"recyclerview-v7"</span>]</span><br><span class="line">          ...</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><h1 id="ä¾èµ–å…³ç³»è§£æ"><a href="#ä¾èµ–å…³ç³»è§£æ" class="headerlink" title="ä¾èµ–å…³ç³»è§£æ"></a>ä¾èµ–å…³ç³»è§£æ</h1><h2 id="ä½¿ç”¨ä¾èµ–å…³ç³»è§£æè§„åˆ™"><a href="#ä½¿ç”¨ä¾èµ–å…³ç³»è§£æè§„åˆ™" class="headerlink" title="ä½¿ç”¨ä¾èµ–å…³ç³»è§£æè§„åˆ™"></a>ä½¿ç”¨ä¾èµ–å…³ç³»è§£æè§„åˆ™</h2><p>ä¾èµ–å…³ç³»è§£æè§„åˆ™æä¾›äº†ä¸€ç§éå¸¸å¼ºå¤§çš„æ–¹æ³•æ¥æ§åˆ¶ä¾èµ–å…³ç³»è§£æè¿‡ç¨‹ï¼Œå¹¶å¯ç”¨äºå®ç°ä¾èµ–ç®¡ç†ä¸­çš„å„ç§é«˜çº§æ¨¡å¼ã€‚æ¯”å¦‚ï¼š</p><ul><li>ç»Ÿä¸€æ„ä»¶ç»„çš„ç‰ˆæœ¬</li></ul><p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¾èµ–ä¸€ä¸ªå…¬å¸çš„åº“ä¼šåŒ…å«å¤šä¸ªmoduleï¼Œè¿™äº›moduleä¸€èˆ¬éƒ½æ˜¯ç»Ÿä¸€æ„å»ºã€æ‰“åŒ…å’Œå‘å¸ƒçš„ï¼Œå…·å¤‡ç›¸åŒçš„ç‰ˆæœ¬å·ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶ä¾èµ–å…³ç³»çš„è§£æè¿‡ç¨‹åšåˆ°ç‰ˆæœ¬å·ç»Ÿä¸€ã€‚</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">configurations.all &#123;</span><br><span class="line">    resolutionStrategy.eachDependency &#123; DependencyResolveDetails details -&gt;</span><br><span class="line">    <span class="keyword">if</span> (details.requested.group == <span class="string">'org.gradle'</span>) &#123;</span><br><span class="line">        details.useVersion <span class="string">'1.4'</span></span><br><span class="line">        details.because <span class="string">'API breakage in higher versions'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¤„ç†è‡ªå®šä¹‰çš„ç‰ˆæœ¬scheme</li></ul><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">configurations.all &#123;</span><br><span class="line">    resolutionStrategy.eachDependency &#123; DependencyResolveDetails details -&gt;</span><br><span class="line">        <span class="keyword">if</span> (details.requested.version == <span class="string">'default'</span>) &#123;</span><br><span class="line">            <span class="keyword">def</span> version = findDefaultVersionInCatalog(details.requested.group, details.requested.name)</span><br><span class="line">            details.useVersion version.version</span><br><span class="line">            details.because version.because</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> findDefaultVersionInCatalog(String group, String name) &#123;</span><br><span class="line">    <span class="comment">//some custom logic that resolves the default version into a specific version</span></span><br><span class="line">    [<span class="string">version:</span> <span class="string">"1.0"</span>, <span class="string">because:</span> <span class="string">'tested by QA'</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³äºæ›´å¤šä¾èµ–å…³ç³»è§£æè§„åˆ™çš„ä½¿ç”¨å®ä¾‹å¯ä»¥å‚è€ƒgradleçš„APIä¸­çš„ <a href="https://docs.gradle.org/current/dsl/org.gradle.api.artifacts.ResolutionStrategy.html" target="_blank" rel="noopener">ResolutionStrategy</a></p><ul><li>ä½¿ç”¨ä¾èµ–å…³ç³»çš„æ›¿ä»£è§„åˆ™</li></ul><p>ä¾èµ–å…³ç³»çš„æ›¿æ¢è§„åˆ™å’Œä¸Šé¢çš„ä¾èµ–å…³ç³»è§£æè§„åˆ™æœ‰ç‚¹ç›¸ä¼¼ã€‚å®é™…ä¸Šï¼Œä¾èµ–å…³ç³»è§£æè§„åˆ™çš„è®¸å¤šåŠŸèƒ½å¯ä»¥é€šè¿‡ä¾èµ–å…³ç³»æ›¿æ¢è§„åˆ™æ¥å®ç°ã€‚ä¾èµ–å…³ç³»çš„æ›¿æ¢è§„åˆ™å…è®¸é¡¹ç›®ä¾èµ–ï¼ˆProject Dependencyï¼‰å’Œæ¨¡å—ä¾èµ–ï¼ˆModule Dependencyï¼‰è¢«æŒ‡å®šçš„æ›¿æ¢è§„åˆ™é€æ˜åœ°æ›¿æ¢ã€‚</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨é¡¹ç›®ä¾èµ–æ›¿æ¢æ¨¡å—ä¾èµ–</span></span><br><span class="line">configurations.all &#123;</span><br><span class="line">    resolutionStrategy.dependencySubstitution &#123;</span><br><span class="line">        substitute module(<span class="string">"org.utils:api"</span>) with project(<span class="string">":api"</span>) because <span class="string">"we work with the unreleased development version"</span></span><br><span class="line">        substitute module(<span class="string">"org.utils:util:2.5"</span>) with project(<span class="string">":util"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä½¿ç”¨æ¨¡å—ä¾èµ–æ›¿æ¢é¡¹ç›®ä¾èµ–</span></span><br><span class="line">configurations.all &#123;</span><br><span class="line">    resolutionStrategy.dependencySubstitution &#123;</span><br><span class="line">        substitute project(<span class="string">":api"</span>) with module(<span class="string">"org.utils:api:1.3"</span>) because <span class="string">"we use a stable version of utils"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ›´å¤šå¯ä»¥æŸ¥çœ‹å®˜æ–¹çš„æ–‡æ¡£<a href="https://docs.gradle.org/current/userguide/customizing_dependency_resolution_behavior.html#sec:dependency_substitution_rules" target="_blank" rel="noopener">Customizing Dependency Resolution Behavior</a></p><h1 id="SourceSet"><a href="#SourceSet" class="headerlink" title="SourceSet"></a>SourceSet</h1><p>SourceSet å¯ä»¥å®šä¹‰é¡¹ç›®ç»“æ„ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹é¡¹ç›®ç»“æ„ã€‚Javaæ’ä»¶é»˜è®¤å®ç°äº†ä¸¤ä¸ªSourceSetï¼Œmain å’Œ testã€‚æ¯ä¸ª SourceSet éƒ½æä¾›äº†ä¸€ç³»åˆ—çš„å±æ€§ï¼Œé€šè¿‡è¿™äº›å±æ€§ï¼Œå¯ä»¥å®šä¹‰è¯¥ SourceSet æ‰€åŒ…å«çš„æºæ–‡ä»¶ã€‚æ¯”å¦‚ï¼Œjava.srcDirsï¼Œresources.srcDirs ã€‚Java æ’ä»¶ä¸­å®šä¹‰çš„å…¶ä»–ä»»åŠ¡ï¼Œå°±æ ¹æ® main å’Œ test çš„è¿™ä¸¤ä¸ª SourceSet çš„å®šä¹‰æ¥å¯»æ‰¾äº§å“ä»£ç å’Œæµ‹è¯•ä»£ç ç­‰ã€‚</p><h2 id="SourceSet-å®šä¹‰æºç ç›®å½•"><a href="#SourceSet-å®šä¹‰æºç ç›®å½•" class="headerlink" title="SourceSet å®šä¹‰æºç ç›®å½•"></a>SourceSet å®šä¹‰æºç ç›®å½•</h2><p>åœ¨ Android é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ src/main/java ç›®å½•æ–°å»º Java æ–‡ä»¶ï¼Œç°åœ¨æˆ‘ä»¬åœ¨srcç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªtestç›®å½•ï¼Œå‘ç°ä¸èƒ½åœ¨è¯¥ç›®å½•ä¸‹æ–°å»ºjavaæ–‡ä»¶ï¼Œè¿™æ˜¯ç”±äºåœ¨ Gradle ä¸­ SourceSet é»˜è®¤å®šä¹‰çš„æºç æ–‡ä»¶è·¯å¾„æ˜¯src/main/java , å…¶ä»–çš„æ–‡ä»¶ä¸‹ä¸‹é¢çš„æºç æˆ‘ä»¬è‡ªç„¶æ— æ³•è®¿é—®ã€‚è§£å†³è¿™ä¸ªé—®é¢˜ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ SourceSet ä¸­å¢åŠ ä¸€ä¸ªæºç è·¯å¾„å³å¯ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line"></span><br><span class="line">    sourceSets &#123;</span><br><span class="line">        main &#123;</span><br><span class="line">            java &#123;</span><br><span class="line">                srcDir <span class="string">'src/test1'</span> <span class="comment">//æŒ‡å®šæºç ç›®</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æˆ–è€…æŒ‰ç…§å¦‚ä¸‹çš„æ–¹å¼å†™ä¹Ÿå¯ä»¥</span></span><br><span class="line">            <span class="comment">//java.srcDirs( 'src/test1' , 'src/test2' ,'src/test3' )</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="SourceSet-å®šä¹‰èµ„æºç›®å½•"><a href="#SourceSet-å®šä¹‰èµ„æºç›®å½•" class="headerlink" title="SourceSet å®šä¹‰èµ„æºç›®å½•"></a>SourceSet å®šä¹‰èµ„æºç›®å½•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line"></span><br><span class="line">    sourceSets &#123;</span><br><span class="line">        main &#123;</span><br><span class="line">            java.srcDirs(<span class="string">'src/test1/java'</span>)  <span class="comment">//å®šä¹‰java æºä»£ç </span></span><br><span class="line">            res.srcDirs(<span class="string">'src/test1/res'</span>)    <span class="comment">//å®šä¹‰èµ„æºç›®å½•ï¼ˆlayout , drawable,valuesï¼‰</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="SourceSet-å®ç°-layout-åˆ†åŒ…"><a href="#SourceSet-å®ç°-layout-åˆ†åŒ…" class="headerlink" title="SourceSet å®ç° layout åˆ†åŒ…"></a>SourceSet å®ç° layout åˆ†åŒ…</h2><p>å¯¹äºä¸€ä¸ªå¤§é¡¹ç›®æ¥è¯´ï¼Œé¡µé¢å¤ªå¤šï¼Œå¸ƒå±€æ–‡ä»¶å°±å¾ˆå¤šï¼Œæœ‰æ—¶åœ¨ä¼—å¤šå¸ƒå±€æ–‡ä»¶ä¸­æ‰¾æŸä¸ªæ¨¡å—çš„å¸ƒå±€æ–‡ä»¶ï¼Œå¾ˆæ˜¯ç—›è‹¦ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»ºå¤šä¸ª layout ç›®å½•ï¼Œä¸åŒæ¨¡å—çš„å¸ƒå±€æ–‡ä»¶æ”¾åœ¨ä¸åŒçš„ layout ç›®å½•ä¸­ï¼Œè¿™æ ·æŸ¥æ‰¾èµ·æ¥ï¼Œå°±å®¹æ˜“å¾ˆå¤šã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line"></span><br><span class="line">    sourceSets &#123;</span><br><span class="line">        main &#123;</span><br><span class="line">            res.srcDirs <span class="string">'src/main/res/layouts/login'</span>  <span class="comment">//å®šä¹‰ç™»å½•å¸ƒå±€ç›®å½•</span></span><br><span class="line">            res.srcDirs <span class="string">'src/main/res/layouts/register'</span>  <span class="comment">//å®šä¹‰æ³¨å†Œå¸ƒå±€ç›®å½•</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="SourceSet-å®šä¹‰-AndroidManifest-æ–‡ä»¶"><a href="#SourceSet-å®šä¹‰-AndroidManifest-æ–‡ä»¶" class="headerlink" title="SourceSet å®šä¹‰ AndroidManifest æ–‡ä»¶"></a>SourceSet å®šä¹‰ AndroidManifest æ–‡ä»¶</h2><p>åœ¨ç»„ä»¶åŒ–å¼€å‘ä¸­, æˆ‘ä»¬éœ€è¦é’ˆå¯¹ debug ä¸ release æ¨¡å¼ä¸‹, æŒ‡å®šä¸åŒçš„ Manifest æ–‡ä»¶, ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    def appDebug = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled <span class="keyword">false</span></span><br><span class="line">            <span class="function">proguardFiles <span class="title">getDefaultProguardFile</span><span class="params">(<span class="string">'proguard-android.txt'</span>)</span>, 'proguard-rules.pro'</span></span><br><span class="line"><span class="function">            appDebug </span>= <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        debug &#123;</span><br><span class="line">            minifyEnabled <span class="keyword">false</span></span><br><span class="line">            <span class="function">proguardFiles <span class="title">getDefaultProguardFile</span><span class="params">(<span class="string">'proguard-android.txt'</span>)</span>, 'proguard-rules.pro'</span></span><br><span class="line"><span class="function">            appDebug </span>= <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sourceSets &#123;</span><br><span class="line">        main &#123;</span><br><span class="line">            <span class="keyword">if</span> (appDebug) &#123;</span><br><span class="line">                manifest.srcFile <span class="string">'src/test1/AndroidManifest.xml'</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                manifest.srcFile <span class="string">'src/main/AndroidManifest.xml'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="buildConfigFieldè‡ªå®šä¹‰é…ç½®"><a href="#buildConfigFieldè‡ªå®šä¹‰é…ç½®" class="headerlink" title="buildConfigFieldè‡ªå®šä¹‰é…ç½®"></a>buildConfigFieldè‡ªå®šä¹‰é…ç½®</h1><p>å®é™…å¼€å‘ä¸­æœåŠ¡å™¨å¯èƒ½æœ‰æ­£å¼ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒï¼Œgradleå¯ä»¥é€šè¿‡buildConfigFieldæ¥é…ç½®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">sdkA &#123;</span><br><span class="line">            buildConfigField â€˜Stringâ€™, â€˜API_HOSTâ€™, <span class="string">"\"http:api.test.com\""</span><span class="comment">//API Host</span></span><br><span class="line">            buildConfigField <span class="string">'String'</span>,   <span class="string">'LANG'</span>, <span class="string">'"en-US"'</span></span><br><span class="line">            buildConfigField <span class="string">'String'</span>,   <span class="string">'MAP'</span>, <span class="string">'"google"'</span></span><br><span class="line">            buildConfigField <span class="string">'String'</span>,   <span class="string">'COORDINATE_SYSTEM'</span>, <span class="string">'"WGS_84"'</span></span><br><span class="line">            buildConfigField <span class="string">'int'</span>,      <span class="string">'COORDINATE_TYPE'</span>, <span class="string">'4'</span></span><br><span class="line">            buildConfigField <span class="string">'String[]'</span>, <span class="string">'SUPPORTED_LANGS'</span>, <span class="string">'&#123;LANG&#125;'</span></span><br><span class="line">            buildConfigField <span class="string">'String'</span>,   <span class="string">'CONSUMER_HOTLINE'</span>, </span><br><span class="line">            dimension <span class="string">"lang"</span></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>ç„¶åé€šè¿‡BuildConfigå¯ä»¥è·å–è¿™äº›å±æ€§ï¼Œä»è€Œåšäº›å·®å¼‚åŒ–çš„é…ç½®ç­‰ç­‰</p><h1 id="æ‰“åŒ…æ›´æ”¹åŒ…å"><a href="#æ‰“åŒ…æ›´æ”¹åŒ…å" class="headerlink" title="æ‰“åŒ…æ›´æ”¹åŒ…å"></a>æ‰“åŒ…æ›´æ”¹åŒ…å</h1><p>é¡¹ç›®çš„build.gradle</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line"> â€¦â€¦</span><br><span class="line"><span class="comment">//æ‰“åŒ…å‘½å</span></span><br><span class="line">    applicationVariants.all &#123;</span><br><span class="line">        variant -&gt;</span><br><span class="line">            variant.outputs.each &#123;</span><br><span class="line">                output -&gt;</span><br><span class="line">                    <span class="keyword">if</span> (variant.buildType.name == <span class="string">'release'</span>) &#123;</span><br><span class="line">                        variant.mergedFlavor.versionCode = getVersionCode(<span class="keyword">false</span>)</span><br><span class="line">                        variant.mergedFlavor.versionName = getVersionName(<span class="keyword">false</span>)</span><br><span class="line">                        <span class="comment">// release</span></span><br><span class="line">                        def apkName = <span class="string">"$&#123;project.getName()&#125;_$&#123;variant.flavorName&#125;_$&#123;buildType.name&#125;_v$&#123;variant.versionCode&#125;.apk"</span>;</span><br><span class="line">                        output.outputFile = <span class="keyword">new</span> File(output.outputFile.parent, apkName);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        variant.mergedFlavor.versionCode = getVersionCode(<span class="keyword">true</span>)</span><br><span class="line">                        variant.mergedFlavor.versionName = getVersionName(<span class="keyword">true</span>)</span><br><span class="line">                        <span class="comment">// debug</span></span><br><span class="line">                        def apkName = <span class="string">"$&#123;project.getName()&#125;_$&#123;buildType.name&#125;.apk"</span>;</span><br><span class="line">                        output.outputFile = <span class="keyword">new</span> File(output.outputFile.parent, apkName);</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– version code</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> def <span class="title">getVersionCode</span><span class="params">(<span class="keyword">boolean</span> isDebug)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isDebug) &#123;</span><br><span class="line">        <span class="keyword">return</span> Integer.parseInt(<span class="keyword">new</span> Date().format(<span class="string">"yyMMddHHmm"</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> getRevisionNumber()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å– version name</span></span><br><span class="line"><span class="function">def <span class="title">getVersionName</span><span class="params">(<span class="keyword">boolean</span> isDebug)</span> </span>&#123;</span><br><span class="line">    String version = appConfig.appmajor +</span><br><span class="line">            <span class="string">'.'</span> + appConfig.appminor +</span><br><span class="line">            <span class="string">'.'</span> + getRevisionNumber()</span><br><span class="line">    String today = <span class="keyword">new</span> Date().format(<span class="string">'yyMMdd'</span>)</span><br><span class="line">    String time = <span class="keyword">new</span> Date().format(<span class="string">'HHmmss'</span>)</span><br><span class="line">    <span class="keyword">if</span> (isDebug) &#123;</span><br><span class="line">        <span class="keyword">return</span> version + <span class="string">".$today.$time."</span> + getRevisionDescription()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> version + <span class="string">".$today."</span> + getRevisionDescription()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ul><li><a href="https://blog.csdn.net/zhaoyanjun6/article/details/77678577#buildtypes-%E5%AE%9A%E4%B9%89%E4%BA%86%E7%BC%96%E8%AF%91%E7%B1%BB%E5%9E%8B" target="_blank" rel="noopener">https://blog.csdn.net/zhaoyanjun6/article/details/77678577#buildtypes-%E5%AE%9A%E4%B9%89%E4%BA%86%E7%BC%96%E8%AF%91%E7%B1%BB%E5%9E%8B</a></li><li><a href="https://juejin.im/post/5b000522f265da0b7f44d1c7" target="_blank" rel="noopener">https://juejin.im/post/5b000522f265da0b7f44d1c7</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h1 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h1&gt;&lt;p&gt;æœ¬ç¯‡ä¸»è¦ä»‹ç»Gradleåœ¨Android
      
    
    </summary>
    
      <category term="Gradle" scheme="https://xsfelvis.github.io/categories/Gradle/"/>
    
    
      <category term="Gradle" scheme="https://xsfelvis.github.io/tags/Gradle/"/>
    
  </entry>
  
  <entry>
    <title>Gradleå­¦ä¹ ä¹‹åŸºæœ¬åŸç†</title>
    <link href="https://xsfelvis.github.io/2018/06/10/Gradle%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/"/>
    <id>https://xsfelvis.github.io/2018/06/10/GradleåŸºæœ¬åŸç†/</id>
    <published>2018-06-09T16:00:00.000Z</published>
    <updated>2018-06-10T12:18:25.403Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>Gradleæ˜¯ä¸€ä¸ªåŸºäºJVMçš„æ„å»ºå·¥å…·ï¼Œç›®å‰Android Studioä¸­å»ºç«‹çš„å·¥ç¨‹éƒ½æ˜¯åŸºäºgradleè¿›è¡Œæ„å»ºçš„ï¼ŒGradleæ¡†æ¶æ˜¯ä½¿ç”¨Groovyè¯­è¨€å®ç°çš„ï¼Œå…³äºGroovyè¯­è¨€çš„å­¦ä¹ å°†ä¸å†èµ˜è¿°å¯ä»¥å‚è€ƒ(<a href="https://www.ibm.com/developerworks/cn/education/java/j-groovy/j-groovy.html" target="_blank" rel="noopener">ç²¾é€šGroovy</a>),ç›®å‰å¾ˆå¤šæŠ€æœ¯é¢†åŸŸå¼€å§‹ä½¿ç”¨Gradleçš„pluginï¼Œæ¯”å¦‚æ¨¡å—åŒ–ã€çƒ­ä¿®å¤ã€SPIçš„ä¼˜åŒ–ç­‰ç­‰ã€‚</p><h1 id="ä¸¤ä¸ªæœ€é‡è¦çš„æ¦‚å¿µ-Projetcå’ŒTasks"><a href="#ä¸¤ä¸ªæœ€é‡è¦çš„æ¦‚å¿µ-Projetcå’ŒTasks" class="headerlink" title="ä¸¤ä¸ªæœ€é‡è¦çš„æ¦‚å¿µ Projetcå’ŒTasks"></a>ä¸¤ä¸ªæœ€é‡è¦çš„æ¦‚å¿µ Projetcå’ŒTasks</h1><p>è¿™æ˜¯Gradleä¸­æœ€é‡è¦çš„ä¸¤ä¸ªæ¦‚å¿µ,æ¯æ¬¡æ„å»ºè‡³å°‘ç”±ä¸€ä¸ªprojectæ„æˆï¼Œä¸€ä¸ªprojectç”±ä¸€åˆ°å¤šä¸ªtaskæ„æˆã€‚<code>é¡¹ç›®ç»“æ„ä¸­çš„æ¯ä¸ªbuild.gradleæ–‡ä»¶ä»£è¡¨ä¸€ä¸ªproject</code>ï¼Œåœ¨è¿™ç¼–è¯‘è„šæœ¬æ–‡ä»¶ä¸­å¯ä»¥å®šä¹‰ä¸€ç³»åˆ—çš„taskï¼›task æœ¬è´¨ä¸Šåˆæ˜¯ç”±ä¸€ç»„è¢«é¡ºåºæ‰§è¡Œçš„<code>Action</code>å¯¹è±¡æ„æˆï¼ŒActionå…¶å®æ˜¯ä¸€æ®µä»£ç å—ï¼Œç±»ä¼¼äºJavaä¸­çš„æ–¹æ³•ã€‚</p><h1 id="Gradle-æ„å»ºç”Ÿå‘½å‘¨æœŸ"><a href="#Gradle-æ„å»ºç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Gradle æ„å»ºç”Ÿå‘½å‘¨æœŸ"></a>Gradle æ„å»ºç”Ÿå‘½å‘¨æœŸ</h1><h2 id="ä¸‰ä¸ªé˜¶æ®µ"><a href="#ä¸‰ä¸ªé˜¶æ®µ" class="headerlink" title="ä¸‰ä¸ªé˜¶æ®µ"></a>ä¸‰ä¸ªé˜¶æ®µ</h2><p>æ¯æ¬¡æ„å»ºçš„æ‰§è¡Œæœ¬è´¨ä¸Šæ˜¯æ‰§è¡Œä¸€ç³»åˆ—çš„taskï¼Œå¹¶ä¸”æŸäº›taskè¿˜éœ€è¦ä¾èµ–å…¶ä»–taskï¼Œè¿™äº›taskçš„ä¾èµ–å…³ç³»éƒ½æ˜¯åœ¨æ„å»ºé˜¶æ®µç¡®å®šçš„ã€‚æ¯æ¬¡æ„å»ºåˆ†ä¸º3ä¸ªé˜¶æ®µ(<a href="https://docs.gradle.org/current/userguide/build_lifecycle.html#sec:build_phases" target="_blank" rel="noopener">Build phases æ–‡æ¡£ </a>)</p><ul><li>Initialization: åˆå§‹åŒ–é˜¶æ®µ</li></ul><p>è¿™æ˜¯åˆ›å»ºProjecté˜¶æ®µï¼Œæ„å»ºå·¥å…·æ ¹æ®æ¯ä¸ªbuild.gradleæ–‡ä»¶åˆ›å»ºå‡ºä¸€ä¸ªProjectå®ä¾‹ã€‚åˆå§‹åŒ–é˜¶æ®µä¼šæ‰§è¡Œé¡¹ç›®æ ¹ç›®å½•ä¸‹çš„settings.gradleæ–‡ä»¶ï¼Œæ¥åˆ†æå“ªäº›é¡¹ç›®å‚ä¸æ„å»ºã€‚</p><ul><li>Configuration:é…ç½®é˜¶æ®µ</li></ul><p>è¿™ä¸ªé˜¶æ®µï¼Œé€šè¿‡æ‰§è¡Œæ„å»ºè„šæœ¬æ¥ä¸ºæ¯ä¸ªprojectåˆ›å»ºå¹¶é…ç½®Taskã€‚é…ç½®é˜¶æ®µä¼šå»åŠ è½½æ‰€æœ‰å‚ä¸æ„å»ºçš„é¡¹ç›®çš„build.gradleæ–‡ä»¶ï¼Œä¼šå°†æ¯ä¸ªbuild.gradleæ–‡ä»¶å®ä¾‹åŒ–ä¸ºä¸€ä¸ªGradleçš„projectå¯¹è±¡ã€‚ç„¶ååˆ†æprojectä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä¸‹è½½ä¾èµ–æ–‡ä»¶ï¼Œåˆ†æprojectä¸‹çš„taskä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</p><ul><li>Execution:æ‰§è¡Œé˜¶æ®µ</li></ul><p>è¿™æ˜¯TaskçœŸæ­£è¢«æ‰§è¡Œçš„é˜¶æ®µï¼ŒGradleä¼šæ ¹æ®ä¾èµ–å…³ç³»å†³å®šå“ªäº›Taskéœ€è¦è¢«æ‰§è¡Œï¼Œä»¥åŠæ‰§è¡Œçš„å…ˆåé¡ºåºã€‚taskæ˜¯Gradleä¸­çš„æœ€å°æ‰§è¡Œå•å…ƒï¼Œæˆ‘ä»¬æ‰€æœ‰çš„æ„å»ºï¼Œç¼–è¯‘ï¼Œæ‰“åŒ…ï¼Œdebugï¼Œtestç­‰éƒ½æ˜¯æ‰§è¡Œäº†æŸä¸€ä¸ªtaskï¼Œä¸€ä¸ªprojectå¯ä»¥æœ‰å¤šä¸ªtaskï¼Œtaskä¹‹é—´å¯ä»¥äº’ç›¸ä¾èµ–ã€‚ä¾‹å¦‚æˆ‘æœ‰ä¸¤ä¸ªtaskï¼ŒtaskAå’ŒtaskBï¼ŒæŒ‡å®štaskAä¾èµ–taskBï¼Œç„¶åæ‰§è¡ŒtaskAï¼Œè¿™æ—¶ä¼šå…ˆå»æ‰§è¡ŒtaskBï¼ŒtaskBæ‰§è¡Œå®Œæ¯•ååœ¨æ‰§è¡ŒtaskAã€‚åœ¨ASå³ä¾§çš„GradleæŒ‰é’®ä¸­å¯ä»¥çœ‹åˆ°è¿™ä¸€äº›åˆ—çš„task</p><h2 id="ç›‘å¬ç”Ÿå‘½å‘¨æœŸ"><a href="#ç›‘å¬ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç›‘å¬ç”Ÿå‘½å‘¨æœŸ"></a>ç›‘å¬ç”Ÿå‘½å‘¨æœŸ</h2><p>åœ¨gradleçš„æ„å»ºè¿‡ç¨‹ä¸­ï¼Œgradleä¸ºæˆ‘ä»¬æä¾›äº†é’©å­ï¼Œå¸®åŠ©æˆ‘ä»¬é’ˆå¯¹é¡¹ç›®çš„éœ€æ±‚å®šåˆ¶æ„å»ºçš„é€»è¾‘ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://user-gold-cdn.xitu.io/2018/5/19/163781a2edc24703?imageslim" alt="ç›‘å¬ç”Ÿå‘½å‘¨æœŸ"></p><p>è¦ç›‘å¬è¿™äº›ç”Ÿå‘½å‘¨æœŸï¼Œä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>æ·»åŠ ç›‘å¬å™¨</li><li>ä½¿ç”¨é’©å­çš„é…ç½®å—</li></ul><p>å…³äºå¯ç”¨çš„é’©å­å¯ä»¥å‚è€ƒGradleå’ŒProjectä¸­çš„å®šä¹‰ï¼Œå¸¸ç”¨çš„é’©å­åŒ…æ‹¬ï¼š</p><blockquote><p>Gradle</p></blockquote><ul><li>beforeProject()/afterProject()<br>ç­‰åŒäºProjectä¸­çš„beforeEvaluateå’ŒafterEvaluate</li></ul><ul><li>settingsEvaluated()<br>settingsè„šæœ¬è¢«æ‰§è¡Œå®Œæ¯•ï¼ŒSettingså¯¹è±¡é…ç½®å®Œæ¯•</li></ul><ul><li>projectsLoaded()<br>æ‰€æœ‰å‚ä¸æ„å»ºçš„é¡¹ç›®éƒ½ä»settingsä¸­åˆ›å»ºå®Œæ¯•</li></ul><ul><li>projectsEvaluated()<br>æ‰€æœ‰å‚ä¸æ„å»ºçš„é¡¹ç›®éƒ½å·²ç»è¢«è¯„ä¼°å®Œ</li></ul><blockquote><p>TaskExecutionGraph</p></blockquote><ul><li>whenReadyï¼ˆï¼‰<br>taskå›¾ç”Ÿæˆã€‚æ‰€æœ‰éœ€è¦è¢«æ‰§è¡Œçš„taskå·²ç»taskä¹‹é—´çš„ä¾èµ–å…³ç³»éƒ½å·²ç»ç¡®ç«‹</li></ul><blockquote><p>Project</p></blockquote><ul><li>beforeEvaluateï¼ˆï¼‰</li><li>afterEvaluateï¼ˆï¼‰</li></ul><h1 id="ä¸‰ä¸ªé‡è¦çš„gradleæ–‡ä»¶"><a href="#ä¸‰ä¸ªé‡è¦çš„gradleæ–‡ä»¶" class="headerlink" title="ä¸‰ä¸ªé‡è¦çš„gradleæ–‡ä»¶"></a>ä¸‰ä¸ªé‡è¦çš„gradleæ–‡ä»¶</h1><p>Gradleé¡¹ç›®æœ‰3ä¸ªé‡è¦çš„æ–‡ä»¶éœ€è¦æ·±å…¥ç†è§£ï¼š</p><ul><li>é¡¹ç›®æ ¹ç›®å½•çš„ build.gradle </li></ul><p>é¡¹ç›®æ ¹ç›®å½•çš„ build.gradle æ–‡ä»¶ç”¨æ¥é…ç½®é’ˆå¯¹æ‰€æœ‰æ¨¡å—çš„ä¸€äº›å±æ€§ã€‚å®ƒé»˜è®¤åŒ…å«2ä¸ªä»£ç å—ï¼šbuildscript{â€¦}å’Œallprojects{â€¦}ã€‚å‰è€…ç”¨äºé…ç½®æ„å»ºè„šæœ¬æ‰€ç”¨åˆ°çš„ä»£ç åº“å’Œä¾èµ–å…³ç³»ï¼Œåè€…ç”¨äºå®šä¹‰æ‰€æœ‰æ¨¡å—éœ€è¦ç”¨åˆ°çš„ä¸€äº›å…¬å…±å±æ€§</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">buildscript &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath <span class="string">'com.android.tools.build:gradle:2.3.2'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">allprojects &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">task <span class="title">clean</span><span class="params">(type: Delete)</span> </span>&#123;</span><br><span class="line">    delete rootProject.buildDir</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>settings.gradle </li></ul><p>settings.gradle æ–‡ä»¶ä¼šåœ¨æ„å»ºçš„ initialization é˜¶æ®µè¢«æ‰§è¡Œï¼Œå®ƒç”¨äºå‘Šè¯‰æ„å»ºç³»ç»Ÿå“ªäº›æ¨¡å—éœ€è¦åŒ…å«åˆ°æ„å»ºè¿‡ç¨‹ä¸­ã€‚å¯¹äºå•æ¨¡å—é¡¹ç›®ï¼Œ settings.gradle æ–‡ä»¶ä¸æ˜¯å¿…éœ€çš„ã€‚å¯¹äºå¤šæ¨¡å—é¡¹ç›®ï¼Œå¦‚æœæ²¡æœ‰è¯¥æ–‡ä»¶ï¼Œæ„å»ºç³»ç»Ÿå°±ä¸èƒ½çŸ¥é“è¯¥ç”¨åˆ°å“ªäº›æ¨¡å—ã€‚</p><ul><li>æ¨¡å—ç›®å½•çš„ build.gradle</li></ul><p>æ¨¡å—çº§é…ç½®æ–‡ä»¶ build.gradle é’ˆå¯¹æ¯ä¸ªmoudle çš„é…ç½®ï¼Œå¦‚æœè¿™é‡Œçš„å®šä¹‰çš„é€‰é¡¹å’Œé¡¶å±‚ build.gradleå®šä¹‰çš„ç›¸åŒã€‚å®ƒæœ‰3ä¸ªé‡è¦çš„ä»£ç å—ï¼špluginï¼Œandroid å’Œ dependenciesã€‚</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ul><li><a href="https://blog.csdn.net/zhaoyanjun6/article/details/77678577#android-gradle-%E7%9A%84-project-%E5%92%8C-tasks" target="_blank" rel="noopener">https://blog.csdn.net/zhaoyanjun6/article/details/77678577#android-gradle-%E7%9A%84-project-%E5%92%8C-tasks</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h1 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h1&gt;&lt;p&gt;Gradleæ˜¯ä¸€ä¸ªåŸºäºJVMçš„æ„å»ºå·¥å…·ï¼Œ
      
    
    </summary>
    
      <category term="Gradle" scheme="https://xsfelvis.github.io/categories/Gradle/"/>
    
    
      <category term="Gradle" scheme="https://xsfelvis.github.io/tags/Gradle/"/>
    
  </entry>
  
  <entry>
    <title>Writing Custom Plugins[è¯‘]</title>
    <link href="https://xsfelvis.github.io/2018/06/09/%E8%AF%91%E6%96%87_Writing%20Custom%20Plugins/"/>
    <id>https://xsfelvis.github.io/2018/06/09/è¯‘æ–‡_Writing Custom Plugins/</id>
    <published>2018-06-08T16:00:00.000Z</published>
    <updated>2018-06-09T13:28:47.469Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h1 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h1><p>Packaging a plugin<br>Writing a simple plugin<br>Making the plugin configurable<br>Working with files in custom tasks and plugins<br>Mapping extension properties to task properties<br>A standalone project<br>Providing a configuration DSL for the plugin</p><p>ä¸€ä¸ªGradle æ’ä»¶å¯ä»¥å°†buildé€»è¾‘çš„å¤ç”¨ç‰‡æ®µæ‰“åŒ…åœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»–ä»¬åº”ç”¨åœ¨ä¸åŒçš„é¡¹ç›®ä¹‹ä¸­ã€‚Gradle å…è®¸æˆ‘ä»¬å®ç°æˆ‘ä»¬è‡ªå®šä¹‰çš„æ’ä»¶ï¼Œå› æ­¤ä½ å¯å¯ä»¥å¤ç”¨ä½ çš„buildé€»è¾‘å¹¶ä¸”åˆ†äº«ç»™å…¶ä»–äºº</p><p>ç†è®ºä¸Šä½ å¯ä»¥ä½¿ç”¨ä½ å–œæ¬¢çš„ä»»ä½•è¯­è¨€å®ç°ä¸€ä¸ªGradle æ’ä»¶ï¼Œå‰æå®ƒä»¬å¯ä»¥æœ€åç¼–è¯‘ä¸ºå­—èŠ‚ç ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨Groovyä½œä¸ºå®ç°è¯­è¨€ã€‚Groovyï¼ŒJavaæˆ–è€…Kotlinéƒ½æ˜¯å®ç°æ’ä»¶è¯­è¨€çš„å¥½çš„é€‰æ‹©ï¼ŒGradle API å·²ç»è¢«è®¾è®¡çš„å¯ä»¥å¾ˆå¥½åœ°å…¼å®¹è¿™äº›è¯­è¨€çš„ã€‚æ€»çš„æ¥è¯´ï¼Œä¸€ä¸ªç”±Javaæˆ–è€…Kotlinå®ç°çš„æ’ä»¶ï¼Œå°†æ¯”Groovyå®ç°çš„æ›´åŠ é€šä¿—æ˜“æ‡‚,</p><h1 id="Packaging-a-plugin"><a href="#Packaging-a-plugin" class="headerlink" title="Packaging a plugin"></a>Packaging a plugin</h1><p>ä»¥ä¸‹çš„ä¸€äº›åœ°æ–¹å¯ä»¥é˜²æ­¢æ’ä»¶çš„ä»£ç </p><h2 id="Build-script"><a href="#Build-script" class="headerlink" title="Build script"></a>Build script</h2><p>ä½ å¯ä»¥ç›´æ¥åœ¨build scriptä¸­ç›´æ¥åŒ…å«æ’ä»¶æºç ï¼Œè¿™ç§åšæ³•æœ‰ä¸ªä¼˜åŠ¿å°±æ˜¯å¯ä»¥è‡ªåŠ¨çš„ç¼–è¯‘ï¼Œå¹¶ä¸”æ·»åŠ åˆ°build scriptçš„classpathä¸­ã€‚ç„¶åï¼Œè¿™ä¸ªæ’ä»¶åœ¨å¤–éƒ¨ä¸å¯è§ï¼Œå› æ­¤ä½ ä¸èƒ½åœ¨è¯¥buildä¹‹å¤–å¤ç”¨è¿™ä¸ªæ’ä»¶</p><h2 id="buildSrc-project"><a href="#buildSrc-project" class="headerlink" title="buildSrc project"></a>buildSrc project</h2><p>ä½ å¯ä»¥æŠŠæ’ä»¶ä»£ç æ”¾åœ¨<code>rootProjectDir/buildSrc/src/main/groovy</code>ç›®å½•ä¸‹,Gradleå°†å¤„ç†å¥½ç¼–è¯‘å’Œæµ‹è¯•æ’ä»¶ï¼Œå¹¶ä¸”è®©å®ƒåœ¨build scriptçš„è·¯å¾„ä¸‹å¯ç”¨ã€‚è¿™ä¸ªæ’ä»¶åœ¨å½“å‰é¡¹ç›®buildå†…çš„build scriptä¸­éƒ½æ˜¯å¯è§çš„ï¼Œç„¶è€Œåœ¨å…¶ä»–é¡¹ç›®ä¸­buildä¸­è¿˜æ˜¯ä¸å¯è§çš„ï¼Œå› æ­¤ä½ è¿˜æ˜¯ä¸èƒ½åœ¨æœ¬é¡¹ç›®ä¹‹å¤–çš„å¤ç”¨è¯¥æ’ä»¶</p><p>ä½ å¯åœ¨å‚è€ƒ <a href="https://docs.gradle.org/current/userguide/organizing_gradle_projects.html" target="_blank" rel="noopener">Organizing Gradle Project</a>äº†è§£æ›´å¤š buildSrc é¡¹ç›®ä½¿ç”¨çš„ç»†èŠ‚</p><h2 id="Standalone-project"><a href="#Standalone-project" class="headerlink" title="Standalone project"></a>Standalone project</h2><p>ä½ å¯ä»¥ä¸ºä½ çš„æ’ä»¶åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„å·¥ç¨‹ã€‚è¿™ä¸ªå·¥ç¨‹å¯ä»¥åˆ›å»ºå’Œå‘å¸ƒJARæ–‡ä»¶ï¼Œè¿™ä¸ªjiaæ–‡ä»¶å¯ä»¥åœ¨å¤šä¸ªé¡¹ç›®çš„buildä¸­è¢«ä½¿ç”¨ï¼Œæ€»è€Œè¨€ä¹‹ï¼Œè¿™ä¸ªjaræ–‡ä»¶å¯ä»¥åŒ…å«ä¸€äº›æ’ä»¶ï¼Œæˆ–è€…ç»‘å®šä¸€äº›ç›¸å…³çš„task</p><p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­,ä¸ºäº†ä½¿å¾—äº‹æƒ…æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬å°†åœ¨build scriptä½¿ç”¨æ’ä»¶ï¼Œï¼Œç„¶åæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åˆ›å»ºä¸€ä¸ªstandalone projectçš„æ’ä»¶</p><h1 id="Writing-a-simple-plugin"><a href="#Writing-a-simple-plugin" class="headerlink" title="Writing a simple plugin"></a>Writing a simple plugin</h1><p>åˆ›å»ºä¸€ä¸ªGradleæ’ä»¶ï¼Œé¦–å…ˆéœ€è¦å®ç°<code>Plugin</code>æ¥å£ï¼Œå®ç°<code>Plugin.apply(T)</code>æ–¹æ³•ã€‚å…¶ä¸­projectå¯¹è±¡ä½œä¸ºä¸€ä¸ªå‚æ•°ï¼Œè¿™æ ·æ’ä»¶å°±å¯ä»¥é…ç½®å®ƒã€‚ä¸‹é¢çš„é£é©¬åŒ…å«äº†ä¸€ä¸ªhello worldæ’ä»¶ï¼Œç»™projectæ·»åŠ äº†ä¸€ä¸ª<code>hello</code>task</p><p><strong>Example: A custom plugin</strong><br><em>build.gradle</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GreetingPlugin</span> <span class="keyword">implements</span> <span class="title">Plugin</span>&lt;<span class="title">Project</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">apply</span><span class="params">(Project project)</span> </span>&#123;</span><br><span class="line">        project.task(<span class="string">'hello'</span>) &#123;</span><br><span class="line">            doLast &#123;</span><br><span class="line">                println <span class="string">'Hello from the GreetingPlugin'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Apply the plugin</span></span><br><span class="line">apply plugin: GreetingPlugin</span><br></pre></td></tr></table></figure><p><strong>Output of gradle -q hello</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt; gradle -q hello</span><br><span class="line">Hello from the GreetingPlugin</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦æ˜ç™½çš„æ˜¯ä¸€ä¸ªæ’ä»¶æ˜¯åœ¨è¢«åº”ç”¨è¿›çš„projetcæ¥åˆ›å»ºæ’ä»¶çš„å®ä¾‹ï¼Œä¹Ÿéœ€è¦æ˜ç™½æ’ä»¶æ˜¯ä¸€ä¸ªæ³›å‹ã€‚åœ¨ä¸Šé¢ä¾‹å­é‡Œï¼Œæ¥å—ä¸€ä¸ªProjectç±»å‹ä½œä¸ºä¸€ä¸ªå‚æ•°ã€‚ä¸€ä¸ªæ’ä»¶ä¹Ÿå¯ä¸€ä»¶æ¥å—<code>Setting</code>ç±»å‹çš„å‚æ•°ï¼Œè¿™ç§æ’ä»¶æˆ‘ä»¬å¯ä»¥æŠŠå®ƒåº”ç”¨åˆ°settin scriptè„šæœ¬ä¸­;æˆ–è€…æ¥å—<code>Gradle</code>ç±»å‹çš„æ’ä»¶å‚æ•°,è¿™ç§æ’ä»¶æˆ‘ä»¬å¯ä»¥åº”ç”¨åˆ°scriptè„šæœ¬åˆå§‹åŒ–ä¸­</p><h1 id="Making-the-plugin-configurable"><a href="#Making-the-plugin-configurable" class="headerlink" title="Making the plugin configurable"></a>Making the plugin configurable</h1><p>å¤§å¤šæ•°æ’ä»¶éœ€è¦ä»build scriptä¸­è·å–ä¸€äº›é…ç½®ï¼Œä¸€ç§æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨<code>extension objects</code>. Gradle <code>Project</code>å’Œ<code>ExtensionContainer</code>å¯¹è±¡å…·æœ‰è”ç³»ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«äº†è¿™ä¸ªæ’ä»¶åº”ç”¨åˆ°projectçš„settingå’Œå±æ€§ã€‚ä½ å¯ä»¥é€šè¿‡æ·»åŠ æ‰©å±•å¯¹è±¡åˆ°è¿™ä¸ªå®¹å™¨æ¥ç»™ä½ çš„æ’ä»¶æä¾›é…ç½®ã€‚ä¸€ä¸ªæ‰©å±•å¯¹è±¡å°±æ˜¯ä¸€ä¸ªç®€å•çš„Java Beanå…¼å®¹ç±»ã€‚Groovyæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è¯­è¨€é€‰æ‹©ï¼Œæ˜¯å®ç°æ¥æ‰©å±•å¯¹è±¡ï¼Œè¿™æ˜¯ç”±äºæ™®é€šè€çš„Groovyå¯¹è±¡åŒ…å«äº†æ‰€æœ‰çš„setterå’Œgetteræ–¹æ³•ï¼Œå½“ç„¶Javaå’ŒKotlinä¹Ÿæ˜¯å…¶ä»–å¥½çš„é€‰æ‹©.</p><p>è®©æˆ‘ä»¬ç»™projectæ·»åŠ ä¸€ä¸ªç®€å•çš„æ‰©å±•å¯¹è±¡ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ç»™projectæ·»åŠ ä¸€ä¸ª<code>greeting</code>æ‰©å±•å¯¹è±¡ã€‚</p><p><strong>Example: A custom plugin extension</strong></p><p><em>build.gradle</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GreetingPluginExtension</span> </span>&#123;</span><br><span class="line">    String message = <span class="string">'Hello from GreetingPlugin'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GreetingPlugin</span> <span class="keyword">implements</span> <span class="title">Plugin</span>&lt;<span class="title">Project</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">apply</span><span class="params">(Project project)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Add the 'greeting' extension object</span></span><br><span class="line">        def extension = project.extensions.create(<span class="string">'greeting'</span>, GreetingPluginExtension)</span><br><span class="line">        <span class="comment">// Add a task that uses configuration from the extension object</span></span><br><span class="line">        project.task(<span class="string">'hello'</span>) &#123;</span><br><span class="line">            doLast &#123;</span><br><span class="line">                println extension.message</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">apply plugin: GreetingPlugin</span><br><span class="line"></span><br><span class="line"><span class="comment">// Configure the extension</span></span><br><span class="line">greeting.message = <span class="string">'Hi from Gradle'</span></span><br></pre></td></tr></table></figure><p><em>Output of gradle -q hello</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; gradle -q hello</span><br><span class="line">Hi from Gradle</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­,<code>GreetingPluginExtension</code>æ˜¯ä¸€ä¸ªæ™®é€šçš„æ—§Groovyå¯¹è±¡ï¼Œå®ƒå¸¦æœ‰ä¸€ä¸ªåä¸ºmessageçš„å±æ€§ï¼Œè¿™ä¸ªæ‰©å±•ä»¥<code>greeting</code>çš„åå­—åŠ è½½åˆ°æ’ä»¶åˆ—è¡¨ä¸­ã€‚è¿™ä¸ªå¯¹è±¡ç„¶ååœ¨Projectä¸­å°±å˜å¾—å¯ç”¨</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œä½ éœ€è¦åœ¨ä¸€ä¸ªæ’ä»¶é‡Œé¢é…ç½®å¯¹ä¸ªç›¸å…³å±æ€§ï¼ŒGradleä¸ºæ¯ä¸ªæ‰©å±•å¯¹è±¡æ·»åŠ äº†é—­ç¯é…ç½®å¯¹è±¡ï¼Œå› è€Œä½ å¯ä»¥å°†è¿™äº›è®¾ç½®åˆ†ç»„åœ¨ä¸€èµ·ï¼Œä¸‹é¢çš„ä¾‹å­å°†è¦å‘ä½ å±•ç¤ºè¿ä½œçš„æ–¹å¼</p><p><strong>Example: A custom plugin with configuration closure</strong><br><em>build.gradle</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GreetingPluginExtension</span> </span>&#123;</span><br><span class="line">    String message</span><br><span class="line">    String greeter</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GreetingPlugin</span> <span class="keyword">implements</span> <span class="title">Plugin</span>&lt;<span class="title">Project</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">apply</span><span class="params">(Project project)</span> </span>&#123;</span><br><span class="line">        def extension = project.extensions.create(<span class="string">'greeting'</span>, GreetingPluginExtension)</span><br><span class="line">        project.task(<span class="string">'hello'</span>) &#123;</span><br><span class="line">            doLast &#123;</span><br><span class="line">                println <span class="string">"$&#123;extension.message&#125; from $&#123;extension.greeter&#125;"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">apply plugin: GreetingPlugin</span><br><span class="line"></span><br><span class="line"><span class="comment">// Configure the extension using a DSL block</span></span><br><span class="line">greeting &#123;</span><br><span class="line">    message = <span class="string">'Hi'</span></span><br><span class="line">    greeter = <span class="string">'Gradle'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>Output of gradle -q hello</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; gradle -q hello</span><br><span class="line">Hi from Gradle</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸€äº›è®¾ç½®å¯ä»¥é€šè¿‡<code>greeting</code>é—­åŒ…å½’ä¸ºä¸€ç±»ï¼Œåœ¨build scriptä¸­çš„é—­åŒ…å—nameéœ€è¦å’Œæ‰©å±•å¯¹è±¡åç§°ä¿æŒä¸€è‡´ã€‚ç„¶åå½“é—­åŒ…è¢«æ‰§è¡Œï¼Œåœ¨æ‰©å±•å¯¹è±¡é‡Œé¢çš„å±æ€§å°†é€šè¿‡Groovyé—­åŒ…ä»£ç†çš„ç‰¹æ€§è¢«æ˜ å°„ä¸ºå˜é‡</p><h1 id="Working-with-files-in-custom-tasks-and-plugins"><a href="#Working-with-files-in-custom-tasks-and-plugins" class="headerlink" title="Working with files in custom tasks and plugins"></a>Working with files in custom tasks and plugins</h1><p>å½“æˆ‘ä»¬å¼€å‘è‡ªå®šä¹‰taskå’Œæ’ä»¶çš„æ—¶å€™ï¼Œå½“æ¥å—æ–‡ä»¶ä½ç½®çš„è¾“å…¥é…ç½®æ—¶å€™éœ€è¦ååˆ†çš„çµæ´»ï¼Œè¦åˆ°è¿™ä¸ªç‚¹ï¼Œæ‚¨å¯ä»¥åˆ©ç”¨Project.fileï¼ˆjava.lang.Objectï¼‰æ–¹æ³•å°½å¯èƒ½æ™šåœ°è§£ææ–‡ä»¶çš„å€¼ã€‚</p><p><strong>Example: Evaluating file properties lazily</strong></p><p><em>build.gradle</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GreetingToFileTask</span> <span class="keyword">extends</span> <span class="title">DefaultTask</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    def destination</span><br><span class="line"></span><br><span class="line">    <span class="function">File <span class="title">getDestination</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        project.file(destination)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TaskAction</span></span><br><span class="line">    <span class="function">def <span class="title">greet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        def file = getDestination()</span><br><span class="line">        file.parentFile.mkdirs()</span><br><span class="line">        file.write <span class="string">'Hello!'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">task <span class="title">greet</span><span class="params">(type: GreetingToFileTask)</span> </span>&#123;</span><br><span class="line">    destination = &#123; project.greetingFile &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">task <span class="title">sayGreeting</span><span class="params">(dependsOn: greet)</span> </span>&#123;</span><br><span class="line">    doLast &#123;</span><br><span class="line">        <span class="function">println <span class="title">file</span><span class="params">(greetingFile)</span>.text</span></span><br><span class="line"><span class="function">    &#125;</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">ext.greetingFile </span>= <span class="string">"$buildDir/hello.txt"</span></span><br></pre></td></tr></table></figure><p><em>Output of gradle -q sayGreeting</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; gradle -q sayGreeting</span><br><span class="line">Hello!</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é…ç½®äº†<code>greet</code> Taskçš„<code>destination</code>å±æ€§ä½œä¸ºäº†é—­ç¯ï¼Œå¹¶åœ¨æœ€åè½¬æ¢ä¸ºFileå¯¹è±¡è¿›è¡Œè¯„é€šè¿‡Project.fileï¼ˆjava.lang.Objectï¼‰æ–¹æ³•å¯¹é—­åŒ…çš„è¿”å›å€¼ä¼°ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ä½ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬è®¾ç½®<code>greetingFile</code>å±æ€§ï¼Œåœ¨æˆ‘ä»¬å·²ç»ä¸ºtaské…ç½®å±æ€§ä¹‹åã€‚è¿™ç§evaluationçš„æ‡’åŠ è½½æ˜¯æ–‡ä»¶è®¾ç½®å±æ€§å¯ä»¥æ¥å—ä»»ä½•å€¼çš„ä¸€ä¸ªå…³é”®çš„å¥½å¤„,ç„¶ååœ¨è¯»å–å±æ€§æ—¶è§£æè¯¥å€¼ã€‚</p><h1 id="Mapping-extension-properties-to-task-properties"><a href="#Mapping-extension-properties-to-task-properties" class="headerlink" title="Mapping extension properties to task properties"></a>Mapping extension properties to task properties</h1><p>build scripté€šè¿‡æ‰©å±•è·å–ç”¨æˆ·çš„è¾“å…¥ï¼Œå¹¶ä¸”å°†å®ƒæ˜ å°„åˆ°è¾“å…¥è¾“å‡ºå±æ€§æ˜¯è‡ªå®šä¹‰taskçš„æœ€ä½³å®è·µã€‚æœ€ç»ˆç”¨æˆ·åªéœ€è¦é€šè¿‡æ‰©å±•å®šä¹‰çš„æš´éœ²å‡ºæ¥çš„DSLè¿›è¡Œäº¤äº’å³å¯ã€‚å‘½ä»¤é€»è¾‘éšè—åœ¨æ’ä»¶å®ç°ä¸­ã€‚</p><p>åœ¨build scriptä¸­ç”³æ˜çš„æ‰©å±•ä»¥åŠæ‰©å±•å±æ€§å’Œè‡ªå®šä¹‰ä»»åŠ¡å±æ€§ä¹‹é—´çš„æ˜ å°„å‘ç”Ÿåœ¨æ„å»ºç”Ÿå‘½å‘¨æœŸçš„Gradleé…ç½®é˜¶æ®µã€‚ä¸ºäº†é¿å…evaluationé¡ºåºçš„é—®é¢˜ï¼Œå¿…é¡»åœ¨excutioné˜¶æ®µè§£å†³æ˜ å°„å±æ€§çš„å®é™…å€¼ã€‚ï¼ˆæ›´å¤šä¿¡æ¯è¯·å‚çœ‹ <a href="https://docs.gradle.org/current/userguide/build_lifecycle.html#sec:build_phases" target="_blank" rel="noopener">the section called â€œBuild phasesâ€</a>ï¼‰.Gradleçš„APIæä¾›äº†ç”¨äºè¡¨ç¤ºåº”è¯¥è¿›è¡Œå»¶è¿Ÿevaluateçš„å±æ€§çš„ç±»å‹ï¼Œä¾‹å¦‚åœ¨æ‰§è¡ŒæœŸï¼ˆå‚é˜…<a href="https://docs.gradle.org/current/userguide/lazy_configuration.html" target="_blank" rel="noopener">å»¶è¿Ÿé…ç½®</a>ï¼‰ï¼Œä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†å°†æ‰©å±•å±æ€§æ˜ å°„åˆ°ä»»åŠ¡å±æ€§ç±»å‹çš„ç”¨æ³•</p><p><strong>Example: Mapping extension properties to task properties</strong><br><em>build.gradle</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GreetingPlugin</span> <span class="keyword">implements</span> <span class="title">Plugin</span>&lt;<span class="title">Project</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">apply</span><span class="params">(Project project)</span> </span>&#123;</span><br><span class="line">        def extension = project.extensions.create(<span class="string">'greeting'</span>, GreetingPluginExtension, project)</span><br><span class="line">        project.tasks.create(<span class="string">'hello'</span>, Greeting) &#123;</span><br><span class="line">            message = extension.message</span><br><span class="line">            outputFiles = extension.outputFiles</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GreetingPluginExtension</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Property&lt;String&gt; message</span><br><span class="line">    <span class="keyword">final</span> ConfigurableFileCollection outputFiles</span><br><span class="line"></span><br><span class="line">    GreetingPluginExtension(Project project) &#123;</span><br><span class="line">        message = project.objects.property(String)</span><br><span class="line">        message.set(<span class="string">'Hello from GreetingPlugin'</span>)</span><br><span class="line">        outputFiles = project.layout.configurableFiles()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setOutputFiles</span><span class="params">(FileCollection outputFiles)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.outputFiles.setFrom(outputFiles)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Greeting</span> <span class="keyword">extends</span> <span class="title">DefaultTask</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Property&lt;String&gt; message = project.objects.property(String)</span><br><span class="line">    <span class="keyword">final</span> ConfigurableFileCollection outputFiles = project.layout.configurableFiles()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setOutputFiles</span><span class="params">(FileCollection outputFiles)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.outputFiles.setFrom(outputFiles)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TaskAction</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">printMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        outputFiles.each &#123;</span><br><span class="line">            logger.quiet <span class="string">"Writing message 'Hi from Gradle' to file"</span></span><br><span class="line">            it.text = message.get()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">apply plugin: GreetingPlugin</span><br><span class="line"></span><br><span class="line">greeting &#123;</span><br><span class="line">    message = <span class="string">'Hi from Gradle'</span></span><br><span class="line">    outputFiles = layout.files(<span class="string">'a.txt'</span>, <span class="string">'b.txt'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Note: The code for this example can be found at samples/userguide/tasks/mapExtensionPropertiesToTaskProperties in the â€˜-allâ€™ distribution of Gradle.</p></blockquote><p><em>Output of gradle -q hello</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt; gradle -q hello</span><br><span class="line">Writing message <span class="string">'Hi from Gradle'</span> to file</span><br><span class="line">Writing message <span class="string">'Hi from Gradle'</span> to file</span><br></pre></td></tr></table></figure><h1 id="A-standalone-project"><a href="#A-standalone-project" class="headerlink" title="A standalone project"></a>A standalone project</h1><p>ç°åœ¨ï¼Œæˆ‘ä»¬å°†æŠŠæ’ä»¶ç§»åˆ°ä¸€ä¸ªç‹¬ç«‹çš„projectä¸­ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å‘å¸ƒå¹¶å…¬ç”¨è¿™ä¸ªæ’ä»¶ã€‚è¿™ä¸ªprojectæ˜¯ä¸ªå¯ä»¥ç”ŸæˆåŒ…å«æ’ä»¶classçš„Jaræ–‡ä»¶çš„ç®€å•Groovy Projectã€‚ä¸‹é¢è¿™ä¸ªprojectçš„ç®€å•build scriptï¼Œapplyäº†Groovyæ’ä»¶ï¼Œå¹¶ä¸”æ·»åŠ äº†gradle apiçš„ä¾èµ–</p><p><strong>Example: A build for a custom plugin</strong></p><p><em>build.gradle</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pply plugin: <span class="string">'groovy'</span></span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    <span class="function">compile <span class="title">gradleApi</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    compile <span class="title">localGroovy</span><span class="params">()</span></span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>Note: The code for this example can be found at samples/customPlugin/plugin in the â€˜-allâ€™ distribution of Gradle.</p></blockquote><p>å› æ­¤Gradleå¦‚ä½•å‘ç°å®ç°çš„æ’ä»¶å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä½ éœ€è¦åœ¨<code>META-INF/gradle-plugins</code>ç›®å½•ä¸‹æä¾›ä¸€ä¸ªåŒ¹é…ä½ æ’ä»¶idçš„å±æ€§<br><strong>Example: Wiring for a custom plugin</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- src/main/resources/META-INF/gradle-plugins/org.samples.greeting.properties</span><br><span class="line">  |</span><br><span class="line">  -  implementation-<span class="class"><span class="keyword">class</span></span>=org.gradle.GreetingPlugin</span><br></pre></td></tr></table></figure></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå±æ€§æ–‡ä»¶åä¸æ’ä»¶æ ‡è¯†åŒ¹é…ï¼Œå¹¶æ”¾ç½®åœ¨èµ„æºæ–‡ä»¶å¤¹ä¸­ï¼Œè€Œå®ç°ç±»å±æ€§æ ‡è¯†æ’ä»¶å®ç°ç±»ã€‚</p><h2 id="Creating-a-plugin-id"><a href="#Creating-a-plugin-id" class="headerlink" title="Creating a plugin id"></a>Creating a plugin id</h2><p>æ’ä»¶IDä»¥ç±»ä¼¼äºJavaè½¯ä»¶åŒ…çš„æ–¹å¼è¢«å®Œå…¨é™å®šï¼ˆå³åå‘åŸŸåï¼‰ã€‚è¿™æœ‰åŠ©äºé¿å…å†²çªï¼Œå¹¶æä¾›äº†ä¸€ç§å°†ç±»ä¼¼æ‰€æœ‰æƒçš„æ’ä»¶åˆ†ç»„çš„æ–¹æ³•ã€‚</p><p>æ‚¨çš„æ’ä»¶IDåº”è¯¥æ˜¯åæ˜ åç§°ç©ºé—´çš„ç»„ä»¶çš„ç»„åˆï¼ˆæŒ‡å‘æ‚¨æˆ–æ‚¨çš„ç»„ç»‡çš„åˆç†æŒ‡é’ˆï¼‰ä»¥åŠå®ƒæä¾›çš„æ’ä»¶çš„åç§°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æœ‰ä¸€ä¸ªåä¸ºâ€œfooâ€çš„Githubå¸æˆ·ï¼Œå¹¶ä¸”æ‚¨çš„æ’ä»¶åä¸ºâ€œbarâ€ï¼Œåˆ™åˆé€‚çš„æ’ä»¶IDå¯èƒ½æ˜¯com.github.foo.barã€‚åŒæ ·ï¼Œå¦‚æœæ’ä»¶æ˜¯åœ¨bazç»„ç»‡å¼€å‘çš„ï¼Œæ’ä»¶IDå¯èƒ½æ˜¯org.baz.barã€‚</p><p>æ’ä»¶idåº”è¯¥æŒ‰ç…§ä»¥ä¸‹è§„åˆ™ï¼š</p><ul><li>å¯ä»¥åŒ…å«ä»»ä½•å­—æ¯æ•°å­—å­—ç¬¦ï¼Œâ€™.â€™å’Œâ€™ - â€˜ã€‚</li><li>å¿…é¡»åŒ…å«è‡³å°‘ä¸€ä¸ªâ€™.â€™å°†åç§°ç©ºé—´ä¸æ’ä»¶åç§°åˆ†å¼€çš„å­—ç¬¦ã€‚</li><li>é€šå¸¸å¯¹åç§°ç©ºé—´ä½¿ç”¨å°å†™åå‘åŸŸåçº¦å®šã€‚</li><li>é€šå¸¸åœ¨åç§°ä¸­åªä½¿ç”¨å°å†™å­—ç¬¦</li><li>ä¸è¦ä½¿ç”¨ org.gradleå’Œcom.gradlewareå‘½åç©ºé—´</li><li>æ— æ³•ä»¥â€™.â€™å¼€å§‹æˆ–ç»“æŸ</li><li>ä¸èƒ½åŒ…å«è¿ç»­çš„â€™.â€™å­—ç¬¦ï¼ˆå³â€™..â€™ï¼‰</li></ul><p>å°½ç®¡æ’ä»¶IDå’ŒåŒ…åç§°ä¹‹é—´å­˜åœ¨ä¼ ç»Ÿçš„ç›¸ä¼¼æ€§ï¼Œä½†åŒ…åé€šå¸¸æ¯”æ’ä»¶IDæ‰€éœ€çš„æ›´è¯¦ç»†ã€‚ä¾‹å¦‚ï¼Œå°†â€œgradleâ€æ·»åŠ ä¸ºæ’ä»¶IDçš„ç»„ä»¶ä¼¼ä¹æ˜¯åˆç†çš„ï¼Œä½†ç”±äºæ’ä»¶IDä»…ç”¨äºGradleæ’ä»¶ï¼Œè¿™å°†æ˜¯å¤šä½™çš„ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œæ ‡è¯†æ‰€æœ‰æƒå’Œåç§°çš„åç§°ç©ºé—´éƒ½æ˜¯è‰¯å¥½çš„æ’ä»¶æ ‡è¯†æ‰€éœ€çš„</p><h2 id="Publishing-your-plugin"><a href="#Publishing-your-plugin" class="headerlink" title="Publishing your plugin"></a>Publishing your plugin</h2><p>å¦‚æœæ‚¨åœ¨å…¬å¸å†…éƒ¨å‘å¸ƒæ‚¨çš„æ’ä»¶ä»¥ä¾›æ‚¨çš„ç»„ç»‡ä½¿ç”¨ï¼Œå¯ä»¥åƒå‘å¸ƒå…¶ä»–ä»»ä½•ä»£ç å·¥ä»¶ä¸€æ ·å‘å¸ƒå®ƒã€‚å…³äºå‘å¸ƒå·¥ä»¶ï¼Œè¯·å‚é˜…<a href="https://docs.gradle.org/current/userguide/publishing_ivy.html" target="_blank" rel="noopener">lvy</a>å’Œ<a href="https://docs.gradle.org/current/userguide/publishing_maven.html" target="_blank" rel="noopener">maven</a>ç« èŠ‚ã€‚</p><p>å¦‚æœæ‚¨æœ‰å…´è¶£å‘å¸ƒæ‚¨çš„æ’ä»¶ä»¥ä¾›æ›´å¹¿æ³›çš„Gradleç¤¾åŒºä½¿ç”¨ï¼Œæ‚¨å¯ä»¥å°†å…¶å‘å¸ƒåˆ°<a href="https://plugins.gradle.org/docs/submit?_ga=2.115105858.438770069.1528507228-204910210.1513922382" target="_blank" rel="noopener">Gradle plugin portal. </a>ã€‚è¯¥ç½‘ç«™æä¾›æœç´¢å’Œæ”¶é›†Gradleç¤¾åŒºè´¡çŒ®æ’ä»¶çš„ä¿¡æ¯çš„èƒ½åŠ›ã€‚è¯·å‚é˜…<a href="https://plugins.gradle.org/?_ga=2.115105858.438770069.1528507228-204910210.1513922382" target="_blank" rel="noopener">æ­¤å¤„</a>çš„è¯´æ˜ï¼Œäº†è§£å¦‚ä½•ä½¿æ‚¨çš„æ’ä»¶åœ¨æœ¬ç½‘ç«™ä¸Šå¯ç”¨ã€‚</p><h2 id="Using-your-plugin-in-another-project"><a href="#Using-your-plugin-in-another-project" class="headerlink" title="Using your plugin in another project"></a>Using your plugin in another project</h2><p>è¦åœ¨æ„å»ºè„šæœ¬ä¸­ä½¿ç”¨æ’ä»¶ï¼Œéœ€è¦å°†æ’ä»¶ç±»æ·»åŠ åˆ°æ„å»ºè„šæœ¬çš„ç±»è·¯å¾„ä¸­ã€‚ä¸ºæ­¤ï¼Œè¯·ä½¿ç”¨â€œbuildscript {}â€å—ï¼Œå¦‚<a href="https://docs.gradle.org/current/userguide/plugins.html#sec:applying_plugins_buildscript" target="_blank" rel="noopener">â€œApplying plugins with the buildscript blockâ€</a>. ä¸€èŠ‚ä¸­æ‰€è¿°ã€‚ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†å½“åŒ…å«è¯¥æ’ä»¶çš„JARå·²å‘å¸ƒåˆ°æœ¬åœ°å­˜å‚¨åº“æ—¶ï¼Œæ‚¨éœ€è¦è¿™æ ·åšï¼š</p><p><strong>Example: Using a custom plugin in another project</strong><br><em>build.gradle</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        maven &#123;</span><br><span class="line">            <span class="function">url <span class="title">uri</span><span class="params">(<span class="string">'../repo'</span>)</span></span></span><br><span class="line"><span class="function">        &#125;</span></span><br><span class="line"><span class="function">    &#125;</span></span><br><span class="line"><span class="function">    dependencies </span>&#123;</span><br><span class="line">        classpath group: <span class="string">'org.gradle'</span>, name: <span class="string">'customPlugin'</span>,</span><br><span class="line">                  version: <span class="string">'1.0-SNAPSHOT'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">apply plugin: <span class="string">'org.samples.greeting'</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…ï¼Œå¦‚æœæ‚¨çš„æ’ä»¶å·²å‘å¸ƒåˆ°æ’ä»¶é—¨æˆ·ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å­µåŒ–æ’ä»¶DSLï¼ˆè¯·å‚é˜…â€œ<a href="https://docs.gradle.org/current/userguide/plugins.html#sec:plugins_block" target="_blank" rel="noopener">ä½¿ç”¨æ’ä»¶DSLåº”ç”¨æ’ä»¶</a>â€ä¸€èŠ‚ï¼‰æ¥åº”ç”¨è¯¥æ’ä»¶ï¼š</p><p><strong>Example: Applying a community plugin with the plugins DSL</strong><br><em>build.gradle</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plugins &#123;</span><br><span class="line">    id <span class="string">'com.jfrog.bintray'</span> version <span class="string">'0.4.1'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Providing-a-configuration-DSL-for-the-plugin"><a href="#Providing-a-configuration-DSL-for-the-plugin" class="headerlink" title="Providing a configuration DSL for the plugin"></a>Providing a configuration DSL for the plugin</h1><p>æ­£å¦‚æˆ‘ä»¬ä¸Šé¢çœ‹åˆ°çš„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ‰©å±•å¯¹è±¡ä¸ºæ‚¨çš„æ’ä»¶æä¾›é…ç½®ã€‚ä½¿ç”¨æ‰©å±•å¯¹è±¡è¿˜æ‰©å±•äº†Gradle DSLä»¥ä¸ºè¯¥æ’ä»¶æ·»åŠ é¡¹ç›®å±æ€§å’ŒDSLå—ã€‚æ‰©å±•å¯¹è±¡åªæ˜¯ä¸€ä¸ªå¸¸è§„å¯¹è±¡ï¼Œå› æ­¤æ‚¨å¯ä»¥é€šè¿‡å‘æ‰©å±•å¯¹è±¡æ·»åŠ å±æ€§å’Œæ–¹æ³•æ¥æä¾›åµŒå¥—åœ¨æ­¤å—ä¸­çš„DSLå…ƒç´ ã€‚Gradleæä¾›äº†ä¸€äº›ä¾¿åˆ©æ¥å¸®åŠ©ä¸ºæ’ä»¶åˆ›å»ºä¸€ä¸ªè¡Œä¸ºè‰¯å¥½çš„DSLã€‚</p><h2 id="Nested-DSL-elements"><a href="#Nested-DSL-elements" class="headerlink" title="Nested DSL elements"></a>Nested DSL elements</h2><p>å½“Gradleåˆ›å»ºä»»åŠ¡æˆ–æ‰©å±•å¯¹è±¡æ—¶ï¼ŒGradleä¿®é¥°å®ç°ç±»ä»¥æ··åˆDSLæ”¯æŒã€‚è¦åˆ›å»ºä¸€ä¸ªåµŒå¥—çš„DSLå…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ObjectFactoryç±»å‹æ¥åˆ›å»ºå…·æœ‰ç±»ä¼¼ä¿®é¥°çš„å¯¹è±¡ã€‚ç„¶åï¼Œå¯ä»¥é€šè¿‡æ’ä»¶æ‰©å±•çš„å±æ€§å’Œæ–¹æ³•ä½¿è¿™äº›ä¿®é¥°å¯¹è±¡å¯è§ã€‚</p><p><strong>Example: Nested DSL elements</strong></p><p><em>build.gradle</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    String name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GreetingPluginExtension</span> </span>&#123;</span><br><span class="line">    String message</span><br><span class="line">    <span class="keyword">final</span> Person greeter</span><br><span class="line"></span><br><span class="line">    <span class="meta">@javax</span>.inject.Inject</span><br><span class="line">    GreetingPluginExtension(ObjectFactory objectFactory) &#123;</span><br><span class="line">        <span class="comment">// Create a Person instance</span></span><br><span class="line">        greeter = objectFactory.newInstance(Person)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">greeter</span><span class="params">(Action&lt;? <span class="keyword">super</span> Person&gt; action)</span> </span>&#123;</span><br><span class="line">        action.execute(greeter)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GreetingPlugin</span> <span class="keyword">implements</span> <span class="title">Plugin</span>&lt;<span class="title">Project</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">apply</span><span class="params">(Project project)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Create the extension, passing in an ObjectFactory for it to use</span></span><br><span class="line">        def extension = project.extensions.create(<span class="string">'greeting'</span>, GreetingPluginExtension, project.objects)</span><br><span class="line">        project.task(<span class="string">'hello'</span>) &#123;</span><br><span class="line">            doLast &#123;</span><br><span class="line">                println <span class="string">"$&#123;extension.message&#125; from $&#123;extension.greeter.name&#125;"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">apply plugin: GreetingPlugin</span><br><span class="line"></span><br><span class="line">greeting &#123;</span><br><span class="line">    message = <span class="string">'Hi'</span></span><br><span class="line">    greeter &#123;</span><br><span class="line">        name = <span class="string">'Gradle'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Output of gradle -q hello</span><br><span class="line"></span><br><span class="line">&gt; gradle -q hello</span><br><span class="line">Hi from Gradle</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ’ä»¶é€šè¿‡å…¶æ„é€ å‡½æ•°å°†é¡¹ç›®çš„ObjectFactoryä¼ é€’ç»™æ‰©å±•å¯¹è±¡ã€‚æ„é€ å‡½æ•°ä½¿ç”¨å®ƒåˆ›å»ºä¸€ä¸ªåµŒå¥—å¯¹è±¡ï¼Œå¹¶é€šè¿‡greeterå±æ€§ä½¿è¯¥å¯¹è±¡å¯ä¾›DSLä½¿ç”¨ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h1 id=&quot;Table-of-Contents&quot;&gt;&lt;a href=&quot;#Table-of-Contents&quot; class=&quot;headerlink&quot; title=&quot;Table of
      
    
    </summary>
    
      <category term="Gradle" scheme="https://xsfelvis.github.io/categories/Gradle/"/>
    
    
      <category term="Gradle" scheme="https://xsfelvis.github.io/tags/Gradle/"/>
    
      <category term="ç¿»è¯‘" scheme="https://xsfelvis.github.io/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>ARouterè§£æä¹‹URLè·³è½¬</title>
    <link href="https://xsfelvis.github.io/2018/06/06/ARouter%E8%A7%A3%E6%9E%90%E4%B9%8BURL%E8%B7%B3%E8%BD%AC/"/>
    <id>https://xsfelvis.github.io/2018/06/06/ARouterè§£æä¹‹URLè·³è½¬/</id>
    <published>2018-06-05T16:00:00.000Z</published>
    <updated>2018-06-06T08:20:03.342Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>ARouterè§£æ</p><ul><li><p><a href="https://xsfelvis.github.io/2018/06/05/ARouter%E8%A7%A3%E6%9E%90%E4%B9%8B%E6%A6%82%E8%BF%B0/">ARouteræ¦‚è¿°</a></p></li><li><p><a href="https://xsfelvis.github.io/2018/06/05/ARouter%E8%A7%A3%E6%9E%90%E4%B9%8B%E8%B7%AF%E7%94%B1%E7%9A%84%E7%A7%98%E5%AF%86/">è·¯ç”±çš„ç§˜å¯†</a></p></li><li><a href="https://xsfelvis.github.io/2018/06/06/ARouter%E8%A7%A3%E6%9E%90%E4%B9%8BURL%E8%B7%B3%E8%BD%AC/">URLè·³è½¬</a></li></ul><h1 id="ARouterè§£æä¹‹URLè·³è½¬"><a href="#ARouterè§£æä¹‹URLè·³è½¬" class="headerlink" title="ARouterè§£æä¹‹URLè·³è½¬"></a>ARouterè§£æä¹‹URLè·³è½¬</h1><p>åœ¨ARouter Demoä¸­ï¼Œç‚¹å‡»é€šè¿‡URLè·³è½¬ï¼Œä¼šé€šè¿‡WebViewåŠ è½½html</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ARouter.getInstance()</span><br><span class="line">        .build(<span class="string">"/test/webview"</span>)</span><br><span class="line">        .withString(<span class="string">"url"</span>, <span class="string">"file:///android_asset/schame-test.html"</span>)</span><br><span class="line">        .navigation();</span><br></pre></td></tr></table></figure><p> <img src="https://upload-images.jianshu.io/upload_images/2608779-5104d9c50fcb0553.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/340" alt=""></p><h2 id="æ–¹æ¡ˆè®¾è®¡"><a href="#æ–¹æ¡ˆè®¾è®¡" class="headerlink" title="æ–¹æ¡ˆè®¾è®¡"></a>æ–¹æ¡ˆè®¾è®¡</h2><p>é€šå¸¸webviewä¸Šçš„urlè·³è½¬ä¼šç»™webviewè®¾ç½®ä¸€ä¸ª<code>webviewClient</code>ï¼Œç„¶åé€šè¿‡shouldOverrideUrlLoadingæ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­æ„é€ intentè¿›è¡Œè·³è½¬ï¼Œç®€å•ç¤ºæ„å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">webview.setWebViewClient(<span class="keyword">new</span> WebViewClient()&#123;    </span><br><span class="line"><span class="meta">@Override</span>    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">shouldOverrideUrlLoading</span><span class="params">(WebView view, String url)</span> </span>&#123;    </span><br><span class="line">        <span class="keyword">if</span> (url != <span class="keyword">null</span> &amp;&amp; url.contains(<span class="string">"arouter"</span>))&#123;    </span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent(TestWebview.<span class="keyword">this</span>, Test1Activity.class);    </span><br><span class="line">        startActivity(intent);    </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;    </span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.shouldOverrideUrlLoading(view, url);    </span><br><span class="line">    &#125;    </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™ç§åšæ³•å¾€å¾€ä¼šæœ‰å¾ˆå¤šç¼ºé™·</p><ol><li>ç¡¬ç¼–ç ï¼Œä¸šåŠ¡å¤æ‚æ—¶å€™webviewå˜å¾—å¾ˆè‡ƒè‚¿ï¼Œè€¦åˆä¸¥é‡ä¸åˆ©äºç»´æŠ¤</li><li>å½“å¤–ä¸åº”ç”¨æ‰“å¼€é“¾æ¥éœ€è¦è·³è½¬åˆ°æˆ‘ä»¬çš„AppæŸä¸ªActivityä¸­æ—¶å€™ï¼Œæ­¤æ—¶å°±ä¸åœ¨è‡ªå·±Appçš„webviewç¯å¢ƒä¸­ï¼Œè¿™æ ·å°±æ— æ³•æ»¡è¶³è·³è½¬éœ€æ±‚çš„ï¼Œå› æ­¤è¿™ç§æ–¹å¼ä¹Ÿä¸å¤Ÿå¼ºå¤§</li></ol><p>ARouterå°±æ˜¯é€šè¿‡<code>æ³¨å†Œä¸€ä¸ªæ²¡æœ‰UIçš„ç•Œé¢</code>ä½œä¸ºè·³æ¿æ¥ç»Ÿä¸€å¤„ç†,schemeæ˜¯arouterçš„è·³è½¬è¯·æ±‚ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;activity android:name=<span class="string">".SchemeFilterActivity"</span>&gt;</span><br><span class="line">    &lt;!-- Schame --&gt;</span><br><span class="line">    &lt;intent-filter&gt;</span><br><span class="line">        &lt;data</span><br><span class="line">            android:host=<span class="string">"m.aliyun.com"</span></span><br><span class="line">            android:scheme=<span class="string">"arouter"</span>/&gt;</span><br><span class="line">        &lt;action android:name=<span class="string">"android.intent.action.VIEW"</span>/&gt;</span><br><span class="line">        &lt;category android:name=<span class="string">"android.intent.category.DEFAULT"</span>/&gt;</span><br><span class="line">        &lt;category android:name=<span class="string">"android.intent.category.BROWSABLE"</span>/&gt;</span><br><span class="line">    &lt;/intent-filter&gt;</span><br><span class="line">    &lt;!-- App Links --&gt;</span><br><span class="line">    &lt;intent-filter android:autoVerify=<span class="string">"true"</span>&gt;</span><br><span class="line">        &lt;action android:name=<span class="string">"android.intent.action.VIEW"</span>/&gt;</span><br><span class="line">        &lt;category android:name=<span class="string">"android.intent.category.DEFAULT"</span>/&gt;</span><br><span class="line">        &lt;category android:name=<span class="string">"android.intent.category.BROWSABLE"</span>/&gt;</span><br><span class="line">        &lt;data</span><br><span class="line">            android:host=<span class="string">"m.aliyun.com"</span></span><br><span class="line">            android:scheme=<span class="string">"http"</span>/&gt;</span><br><span class="line">        &lt;data</span><br><span class="line">            android:host=<span class="string">"m.aliyun.com"</span></span><br><span class="line">            android:scheme=<span class="string">"https"</span>/&gt;</span><br><span class="line">    &lt;/intent-filter&gt;</span><br><span class="line">&lt;/activity&gt;</span><br></pre></td></tr></table></figure><p>åœ¨æ¸…å•æ–‡ä»¶ä¸­æ³¨å†Œäº†SchemeFilterActivityè¿™ä¸ªactivity</p><ul><li>schemeå°±æ˜¯arouter, </li><li>hostå°±æ˜¯m.aliyun.comï¼Œ</li><li>å…¶ä¸­æœ‰ä¸ªcategoryæ˜¯ android.intent.category.BROWSABLEï¼Œ</li></ul><p>å…¶ä¸­ <code>android.intent.category.BROWSABLE</code>å°±æ˜¯è®©æµè§ˆå™¨å¯ä»¥æ‰“è¿™ä¸ªActvityï¼Œå½“ç„¶è¦ç¬¦åˆhostå’Œscheme,è¿™æ ·å°±å¯ä»¥åœ¨WebViewä¸­è·³è½¬SchemeFilterActivityè¿™ä¸ªç•Œé¢äº†ã€‚</p><p>è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹ï¼š</p><ol><li><p>é¦–å…ˆæ˜¯é¡µé¢è·³è½¬çš„çµæ´»æ€§ï¼Œ<br>æ¯”å¦‚éœ€è¦å’ŒH5ä¸­è¿›è¡Œé€šä¿¡ï¼ŒH5éœ€è¦è·³è½¬åˆ°Appæœ¬åœ°çš„é¡µé¢ï¼ŒNativeå’ŒH5åªéœ€è¦ç»Ÿä¸€ä¸€ä¸ªpathæ–‡æ¡£å³å¯ï¼ŒH5å¯ä»¥é€šè¿‡pathæ„é€ ä¸€ä¸ªurlå°±å¯ä»¥å®ç°è·³è½¬åˆ°å¯¹åº”é¡µé¢çš„åŠŸèƒ½ï¼Œå¾ˆç±»ä¼¼æµè§ˆå™¨ï¼Œå®ç°å¾ˆå¥½çš„è§£è€¦</p></li><li><p>æ›´åŠ çš„å®‰å…¨<br>ç›¸æ¯”è¾ƒäºéšå¼çš„intentï¼Œæ¯ä¸€ä¸ªä»å¤–é¢è·³è½¬è¿›æ¥çš„é¡µé¢éƒ½éœ€è¦æ³¨å†Œä¸Šintent-filterï¼Œæ¯ä¸ªé¡µé¢éƒ½éœ€è¦è®¾ç½®export=trueï¼Œä¹Ÿå°±æ˜¯éœ€è¦è®©æ¯ä¸€ä¸ªé¡µé¢éƒ½å¯ä»¥å¯¼å‡ºï¼Œåœ¨å¤–éƒ¨å¯ä»¥è®¿é—®åˆ°ã€‚è¿™æ ·åšä¼šå¸¦æ¥éå¸¸ä¸¥é‡çš„å®‰å…¨é£é™©ï¼Œå°±åƒæ˜¯ä¸€ä¸ªæˆ¿å­æœ‰åä¸ªé—¨è¿˜æ˜¯åªæœ‰ä¸€ä¸ªé—¨ï¼Œçœ‹é—¨çš„æˆæœ¬æ˜¯ä¸åŒçš„ã€‚è€Œç°åœ¨ä½¿ç”¨çš„è¿™ç§åœºæ™¯åªéœ€è¦å¯¹å¤–æš´éœ²å‡ºä¸€ä¸ªactivityï¼Œç„¶ååœ¨è¿™ä¸ªactivityä¸­æ³¨å†Œä¸€ä¸ªintent-filterï¼Œè¿™æ ·ä¹‹åæ‰€æœ‰çš„å¤–éƒ¨è·¯ç”±è¯·æ±‚éƒ½ä¼šç»è¿‡è¿™å”¯ä¸€çš„é—¨ï¼Œç„¶ååœ¨è¿™ä¸ªactivityä¸­è·å–åˆ°URLå¹¶å°†å…¶äº¤ç»™ARouterï¼Œå‰©ä¸‹çš„å°±ç”±è·¯ç”±æ¡†æ¶åšåˆ†å‘äº†ã€‚</p></li><li><p>æºå¸¦å‚æ•°æ³¨å…¥<br>å¦å¤–ä¸€ä¸ªå¥½å¤„å°±æ˜¯éšå¼intentè·³è½¬æ— æ³•å°†å‚æ•°è‡ªåŠ¨æ³¨å…¥ï¼ŒARouterå¯ä»¥åœ¨urlä¸­æºå¸¦å‚æ•°ç„¶åè‡ªåŠ¨æ³¨å…¥</p></li></ol><p>è¿™é‡Œä¹Ÿéœ€è¦H5é“¾æ¥éœ€è¦æŒ‰ç…§<code>çº¦å®šçš„schemeæ¥</code>ï¼Œ</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>è·³è½¬æµ‹è¯•<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>è‡ªå®šä¹‰Scheme[é€šå¸¸æ¥è¯´éƒ½æ˜¯è¿™æ ·çš„]<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"arouter://m.aliyun.com/test/activity1"</span>&gt;</span>arouter://m.aliyun.com/test/activity1<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"arouter://m.aliyun.com/test/activity1?url=https%3a%2f%2fm.abc.com%3fa%3db%26c%3dd"</span>&gt;</span>æµ‹è¯•URL Encodeæƒ…å†µ<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"arouter://m.aliyun.com/test/activity1?name=alex&amp;age=18&amp;boy=true&amp;high=180&amp;obj=%7b%22name%22%3a%22jack%22%2c%22id%22%3a666%7d"</span>&gt;</span>arouter://m.aliyun.com/test/activity1?name=alex&amp;age=18&amp;boy=true&amp;high=180&amp;obj=&#123;"name":"jack","id":"666"&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"arouter://m.aliyun.com/test/activity2"</span>&gt;</span>arouter://m.aliyun.com/test/activity2<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"arouter://m.aliyun.com/test/activity2?key1=value1"</span>&gt;</span>arouter://m.aliyun.com/test/activity2?key1=value1<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"arouter://m.aliyun.com/test/activity3?name=alex&amp;age=18&amp;boy=true&amp;high=180"</span>&gt;</span>arouter://m.aliyun.com/test/activity3?name=alex&amp;age=18&amp;boy=true&amp;high=180<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>App Links[é˜²æ­¢è¢«Appå±è”½]<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://m.aliyun.com/test/activity1"</span>&gt;</span>http://m.aliyun.com/test/activity1<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://m.aliyun.com/test/activity2"</span>&gt;</span>http://m.aliyun.com/test/activity2<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="URLä¸­è½¬SchemeFilterActivity"><a href="#URLä¸­è½¬SchemeFilterActivity" class="headerlink" title="URLä¸­è½¬SchemeFilterActivity"></a>URLä¸­è½¬SchemeFilterActivity</h2><p>ç‚¹å‡»urlä¹‹åé€šè¿‡æ¸…å•æ–‡ä»¶çš„åŒ¹é…intent-filterä¸­çš„data, action, categoryçš„æ ‡ç­¾ï¼Œå…¶ä¸­categoryåŒ¹é…ä»»æ„ä¸€ä¸ªå³å¯ã€‚æ¥ç€å°±æ¥åˆ°SchemeFilterActivity</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SchemeFilterActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line"><span class="comment">//        ç›´æ¥é€šè¿‡ARouterå¤„ç†å¤–éƒ¨Uri</span></span><br><span class="line">        Uri uri = getIntent().getData();</span><br><span class="line">        ARouter.getInstance().build(uri).navigation(<span class="keyword">this</span>, <span class="keyword">new</span> NavCallback() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onArrival</span><span class="params">(Postcard postcard)</span> </span>&#123;</span><br><span class="line">                finish();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åç»­å¤„ç†å°±è·Ÿä¹‹å‰è·¯ç”±é€»è¾‘ä¸€è‡´äº†,è¿™é‡Œå°±ä¸èµ˜è¿°äº†</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;p&gt;ARouterè§£æ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://xsfelvis.github.io/2018/06/05/ARouter%E8%A7%
      
    
    </summary>
    
      <category term="å¼€æºå­¦ä¹ " scheme="https://xsfelvis.github.io/categories/%E5%BC%80%E6%BA%90%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="ARouter" scheme="https://xsfelvis.github.io/tags/ARouter/"/>
    
      <category term="è·¯ç”±" scheme="https://xsfelvis.github.io/tags/%E8%B7%AF%E7%94%B1/"/>
    
  </entry>
  
  <entry>
    <title>è°ˆè°ˆAPTå’ŒJavaPoetçš„ä¸€äº›ä½¿ç”¨æŠ€å·§å’Œè¦ç‚¹</title>
    <link href="https://xsfelvis.github.io/2018/06/06/%E8%B0%88%E8%B0%88APT%E5%92%8CJavaPoet%E7%9A%84%E4%B8%80%E4%BA%9B%E6%8A%80%E5%B7%A7/"/>
    <id>https://xsfelvis.github.io/2018/06/06/è°ˆè°ˆAPTå’ŒJavaPoetçš„ä¸€äº›æŠ€å·§/</id>
    <published>2018-06-05T16:00:00.000Z</published>
    <updated>2018-06-06T15:28:38.868Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>APT+JavaPoet æ˜¯ä¸€æŠŠåˆ©å‰‘ï¼Œå¯ä»¥å°†å¾ˆå¤šæ¨¡æ¿ä»£ç åœ¨ç¼–è¯‘æœŸé—´ç›´æ¥ç”Ÿæˆï¼Œå³é€šè¿‡æ³¨è§£æ”¶é›†ä¿¡æ¯ï¼Œç„¶åå°†è¿™äº›ä¿¡æ¯å½¢æˆä¸€äº›å›ºå®šä»£ç ï¼›ç‰¹åˆ«æ˜¯åœ¨å†™æ¡†æ¶çš„æ—¶å€™ï¼Œå¯ä»¥å°†ä¸€äº›â€œè„æ´»ã€ç´¯æ´»â€é€šè¿‡è¿™ç§æ–¹å¼å¤„ç†æ‰ï¼Œç„¶åæä¾›ç»™ç”¨æˆ·ä¸€ä¸ªå¹²å‡€çš„APIæ¥å£ä½¿ç”¨ï¼Œç›®å‰å¸¸ç”¨åœ¨</p><ul><li>è·¯ç”± å¦‚<a href="https://github.com/alibaba/ARouter" target="_blank" rel="noopener">ARouter</a></li><li>ButterKnifeã€Daggerç­‰</li><li>JsBridge (Hanlderæˆ–è€…Actioon)</li><li><p>æƒé™<br>å¦‚ <a href="https://github.com/hongyangAndroid/MPermissions" target="_blank" rel="noopener">MPermissions</a>ã€<a href="https://github.com/permissions-dispatcher/PermissionsDispatcher" target="_blank" rel="noopener">PermissionsDispatcher</a></p></li><li><p>å·¥å‚æ¨¡å¼ç›¸å…³ <a href="https://race604.com/annotation-processing/" target="_blank" rel="noopener">å·¥å‚æ¨¡å¼ç®€åŒ–</a> </p></li></ul><p>ä¸€äº›å¤æ‚ç±»å‹çš„Adapter ç­‰ç­‰ï¼Œè¿™äº›éƒ½å¯ä»¥æ‰¾åˆ°ç›¸å…³çš„å¼€æºåº“</p><p>å…³äºAPT+JavePoetè¦æ˜¯ä¸ç†Ÿæ‚‰çš„è¯å»ºè®®å…ˆçœ‹çœ‹æˆ‘ä¹‹å‰çš„æ³¨è§£ç³»åˆ—</p><p>æ³¨è§£ç³»åˆ—</p><ul><li><a href="https://xsfelvis.github.io/2017/01/06/%E6%B3%A8%E8%A7%A3%E5%9F%BA%E7%A1%80/">æ³¨è§£åŸºç¡€</a></li><li><a href="https://xsfelvis.github.io/2017/04/07/%E7%BC%96%E8%AF%91%E6%9C%9F%E6%B3%A8%E8%A7%A3%E4%B9%8BAPT/">ç¼–è¯‘æœŸæ³¨è§£å¤„ç†ä¹‹APT</a></li><li><a href="https://xsfelvis.github.io/2017/03/12/%E7%BC%96%E8%AF%91%E6%9C%9F%E6%B3%A8%E8%A7%A3%E4%B9%8BJavaPoet/">JavaPoet</a></li></ul><p><a href="https://xsfelvis.github.io/2018/06/05/ARouter%E8%A7%A3%E6%9E%90%E4%B9%8B%E6%A6%82%E8%BF%B0/#more">ARouterè§£æ</a></p><h1 id="ä¸€äº›æŠ€å·§"><a href="#ä¸€äº›æŠ€å·§" class="headerlink" title="ä¸€äº›æŠ€å·§"></a>ä¸€äº›æŠ€å·§</h1><h2 id="è€ç”Ÿå¸¸è°ˆçš„é¢å‘æ¥å£ç¼–ç¨‹"><a href="#è€ç”Ÿå¸¸è°ˆçš„é¢å‘æ¥å£ç¼–ç¨‹" class="headerlink" title="è€ç”Ÿå¸¸è°ˆçš„é¢å‘æ¥å£ç¼–ç¨‹"></a>è€ç”Ÿå¸¸è°ˆçš„é¢å‘æ¥å£ç¼–ç¨‹</h2><p>æ¯”å¦‚åœ¨<a href="https://github.com/hongyangAndroid/MPermissions" target="_blank" rel="noopener">MPermissions</a>ä¸­ï¼Œæä¾›äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PermissionProxy</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">grant</span><span class="params">(T source, <span class="keyword">int</span> requestCode)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">denied</span><span class="params">(T source, <span class="keyword">int</span> requestCode)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rationale</span><span class="params">(T source, <span class="keyword">int</span> requestCode)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">needShowRationale</span><span class="params">(<span class="keyword">int</span> requestCode)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åAPTç”Ÿæˆçš„ä»£ç å®ç°è¯¥æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span>$$<span class="title">PermissionProxy</span> <span class="keyword">implements</span> <span class="title">PermissionProxy</span>&lt;<span class="title">MainActivity</span>&gt; </span>&#123;</span><br><span class="line">    â€¦â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®é™…é€»è¾‘æ“ä½œä¸­ç›´æ¥ä½¿ç”¨è¯¥æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">shouldShowRequestPermissionRationale</span><span class="params">(Activity activity, String permission, <span class="keyword">int</span> requestCode)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//æ ¸å¿ƒé€»è¾‘åªå…³æ³¨æ¥å£</span></span><br><span class="line">        PermissionProxy proxy = findPermissionProxy(activity);</span><br><span class="line">        <span class="keyword">if</span> (!proxy.needShowRationale(requestCode)) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (ActivityCompat.shouldShowRequestPermissionRationale(activity,</span><br><span class="line">                permission)) &#123;</span><br><span class="line">            proxy.rationale(activity, requestCode);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ARouter(<a href="https://xsfelvis.github.io/2018/06/05/ARouter%E8%A7%A3%E6%9E%90%E4%B9%8B%E6%A6%82%E8%BF%B0/#more">Arouterè§£æ</a>)ä¸­ä¹Ÿæœ‰è¿™ç§å¤„ç†çš„æ–¹å¼ï¼Œæ¯”å¦‚IRouteGroup<br>LogisticsCenter#completion</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">IRouteGroup iGroupInstance = groupMeta.getConstructor().newInstance();</span><br><span class="line">iGroupInstance.loadInto(Warehouse.routes);</span><br><span class="line">Warehouse.groupsIndex.remove(postcard.getGroup());</span><br></pre></td></tr></table></figure><p>æ€æƒ³ä¸€æ ·è¿™é‡Œå°±ä¸å±•å¼€èµ˜è¿°äº†</p><h2 id="ä¿¡æ¯æ³¨å…¥åˆ†ç¦»"><a href="#ä¿¡æ¯æ³¨å…¥åˆ†ç¦»" class="headerlink" title="ä¿¡æ¯æ³¨å…¥åˆ†ç¦»"></a>ä¿¡æ¯æ³¨å…¥åˆ†ç¦»</h2><p>æ¯”å¦‚åœ¨ARouterä¸­æœ‰ä¸€ä¸ª<code>ä»“åº“</code>WearHouseç±»é‡Œé¢å°±æ˜¯ä¸€äº›ç©ºå£³å®¹å™¨ï¼Œç”¨æ¥ç››æ”¾è·¯ç”±çš„å…ƒä¿¡æ¯ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Warehouse</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Cache route and metas</span></span><br><span class="line">    <span class="keyword">static</span> Map&lt;String, Class&lt;? extends IRouteGroup&gt;&gt; groupsIndex = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">static</span> Map&lt;String, RouteMeta&gt; routes = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Cache provider</span></span><br><span class="line">    <span class="keyword">static</span> Map&lt;Class, IProvider&gt; providers = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">static</span> Map&lt;String, RouteMeta&gt; providersIndex = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Cache interceptor</span></span><br><span class="line">    <span class="keyword">static</span> Map&lt;Integer, Class&lt;? extends IInterceptor&gt;&gt; interceptorsIndex = <span class="keyword">new</span> UniqueKeyTreeMap&lt;&gt;(<span class="string">"More than one interceptors use same priority [%s]"</span>);</span><br><span class="line">    <span class="keyword">static</span> List&lt;IInterceptor&gt; interceptors = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    â€¦â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çŸ¥é“å…·ä½“çš„ä¿¡æ¯æ˜¯åœ¨æ³¨è§£ä¹‹ä¸­ï¼ŒAPT+JavaPoetè´Ÿè´£å°†ä¿¡æ¯æ”¶é›†ï¼Œåœ¨ARouterä¸­ä½“ç°å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ARouter</span>$$<span class="title">Group</span>$$<span class="title">service</span> <span class="keyword">implements</span> <span class="title">IRouteGroup</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadInto</span><span class="params">(Map&lt;String, RouteMeta&gt; atlas)</span> </span>&#123;</span><br><span class="line">    atlas.put(<span class="string">"/service/hello"</span>, RouteMeta.build(RouteType.PROVIDER, HelloServiceImpl.class, <span class="string">"/service/hello"</span>, <span class="string">"service"</span>, <span class="keyword">null</span>, -<span class="number">1</span>, -<span class="number">2147483648</span>));</span><br><span class="line">    atlas.put(<span class="string">"/service/json"</span>, RouteMeta.build(RouteType.PROVIDER, JsonServiceImpl.class, <span class="string">"/service/json"</span>, <span class="string">"service"</span>, <span class="keyword">null</span>, -<span class="number">1</span>, -<span class="number">2147483648</span>));</span><br><span class="line">    atlas.put(<span class="string">"/service/single"</span>, RouteMeta.build(RouteType.PROVIDER, SingleService.class, <span class="string">"/service/single"</span>, <span class="string">"service"</span>, <span class="keyword">null</span>, -<span class="number">1</span>, -<span class="number">2147483648</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºåªæœ‰ä¸€ä¸ªæ¥å—æ³¨å…¥çš„ä¿¡æ¯çš„å‡½æ•°,ç„¶ååœ¨å®é™…é€»è¾‘å¤„ç†ä¸­,å°†æ­¤å¤„çš„ä¿¡æ¯loadåˆ°WareHouseä¸­å¯¹åº”map</p><p>LogisticsCenter#completion</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">IRouteGroup iGroupInstance = groupMeta.getConstructor().newInstance();</span><br><span class="line">iGroupInstance.loadInto(Warehouse.routes);</span><br><span class="line">Warehouse.groupsIndex.remove(postcard.getGroup());</span><br></pre></td></tr></table></figure><p>å¹²å‡€æ¸…çˆ½</p><h2 id="å¸¸ç”¨çš„JavaPoet"><a href="#å¸¸ç”¨çš„JavaPoet" class="headerlink" title="å¸¸ç”¨çš„JavaPoet"></a>å¸¸ç”¨çš„JavaPoet</h2><p>åŸºæœ¬æ“ä½œå¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£<a href="https://github.com/square/javapoet" target="_blank" rel="noopener">JavaPoet</a> è¿™é‡Œè®²ä¸€ä¸‹ä¸€äº›éš¾ç‚¹æ‰€åœ¨ä¸è¿‡ä¸€èˆ¬éƒ½æ˜¯çº ç»“åœ¨ è·å–ç±»ã€æ¥å£ã€Mapã€å¸¦æ³›å‹çš„Mapï¼Œä¸‹é¢å°†ä¸€ä¸€è¯´æ˜</p><h3 id="è·å–ç±»"><a href="#è·å–ç±»" class="headerlink" title="è·å–ç±»"></a>è·å–ç±»</h3><p>æœ‰ä¸¤ç§æ–¹å¼</p><ul><li><p>ClassName.bestGuess(â€œç±»å…¨åç§°â€) è¿”å›ClassNameå¯¹è±¡ï¼Œè¿™é‡Œçš„ç±»å…¨åç§°è¡¨ç¤ºçš„ç±»å¿…é¡»è¦å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨å¯¼å…¥ç›¸åº”çš„åŒ…</p></li><li><p>ClassName.get(â€œåŒ…åâ€ï¼Œâ€ç±»åâ€) è¿”å›ClassNameå¯¹è±¡ï¼Œä¸æ£€æŸ¥è¯¥ç±»æ˜¯å¦å­˜åœ¨</p></li></ul><p>å› æ­¤éœ€è¦æ³¨æ„è·å–ç±»å…¨åçš„ç±»åœ¨ä»¥åé‡æ„æ—¶å€™<code>æ”¹åç±»å</code>æˆ–è€…<code>ç§»åŠ¨äº†ä½ç½®</code>éœ€è¦å¯¹åº”ä¿®æ”¹è¿™é‡Œ</p><h3 id="å ä½ç¬¦"><a href="#å ä½ç¬¦" class="headerlink" title="å ä½ç¬¦"></a>å ä½ç¬¦</h3><ul><li>$L å­—é¢å¸¸é‡ï¼ˆLiteralsï¼‰</li><li>$S å­—ç¬¦ä¸²å¸¸é‡ï¼ˆStringï¼‰</li><li>$T ç±»å‹(Types)<br>è¯¥å ä½ç¬¦æœ€å¤§ç‰¹ç‚¹å°±æ˜¯ä¼šè‡ªåŠ¨å¯¼åŒ…</li><li>$N å‘½å(Names),é€šå¸¸æŒ‡æˆ‘ä»¬è‡ªå·±ç”Ÿæˆçš„æ–¹æ³•åæˆ–è€…å˜é‡åç­‰ç­‰</li></ul><h3 id="å¤æ‚ç±»å‹"><a href="#å¤æ‚ç±»å‹" class="headerlink" title="å¤æ‚ç±»å‹"></a>å¤æ‚ç±»å‹</h3><p>ç¨å¾®å¤æ‚ç‚¹çš„ç±»å‹ æ¯”å¦‚æ³›å‹ ã€Mapä¹‹ç±»çš„ï¼Œéœ€è¦äº†è§£ä¸‹JavaPoetå®šä¹‰çš„å‡ ç§ä¸“é—¨æè¿°ç±»å‹çš„ç±»</p><p><img src="https://user-gold-cdn.xitu.io/2018/5/26/1639c8621da268bc?imageView2/0/w/1280/h/960/ignore-error/1" alt="å¤æ‚ç±»å‹"></p><p>å¸¸è§çš„æœ‰</p><table><thead><tr><th>åˆ†ç±»</th><th>ç”Ÿæˆçš„ç±»å‹</th><th>JavaPoet å†™æ³•</th><th>ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™ ï¼ˆç­‰æ•ˆçš„ Java å†™æ³•ï¼‰</th></tr></thead><tbody><tr><td>å†…ç½®ç±»å‹</td><td>int</td><td>TypeName.INT</td><td>int.class</td></tr><tr><td>æ•°ç»„ç±»å‹</td><td>int[]</td><td>ArrayTypeName.of(int.class)</td><td>int[].class</td></tr><tr><td>éœ€è¦å¼•å…¥åŒ…åçš„ç±»å‹</td><td>java.io.File</td><td>ClassName.get(â€œjava.ioâ€, â€œFileâ€)</td><td>java.io.File.class</td></tr><tr><td>å‚æ•°åŒ–ç±»å‹ ï¼ˆParameterizedType</td><td>List</td><td>ParameterizedTypeName.get(List.class, String.class)</td><td>-</td></tr><tr><td>ç±»å‹å˜é‡  ï¼ˆWildcardTypeï¼‰ ç”¨äºå£°æ˜æ³›å‹</td><td>T</td><td>TypeVariableName.get(â€œTâ€)</td><td>-</td></tr><tr><td>é€šé…ç¬¦ç±»å‹</td><td>? extends String</td><td>WildcardTypeName.subtypeOf(String.class)</td><td>-</td></tr></tbody></table><p>é€šè¿‡ARouterä¸­çš„ä¸€æ®µä»£ç ï¼Œå°±å¯ä»¥è§£é‡Šçš„å¾ˆæ¸…æ¥š</p><p>RouterProcessor</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å‚æ•°åŒ–ç±»å‹ Map&lt;String, Class&lt;? extends IRouteGroup&gt;&gt;</span></span><br><span class="line">ParameterizedTypeName inputMapTypeOfRoot = ParameterizedTypeName.get(</span><br><span class="line">            ClassName.get(Map.class),</span><br><span class="line">            ClassName.get(String.class),</span><br><span class="line">            ParameterizedTypeName.get(</span><br><span class="line">                    ClassName.get(Class.class),</span><br><span class="line">                    WildcardTypeName.subtypeOf(ClassName.get(type_IRouteGroup))</span><br><span class="line">            )</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line"><span class="comment">//å‚æ•°åŒ–ç±»å‹ Map&lt;String, RouteMeta&gt;</span></span><br><span class="line">ParameterizedTypeName inputMapTypeOfGroup = ParameterizedTypeName.get(</span><br><span class="line">            ClassName.get(Map.class),</span><br><span class="line">            ClassName.get(String.class),</span><br><span class="line">            ClassName.get(RouteMeta.class)</span><br><span class="line">    );        </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     *Build input param name.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    ParameterSpec rootParamSpec = ParameterSpec.builder(inputMapTypeOfRoot, <span class="string">"routes"</span>).build();</span><br><span class="line">    ParameterSpec groupParamSpec = ParameterSpec.builder(inputMapTypeOfGroup, <span class="string">"atlas"</span>).build();</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ARouter</span>$$<span class="title">Root</span>$$<span class="title">app</span> <span class="keyword">implements</span> <span class="title">IRouteRoot</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadInto</span><span class="params">(Map&lt;String, Class&lt;? extends IRouteGroup&gt;&gt; routes)</span> </span>&#123;</span><br><span class="line">    routes.put(<span class="string">"service"</span>, ARouter$$Group$$service.class);</span><br><span class="line">    routes.put(<span class="string">"test"</span>, ARouter$$Group$$test.class);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ARouter</span>$$<span class="title">Group</span>$$<span class="title">service</span> <span class="keyword">implements</span> <span class="title">IRouteGroup</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadInto</span><span class="params">(Map&lt;String, RouteMeta&gt; atlas)</span> </span>&#123;</span><br><span class="line">    atlas.put(<span class="string">"/service/hello"</span>, RouteMeta.build(RouteType.PROVIDER, HelloServiceImpl.class, <span class="string">"/service/hello"</span>, <span class="string">"service"</span>, <span class="keyword">null</span>, -<span class="number">1</span>, -<span class="number">2147483648</span>));</span><br><span class="line">    atlas.put(<span class="string">"/service/json"</span>, RouteMeta.build(RouteType.PROVIDER, JsonServiceImpl.class, <span class="string">"/service/json"</span>, <span class="string">"service"</span>, <span class="keyword">null</span>, -<span class="number">1</span>, -<span class="number">2147483648</span>));</span><br><span class="line">    atlas.put(<span class="string">"/service/single"</span>, RouteMeta.build(RouteType.PROVIDER, SingleService.class, <span class="string">"/service/single"</span>, <span class="string">"service"</span>, <span class="keyword">null</span>, -<span class="number">1</span>, -<span class="number">2147483648</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ–è€…ç›´æ¥å…ˆæŠŠä½ éœ€è¦çš„æ³›å‹éƒ½å†™å‡ºæ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> ClassName java_lang_Class = ClassName.get(Class.class);</span><br><span class="line">        <span class="keyword">final</span> ClassName java_util_Collections = ClassName.get(<span class="string">"java.util"</span>, <span class="string">"Collections"</span>);</span><br><span class="line">        <span class="keyword">final</span> ClassName java_util_Map = ClassName.get(<span class="string">"java.util"</span>, <span class="string">"Map"</span>);</span><br><span class="line">        <span class="keyword">final</span> ClassName java_util_Set = ClassName.get(<span class="string">"java.util"</span>, <span class="string">"Set"</span>);</span><br><span class="line">        <span class="keyword">final</span> ClassName java_util_LinkedHashMap = ClassName.get(<span class="string">"java.util"</span>, <span class="string">"LinkedHashMap"</span>);</span><br><span class="line">        <span class="keyword">final</span> ClassName java_util_LinkedHashSet = ClassName.get(<span class="string">"java.util"</span>, <span class="string">"LinkedHashSet"</span>);</span><br><span class="line">        <span class="keyword">final</span> ClassName instantiator = ClassName.get(<span class="string">"java.util.concurrent"</span>, <span class="string">"Callable"</span>);</span><br><span class="line">        <span class="keyword">final</span> TypeName classOfAny = ParameterizedTypeName.get(java_lang_Class, any);</span><br><span class="line">        <span class="keyword">final</span> TypeName instantiatorOfAny = ParameterizedTypeName.get(instantiator, any);</span><br><span class="line">        <span class="keyword">final</span> TypeName instantiatorOfP = ParameterizedTypeName.get(instantiator, p);</span><br><span class="line">        <span class="keyword">final</span> TypeName classOfS = ParameterizedTypeName.get(java_lang_Class, s);</span><br><span class="line">        <span class="keyword">final</span> TypeName classOfP = ParameterizedTypeName.get(java_lang_Class, p);</span><br><span class="line">        <span class="keyword">final</span> TypeName classOfSubTypeOfS = ParameterizedTypeName.get(java_lang_Class, subTypeOfS);</span><br><span class="line">        <span class="keyword">final</span> TypeName setOfClass = ParameterizedTypeName.get(java_util_Set, classOfAny);</span><br><span class="line">        <span class="keyword">final</span> TypeName setOfClassOfSubTypeOfS = ParameterizedTypeName.get(java_util_Set, classOfSubTypeOfS);</span><br><span class="line">        <span class="keyword">final</span> TypeName linkedHashSetOfClass = ParameterizedTypeName.get(java_util_LinkedHashSet, classOfAny);</span><br><span class="line">        <span class="keyword">final</span> TypeName mapOfClassToSetOfClass = ParameterizedTypeName.get(java_util_Map, classOfAny, setOfClass);</span><br><span class="line">        <span class="keyword">final</span> TypeName mapOfClassToInstantiator = ParameterizedTypeName.get(java_util_Map, classOfAny, instantiatorOfAny);</span><br><span class="line">        <span class="keyword">final</span> TypeName linkedHashMapOfClassToSetOfClass = ParameterizedTypeName.get(java_util_LinkedHashMap, classOfAny, setOfClass);</span><br><span class="line">        <span class="keyword">final</span> TypeName linkedHashMapOfClassToInstantializer = ParameterizedTypeName.get(java_util_LinkedHashMap, classOfAny, instantiatorOfAny);</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨éœ€è¦æ—¶ç›´æ¥æ‹¿åˆ°å³å¯,è¿™é‡Œæ˜¯ä½œä¸ºä¸€ä¸ªå˜é‡(Fieldä½¿ç”¨)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.addField(FieldSpec.builder(mapOfClassToSetOfClass, <span class="string">"sServices"</span>)</span><br><span class="line">                        .addModifiers(Modifier.PRIVATE, Modifier.STATIC, Modifier.FINAL)</span><br><span class="line">                        .initializer(<span class="string">"new $T()"</span>, linkedHashMapOfClassToSetOfClass)</span><br><span class="line">                        .build())</span><br><span class="line">                        </span><br><span class="line">.addField(FieldSpec.builder(mapOfClassToInstantiator, <span class="string">"sInstantiators"</span>)</span><br><span class="line">                        .addModifiers(Modifier.PRIVATE, Modifier.STATIC, Modifier.FINAL)</span><br><span class="line">                        .initializer(<span class="string">"new $T()"</span>, linkedHashMapOfClassToInstantializer)</span><br><span class="line">                        .build())</span><br></pre></td></tr></table></figure><h1 id="è¦ç‚¹åˆ†æ"><a href="#è¦ç‚¹åˆ†æ" class="headerlink" title="è¦ç‚¹åˆ†æ"></a>è¦ç‚¹åˆ†æ</h1><h2 id="Elementå’ŒTypeMirror"><a href="#Elementå’ŒTypeMirror" class="headerlink" title="Elementå’ŒTypeMirror"></a>Elementå’ŒTypeMirror</h2><p>è¿™ä¸ªç‚¹è¿˜æ˜¯éå¸¸é‡è¦çš„ï¼Œæˆ‘ä»¬çš„javaä»£ç åœ¨å¯¹äºAPTå¤„ç†æ—¶åªä¸è¿‡å„ç§çš„Elementçš„ç»“æ„åŒ–æ–‡æœ¬ï¼Œå½“æˆ‘ä»¬éœ€è¦è¿›è¡Œç»†è‡´çš„é€»è¾‘åˆ¤æ–­æ—¶å€™ï¼Œæ¯”å¦‚æ˜¯å¦æ˜¯æŸä¸ªç±»çš„å­ç±»ï¼Œå°±éœ€è¦æ“ä½œä»–ä»¬äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">package com.example;    // PackageElement</span><br><span class="line"></span><br><span class="line">public class Test &#123;        // TypeElement</span><br><span class="line"></span><br><span class="line">    private int a;      // VariableElement</span><br><span class="line">    private Test other;  // VariableElement</span><br><span class="line"></span><br><span class="line">    public Test () &#123;&#125;    // ExecuteableElement</span><br><span class="line">    public void setA (  // ExecuteableElement</span><br><span class="line">                     int newA   // TypeElement</span><br><span class="line">                     ) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Element</code>ä»£è¡¨javaæºæ–‡ä»¶ä¸­çš„ç¨‹åºæ„å»ºå…ƒç´ ï¼Œä¾‹å¦‚åŒ…ã€ç±»ã€æ–¹æ³•ç­‰ã€‚Elementæ¥å£æœ‰5ä¸ªå­ç±»ã€‚</p><table><thead><tr><th>PackageElement</th><th>è¡¨ç¤ºä¸€ä¸ªåŒ…ç¨‹åºå…ƒç´ ï¼Œå¯ä»¥è·å–åˆ°åŒ…åç­‰</th></tr></thead><tbody><tr><td>TypeParameterElement</td><td>è¡¨ç¤ºä¸€èˆ¬ç±»ã€æ¥å£ã€æ–¹æ³•æˆ–æ„é€ æ–¹æ³•å…ƒç´ çš„æ³›å‹å‚æ•°</td></tr><tr><td>TypeElement</td><td>è¡¨ç¤ºä¸€ä¸ªç±»æˆ–æ¥å£ç¨‹åºå…ƒç´ </td></tr><tr><td>VariableElement</td><td>è¡¨ç¤ºä¸€ä¸ªå­—æ®µã€enum å¸¸é‡ã€æ–¹æ³•æˆ–æ„é€ æ–¹æ³•å‚æ•°ã€å±€éƒ¨å˜é‡æˆ–å¼‚å¸¸å‚æ•°</td></tr><tr><td>ExecutableElement</td><td>è¡¨ç¤ºæŸä¸ªç±»æˆ–æ¥å£çš„æ–¹æ³•ã€æ„é€ æ–¹æ³•æˆ–åˆå§‹åŒ–ç¨‹åºï¼ˆé™æ€æˆ–å®ä¾‹ï¼‰ï¼ŒåŒ…æ‹¬æ³¨è§£ç±»å‹å…ƒç´ </td></tr></tbody></table><p>å¼€å‘ä¸­Elementå¯æ ¹æ®å®é™…æƒ…å†µå¼ºè½¬ä¸ºä»¥ä¸Š5ç§ä¸­çš„ä¸€ç§</p><ul><li>å½“ä½ æœ‰ä¸€ä¸ªæ³¨è§£æ˜¯ä»¥@Target(ElementType.METHOD)å®šä¹‰æ—¶ï¼Œè¡¨ç¤ºè¯¥æ³¨è§£åªèƒ½ä¿®é¥°æ–¹æ³•ã€‚<br>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä½ ä¸ºäº†ç”Ÿæˆä»£ç ï¼Œè€Œéœ€è¦è·å–ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼šåŒ…åã€ç±»åã€æ–¹æ³•åã€å‚æ•°ç±»å‹ã€è¿”å›å€¼,å¦‚ä½•åšï¼Ÿ</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//@Target(ElementType.METHOD)ä¿®é¥°</span></span><br><span class="line"><span class="keyword">for</span> (Element element : roundEnv.getElementsAnnotatedWith(Inject.class)) &#123;</span><br><span class="line">    <span class="comment">//å¯¹äºElementç›´æ¥å¼ºè½¬</span></span><br><span class="line">    ExecutableElement executableElement = (ExecutableElement) element;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//éå¯¹åº”çš„Elementï¼Œé€šè¿‡getEnclosingElementè½¬æ¢è·å–</span></span><br><span class="line">    TypeElement classElement = (TypeElement) element</span><br><span class="line">                .getEnclosingElement();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å½“(ExecutableElement) elementæˆç«‹æ—¶ï¼Œä½¿ç”¨(PackageElement) element</span></span><br><span class="line">    <span class="comment">//            .getEnclosingElement();å°†æŠ¥é”™ã€‚</span></span><br><span class="line">    <span class="comment">//éœ€è¦ä½¿ç”¨elementUtilsæ¥è·å–</span></span><br><span class="line">    Elements elementUtils = processingEnv.getElementUtils();</span><br><span class="line">    PackageElement packageElement = elementUtils.getPackageOf(classElement);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…¨ç±»å</span></span><br><span class="line">    String fullClassName = classElement.getQualifiedName().toString();</span><br><span class="line">    <span class="comment">//ç±»å</span></span><br><span class="line">    String className = classElement.getSimpleName().toString();</span><br><span class="line">    <span class="comment">//åŒ…å</span></span><br><span class="line">    String packageName = packageElement.getQualifiedName().toString();</span><br><span class="line">    <span class="comment">//æ–¹æ³•å</span></span><br><span class="line">    String methodName = executableElement.getSimpleName().toString();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å–å¾—æ–¹æ³•å‚æ•°åˆ—è¡¨</span></span><br><span class="line">    List&lt;? extends VariableElement&gt; methodParameters = executableElement.getParameters();</span><br><span class="line">    <span class="comment">//å‚æ•°ç±»å‹åˆ—è¡¨</span></span><br><span class="line">    List&lt;String&gt; types = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (VariableElement variableElement : methodParameters) &#123;</span><br><span class="line">        TypeMirror methodParameterType = variableElement.asType();</span><br><span class="line">        <span class="keyword">if</span> (methodParameterType <span class="keyword">instanceof</span> TypeVariable) &#123;</span><br><span class="line">            TypeVariable typeVariable = (TypeVariable) methodParameterType;</span><br><span class="line">            methodParameterType = typeVariable.getUpperBound();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å‚æ•°å</span></span><br><span class="line">        String parameterName = variableElement.getSimpleName().toString();</span><br><span class="line">        <span class="comment">//å‚æ•°ç±»å‹</span></span><br><span class="line">        String parameteKind = methodParameterType.toString();</span><br><span class="line">        types.add(methodParameterType.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å½“ä½ æœ‰ä¸€ä¸ªæ³¨è§£æ˜¯ä»¥@Target(ElementType.FIELD)å®šä¹‰æ—¶ï¼Œè¡¨ç¤ºè¯¥æ³¨è§£åªèƒ½ä¿®é¥°å±æ€§ã€ç±»æˆå‘˜ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä½ ä¸ºäº†ç”Ÿæˆä»£ç ï¼Œè€Œéœ€è¦è·å–ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼šåŒ…åã€ç±»åã€ç±»æˆå‘˜ç±»å‹ã€ç±»æˆå‘˜å,å¦‚ä½•è·å–?</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">for</span> (Element element : roundEnv.getElementsAnnotatedWith(IdProperty.class)) &#123;</span><br><span class="line">    <span class="comment">//ElementType.FIELDæ³¨è§£å¯ä»¥ç›´æ¥å¼ºè½¬VariableElement</span></span><br><span class="line">    VariableElement variableElement = (VariableElement) element;</span><br><span class="line">    <span class="comment">//éå¯¹åº”çš„Elementï¼Œé€šè¿‡getEnclosingElementè½¬æ¢è·å–</span></span><br><span class="line">    TypeElement classElement = (TypeElement) element</span><br><span class="line">            .getEnclosingElement();</span><br><span class="line">    PackageElement packageElement = elementUtils.getPackageOf(classElement);</span><br><span class="line">    <span class="comment">//ç±»å</span></span><br><span class="line">    String className = classElement.getSimpleName().toString();</span><br><span class="line">    <span class="comment">//åŒ…å</span></span><br><span class="line">    String packageName = packageElement.getQualifiedName().toString();</span><br><span class="line">    <span class="comment">//ç±»æˆå‘˜å</span></span><br><span class="line">    String variableName = variableElement.getSimpleName().toString();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç±»æˆå‘˜ç±»å‹</span></span><br><span class="line">    TypeMirror typeMirror = variableElement.asType();</span><br><span class="line">    String type = typeMirror.toString();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å½“ä½ æœ‰ä¸€ä¸ªæ³¨è§£æ˜¯ä»¥@Target(ElementType.TYPE)å®šä¹‰æ—¶ï¼Œè¡¨ç¤ºè¯¥æ³¨è§£åªèƒ½ä¿®é¥°ç±»ã€æ¥å£ã€æšä¸¾ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä½ ä¸ºäº†ç”Ÿæˆä»£ç ï¼Œè€Œéœ€è¦è·å–ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼šåŒ…åã€ç±»åã€å…¨ç±»åã€çˆ¶ç±»ï¼Œå¦‚ä½•è·å–ï¼Ÿ</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">for</span> (Element element : roundEnv.getElementsAnnotatedWith(xxx.class)) &#123;</span><br><span class="line">    <span class="comment">//ElementType.TYPEæ³¨è§£å¯ä»¥ç›´æ¥å¼ºè½¬TypeElement</span></span><br><span class="line">    TypeElement classElement = (TypeElement) element;</span><br><span class="line">    <span class="comment">//éå¯¹åº”çš„Elementï¼Œé€šè¿‡getEnclosingElementè½¬æ¢è·å–</span></span><br><span class="line">    PackageElement packageElement = (PackageElement) element</span><br><span class="line">                .getEnclosingElement();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…¨ç±»å</span></span><br><span class="line">    String fullClassName = classElement.getQualifiedName().toString();</span><br><span class="line">    <span class="comment">//ç±»å</span></span><br><span class="line">    String className = classElement.getSimpleName().toString();</span><br><span class="line">    <span class="comment">//åŒ…å</span></span><br><span class="line">    String packageName = packageElement.getQualifiedName().toString();</span><br><span class="line">    <span class="comment">//çˆ¶ç±»å</span></span><br><span class="line">    String superClassName = classElement.getSuperclass().toString();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Elementä»£è¡¨çš„æ˜¯æºä»£ç ã€‚TypeElementä»£è¡¨çš„æ˜¯æºä»£ç ä¸­çš„ç±»å‹å…ƒç´ ï¼Œä¾‹å¦‚ç±»ã€‚ç„¶è€Œï¼ŒTypeElementå¹¶ä¸åŒ…å«ç±»æœ¬èº«çš„ä¿¡æ¯ã€‚ä½ å¯ä»¥ä»TypeElementä¸­è·å–ç±»çš„åå­—ï¼Œä½†æ˜¯ä½ è·å–ä¸åˆ°ç±»çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å®ƒçš„çˆ¶ç±»ã€‚è¿™ç§ä¿¡æ¯éœ€è¦é€šè¿‡TypeMirrorè·å–ã€‚<code>TypeMirror</code>ç”¨ä¸æè¿°Javaç¨‹åºä¸­å…ƒç´ çš„ä¿¡æ¯ï¼Œå³Elmentçš„å…ƒä¿¡æ¯ã€‚é€šè¿‡é€šè¿‡<code>Element.asType()</code>æ¥å£å¯ä»¥è·å–Elementçš„TypeMirrorï¼Œç»“æ„æ¯”è¾ƒå¤æ‚<br><img src="https://blog-10039692.file.myqcloud.com/1508900053643_8070_1508900092231.png" alt="typemirror"></p><p>å¸¸ç”¨çš„TypeMirrorï¼Œå¦‚ä¸‹</p><table><thead><tr><th>PrimitiveType</th><th>åŸå§‹æ•°æ®ç±»å‹ï¼Œboolean,byte,short int,long,float,char,double</th></tr></thead><tbody><tr><td>ReferenceType</td><td>å¼•ç”¨ç±»å‹</td></tr><tr><td>ArrayType</td><td>æ•°ç»„ç±»å‹</td></tr><tr><td>DeclaredType</td><td>å£°æ˜çš„ç±»å‹ï¼Œä¾‹å¦‚ç±»ã€æ¥å£ã€æšä¸¾ã€æ³¨è§£ç±»å‹</td></tr><tr><td>AnnotationType</td><td>æ³¨è§£ç±»å‹</td></tr><tr><td>ClassType</td><td>ç±»ç±»å‹</td></tr><tr><td>EnumType</td><td>æšä¸¾ç±»å‹</td></tr><tr><td>InterfaceType</td><td>æ¥å£ç±»å‹</td></tr><tr><td>TypeVariable</td><td>ç±»å‹å˜é‡ç±»å‹</td></tr><tr><td>VoidType</td><td>void ç±»å‹</td></tr><tr><td>WildcardType</td><td>é€šé…ç¬¦ç±»å‹</td></tr></tbody></table><p>å½“TypeMirroræ˜¯DeclaredTypeæˆ–è€…TypeVariableæ—¶ï¼ŒTypeMirrorå¯ä»¥è½¬åŒ–æˆElement:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Element element = processingEviroment.getTypeUtils().asElement(typeMirror);</span><br></pre></td></tr></table></figure><p>åœ¨ARouterä¸­ ä¸ºäº†åŒºåˆ†æ˜¯å¦æ˜¯æŸä¸ªç±»çš„å­ç±»ä½¿ç”¨åˆ°äº†TypeMirro</p><p>RouterProcessor # parseRoutes</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> TypeMirror type_Activity = elements.getTypeElement(ACTIVITY).asType();</span><br><span class="line">            TypeMirror type_Service = elements.getTypeElement(SERVICE).asType();</span><br><span class="line">            TypeMirror fragmentTm = elements.getTypeElement(FRAGMENT).asType();</span><br><span class="line">            TypeMirror fragmentTmV4 = elements.getTypeElement(Consts.FRAGMENT_V4).asType();</span><br><span class="line">            </span><br><span class="line"><span class="keyword">if</span> (types.isSubtype(tm, type_Activity)) &#123;                 <span class="comment">// Activity</span></span><br><span class="line">                    â€¦â€¦</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (types.isSubtype(tm, iProvider)) &#123;         <span class="comment">// IProvider</span></span><br><span class="line">                â€¦â€¦</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (types.isSubtype(tm, fragmentTm) || types.isSubtype(tm, fragmentTmV4)) &#123;</span><br><span class="line">                 â€¦â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><ul><li>ä½¿ç”¨Messager</li></ul><p><code>Messager</code>æä¾›ç»™æ³¨è§£å¤„ç†å™¨ä¸€ä¸ªæŠ¥å‘Šé”™è¯¯ã€è­¦å‘Šä»¥åŠæç¤ºä¿¡æ¯çš„é€”å¾„ã€‚å®ƒä¸æ˜¯æ³¨è§£å¤„ç†å™¨å¼€å‘è€…çš„æ—¥å¿—å·¥å…·ï¼Œè€Œæ˜¯ç”¨æ¥å†™ä¸€äº›ä¿¡æ¯ç»™ä½¿ç”¨æ­¤æ³¨è§£å™¨çš„ç¬¬ä¸‰æ–¹å¼€å‘è€…çš„ã€‚<br>åœ¨å®˜æ–¹æ–‡æ¡£ä¸­æè¿°äº†æ¶ˆæ¯çš„ä¸åŒçº§åˆ«ä¸­éå¸¸é‡è¦çš„æ˜¯Kind.ERRORï¼Œå› ä¸ºè¿™ç§ç±»å‹çš„ä¿¡æ¯ç”¨æ¥è¡¨ç¤ºæˆ‘ä»¬çš„æ³¨è§£å¤„ç†å™¨å¤„ç†å¤±è´¥äº†ã€‚å¾ˆæœ‰å¯èƒ½æ˜¯ç¬¬ä¸‰æ–¹å¼€å‘è€…é”™è¯¯çš„ä½¿ç”¨äº†æ³¨è§£ã€‚è¿™ä¸ªæ¦‚å¿µå’Œä¼ ç»Ÿçš„Javaåº”ç”¨æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œåœ¨ä¼ ç»ŸJavaåº”ç”¨ä¸­æˆ‘ä»¬å¯èƒ½å°±æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸Exceptionã€‚å¦‚æœä½ åœ¨process()ä¸­æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œé‚£ä¹ˆè¿è¡Œæ³¨è§£å¤„ç†å™¨çš„JVMå°†ä¼šå´©æºƒï¼ˆå°±åƒå…¶ä»–Javaåº”ç”¨ä¸€æ ·ï¼‰ï¼Œä½¿ç”¨æˆ‘ä»¬æ³¨è§£å¤„ç†å™¨ç¬¬ä¸‰æ–¹å¼€å‘è€…å°†ä¼šä»javacä¸­å¾—åˆ°éå¸¸éš¾æ‡‚çš„å‡ºé”™ä¿¡æ¯ï¼Œå› ä¸ºå®ƒåŒ…å«æ³¨è§£å¤„ç†å™¨çš„å †æ ˆè·Ÿè¸ªï¼ˆStacktaceï¼‰ä¿¡æ¯ã€‚å› æ­¤ï¼Œæ³¨è§£å¤„ç†å™¨å°±æœ‰ä¸€ä¸ªMessagerç±»ï¼Œå®ƒèƒ½å¤Ÿæ‰“å°éå¸¸ä¼˜ç¾çš„é”™è¯¯ä¿¡æ¯ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥è¿æ¥åˆ°å‡ºé”™çš„å…ƒç´ ã€‚åœ¨åƒç°åœ¨çš„IDEï¼ˆé›†æˆå¼€å‘ç¯å¢ƒï¼‰ä¸­ï¼Œç¬¬ä¸‰æ–¹å¼€å‘è€…å¯ä»¥ç›´æ¥ç‚¹å‡»é”™è¯¯ä¿¡æ¯ï¼ŒIDEå°†ä¼šç›´æ¥è·³è½¬åˆ°ç¬¬ä¸‰æ–¹å¼€å‘è€…é¡¹ç›®çš„å‡ºé”™çš„æºæ–‡ä»¶çš„ç›¸åº”çš„è¡Œã€‚<br>å› æ­¤æˆ‘ä»¬é€šå¸¸å°è£…ä¸€ä¸ªLoggerå»æ‰“å°å…³é”®ç‚¹ï¼Œå…·ä½“å¯ä»¥å‚è€ƒARouterçš„<a href="https://github.com/alibaba/ARouter/blob/master/arouter-compiler/src/main/java/com/alibaba/android/arouter/compiler/utils/Logger.java" target="_blank" rel="noopener">Logger</a></p><ul><li>æ–­ç‚¹è°ƒè¯•</li></ul><p>(1) åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹çš„gradle.propertiesæ–‡ä»¶ä¸­ï¼Œæ–°å¢å¦‚ä¸‹é…ç½®ï¼š</p><blockquote><p>org.gradle.jvmargs=-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005<br>org.gradle.daemon=true</p></blockquote><p>(2)æ–°å»ºremote debugger</p><p>æ³¨æ„æ–°å»ºremoteDebugerçš„åç§°ä¸€å®šè¦æ˜¯AnnotationProcessor<br><img src="https://blog-10039692.file.myqcloud.com/1508900731628_7034_1508900770128.png" alt=""></p><p><img src="https://blog-10039692.file.myqcloud.com/1508900743976_6437_1508900782462.png" alt=""><br>(3)Debug AnnotationProcessor<br><img src="https://blog-10039692.file.myqcloud.com/1508900753173_3782_1508900791654.png" alt=""></p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>APT + JavaPoet å›ºç„¶æ¯”è¾ƒå¼ºå¤§ï¼Œä½†æ˜¯ä¹Ÿæœ‰å…¶å±€é™æ€§ï¼Œæ¯”å¦‚å®ƒæ— æ³•æ‰«æ AARã€JARåŒ…ï¼Œåœ¨ä¸€äº›å¤§å‹appä¸Šåˆ†æ¨¡å—æœ€ç»ˆä»¥jaråŒ…å½¢å¼æä¾›çš„è¯ï¼Œå°±ä¸èƒ½æ‰«æåˆ°æ³¨è§£äº†ï¼Œé‚£è¿™æ—¶å°±éœ€è¦å€ŸåŠ©äºæ›´ä¸ºå¼ºå¤§çš„æŠ€æœ¯äº†ï¼Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰Gradle Plugin + JavaAssiståœ¨dexä¹‹å‰æ‰«æclassæ–¹å¼å»ç”Ÿæˆæˆ‘ä»¬æƒ³è¦çš„ä»£ç ,è¿™æ˜¯åè¯äº†ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://juejin.im/entry/58fefebf8d6d810058a610de/" target="_blank" rel="noopener">https://juejin.im/entry/58fefebf8d6d810058a610de/</a></li><li><a href="https://cloud.tencent.com/developer/article/1006210" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1006210</a></li><li><a href="https://race604.com/annotation-processing/" target="_blank" rel="noopener">https://race604.com/annotation-processing/</a></li><li><a href="https://lizhaoxuan.github.io/2016/07/17/apt-Grammar-explanation/" target="_blank" rel="noopener">https://lizhaoxuan.github.io/2016/07/17/apt-Grammar-explanation/</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h1 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h1&gt;&lt;p&gt;APT+JavaPoet æ˜¯ä¸€æŠŠåˆ©å‰‘ï¼Œå¯
      
    
    </summary>
    
      <category term="æ³¨è§£" scheme="https://xsfelvis.github.io/categories/%E6%B3%A8%E8%A7%A3/"/>
    
    
      <category term="APT" scheme="https://xsfelvis.github.io/tags/APT/"/>
    
      <category term="JavaPoet" scheme="https://xsfelvis.github.io/tags/JavaPoet/"/>
    
  </entry>
  
  <entry>
    <title>ARouterè§£æ</title>
    <link href="https://xsfelvis.github.io/2018/06/05/ARouter%E8%A7%A3%E6%9E%90/"/>
    <id>https://xsfelvis.github.io/2018/06/05/ARouterè§£æ/</id>
    <published>2018-06-04T16:00:00.000Z</published>
    <updated>2018-06-08T07:34:40.410Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>ARouterè§£æ</p><ul><li><p><a href="https://xsfelvis.github.io/2018/06/05/ARouter%E8%A7%A3%E6%9E%90%E4%B9%8B%E6%A6%82%E8%BF%B0/">ARouteræ¦‚è¿°</a></p></li><li><p><a href="https://xsfelvis.github.io/2018/06/05/ARouter%E8%A7%A3%E6%9E%90%E4%B9%8B%E8%B7%AF%E7%94%B1%E7%9A%84%E7%A7%98%E5%AF%86/">è·¯ç”±çš„ç§˜å¯†</a></p></li><li><a href="https://xsfelvis.github.io/2018/06/06/ARouter%E8%A7%A3%E6%9E%90%E4%B9%8BURL%E8%B7%B3%E8%BD%AC/">URLè·³è½¬</a></li></ul><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>è¿™ä¸ªåº“éå¸¸å€¼å¾—å­¦ä¹ ï¼Œé‡Œé¢æ¶‰åŠåˆ°çš„æŠ€æœ¯å’Œç¼–ç¨‹æ€æƒ³éƒ½æ˜¯ä¸é”™çš„</p><ol><li>APT ç¼–è¯‘å™¨æ³¨è§£å¤„ç†æŠ€æœ¯</li><li>URLçš„ç»Ÿä¸€ç®¡ç†è·³è½¬çš„æ–¹æ¡ˆ</li><li>â€˜æœåŠ¡â€™çš„è§£è€¦ï¼ˆæ¥å£è®¾è®¡ï¼‰ä¸è·å–(åå°„)</li><li>å¤šçº¿ç¨‹å¤„ç†æŠ€æœ¯ (CountDownLatchçš„ä½¿ç”¨) </li><li>æ‹¦æˆªå™¨æ€æƒ³ã€é™çº§ç­–ç•¥(ï¼ˆAOPçš„è®¾è®¡æ€æƒ³ï¼‰)ã€åˆ†ç»„åŠ è½½ç­–ç•¥</li><li>å‹å¥½çš„apiè®¾è®¡</li></ol><h1 id="æ•´ä½“è®¾è®¡"><a href="#æ•´ä½“è®¾è®¡" class="headerlink" title="æ•´ä½“è®¾è®¡"></a>æ•´ä½“è®¾è®¡</h1><p><img src="http://p927u2n0k.bkt.clouddn.com/ARouter.png" alt="ARoute"></p><p>å†è¿›ä¸€æ­¥æŠ½è±¡å°±æ˜¯<code>â€œé‚®ç¥¨â€PostCardä¿¡æ¯çš„å®Œå–„è¿‡ç¨‹</code>ï¼Œå½“ä¿¡æ¯å®Œå…¨å¡«å……å°±å¯ä»¥å…·ä½“å¾€å“ªé‡Œè·³ï¼Œæºå¸¦ä»€ä¹ˆå‚æ•°</p><p><img src="http://p927u2n0k.bkt.clouddn.com/Arouteræ ¸å¿ƒæŠ½è±¡.png" alt="Arouteræ ¸å¿ƒæŠ½è±¡"></p><p>ä½¿ç”¨åŸä½œè€…çš„æŠ½è±¡å›¾ï¼Œæ•´ä¸ªARouteræ¶æ„å¦‚ä¸‹:</p><p><img src="http://p927u2n0k.bkt.clouddn.com/37b723fb660fdfcf7cdc09c194c88a8073d8272d.png" alt="37b723fb660fdfcf7cdc09c194c88a8073d8272d"></p><p><img src="http://p927u2n0k.bkt.clouddn.com/e4d3ec6020479ef2043cfd7e10cfaf33254ac309-1.png" alt="e4d3ec6020479ef2043cfd7e10cfaf33254ac309"></p><p>å…¶å®åœ¨AndroidåŸç”Ÿè·³è½¬ä¸»è¦æ˜¯é€šè¿‡intentï¼Œä¸»è¦åˆ†ä¸ºæ˜¾å¼å’Œéšå¼è·³è½¬ï¼Œæ˜¾ç¤ºè·³è½¬ç›´æ¥å¯¼è‡´ç±»ä¹‹é—´çš„è€¦åˆï¼Œè€Œéšå¼è·³è½¬éœ€è¦åœ¨æ¸…å•æ–‡ä»¶ä¸­ç”³æ˜ï¼Œåœ¨å¤šæ¨¡å—åä½œä¸­æ¯”è¾ƒå›°éš¾,è€Œä¸”äºŒè€…æœ€ç»ˆéƒ½ä¼šè°ƒç”¨startActivityï¼Œè¿™ä¸ªç¯èŠ‚æˆ‘ä»¬å°±æ— æ³•æ§åˆ¶äº†ï¼Œè€ŒARouterè·¯ç”±å¯ä»¥åœ¨è·³è½¬ä¸­è¿›è¡Œå¦‚åŒæ‹¦æˆª,è·³è½¬å¤±è´¥è¿›è¡Œé™çº§çš„æ“ä½œã€‚</p><p>æŠŠæ¡å¥½äº†æ•´ä½“ï¼Œä¸‹é¢å°†åˆ†å‡ ç¯‡ä»‹ç»è¿™ä¸ªå¼€æºåº“,è§å¼€ç¯‡é“¾æ¥ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;p&gt;ARouterè§£æ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://xsfelvis.github.io/2018/06/05/ARouter%E8%A7%
      
    
    </summary>
    
      <category term="å¼€æºå­¦ä¹ " scheme="https://xsfelvis.github.io/categories/%E5%BC%80%E6%BA%90%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="ARouter" scheme="https://xsfelvis.github.io/tags/ARouter/"/>
    
      <category term="è·¯ç”±" scheme="https://xsfelvis.github.io/tags/%E8%B7%AF%E7%94%B1/"/>
    
  </entry>
  
  <entry>
    <title>ARouterè§£æä¹‹è·¯ç”±çš„ç§˜å¯†</title>
    <link href="https://xsfelvis.github.io/2018/06/05/ARouter%E8%A7%A3%E6%9E%90%E4%B9%8B%E8%B7%AF%E7%94%B1%E7%9A%84%E7%A7%98%E5%AF%86/"/>
    <id>https://xsfelvis.github.io/2018/06/05/ARouterè§£æä¹‹è·¯ç”±çš„ç§˜å¯†/</id>
    <published>2018-06-04T16:00:00.000Z</published>
    <updated>2018-06-06T15:30:42.105Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>ARouterè§£æ</p><ul><li><p><a href="https://xsfelvis.github.io/2018/06/05/ARouter%E8%A7%A3%E6%9E%90%E4%B9%8B%E6%A6%82%E8%BF%B0/">ARouteræ¦‚è¿°</a></p></li><li><p><a href="https://xsfelvis.github.io/2018/06/05/ARouter%E8%A7%A3%E6%9E%90%E4%B9%8B%E8%B7%AF%E7%94%B1%E7%9A%84%E7%A7%98%E5%AF%86/">è·¯ç”±çš„ç§˜å¯†</a></p></li><li><a href="https://xsfelvis.github.io/2018/06/06/ARouter%E8%A7%A3%E6%9E%90%E4%B9%8BURL%E8%B7%B3%E8%BD%AC/">URLè·³è½¬</a></li></ul><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>æœ¬ç¯‡ä¸»è¦ä»‹ç»ARouterå¦‚ä½•è¿›è¡Œè·¯ç”±çš„ï¼Œæ¯”å¦‚Activityã€Fragmentã€æœåŠ¡ç­‰</p><h1 id="è·¯ç”±çš„ç§˜å¯†"><a href="#è·¯ç”±çš„ç§˜å¯†" class="headerlink" title="è·¯ç”±çš„ç§˜å¯†"></a>è·¯ç”±çš„ç§˜å¯†</h1><h2 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h2><p>åˆå§‹åŒ–è·¯ç”±ä¹‹å</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ARouter.init(mApplication);</span><br></pre></td></tr></table></figure><p>åœ¨éœ€è¦æ”¯æŒé¡µé¢è·¯ç”±çš„é¡µé¢ä¸Šæ·»åŠ æ³¨è§£(è‡³å°‘ä¸¤çº§)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Route</span>(path = <span class="string">"/test/activity2"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test2Activity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span></span></span><br></pre></td></tr></table></figure><p>åœ¨è·¯ç”±æ—¶å€™é€šè¿‡å»ºé€ è€…æ¨¡å¼æ„å»ºå‚æ•°ï¼Œ<code>è·¯ç”±é¡µé¢</code>åˆ†ä¸ºä»¥ä¸‹å‡ ç§</p><h3 id="è·¯ç”±é¡µé¢"><a href="#è·¯ç”±é¡µé¢" class="headerlink" title="è·¯ç”±é¡µé¢"></a>è·¯ç”±é¡µé¢</h3><ul><li>æ™®é€šè·³è½¬</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ARouter.getInstance()</span><br><span class="line">        .build(<span class="string">"/test/activity2"</span>)</span><br><span class="line">        .navigation();</span><br></pre></td></tr></table></figure><ul><li>å¸¦å‚æ•°è·³è½¬</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ARouter.getInstance()</span><br><span class="line">    .build(<span class="string">"/test/activity2"</span>)</span><br><span class="line">    .withString(<span class="string">"key1"</span>, <span class="string">"value1"</span>)</span><br><span class="line">    .navigation();</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ARouteræä¾›äº†ä¸°å¯Œçš„å‚æ•°ç±»å‹ä¸»è¦æœ‰åŸºæœ¬ç±»å‹ã€Objectã€Parceableç­‰ï¼Œæ ¸å¿ƒåŸç†ä¹Ÿæ˜¯é€šè¿‡Bundleæºå¸¦ä¼ é€’</p><ul><li>startActivityForResult</li></ul><p>æ¯”å¦‚åœ¨TestActivityä¸­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ARouter.getInstance().build(<span class="string">"/test/activity2"</span>)</span><br><span class="line">                     .withString(<span class="string">"key1"</span>, <span class="string">"value1"</span>)</span><br><span class="line">                     .navigation(<span class="keyword">this</span>, <span class="number">999</span>);</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨TestActivityä¸­ ä½¿ç”¨onActivityResultå¾—åˆ°æ•°æ®è¿›è¡Œå¤„ç†ï¼Œè¿™é‡Œè·Ÿæ™®é€šè¿‡ç¨‹ä¸€æ ·</p><ul><li>å¸¦å›è°ƒè·¯ç”±</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ARouter.getInstance().build(<span class="string">"/xxx/xxx"</span>).navigation(<span class="keyword">this</span>, <span class="keyword">new</span> NavCallback() &#123;</span><br><span class="line">                   <span class="meta">@Override</span></span><br><span class="line">                   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFound</span><span class="params">(Postcard postcard)</span> </span>&#123;</span><br><span class="line">                       Log.d(<span class="string">"ARouter"</span>, <span class="string">"æ‰¾åˆ°äº†"</span>);</span><br><span class="line">                   &#125;</span><br><span class="line"></span><br><span class="line">                   <span class="meta">@Override</span></span><br><span class="line">                   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLost</span><span class="params">(Postcard postcard)</span> </span>&#123;</span><br><span class="line">                       Log.d(<span class="string">"ARouter"</span>, <span class="string">"æ‰¾ä¸åˆ°äº†"</span>);</span><br><span class="line">                   &#125;</span><br><span class="line"></span><br><span class="line">                   <span class="meta">@Override</span></span><br><span class="line">                   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onArrival</span><span class="params">(Postcard postcard)</span> </span>&#123;</span><br><span class="line">                       Log.d(<span class="string">"ARouter"</span>, <span class="string">"è·³è½¬å®Œäº†"</span>);</span><br><span class="line">                   &#125;</span><br><span class="line"></span><br><span class="line">                   <span class="meta">@Override</span></span><br><span class="line">                   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onInterrupt</span><span class="params">(Postcard postcard)</span> </span>&#123;</span><br><span class="line">                       Log.d(<span class="string">"ARouter"</span>, <span class="string">"è¢«æ‹¦æˆªäº†"</span>);</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;);</span><br></pre></td></tr></table></figure><h3 id="è·¯ç”±Fragment"><a href="#è·¯ç”±Fragment" class="headerlink" title="è·¯ç”±Fragment"></a>è·¯ç”±Fragment</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Fragment fragment = (Fragment) ARouter.getInstance()</span><br><span class="line">                    .build(<span class="string">"/test/fragment"</span>)</span><br><span class="line">                    .navigation();</span><br></pre></td></tr></table></figure><h3 id="è·¯ç”±æœåŠ¡"><a href="#è·¯ç”±æœåŠ¡" class="headerlink" title="è·¯ç”±æœåŠ¡"></a>è·¯ç”±æœåŠ¡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ARouter.getInstance()</span><br><span class="line">        .navigation(SingleService.class)</span><br><span class="line">        .sayHello(<span class="string">"Mike"</span>);</span><br></pre></td></tr></table></figure><h2 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h2><p>å¯ä»¥çœ‹å‡ºè·¯ç”±åˆ°é¡µé¢ åˆ†ä¸ºä¸‰æ­¥</p><ul><li>build æ„å»º ä¿¡æ¯é‚®ç¥¨(PostCard)</li></ul><p>_ARouter # build</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Build postcard by path and default group</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> Postcard <span class="title">build</span><span class="params">(String path)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (TextUtils.isEmpty(path)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> HandlerException(Consts.TAG + <span class="string">"Parameter is invalid!"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        PathReplaceService pService = ARouter.getInstance().navigation(PathReplaceService.class);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != pService) &#123;</span><br><span class="line">            path = pService.forString(path);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> build(path, extractGroup(path));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>WithXXX è·¯ç”±å‚æ•°</p></li><li><p>navagation å¯¼èˆª</p></li></ul><p>_ARouter # navagation</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">navigation</span><span class="params">(Context mContext, Postcard postcard, <span class="keyword">int</span> requestCode, NavigationCallback callback)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> _ARouter.getInstance().navigation(mContext, postcard, requestCode, callback);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å°†æŒ‰ç…§ä¸Šé¢çš„æåˆ°ä¸‰ä¸ªæ ¸å¿ƒè¿‡ç¨‹è¿›è¡Œåˆ†æ</p><ul><li>é€šè¿‡pathæ„å»ºè·¯ç”±ä¿¡æ¯</li></ul><p>buildæ˜¯åœ¨æ„å»ºè·¯ç”±ä¿¡æ¯é‚®ç¥¨â€PostCardâ€,ä»åå­—çœ‹æ¥è¿™å°±æ˜¯ä¸€å¼ è·¯ç”±é‚®ç¥¨ï¼Œè·Ÿç½‘ç»œè·¯ç”±åè®®ä¼ é€’æºå¸¦çš„ä¿¡æ¯ä½œç”¨ä¸€æ ·,é€šè¿‡ARouterè¿™ä¸ªé—¨é¢ç±»(Facade)è°ƒç”¨å®é™…æ“æ§ç€_ARouter</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Build postcard by path and default group</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> Postcard <span class="title">build</span><span class="params">(String path)</span> </span>&#123;</span><br><span class="line">      â€¦â€¦</span><br><span class="line">    <span class="comment">//è·¯å¾„æ‰©å±•</span></span><br><span class="line">    PathReplaceService pService = ARouter.getInstance().navigation(PathReplaceService.class);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> != pService) &#123;</span><br><span class="line">        path = pService.forString(path);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> build(path, extractGroup(path));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¹Ÿä½“ç°äº†ä½œè€…è®¾è®¡è¿™å¥—æ¡†æ¶çš„æ‰©å±•æ€§èƒ½ï¼Œè¿™ä¸ª<code>PathReplaceService</code>å°±æ˜¯è®©ä½¿ç”¨è€…è‡ªå·±å¯ä»¥ç»™pathæ·»åŠ æ‰©å±•ã€‚extractGroupå°±æ˜¯æ ¹æ®path(/test/activity2)æå–group(test)ï¼Œè¿™é‡Œå°±æ˜¯é»˜è®¤ç¬¬ä¸€ä¸ª/éš”æ–­çš„å­—ç¬¦ä¸²ï¼Œé€šè¿‡è¿™äº›ä¿¡æ¯<code>åˆæ­¥</code>æ„é€ è·¯ç”±ä¿¡æ¯ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">protected</span> Postcard <span class="title">build</span><span class="params">(String path, String group)</span> </span>&#123;</span><br><span class="line">       â€¦â€¦</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Postcard(path, group);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¸€ä¸ªå…·æœ‰ <code>path</code>å’Œ<code>group</code>ç®€å•ä¿¡æ¯çš„PostCardå¯¹è±¡å°±è¢«æ„é€ å‡ºæ¥äº†</p><ul><li>æºå¸¦å‚æ•°</li></ul><p>ç”±äºæ˜¯Builderæ¨¡å¼ï¼Œæ­¤æ—¶æ„é€ å‡ºpostcardä¹‹åä¹‹åçš„<code>.WithXXX</code>å®é™…ä¸Šå®åœ¨ç»™PostCardå¯¹è±¡å¡«å……ä¿¡æ¯ï¼ŒPostCardå¯¹è±¡çš„Bundleæ¥æ‰¿è½½è¿™äº›ä¿¡æ¯ï¼Œ<br>å…¶ä¸­ åºåˆ—åŒ–å¯¹è±¡<code>SerializationService</code>è½¬æˆjsonå­˜åˆ°Bundleä¸­<br>é€šè¿‡è¿™ä¸€æ­¥PostCardè¿™ä¸ª<code>é‚®ç¥¨</code>ä¿¡æ¯è¿›ä¸€æ­¥ä¸°æ»¡äº†</p><ul><li>navigation å¯¼èˆª</li></ul><p>å¾—åˆ°PostCardå¯¹è±¡ä¹‹åå›å»è°ƒç”¨postCardå¯¹è±¡çš„navigationå¯¹è±¡,è°ƒç”¨å‡½æ•°é“¾å¦‚ä¸‹</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PostCardï¼ˆArouter.getInstance.build("test/activity2")ï¼‰â€”â€”&gt;PostCard#navigationâ€”â€”&gt;ARouter#navigation</span><br><span class="line">â€”â€”&gt;_ARouter#navigation`</span><br></pre></td></tr></table></figure><h4 id="ARouter-navigation"><a href="#ARouter-navigation" class="headerlink" title="_ARouter#navigation"></a>_ARouter#navigation</h4><p>æ¥åˆ°äº†æ ¸å¿ƒå‡½æ•° <code>_ARouter#navigation</code>å‡½æ•°ä¸­,è¿™ä¸ªå‡½æ•°å…¶å®æ˜¯æ ¸å¿ƒè·¯ç”±é€»è¾‘çš„ç¬¬ä¸€é“å¤§é—¨,æˆ‘ä»¬è¶Šæ¥è¶Šæ¥è¿‘çœŸç›¸äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> Object <span class="title">navigation</span><span class="params">(<span class="keyword">final</span> Context context, <span class="keyword">final</span> Postcard postcard, <span class="keyword">final</span> <span class="keyword">int</span> requestCode, <span class="keyword">final</span> NavigationCallback callback)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//å®Œå–„postCard æ ¸å¿ƒä¿¡æ¯,ä¸»è¦æ˜¯è·³è½¬è·¯å¾„ åé¢ä¼šè¯¦ç»†åˆ†æ</span></span><br><span class="line">        LogisticsCenter.completion(postcard);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NoRouteFoundException ex) &#123;</span><br><span class="line">        <span class="comment">// æœªæ‰¾åˆ°é¡µé¢çš„é™çº§å¤„ç†ç­–ç•¥</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != callback) &#123;</span><br><span class="line">            <span class="comment">//è‡ªå®šä¹‰å›è°ƒé«˜äºç³»ç»Ÿ</span></span><br><span class="line">            callback.onLost(postcard);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// No callback for this invoke, then we use the global degrade service.</span></span><br><span class="line">            <span class="comment">//æ²¡æœ‰è‡ªå®šä¹‰å›è°ƒæ‰ä½¿ç”¨ç³»ç»ŸonLost</span></span><br><span class="line">            DegradeService degradeService = ARouter.getInstance().navigation(DegradeService.class);</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> != degradeService) &#123;</span><br><span class="line">                degradeService.onLost(context, postcard);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> != callback) &#123;</span><br><span class="line">        <span class="comment">//onFoundå›è°ƒ</span></span><br><span class="line">        callback.onFound(postcard);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!postcard.isGreenChannel()) &#123;   <span class="comment">// It must be run in async thread, maybe interceptor cost too mush time made ANR.</span></span><br><span class="line">        <span class="comment">//éç»¿è‰²é€šé“æ£€æŸ¥æ‹¦æˆªå™¨</span></span><br><span class="line">        interceptorService.doInterceptions(postcard, <span class="keyword">new</span> InterceptorCallback() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onContinue</span><span class="params">(Postcard postcard)</span> </span>&#123;</span><br><span class="line">            <span class="comment">//çœŸæ­£æ ¸å¿ƒå¯¼èˆªé€»è¾‘</span></span><br><span class="line">            _navigation(context, postcard, requestCode, callback);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onInterrupt</span><span class="params">(Throwable exception)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != callback) &#123;</span><br><span class="line">                    callback.onInterrupt(postcard);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//çœŸæ­£æ ¸å¿ƒå¯¼èˆªé€»è¾‘</span></span><br><span class="line">        <span class="keyword">return</span> _navigation(context, postcard, requestCode, callback);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•è¾ƒé•¿ ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å››æ­¥</p><ol><li>é¦–å…ˆè°ƒç”¨LogisticsCenter.completionå®Œæˆpostcardçš„è¡¥å……</li><li>NavigationCallBackçš„å¤„ç†</li><li>æ‹¦æˆªå™¨Interceptionsçš„å¤„ç†</li><li>å¼€å§‹è·¯ç”±å¯¼èˆª</li></ol><p>è·¯ç”±å¯¼èˆªä¹‹å‰å¦‚ä½•å°†ä¹‹å‰è·å–çš„postcardä¿¡æ¯è¿›è¡Œå®Œå–„?<br>ARouter.getInstance() .build(â€œ/test/activity2â€)æ—¶å·²ç»è¿”å›äº†ä¸€ä¸ªpostcardå¯¹è±¡ï¼Œé‚£ä¹ˆè¦å®Œå–„é‚£äº›ä¿¡æ¯å‘¢ï¼Ÿå…¶å®æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œpostcardä¸­åªæœ‰pathå’Œgroupçš„ä¿¡æ¯ï¼Œç›®æ ‡é¡µé¢æ˜¯ä»€ä¹ˆè¿˜ä¸æ˜ç¡®ï¼Œå› æ­¤éœ€è¦è¿›ä¸€æ­¥å®Œå–„ä¿¡æ¯ï¼Œæ ¸å¿ƒå‡½æ•°å°±æ˜¯ä¸Šé¢çš„LogisticsCenter.completionï¼Œè¿™æ ·å°±ä½“ç°äº†æ¡†æ¶çš„é‡è¦æ€§ï¼Œè„æ´»ç´¯æ´»äº¤ç»™æ¡†æ¶å±‚é¢ï¼Œè€Œè·Ÿç”¨æˆ·æ‰“äº¤é“çš„æ°¸è¿œéƒ½æ˜¯é‚£ä¹ˆçš„ç®€æ´ã€‚</p><h4 id="ARouter-navigationObject-navigation"><a href="#ARouter-navigationObject-navigation" class="headerlink" title="_ARouter#navigationObject navigation("></a>_ARouter#navigationObject navigation(</h4><p>æœ€åä¼šæ¥åˆ°_ARouter#navigationObject navigation(final Context context, final Postcard postcard, final int requestCode, final NavigationCallback callback)ï¼‰</p><p>è¿™ä¸ªå‡½æ•°è´Ÿè´£æœ€ç»ˆçš„é¡µé¢è·³è½¬</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Object <span class="title">_navigation</span><span class="params">(<span class="keyword">final</span> Context context, <span class="keyword">final</span> Postcard postcard, <span class="keyword">final</span> <span class="keyword">int</span> requestCode, <span class="keyword">final</span> NavigationCallback callback)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> Context currentContext = <span class="keyword">null</span> == context ? mContext : context;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (postcard.getType()) &#123;</span><br><span class="line">            <span class="keyword">case</span> ACTIVITY:</span><br><span class="line">                <span class="comment">// Build intent</span></span><br><span class="line">                <span class="keyword">final</span> Intent intent = <span class="keyword">new</span> Intent(currentContext, postcard.getDestination());</span><br><span class="line">                intent.putExtras(postcard.getExtras());</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Set flags.</span></span><br><span class="line">                <span class="keyword">int</span> flags = postcard.getFlags();</span><br><span class="line">                <span class="keyword">if</span> (-<span class="number">1</span> != flags) &#123;</span><br><span class="line">                    intent.setFlags(flags);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!(currentContext <span class="keyword">instanceof</span> Activity)) &#123;    <span class="comment">// Non activity, need less one flag.</span></span><br><span class="line">                    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Navigation in main looper.</span></span><br><span class="line">                <span class="keyword">new</span> Handler(Looper.getMainLooper()).post(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                        <span class="keyword">if</span> (requestCode &gt; <span class="number">0</span>) &#123;  <span class="comment">// Need start for result</span></span><br><span class="line">                            ActivityCompat.startActivityForResult((Activity) currentContext, intent, requestCode, postcard.getOptionsBundle());</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            ActivityCompat.startActivity(currentContext, intent, postcard.getOptionsBundle());</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> ((-<span class="number">1</span> != postcard.getEnterAnim() &amp;&amp; -<span class="number">1</span> != postcard.getExitAnim()) &amp;&amp; currentContext <span class="keyword">instanceof</span> Activity) &#123;    <span class="comment">// Old version.</span></span><br><span class="line">                            ((Activity) currentContext).overridePendingTransition(postcard.getEnterAnim(), postcard.getExitAnim());</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> (<span class="keyword">null</span> != callback) &#123; <span class="comment">// Navigation over.</span></span><br><span class="line">                            callback.onArrival(postcard);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> PROVIDER:</span><br><span class="line">                <span class="keyword">return</span> postcard.getProvider();</span><br><span class="line">            <span class="keyword">case</span> BOARDCAST:</span><br><span class="line">            <span class="keyword">case</span> CONTENT_PROVIDER:</span><br><span class="line">            <span class="keyword">case</span> FRAGMENT:</span><br><span class="line">                Class fragmentMeta = postcard.getDestination();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Object instance = fragmentMeta.getConstructor().newInstance();</span><br><span class="line">                    <span class="keyword">if</span> (instance <span class="keyword">instanceof</span> Fragment) &#123;</span><br><span class="line">                        ((Fragment) instance).setArguments(postcard.getExtras());</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (instance <span class="keyword">instanceof</span> android.support.v4.app.Fragment) &#123;</span><br><span class="line">                        ((android.support.v4.app.Fragment) instance).setArguments(postcard.getExtras());</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> instance;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">                    logger.error(Consts.TAG, <span class="string">"Fetch fragment instance error, "</span> + TextUtils.formatStackTrace(ex.getStackTrace()));</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">case</span> METHOD:</span><br><span class="line">            <span class="keyword">case</span> SERVICE:</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><ul><li>Activity</li></ul><p>æ¥åˆ°ACTIVITYåˆ†æ”¯ï¼Œä»postcardä¸­æ‹¿åˆ°ç›®æ ‡é¡µé¢TestActivity.classç„¶åç»„æˆintentï¼Œç„¶åputExtrasï¼Œå¦‚æœæ˜¯startActivityForResult,è¿™é‡Œé¢å°±æœ‰å‚æ•°ã€‚å¦‚æœcontextä¸æ˜¯activityï¼Œé‚£ä¹ˆå°±éœ€è¦å¦èµ·ä¸€ä¸ªæ ˆIntent.FLAG_ACTIVITY_NEW_TASKè¿›è¡Œactivityçš„å±•ç¤ºã€‚æ¥ä¸‹æ¥é€šè¿‡handlerå‘é€å¯åŠ¨activityçš„ä»»åŠ¡ã€‚ç»ˆäºæ‰¾åˆ°äº†ç†Ÿæ‚‰çš„ActivityCompat.startActivityå’ŒActivityCompat.startActivityForResultï¼Œ</p><ul><li>Fragment</li></ul><p>é€šè¿‡postcardæ‹¿åˆ°ç›®æ ‡é¡µé¢çš„Fragment Classï¼Œç„¶åå®ä¾‹åŒ–è¿™ä¸ªï¼Œè¿˜éœ€è¦å…¼å®¹fragmentï¼Œè®¾ç½®Argumentså‚æ•°ä¹‹åè¿”å›è¿™ä¸ªFragmentå®ä¾‹</p><ul><li>Provider</li></ul><p>è¿™ä¸ªæ˜¯ç”¨æ¥æä¾›æœåŠ¡çš„ï¼Œç”±äºåœ¨ å®Œå–„postCard æ ¸å¿ƒä¿¡æ¯,<code>LogisticsCenter.completion(postcard);</code>ä¸­å·²ç»å°†providerå®ä¾‹åŒ–äº†ï¼Œè¿™é‡Œç›´æ¥ç›´æ¥getå‡ºæ¥å°±å¥½ã€‚åé¢å°†ä¼šåˆ†æ<code>LogisticsCenter.completion(postcard)</code>å…·ä½“åšäº†å“ªäº›å·¥ä½œ</p><h4 id="LogisticsCenter-completion-postcard"><a href="#LogisticsCenter-completion-postcard" class="headerlink" title="LogisticsCenter.completion(postcard)"></a>LogisticsCenter.completion(postcard)</h4><p>è¿™ä¸ªå‡½æ•°å°±æ˜¯å®Œå–„PostCardä¿¡æ¯çš„ï¼Œpostcardæ˜¯è·¯ç”±ä¿¡æ¯çš„å®¹å™¨ï¼Œåˆ°è¿™ä¸ªå‡½æ•°æ—¶å€™postcardä¸­åªæœ‰pathå’Œgroupçš„ä¿¡æ¯ï¼Œç›®æ ‡é¡µé¢æ˜¯ä»€ä¹ˆè¿˜ä¸çŸ¥é“ï¼ŒLogisticsCenter.completionå°±æ˜¯å¡«å……å‰©ä½™çš„å…³é”®ä¿¡æ¯çš„ï¼Œbå¹¶ä¸”æ˜¯é€šè¿‡<code>æŒ‰éœ€åŠ è½½çš„</code>,ååˆ†é‡è¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">completion</span><span class="params">(Postcard postcard)</span> </span>&#123;</span><br><span class="line">    â€¦â€¦</span><br><span class="line">    <span class="comment">//ä»ä»“åº“WareHouseä¸­è·å–è·¯ç”±å…ƒæ•°æ®ï¼Œå³ä¸€äº›è·¯ç”±åŸºæœ¬çš„æ•°æ®</span></span><br><span class="line">    RouteMeta routeMeta = Warehouse.routes.get(postcard.getPath());</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> == routeMeta) &#123;    <span class="comment">// Maybe its does't exist, or didn't load.</span></span><br><span class="line">        Class&lt;? extends IRouteGroup&gt; groupMeta = Warehouse.groupsIndex.get(postcard.getGroup());  <span class="comment">// Load route meta.</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == groupMeta) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoRouteFoundException(TAG + <span class="string">"There is no route match the path ["</span> + postcard.getPath() + <span class="string">"], in group ["</span> + postcard.getGroup() + <span class="string">"]"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Load route and cache it into memory, then delete from metas.</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                â€¦â€¦</span><br><span class="line">                <span class="comment">//å°†ä¿¡æ¯åŠ è½½è¿›Warehouse.routesä¸­</span></span><br><span class="line">                IRouteGroup iGroupInstance = groupMeta.getConstructor().newInstance();</span><br><span class="line">                iGroupInstance.loadInto(Warehouse.routes);</span><br><span class="line">                Warehouse.groupsIndex.remove(postcard.getGroup());</span><br><span class="line">                â€¦â€¦</span><br><span class="line">            &#125; </span><br><span class="line">            â€¦â€¦</span><br><span class="line">            <span class="comment">//ç»è¿‡ä¸Šé¢çš„å¤„ç†åï¼Œæ­¤æ—¶å¯ä»¥è·å–åˆ°å¯¹åº”pathä¸‹çš„routeMetaï¼Œè°ƒç”¨æœ¬èº«</span></span><br><span class="line">            completion(postcard);   <span class="comment">// Reload</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//æ­£å¸¸è·å–åˆ°routeMetaå¡«å……postCardä¿¡æ¯</span></span><br><span class="line">        postcard.setDestination(routeMeta.getDestination());</span><br><span class="line">        postcard.setType(routeMeta.getType());</span><br><span class="line">        postcard.setPriority(routeMeta.getPriority());</span><br><span class="line">        postcard.setExtra(routeMeta.getExtra());</span><br><span class="line"></span><br><span class="line">        Uri rawUri = postcard.getUri();</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != rawUri) &#123;   <span class="comment">// Try to set params into bundle.</span></span><br><span class="line">            Map&lt;String, String&gt; resultMap = TextUtils.splitQueryParameters(rawUri);</span><br><span class="line">            Map&lt;String, Integer&gt; paramsType = routeMeta.getParamsType();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (MapUtils.isNotEmpty(paramsType)) &#123;</span><br><span class="line">                <span class="comment">// Set value by its type, just for params which annotation by @Param</span></span><br><span class="line">                <span class="keyword">for</span> (Map.Entry&lt;String, Integer&gt; params : paramsType.entrySet()) &#123;</span><br><span class="line">                    setValue(postcard,</span><br><span class="line">                            params.getValue(),</span><br><span class="line">                            params.getKey(),</span><br><span class="line">                            resultMap.get(params.getKey()));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Save params name which need auto inject.</span></span><br><span class="line">                postcard.getExtras().putStringArray(ARouter.AUTO_INJECT, paramsType.keySet().toArray(<span class="keyword">new</span> String[]&#123;&#125;));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Save raw uri</span></span><br><span class="line">            postcard.withString(ARouter.RAW_URI, rawUri.toString());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (routeMeta.getType()) &#123;</span><br><span class="line">            <span class="comment">//å®Œæˆä¿¡æ¯çš„åŒæ—¶é¡ºä¾¿æŠŠ"æœåŠ¡å®ä¾‹åŒ–"ï¼Œfragmentç½®ä¸ºæ— é¡»è¿‡æ»¤çš„ç»¿è‰²é€šé“</span></span><br><span class="line">            <span class="keyword">case</span> PROVIDER:  <span class="comment">// if the route is provider, should find its instance</span></span><br><span class="line">                <span class="comment">// Its provider, so it must implement IProvider</span></span><br><span class="line">                Class&lt;? extends IProvider&gt; providerMeta = (Class&lt;? extends IProvider&gt;) routeMeta.getDestination();</span><br><span class="line">                IProvider instance = Warehouse.providers.get(providerMeta);</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> == instance) &#123; <span class="comment">// There's no instance of this provider</span></span><br><span class="line">                    IProvider provider;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        provider = providerMeta.getConstructor().newInstance();</span><br><span class="line">                        provider.init(mContext);</span><br><span class="line">                        Warehouse.providers.put(providerMeta, provider);</span><br><span class="line">                        instance = provider;</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> HandlerException(<span class="string">"Init provider failed! "</span> + e.getMessage());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                postcard.setProvider(instance);</span><br><span class="line">                postcard.greenChannel();    <span class="comment">// Provider should skip all of interceptors</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> FRAGMENT:</span><br><span class="line">                postcard.greenChannel();    <span class="comment">// Fragment needn't interceptors</span></span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµç¨‹å›¾å¦‚ä¸‹<br><img src="http://p927u2n0k.bkt.clouddn.com/arouter-complete.png" alt="arouter-complete"></p><p>è¿™ä¸ªæœ‰ä¸€ä¸ªå…³é”®ç‚¹ WearHouse</p><ul><li>ä»“åº“æŸ¥æ‰¾é¡µé¢èŠ‚ç‚¹</li></ul><p>é¦–å…ˆæ ¹æ®è·¯å¾„ä¿¡æ¯åˆ°WareHouseä»“åº“ä¸­æŸ¥æ‰¾è·¯ç”±èŠ‚ç‚¹ä¿¡æ¯ï¼Œå…¶å®å°±æ˜¯å‡ ä¸ªmapï¼ŒåŒ…å«èŠ‚ç‚¹ã€æ‹¦æˆªå™¨å’Œç»„åˆ«ç­‰ä¿¡æ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RouteMeta routeMeta = Warehouse.routes.get(postcard.getPath());</span><br></pre></td></tr></table></figure><p>ä¸€å¼€å§‹æ˜¯æ²¡æœ‰è¿™ä¸ªèŠ‚ç‚¹ä¿¡æ¯çš„ï¼Œæ‰€ä»¥éœ€è¦åˆ°WareHouse.groupsIndexä¸­æ‰¾åˆ°ç»„åˆ«çš„ä¿¡æ¯ï¼Œè¿™é‡Œä½“ç°äº†ä¹‹å‰æåˆ°çš„<code>åˆ†ç»„åŠ è½½çš„ç­–ç•¥</code>ï¼Œè¿™é‡Œå¯¹åº”çš„æ˜¯testè¿™ä¸€ç»„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;? extends IRouteGroup&gt; groupMeta = Warehouse.groupsIndex.get(postcard.getGroup());  <span class="comment">// Load route meta</span></span><br></pre></td></tr></table></figure><p>ç„¶åé€šè¿‡åå°„çš„æ–¹å¼åŠ è½½è¿™ä¸€ç»„ç±»åˆ«çš„æ˜ å°„å…³ç³»ï¼Œå°±æ˜¯å‰é¢æåˆ°çš„æŒ‰éœ€åŠ è½½ï¼Œç„¶åä»ä»“åº“ä¸­åˆ é™¤è¿™ä¸ªç»„åˆ«ä¿¡æ¯èŠ‚ç‚¹ï¼Œé˜²æ­¢é‡å¤åŠ è½½</p><pre><code class="java">IRouteGroup iGroupInstance = groupMeta.getConstructor().newInstance();        iGroupInstance.loadInto(Warehouse.routes);    Warehouse.groupsIndex.remove(postcard.getGroup());</code></pre><p>å…¶ä¸­ç¼–è¯‘æœŸé—´å·²ç»ç»„æˆäº†RouteMetaè¿™ä¸ªèŠ‚ç‚¹ä¿¡æ¯ï¼ŒåŒ…å«æœ‰ç›®æ ‡é¡µé¢ã€ç±»å‹ã€è·¯å¾„ã€ç»„åˆ«ã€å‚æ•°ã€ä¼˜å…ˆçº§ç­‰ä¿¡æ¯ã€‚å¯ä»¥çœ‹åˆ°ç”Ÿæˆä¹‹åçš„ä¿¡æ¯è¡¨å¹¶æ²¡æœ‰ç›´æ¥åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè€Œæ˜¯åœ¨ç¬¬ä¸€æ¬¡è®¿é—®è¯¥ç»„å†…ä¸€ä¸ªé¡µé¢æ—¶æ‰å»åŠ è½½è¯¥ç»„çš„ä¿¡æ¯ï¼Œç„¶åè¯¥groupindexç§»é™¤ï¼Œé˜²æ­¢é‡å¤åŠ è½½</p><p>ç”Ÿæˆçš„<code>ARouter$$Group$$test</code></p><p><img src="https://upload-images.jianshu.io/upload_images/2608779-20192e96ae6f869f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt="testç»„"></p><ul><li>å¡«å……ä¿¡æ¯</li></ul><p>å½“ç¬¬ä¸€æ¬¡æ²¡æœ‰æŸ¥æ‰¾åˆ°è·¯ç”±èŠ‚ç‚¹ä¹‹åï¼Œè¦åˆ°ç»„åˆ«ä¸­æ‰¾åˆ°è·¯ç”±ä¿¡æ¯ loadåˆ°warehouseä¸­ï¼Œå†æ¬¡è°ƒç”¨æœ¬èº«<code>completion(postcard)</code>å‡½æ•°.ç„¶åæ‰§è¡Œåˆ°elseä¸­å¡«å……è·¯ç”±ä¿¡æ¯</p><ul><li>ä¸€äº›åˆå§‹åŒ–</li></ul><p>å¡«å……ç©ä¿¡æ¯åï¼Œå°†â€æœåŠ¡â€å®ä¾‹åŒ–ï¼Œæ–¹ä¾¿åé¢ç›´æ¥è·å–ï¼Œå¹¶ä¸”å°†â€œæœåŠ¡â€å’Œfragmentè®¾ç½®ä¸ºç»¿è‰²é€šé“æ— éœ€æ£€æŸ¥ï¼Œæ„Ÿè§‰æ˜¯ç”±äºäºŒè€…æœ¬èº«éœ€è¦è¿”å›ä¸€ä¸ªå®ä¾‹ï¼Œå›è°ƒæ¥å£NavCallBackåªèƒ½å›è°ƒPostCardä¿¡æ¯ï¼Œè€Œä¸”äºŒè€…è¿‘ä¼¼æœåŠ¡æ€§è´¨ï¼Œå› è€Œä¸å¦‚ç›´æ¥ç»™ä¸ªç»¿è‰²é€šé“æ¥çš„ç›´æ¥ã€‚</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>è·¯ç”±ä¹‹é—´è·³è½¬åˆ°çš„åˆ†æåˆ°æ­¤åŸºæœ¬ä¸Šå‘Šä¸€æ®µè½äº†ï¼Œå…¶ä¸­ä¼—å¤šä¿¡æ¯éƒ½åœ¨PostCardä¸­ä¸æ–­å®Œå–„ï¼Œç„¶ååœ¨LogisticsCenter.completionè¿›è¡Œå®Œå…¨å¡«å……ï¼Œæ›´é‡è¦çš„æ˜¯æ•´ä½“æ¶æ„å…³æ³¨ç‚¹åˆ†ç¦»çš„è®¾è®¡æ˜¯éå¸¸æ£’çš„ï¼Œç¼–è¯‘æœŸé—´æ˜ å°„ä¿¡æ¯éƒ½ä¸‹æ²‰åˆ°LogisticsCenterä¸ç”¨æˆ·å±‚æ‰“äº¤é“çš„APIéƒ½é€šè¿‡ARouterè¿™ä¸ªé—¨é¢å‹å¥½çš„æš´éœ²ç»™ç”¨æˆ·ï¼Œæˆ‘ä»¬å¹³æ—¶åœ¨å¼€å‘è®¾è®¡ä¸­ä¹Ÿå¯ä»¥è¿™æ ·å­¦ä¹ ä¸€ä¸‹</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;p&gt;ARouterè§£æ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://xsfelvis.github.io/2018/06/05/ARouter%E8%A7%
      
    
    </summary>
    
      <category term="å¼€æºå­¦ä¹ " scheme="https://xsfelvis.github.io/categories/%E5%BC%80%E6%BA%90%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="ARouter" scheme="https://xsfelvis.github.io/tags/ARouter/"/>
    
      <category term="è·¯ç”±" scheme="https://xsfelvis.github.io/tags/%E8%B7%AF%E7%94%B1/"/>
    
  </entry>
  
  <entry>
    <title>cleanæ¶æ„</title>
    <link href="https://xsfelvis.github.io/2018/05/18/%E5%85%B3%E4%BA%8Eclean%E6%9E%B6%E6%9E%84%E5%9C%A8android%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/"/>
    <id>https://xsfelvis.github.io/2018/05/18/å…³äºcleanæ¶æ„åœ¨androidä¸­çš„åº”ç”¨/</id>
    <published>2018-05-17T16:00:00.000Z</published>
    <updated>2018-06-06T06:13:38.572Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h2 id="1ã€cleanæ¶æ„ç®€ä»‹"><a href="#1ã€cleanæ¶æ„ç®€ä»‹" class="headerlink" title="1ã€cleanæ¶æ„ç®€ä»‹"></a>1ã€cleanæ¶æ„ç®€ä»‹</h2><p>cleanæ¶æ„ç›¸ä¿¡å¤§å®¶æ—©æœ‰è€³é—»ï¼Œæ¯•ç«Ÿæ˜¯Bobå¤§å”çš„å¿ƒè¡€ä¹‹ä½œï¼Œæœ€è¿‘åˆæŠŠ<a href="http://five.agency/blog/android/" target="_blank" rel="noopener">http://five.agency/blog/android/</a> å‡ ç¯‡å…³äºclean æ¶æ„çš„æ–‡ç« æ‹¿å‡ºæ¥è¯»è¯»åŠ æ·±äº†å¯¹è¯¥æ¶æ„çš„ä¸€äº›ç†è§£ã€‚cleanæ¶æ„åˆç§°â€œæ´‹è‘±æ¶æ„â€ï¼Œè¿™ä¸ªæ˜¯ç”±äºå®ƒçš„æ¶æ„ç¤ºæ„å›¾å¾—åçš„<br><img src="https://user-gold-cdn.xitu.io/2018/5/15/16364599d2727324?w=896&amp;h=472&amp;f=png&amp;s=104636" alt="" title="image.png"><br>åˆ é™¤ä¸€äº›androidé¡¹ç›®ä¸­ä½¿ç”¨ä¸åˆ°çš„ä¸œè¥¿åŠ ä¸Šæˆ‘ä»¬ä½¿ç”¨çš„ä¸œè¥¿çœ‹èµ·æ¥å¦‚ä¸‹å›¾</p><p><img src="https://user-gold-cdn.xitu.io/2018/5/15/16364599d36a65e7?w=892&amp;h=467&amp;f=png&amp;s=96377" alt="" title="image.png"></p><h2 id="2ã€æ ¸å¿ƒæ¦‚å¿µ"><a href="#2ã€æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="2ã€æ ¸å¿ƒæ¦‚å¿µ"></a>2ã€æ ¸å¿ƒæ¦‚å¿µ</h2><p>ä»æœ€æŠ½è±¡çš„æ ¸å¿ƒåˆ°ç»†èŠ‚çš„è¾¹ç¼˜</p><h3 id="Entities"><a href="#Entities" class="headerlink" title="Entities"></a>Entities</h3><ul><li><p>Entitiesï¼Œ<br>å³<strong>Domain å¯¹è±¡</strong>æˆ–ä¸šåŠ¡å¯¹è±¡ï¼Œæ˜¯Appçš„æ ¸å¿ƒã€‚ å®ƒä»¬ä»£è¡¨äº†APPçš„ä¸»è¦åŠŸèƒ½ï¼Œ å®ƒä»¬åŒ…å«ä¸šåŠ¡é€»è¾‘ï¼Œ ä»–ä»¬ä¸ä¼šä¸å¤–åœ¨ä¸–ç•Œçš„ç»†èŠ‚è¿›è¡Œäº’åŠ¨ã€‚</p></li><li><p>Use caseï¼Œ<br>åˆåinteractorsï¼ˆäº¤äº’å™¨ï¼‰ï¼Œåˆåbusiness servicesï¼Œæ˜¯Entitiesçš„æ‰©å±•ï¼Œæ˜¯ä¸šåŠ¡é€»è¾‘çš„å»¶ä¼¸ï¼Œä¹Ÿå°±æ˜¯è¯´ã€‚ å®ƒä»¬åŒ…å«çš„é€»è¾‘ä¸ä»…é™äºä¸€ä¸ªå®ä½“ï¼Œè€Œæ˜¯å¤„ç†æ›´å¤šçš„å®ä½“ã€‚</p></li></ul><h3 id="Repositories"><a href="#Repositories" class="headerlink" title="Repositories"></a>Repositories</h3><p>Repositoriesç”¨äºæŒä¹…åŒ–Entitiesã€‚ å°±è¿™ä¹ˆç®€å•ã€‚ å®ƒä»¬è¢«å®šä¹‰ä¸ºæ¥å£å¹¶ç”¨ä½œæƒ³è¦å¯¹Entitiesæ‰§è¡ŒCRUDæ“ä½œçš„ç”¨ä¾‹çš„è¾“å‡ºç«¯å£ã€‚</p><h3 id="Presenters"><a href="#Presenters" class="headerlink" title="Presenters"></a>Presenters</h3><p>å¦‚æœä½ ç†Ÿæ‚‰MVPæ¨¡å¼ï¼ŒPresenterså°±ä¼šåšä½ æœŸæœ›ä»–ä»¬åšçš„äº‹æƒ…ã€‚ ä»–ä»¬å¤„ç†ç”¨æˆ·äº¤äº’ï¼Œè°ƒç”¨é€‚å½“çš„ä¸šåŠ¡é€»è¾‘ï¼Œå¹¶å°†æ•°æ®å‘é€åˆ°UIè¿›è¡Œæ¸²æŸ“ã€‚ è¿™é‡Œé€šå¸¸æœ‰ä¸åŒç±»å‹ä¹‹é—´çš„æ˜ å°„<br>å¤§æ¦‚è¿™å‡ ä¸ªæ¦‚å¿µå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„ç†è§£clean æ¶æ„ï¼Œä½†æ˜¯æ ¸å¿ƒä¸€ç‚¹å°±æ˜¯è¶Šåœ¨æ´‹è‘±é‡Œé¢è¶Šæ˜¯æŠ½è±¡ã€‚</p><h2 id="3ã€clean-æ¶æ„çš„æ ¸å¿ƒè§„åˆ™"><a href="#3ã€clean-æ¶æ„çš„æ ¸å¿ƒè§„åˆ™" class="headerlink" title="3ã€clean æ¶æ„çš„æ ¸å¿ƒè§„åˆ™"></a>3ã€clean æ¶æ„çš„æ ¸å¿ƒè§„åˆ™</h2><p>é¦–å…ˆéœ€è¦æŒæ¡æ¶‰åŠçš„é¢†åŸŸï¼ŒåŸæ–‡ç§°ä½œâ€œMaster of your domainâ€ï¼Œå°±æ˜¯è¯´å½“ä½ æ‰“å¼€ä½ çš„å·¥ç¨‹ï¼Œé™¤å»æŠ€æœ¯ç›¸å…³ï¼Œä½ å°±åº”è¯¥ä»å®è§‚ä¸ŠçŸ¥æ™“ä½ çš„appæ˜¯åšä»€ä¹ˆçš„ï¼Œè€Œä¸è¦æ²‰æµ¸åˆ°ç»†èŠ‚ä¹‹ä¸­â€ ä¸ºå•¥éœ€è¦æˆ‘ä»¬ç«™åœ¨è¿™ä¸ªé«˜åº¦å»çœ‹å¾…è‡ªå·±çš„é¡¹ç›®å‘¢ï¼Œå› ä¸ºè¿™ä¹Ÿæ˜¯cleanæ ¸å¿ƒæ‰€åœ¨ï¼Œè¯¥æ¶æ„è¶Šå¾€æ´‹è‘±é‡Œé¢æŠ½è±¡åº¦è¶Šæ¥è¶Šé«˜ï¼Œéƒ½æ˜¯ä¸šåŠ¡é€»è¾‘çš„é«˜åº¦æŠ½è±¡ï¼Œå³â€å†…å±‚åŒ…å«ä¸šåŠ¡é€»è¾‘ã€å¤–å±‚åŒ…å«å®ç°ç»†èŠ‚â€</p><p>ç»§è€Œç»™å‡ºäº†è®¾è®¡å‡ºè¿™æ ·ç‰¹æ€§çš„cleanæ¶æ„éœ€è¦å…·å¤‡çš„æŠ€æœ¯ç‚¹</p><p>ï¼ˆ1ï¼‰Dependency ruleï¼ˆä¾èµ–åŸåˆ™ï¼‰</p><p>ï¼ˆ2ï¼‰Abstractionï¼ˆæŠ½è±¡ï¼‰</p><p>ï¼ˆ3ï¼‰Communication between layersï¼ˆå±‚ä¹‹é—´çš„é€šä¿¡ï¼‰</p><p>ä¸‹é¢å°†ä¸€ä¸€ä»‹ç»</p><h3 id="3-1-Dependency-ruleï¼ˆä¾èµ–åŸåˆ™ï¼‰"><a href="#3-1-Dependency-ruleï¼ˆä¾èµ–åŸåˆ™ï¼‰" class="headerlink" title="3.1 Dependency ruleï¼ˆä¾èµ–åŸåˆ™ï¼‰"></a>3.1 Dependency ruleï¼ˆä¾èµ–åŸåˆ™ï¼‰</h3><p>ä»æœ€å¼€å§‹çš„ç¬¬ä¸€å¹…æˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºç®­å¤´æ˜¯â€ä¾èµ–â€,å³ å¤–å±‚çœ‹åˆ°å¹¶äº†è§£å†…å±‚ï¼Œä½†æ˜¯å†…å±‚æ—¢çœ‹ä¸åˆ°ä¹Ÿä¸çŸ¥é“å¤–å±‚ï¼Œç»“åˆå‰é¢æ‰€å¼ºè°ƒçš„ å†…å±‚åŒ…å«ä¸šåŠ¡é€»è¾‘ï¼ˆæŠ½è±¡ï¼‰ï¼Œå¤–å±‚åŒ…å«å®ç°ç»†èŠ‚ã€‚ ç»“åˆä¾èµ–å…³ç³»è§„åˆ™ï¼Œä¸šåŠ¡é€»è¾‘æ—¢çœ‹ä¸åˆ°ï¼Œä¹Ÿä¸çŸ¥é“å®ç°ç»†èŠ‚ã€‚ é€šå¸¸æˆ‘ä»¬å¯ä»¥é€šè¿‡æ”¾åœ¨ä¸åŒçš„moduleä¸­å»æ¥è°ƒæ•´å®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»<br><img src="https://user-gold-cdn.xitu.io/2018/5/15/16364599d4727672?w=456&amp;h=405&amp;f=png&amp;s=64878" alt="" title="image.png"></p><h3 id="3-2-Abstractionï¼ˆæŠ½è±¡ï¼‰"><a href="#3-2-Abstractionï¼ˆæŠ½è±¡ï¼‰" class="headerlink" title="3.2 Abstractionï¼ˆæŠ½è±¡ï¼‰"></a>3.2 Abstractionï¼ˆæŠ½è±¡ï¼‰</h3><p>ä¹‹å‰ä¹Ÿè¯´è¿‡å½“ä½ èµ°å‘å›¾çš„ä¸­é—´æ—¶ï¼Œä¸œè¥¿å˜å¾—æ›´åŠ æŠ½è±¡ã€‚ è¿™æ˜¯æœ‰é“ç†çš„ï¼šæŠ½è±¡å¾€å¾€æ¯”ç»†èŠ‚æ›´åŠ ç¨³å®šï¼Œå°±åƒæ­ç§¯æœ¨ä¸€æ ·æ ¹åŸºè¶Šç¨³è¶Šå¥½ã€‚</p><p>ä¸¾ä¸ªä¾‹å­æ¯”å¦‚æˆ‘ä»¬å¯ä»¥å°†æŠ½è±¡æ¥å£å®šä¹‰ä¸ºâ€œåŠ è½½ç½‘ç»œå›¾ç‰‡â€å¹¶å°†å…¶æ”¾å…¥å†…å±‚ï¼Œä¸šåŠ¡é€»è¾‘å°±å¯ä»¥ä½¿ç”¨å®ƒæ¥æ˜¾ç¤ºå›¾ç‰‡ã€‚ å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°æ”¹æ¥å£è°ƒç”¨å…·ä½“çš„å›¾ç‰‡åŠ è½½åº“glideæˆ–è€…Picassoï¼Œç„¶åå°†è¯¥å®ç°æ”¾å…¥å¤–å±‚ã€‚ä¸šåŠ¡é€»è¾‘å¯ä»¥ä½¿ç”¨åŠ è½½å›¾ç‰‡åŠŸèƒ½è€Œæ— éœ€çŸ¥é“å®ç°ç»†èŠ‚çš„ä»»ä½•å†…å®¹ã€‚è¿™æ ·æŠµå¾¡äº†å˜åŒ–çš„é£é™©ï¼Œæ—¥åæ¢æˆä»€ä¹ˆæ–¹å¼åŠ è½½å›¾ç‰‡ï¼Œæ´‹è‘±å†…éƒ¨çš„æŠ½è±¡ä¸šåŠ¡é€»è¾‘æ˜¯ä¸ä¼šæ„ŸçŸ¥åˆ°çš„</p><h3 id="3-3-Communication-between-layersï¼ˆå±‚ä¹‹é—´çš„é€šä¿¡ï¼‰"><a href="#3-3-Communication-between-layersï¼ˆå±‚ä¹‹é—´çš„é€šä¿¡ï¼‰" class="headerlink" title="3.3 Communication between layersï¼ˆå±‚ä¹‹é—´çš„é€šä¿¡ï¼‰"></a>3.3 Communication between layersï¼ˆå±‚ä¹‹é—´çš„é€šä¿¡ï¼‰</h3><p>æ—¢ç„¶å·²ç»åˆ’åˆ†å¥½äº†å±‚ï¼Œåˆ†ç¦»äº†å†…å®¹ï¼Œå°†ä¸šåŠ¡é€»è¾‘æ”¾åœ¨åº”ç”¨ç¨‹åºçš„æ¶æ„ä¸­å¿ƒå’Œæ¶æ„è¾¹ç¼˜çš„å®ç°ç»†èŠ‚ä¸­ï¼Œä¸€åˆ‡çœ‹èµ·æ¥éƒ½å¾ˆæ£’ã€‚ ä½†æ˜¯ä½ å¯èƒ½å¾ˆå¿«é‡åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜ã€‚<br>å¦‚æœä½ çš„UIæ˜¯ä¸€ä¸ªå®ç°ç»†èŠ‚ï¼Œé‚£ä¹ˆinternetä¹Ÿæ˜¯ä¸€ä¸ªå®ç°ç»†èŠ‚ï¼Œä¸šåŠ¡é€»è¾‘ä»‹äºä¸¤è€…ä¹‹é—´ï¼Œ<strong>æˆ‘ä»¬å¦‚ä½•ä»internetè·å–æ•°æ®ï¼Œé€šè¿‡ä¸šåŠ¡é€»è¾‘ä¼ é€’å®ƒï¼Œç„¶åå°†å…¶å‘é€åˆ°å±å¹•ï¼Ÿ</strong><br>ç»„åˆå’Œç»§æ‰¿çš„å°±è¦å‘æŒ¥åŠŸæ•ˆäº†</p><p><img src="https://user-gold-cdn.xitu.io/2018/5/15/16364599d7039681?w=665&amp;h=447&amp;f=png&amp;s=107878" alt="" title="image.png"></p><h2 id="4ã€å®è·µ"><a href="#4ã€å®è·µ" class="headerlink" title="4ã€å®è·µ"></a>4ã€å®è·µ</h2><p>ä¸‹é¢ç”¨ä»£ç ç¤ºæ„ä¸€ä¸‹ï¼Œä»¥RSS Reader ä¸ºä¾‹æˆ‘ä»¬çš„ç”¨æˆ·åº”è¯¥èƒ½å¤Ÿç®¡ç†ä»–ä»¬çš„RSSæè¦è®¢é˜…ï¼Œä»æè¦ä¸­è·å–æ–‡ç« å¹¶é˜…è¯»å®ƒä»¬ã€‚è¿™é‡Œæ˜¯æ•°æ®æµé—®é¢˜ï¼Œç”¨ä¾‹ä»‹äºè¡¨ç¤ºå±‚å’Œæ•°æ®å±‚ä¹‹é—´ã€‚ æˆ‘ä»¬å¦‚ä½•å»ºç«‹å±‚ä¹‹é—´çš„æ²Ÿé€šï¼Ÿ è®°ä½é‚£äº›è¾“å…¥å’Œè¾“å‡ºç«¯å£ï¼Ÿ<br><img src="https://user-gold-cdn.xitu.io/2018/5/15/16364599d7eca624?w=888&amp;h=466&amp;f=png&amp;s=49877" alt="" title="image.png"></p><p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºæˆ‘ä»¬çš„ Use Caseå¿…é¡»å®ç°è¾“å…¥ç«¯å£ï¼ˆæ¥å£ï¼‰ã€‚ Presenteråœ¨ Use Caseä¸Šè°ƒç”¨æ–¹æ³•ï¼Œæ•°æ®æµå‘ Use Caseï¼ˆfeedIdï¼‰ã€‚ Use Caseæ˜ å°„feedIdæä¾›æ–‡ç« å¹¶å¸Œæœ›å°†å®ƒä»¬å‘é€å›è¡¨ç¤ºå±‚ã€‚ å®ƒæœ‰ä¸€ä¸ªå¯¹è¾“å‡ºç«¯å£ï¼ˆå›è°ƒï¼‰çš„å¼•ç”¨ï¼Œå› ä¸ºè¾“å‡ºç«¯å£æ˜¯åœ¨åŒä¸€å±‚å®šä¹‰çš„ï¼Œå› æ­¤å®ƒè°ƒç”¨äº†ä¸€ä¸ªæ–¹æ³•ã€‚ å› æ­¤ï¼Œæ•°æ®å‘é€åˆ°è¾“å‡ºç«¯å£ - Presenterã€‚</p><p>è®©æˆ‘ä»¬ä»domainå±‚å¼€å§‹ï¼Œåˆ›å»ºæˆ‘ä»¬çš„æ ¸å¿ƒä¸šåŠ¡æ¨¡å‹å’Œé€»è¾‘ã€‚</p><p>æˆ‘ä»¬çš„å•†ä¸šæ¨¡å¼éå¸¸ç®€å•ï¼š</p><ul><li>Feed - æŒæœ‰RSSæè¦ç›¸å…³æ•°æ®ï¼Œå¦‚ç½‘å€ï¼Œç¼©ç•¥å›¾ç½‘å€ï¼Œæ ‡é¢˜å’Œè¯´æ˜</li><li>Article -ä¿å­˜æ–‡ç« ç›¸å…³æ•°æ®ï¼Œå¦‚æ–‡ç« æ ‡é¢˜ï¼Œç½‘å€å’Œå‘å¸ƒæ—¥æœŸ</li></ul><p>æˆ‘ä»¬çš„é€»è¾‘ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨UseCasesã€‚ ä»–ä»¬åœ¨ç®€æ´çš„ç±»ä¸­å°è£…äº†å°éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘ã€‚ ä»–ä»¬éƒ½å°†å®æ–½é€šç”¨çš„UseCase å¥‘çº¦æ¥å£ï¼š  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UseCase</span>&lt;<span class="title">P</span>, <span class="title">R</span>&gt;</span></span><br><span class="line"><span class="class"> </span>&#123;</span><br><span class="line"></span><br><span class="line"> <span class="class"><span class="keyword">interface</span> <span class="title">Callback</span>&lt;<span class="title">R</span>&gt;</span></span><br><span class="line"><span class="class"> </span>&#123;</span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(R return)</span></span>;</span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable throwable)</span></span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">(P parameter, Callback&lt;R&gt;</span></span></span><br><span class="line"><span class="function"><span class="params"> callback)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CompletableUseCase</span>&lt;<span class="title">P</span>&gt;</span></span><br><span class="line"><span class="class"> </span>&#123;</span><br><span class="line"></span><br><span class="line"> <span class="class"><span class="keyword">interface</span> <span class="title">Callback</span> </span>&#123;</span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">()</span></span>;</span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable throwable)</span></span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">(P parameter, Callback callback)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>UseCaseæ¥å£æ˜¯è¾“å…¥ç«¯å£ï¼ŒCallbackæ¥å£æ˜¯è¾“å‡ºç«¯å£ï¼ŒGetFeedArticlesUseCaseå®ç°å¦‚ä¸‹  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetFeedArticlesUseCase</span> <span class="keyword">implements</span> <span class="title">UseCase</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">Integer</span>, <span class="title">List</span>&lt;<span class="title">Article</span>&gt;&gt;</span></span><br><span class="line"><span class="class"> </span>&#123;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">final</span> FeedRepository feedRepository;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(<span class="keyword">final</span> Integer feedId, <span class="keyword">final</span> Callback&lt;List&lt;Article&gt;&gt;</span></span></span><br><span class="line"><span class="function"><span class="params"> callback)</span> </span>&#123;</span><br><span class="line"> <span class="keyword">try</span> &#123;</span><br><span class="line"> callback.onSuccess(feedRepository.getFeedArticles(feedId));</span><br><span class="line"> &#125; <span class="keyword">catch</span> (<span class="keyword">final</span> Throwable throwable) &#123;</span><br><span class="line"> callback.onError(throwable);</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ°æ´‹è‘±å¤–é¢çš„UIå®ç°ï¼ŒViewæœ‰ä¸€ä¸ªç®€å•çš„å¥‘çº¦ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">View</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">showArticles</span><span class="params">(List&lt;ArticleViewModel&gt;</span></span></span><br><span class="line"><span class="function"><span class="params"> feedArticles)</span></span>;</span><br><span class="line"> </span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">showErrorMessage</span><span class="params">()</span></span>;</span><br><span class="line"> </span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">showLoadingIndicator</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥è§†å›¾çš„Presenterå…·æœ‰éå¸¸ç®€å•çš„æ˜¾ç¤ºé€»è¾‘ã€‚ å®ƒè·å–æ–‡ç« ï¼Œå°†å®ƒä»¬æ˜ å°„åˆ°view odelså¹¶ä¼ é€’åˆ°Viewï¼Œå†çœ‹ä¸‹FeedArticlesPresenterï¼š  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FeedArticlesPresenter</span> <span class="keyword">implements</span> <span class="title">UseCase</span>.<span class="title">Callback</span>&lt;<span class="title">List</span>&lt;<span class="title">Article</span>&gt;&gt;</span></span><br><span class="line"><span class="class"> </span>&#123;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">final</span> GetFeedArticlesUseCase getFeedArticlesUseCase;</span><br><span class="line"> <span class="keyword">private</span> <span class="keyword">final</span> ViewModeMapper viewModelMapper;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fetchFeedItems</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> feedId)</span> </span>&#123;</span><br><span class="line"> getFeedArticlesUseCase.execute(feedId, <span class="keyword">this</span>);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span><span class="params">(<span class="keyword">final</span> List&lt;Article&gt;</span></span></span><br><span class="line"><span class="function"><span class="params"> articles)</span> </span>&#123;</span><br><span class="line"> getView().showArticles(viewModelMapper.mapArticlesToViewModels(articles));</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(<span class="keyword">final</span> Throwable throwable)</span> </span>&#123;</span><br><span class="line"> getView().showErrorMessage();</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œå¯ä»¥çœ‹å‡ºFeedArticlesPresenterå®ç°äº†Callbackæ¥å£ï¼Œå¹¶å°†å…¶è‡ªèº«ä¼ é€’ç»™use caseï¼Œå®ƒå®é™…ä¸Šæ˜¯use caseçš„è¾“å‡ºç«¯å£ï¼Œå¹¶ä»¥è¿™ç§æ–¹å¼å…³é—­äº†æ•°æ®æµ</p><p><img src="https://user-gold-cdn.xitu.io/2018/5/15/16364599d8d3d3ff?w=892&amp;h=472&amp;f=png&amp;s=76180" alt="" title="image.png"></p><p>è°·æ­Œæ¶æ„é¡¹ç›®ä¸Šä¹Ÿæœ‰ä¸ª <a href="https://github.com/googlesamples/android-architecture/tree/todo-mvp-clean/" target="_blank" rel="noopener">todo-mvp-clean</a>åˆ†æ”¯å¯ä»¥çœ‹ä¸‹å…·ä½“ç©æ³•ã€‚</p><h2 id="5ã€å°ç»“"><a href="#5ã€å°ç»“" class="headerlink" title="5ã€å°ç»“"></a>5ã€å°ç»“</h2><p>è¿™ä¸ªè·Ÿè®¾è®¡æ¨¡å¼ä¸­ä¾èµ–å€’ç½®å’Œæ¥å£éš”ç¦»æœ‰ç€å¯†ä¸å¯åˆ†çš„å…³ç³»ï¼Œé€šè¿‡ä¾èµ–å€’ç½®ï¼Œåªä¾èµ–äºæŠ½è±¡è€Œä¸æ˜¯ç»†èŠ‚ï¼Œå°†ç»†èŠ‚çš„å®ç°å€’ç½®åˆ°å®ç°ç±»ä¸­ï¼Œè¿™æ ·æ´‹è‘±çš„æ ¸å¿ƒå°±æ˜¯æ¸…æ¸…çˆ½çˆ½çš„ä¸šåŠ¡é€»è¾‘ï¼ˆæŠ½è±¡ï¼‰ï¼›</p><p>é€šå¸¸ä¸€ä¸ªè‰¯å¥½çš„æ¶æ„ä¸€èˆ¬éœ€è¦æ»¡è¶³ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ol><li>Satisfy a multitude of stakeholders.ï¼ˆæ»¡è¶³å„æ–¹åˆ©ç›Šè€…ï¼‰</li><li>Encourage separation of concerns.ï¼ˆé¼“åŠ±çš„å…³æ³¨ç‚¹åˆ†ç¦»ï¼‰</li><li>Run away from the real world (Android, DB, Internetâ€¦).å³é«˜åº¦çš„æŠ½è±¡</li><li>Enable your components to be testable.ï¼ˆä½¿æ‚¨çš„ç»„ä»¶æˆä¸ºå¯æµ‹è¯•çš„ï¼‰</li></ol><p>ä½†æ˜¯ä¸€ä¸ªæ¶æ„å¾€å¾€é’ˆå¯¹ç‰¹å®šçš„åœºæ™¯ï¼Œæ¶æ„ä¹Ÿæ˜¯éœ€è¦æ…¢æ…¢æ¼”è¿›çš„ï¼Œæ¯”å¦‚åé¢çš„æ¨¡å—åŒ–ã€æ’ä»¶åŒ–ç­‰ç­‰éƒ½æ˜¯ä¸šåŠ¡å‘å±•åˆ°ä¸€å®šç¨‹åº¦ï¼Œå½“å‰æ¶æ„çš„å¼Šç«¯æ…¢æ…¢çš„å‡¸æ˜¾éœ€è¦æ›´æ–°ã€‚ä½†ä¸ç®¡å¦‚ä½•å˜åŒ–ï¼Œä¸€äº›æ ¸å¿ƒåŸºæœ¬ç‚¹è¿˜æ˜¯ç›¸ä¼´ç›¸éšï¼Œæ¯”å¦‚ä¾èµ–ç¿»è½¬ã€é¢å‘æ¥å£ç¼–ç¨‹ã€å…³æ³¨ç‚¹åˆ†ç¦»ç­‰éƒ½æ˜¯æˆ‘ä»¬éœ€è¦ç‚¹äº®çš„æŠ€èƒ½ç‚¹ä¹‹ä¸€ã€‚</p><p>##å‚è€ƒ</p><p>1ã€<a href="http://five.agency/blog/android/" target="_blank" rel="noopener">http://five.agency/blog/android/</a><br>2ã€<a href="http://five.agency/android-architecture-part-1-every-new-beginning-is-hard/" target="_blank" rel="noopener">http://five.agency/android-architecture-part-1-every-new-beginning-is-hard/</a><br>3ã€<a href="http://five.agency/android-architecture-part-2-clean-architecture/" target="_blank" rel="noopener">http://five.agency/android-architecture-part-2-clean-architecture/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h2 id=&quot;1ã€cleanæ¶æ„ç®€ä»‹&quot;&gt;&lt;a href=&quot;#1ã€cleanæ¶æ„ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;1ã€cleanæ¶æ„ç®€ä»‹&quot;&gt;&lt;/a&gt;1ã€c
      
    
    </summary>
    
      <category term="æ¶æ„" scheme="https://xsfelvis.github.io/categories/%E6%9E%B6%E6%9E%84/"/>
    
    
      <category term="clean" scheme="https://xsfelvis.github.io/tags/clean/"/>
    
  </entry>
  
  <entry>
    <title>å‡ ä¸ªæƒé™åº“åˆ†æ</title>
    <link href="https://xsfelvis.github.io/2018/04/21/%E5%8A%A8%E6%80%81%E6%9D%83%E9%99%902%20%E5%87%A0%E4%B8%AA%E6%9D%83%E9%99%90%E5%BA%93%E5%88%86%E6%9E%90/"/>
    <id>https://xsfelvis.github.io/2018/04/21/åŠ¨æ€æƒé™2 å‡ ä¸ªæƒé™åº“åˆ†æ/</id>
    <published>2018-04-20T16:00:00.000Z</published>
    <updated>2018-06-06T07:33:00.094Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>æƒé™ç³»åˆ—</p><ul><li><a href="https://xsfelvis.github.io/2018/04/06/%E5%8A%A8%E6%80%81%E6%9D%83%E9%99%901/">åŠ¨æ€æƒé™åŸºç¡€</a></li><li><a href="https://xsfelvis.github.io/2018/04/21/%E5%8A%A8%E6%80%81%E6%9D%83%E9%99%902%20%E5%87%A0%E4%B8%AA%E6%9D%83%E9%99%90%E5%BA%93%E5%88%86%E6%9E%90/">å‡ ä¸ªæƒé™åº“åˆ†æ</a></li></ul><p>æœ‰æ¯”è¾ƒå¤šçš„æƒé™åº“,ç”±æµ…å…¥æ·±å…ˆçœ‹ç®€å•çš„å¼€å¼€èƒƒ</p><h2 id="PermissionGen"><a href="#PermissionGen" class="headerlink" title="PermissionGen"></a>PermissionGen</h2><h3 id="æ ¸å¿ƒæºç åˆ†æ"><a href="#æ ¸å¿ƒæºç åˆ†æ" class="headerlink" title="æ ¸å¿ƒæºç åˆ†æ"></a>æ ¸å¿ƒæºç åˆ†æ</h3><p><a href="https://github.com/lovedise/PermissionGen" target="_blank" rel="noopener">PermissionGen</a>  </p><p>è¯¥åº“æ¯”è¾ƒæ—© çœ‹æäº¤æ˜¯3å¹´å‰äº† é€šè¿‡çœ‹è¯¥åº“çš„readmeå¯ä»¥äº†è§£è¿™ä¸ªåº“çš„ä½¿ç”¨æ–¹å¼ï¼Œé€šè¿‡é“¾å¼è°ƒç”¨æ¯”è¾ƒæ˜“äºé…ç½®</p><p>æ ¸å¿ƒç±»å›¾å¦‚ä¸‹ï¼š<br><img src="https://user-gold-cdn.xitu.io/2018/5/15/16364446c046e010" alt="" title="image.png"></p><p>å°†æƒé™æ¶‰åŠåˆ°æ ¸å¿ƒapiå°è£…åˆ°æ¡†æ¶ä¹‹ä¸­ï¼Œå¹²æ‰å†—ä½™å‡½æ•°ï¼Œä½¿ç”¨è€…åªå…³å¿ƒåŠŸèƒ½å‡½æ•°å³å¯ã€‚</p><p>æ¶‰åŠåˆ°çš„æ¯”è¾ƒæ ¸å¿ƒçš„ä¸€ä¸ªç‚¹å°±æ˜¯ï¼Œ<code>é€šè¿‡æ³¨è§£çš„æ–¹å¼ç›´æ¥å›è°ƒæƒé™æˆåŠŸã€å¤±è´¥çš„å‡½æ•°</code></p><p>When it succeeded in obtaining permission</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PermissionSuccess</span>(requestCode = <span class="number">100</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;</span><br><span class="line">Toast.makeText(<span class="keyword">this</span>, <span class="string">"Contact permission is granted"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>When it failed in obtaining permission</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PermissionFail</span>(requestCode = <span class="number">100</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFailSomething</span><span class="params">()</span></span>&#123;</span><br><span class="line">Toast.makeText(<span class="keyword">this</span>, <span class="string">"Contact permission is not granted"</span>, t.LENGTH_SHORT).show();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¸å¿ƒçš„å¤„ç†é€»è¾‘åœ¨<code>PermissionGen\#requestPermissions\(Object object, int requestCode, String\[\] permissions\)</code>ä¸­ï¼Œæœ€ç»ˆé€šè¿‡åå°„è°ƒå– PermissionFailå’ŒPermissionSucessæ³¨è§£çš„å‡½æ•°</p><p>é€šè¿‡è¿™ç§æ–¹å¼å¹²æ‰äº†å†—ä½™ä»£ç ï¼Œè®©ç”¨æˆ·ä¸“æ³¨äºä¸šåŠ¡çš„å¼€å‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">requestPermissions</span><span class="params">(Object object, <span class="keyword">int</span> requestCode, String[] permissions)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!Utils.isOverMarshmallow()) &#123;</span><br><span class="line">      doExecuteSuccess(object, requestCode);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;String&gt; deniedPermissions = Utils.findDeniedPermissions(getActivity(object), permissions);</span><br><span class="line">    <span class="keyword">if</span>(deniedPermissions.size() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">      <span class="keyword">if</span>(object <span class="keyword">instanceof</span> Activity)&#123;</span><br><span class="line">        ((Activity)object).requestPermissions(deniedPermissions.toArray(<span class="keyword">new</span> String[deniedPermissions.size()]), requestCode);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span>(object <span class="keyword">instanceof</span> Fragment)&#123;</span><br><span class="line">        ((Fragment)object).requestPermissions(deniedPermissions.toArray(<span class="keyword">new</span> String[deniedPermissions.size()]), requestCode);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(object.getClass().getName() + <span class="string">" is not supported"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      doExecuteSuccess(object, requestCode);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">executeMethod</span><span class="params">(Object activity, Method executeMethod)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(executeMethod != <span class="keyword">null</span>)&#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(!executeMethod.isAccessible()) executeMethod.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        executeMethod.invoke(activity, <span class="keyword">null</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">      &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºåå°„å‡½æ•°åªèƒ½æ— å‚å‡½æ•° å…¶ä¸­æ‹¿åˆ°activityæˆ–è€…fragmentçš„æ³¨è§£æ–¹æ³•åœ¨Utilsçš„æ–¹æ³•ä¸­ï¼Œè¿™é‡Œå¯ä»¥å­¦ä¹ ä¸€ä¸‹åå°„çš„ä¸€äº›ç”¨æ³•ï¼Œæ¯”å¦‚æŸ¥æ‰¾å¯¹åº”æ³¨è§£çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;A extends Annotation&gt; <span class="function">Method <span class="title">findMethodWithRequestCode</span><span class="params">(Class clazz,</span></span></span><br><span class="line"><span class="function"><span class="params">      Class&lt;A&gt; annotation, <span class="keyword">int</span> requestCode)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(Method method : clazz.getDeclaredMethods())&#123;</span><br><span class="line">      <span class="keyword">if</span>(method.isAnnotationPresent(annotation))&#123;</span><br><span class="line">        <span class="keyword">if</span>(isEqualRequestCodeFromAnntation(method, annotation, requestCode))&#123;</span><br><span class="line">          <span class="keyword">return</span> method;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="å°ç»“ï¼š"><a href="#å°ç»“ï¼š" class="headerlink" title="å°ç»“ï¼š"></a>å°ç»“ï¼š</h3><p>è¿™ä¸ªåº“æ¯”è¾ƒç®€å•æœ‰ä¸€äº›ä¼˜ç¼ºç‚¹ï¼š<br>ä¼˜ç‚¹ï¼šåˆæ­¥å°è£…äº†æƒé™çš„æ ¸å¿ƒå‡½æ•°çš„ï¼Œçœå»äº†å†—ä½™ä»£ç ï¼›å¯ä»¥å­¦ä¹ åå°„çš„ä¸€äº›ç”¨æ³•</p><p>ç¼ºç‚¹ï¼š</p><p>ï¼ˆ1ï¼‰å¤§é‡ä½¿ç”¨åå°„ï¼ˆå¯ä»¥ä½¿ç”¨aptï¼‰ï¼Œ</p><p>ï¼ˆ2ï¼‰apiè®¾è®¡ä¸æ˜¯å¾ˆåˆç†</p><p> é“¾å¼è°ƒç”¨å¾€å¾€æ˜¯å¹³çº§è°ƒç”¨æ–¹æ³•ï¼Œä½†æ˜¯ç°åœ¨è¿™ä¸ªæ˜æ˜¾æ˜¯æœ‰å…ˆåé¡ºåºçš„ï¼Œä¸€ä¸ç•™ç¥å®¹æ˜“å†™é”™</p><h2 id="MPermissions"><a href="#MPermissions" class="headerlink" title="MPermissions"></a>MPermissions</h2><p><a href="https://github.com/hongyangAndroid/MPermissions" target="_blank" rel="noopener">MPermissions</a></p><p>è¿™ä¸ªæ˜¯é¸¿æ´‹åœ¨PermissionGenåŸºç¡€ä¸Šåšäº†ä¸€äº›ä¼˜åŒ–ï¼Œä½œè€…è¯´æ˜¯ä½¿ç”¨aptè§£å†³äº†è¿è¡Œæ—¶åå°„çš„é—®é¢˜ï¼Œä¼˜åŒ–äº†å¯¹å¤–æä¾›çš„apiï¼Œå› ä¸ºç”³è¯·åªéœ€è¦ä¸‰ä¸ªå‚æ•°ï¼ŒæŠ›å¼ƒäº†ä½¿ç”¨åŸæœ¬ç±»åº“çš„å•ä¾‹çš„æ–¹å¼ï¼Œç›´æ¥ä¸€ä¸ªå‡ ä¸ªé™æ€æ–¹æ³•ï¼Œç®€å•æ•´æ´æš´åŠ›ã€‚</p><p>çœ‹äº†ä¸€ä¸‹ä»£ç ï¼Œä¸»è¦æ˜¯æ ¸å¿ƒç±»MPermissionsæ“ä½œæ¥å£ï¼Œé—´æ¥æ“ä½œå®ç°è¯¥æ¥å£çš„APTç”Ÿæˆç±»(ä¾èµ–ç¿»è½¬ï¼Œé¢å‘æ¥å£ç¼–ç¨‹)</p><p><img src="https://user-gold-cdn.xitu.io/2018/5/15/16364446c11d972d" alt="" title="image.png"></p><p>å¯ä»¥å­¦ä¹ çš„ä¸€äº›ç‚¹ï¼š</p><h4 id="2-1-APT-ç¼–è¯‘å‰æ‰¾ä¸åˆ°ç±»"><a href="#2-1-APT-ç¼–è¯‘å‰æ‰¾ä¸åˆ°ç±»" class="headerlink" title="2.1 APT ç¼–è¯‘å‰æ‰¾ä¸åˆ°ç±»"></a>2.1 APT ç¼–è¯‘å‰æ‰¾ä¸åˆ°ç±»</h4><p>é¢å‘æ¥å£ç¼–ç¨‹ï¼ŒAPTä»£ç ç”Ÿæˆä»£ç å®ç°è¿™ä¸ªæ¥å£å°±å¯ä»¥ï¼Œ</p><p>æƒé™ç±»çš„æ ¸å¿ƒèƒ½åŠ›é€šè¿‡æ¥å£æä¾›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PermissionProxy</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">grant</span><span class="params">(T source, <span class="keyword">int</span> requestCode)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">denied</span><span class="params">(T source, <span class="keyword">int</span> requestCode)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rationale</span><span class="params">(T source, <span class="keyword">int</span> requestCode)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">needShowRationale</span><span class="params">(<span class="keyword">int</span> requestCode)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠŸèƒ½ç±»è·Ÿæ¥å£å±‚äº¤äº’å³å¯</p><h4 id="2-2-APTæŠ€æœ¯"><a href="#2-2-APTæŠ€æœ¯" class="headerlink" title="2.2 APTæŠ€æœ¯"></a>2.2 APTæŠ€æœ¯</h4><p>é€šè¿‡APTç”Ÿæˆä¸€äº›é‡å¤çš„æ¨¡æ¿ä»£ç éå¸¸æœ‰ç”¨ï¼Œå…³äºAPTæŠ€æœ¯åœ¨ä¹‹å‰çš„åšå®¢å¤šæœ‰æåŠå°±ä¸å†èµ˜è¿°äº†ã€‚<br>ä¸è¿‡APTä¹Ÿæœ‰å®ƒçš„å¼Šç«¯å°±æ˜¯APT çš„å·¥ä½œåŸç†æ˜¯åœ¨ç¼–è¯‘ class æ—¶ï¼Œé€šè¿‡ Annotation ç”Ÿæˆæºä»£ç ï¼Œè€Œåœ¨ Android æ„å»ºçš„è¿‡ç¨‹ä¸­ï¼Œåƒ æ»´æ»´å‡ºè¡Œä¹˜å®¢ç«¯ è¿™æ ·çš„é›†æˆæ–¹å¼ï¼Œæ‰€æœ‰çš„æ¨¡å—éƒ½æ˜¯ AAR çš„æ–¹å¼æ¥é›†æˆæ„å»ºçš„ï¼Œæ²¡æœ‰æœºä¼šå»åŒæ—¶ç¼–è¯‘æ‰€æœ‰çš„ classï¼Œè¿™æ—¶å€™å°±éœ€è¦æ–°çš„æ‰‹æ®µæ¥ç”Ÿæˆä»£ç äº†ï¼Œæ¯”å¦‚æ„å»ºgradleçš„taskåœ¨ç¼–è¯‘å‰æ‰«æå…¨å±€ç»“åˆjavapoetç”Ÿæˆä»£ç ï¼Œåœ¨è¿™ä¸ªåº“é‡Œå¯ä»¥å­¦ä¹ ä¸€ä¸‹apt processorçš„å¼‚å¸¸å¤„ç†æœ‰åŠ©äºæˆ‘ä»¬å®šä½ä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">private void error(Element element, String message, Object... args) &#123;</span><br><span class="line">    if (args.length &gt; 0) &#123;</span><br><span class="line">        message = String.format(message, args);</span><br><span class="line">    &#125;</span><br><span class="line">    processingEnv.getMessager().printMessage(Diagnostic.Kind.NOTE, message, element);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h4><p>ä½œè€…ä»…ä»…æ˜¯é€šè¿‡APTç”Ÿæˆäº†æ¨¡æ¿ä»£ç ï¼Œä½†æ˜¯è¿˜æ˜¯ä½¿ç”¨åˆ°åå°„ç”Ÿæˆå®ç°ä»£ç†æ¥å£çš„å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> PermissionProxy <span class="title">findPermissionProxy</span><span class="params">(Object activity)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Class clazz = activity.getClass();</span><br><span class="line">        Class injectorClazz = Class.forName(clazz.getName() + SUFFIX);</span><br><span class="line">        <span class="keyword">return</span> (PermissionProxy) injectorClazz.newInstance();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(String.format(<span class="string">"can not find %s , something when compiler."</span>, activity.getClass().getSimpleName() + SUFFIX));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªAPTä»£ç†çš„æ€æƒ³è¿˜æ˜¯å€¼å¾—æˆ‘ä»¬å»å€Ÿé‰´çš„</p><h2 id="PermissionsDispatcher"><a href="#PermissionsDispatcher" class="headerlink" title="PermissionsDispatcher"></a>PermissionsDispatcher</h2><p>è¿™ä¸ªåº“ç›®å‰æœ‰7726ä¸ªstartï¼Œè€Œä¸”æœ‰è‡ªå·±çš„<a href="https://permissions-dispatcher.github.io/PermissionsDispatcher/" target="_blank" rel="noopener">ç½‘ç«™</a>æŒ‡å¯¼è¯´æ˜ï¼Œä¿¨ç„¶æ˜¯åŠ¨æ€æƒé™ä¸‰æ–¹åº“çš„ä¸€å“¥ï¼Œçœ‹æ¥è¿™ä¸ªåº“éœ€è¦å¥½å¥½åˆ†æä¸€ä¸‹</p><p>ä»å®˜æ–¹è¿™ä¸ªåº“ä½¿ç”¨èµ·æ¥ä¹Ÿéå¸¸ç®€å•ï¼Œä»”ç»†çœ‹äº†ä¸‹ä»£ç å‘ç°å¤§åŒå°å¼‚ï¼Œè·Ÿå‰é¢ä¸¤ä¸ªåº“ä½¿ç”¨çš„æ–¹å¼å¾ˆåƒï¼Œé€šè¿‡æ³¨è§£çš„æ–¹å¼æ ‡è®° æƒé™ç”³è¯·æˆåŠŸã€æƒé™äº‹æƒ…å¤±è´¥ã€æƒé™å¼¹çª—è¯´æ˜ç­‰å‡½æ•°è°ƒç”¨ï¼Œå”¯ä¸€å¤šçš„æ˜¯ï¼š</p><p>1ã€éœ€è¦ä½¿ç”¨åŠ¨æ€æƒçš„ <code>Activity</code> or <code>Fragment</code>(we support both) to handle permissionsåŠ ä¸ŠRuntimePermissionsæ³¨è§£</p><p>è¿™ä¸ªåº“æ›´å¤šæ˜¯å°†æ‰€æœ‰çš„é€»è¾‘å¤„ç†æ”¾åœ¨äº†æƒé™ç”Ÿæˆç±» xxxPermissionDispatcherç±»ï¼Œï¼ˆç”Ÿæˆä»£ç æ‰¿æ‹…äº†å¾ˆå¤šçš„é€»è¾‘å¤„ç†ï¼‰è€Œä¸åƒMPermissionåº“ä¸­ä»…ä»…å°†ç”¨æˆ·ä½¿ç”¨çš„åŠŸèƒ½ä»£ç ï¼Œæ¯”å¦‚æƒé™æˆåŠŸã€å¤±è´¥ä¹‹ç±»çš„å‡½æ•°è§„æ•´åˆ°ç”Ÿæˆç±»ä¸­ï¼Œæ ¸å¿ƒé€»è¾‘è¿˜æ˜¯é€šè¿‡å¼€å‘è€…è‡ªå·±ä»£ç å¤„ç†ï¼Œè¿™æ ·æ›´å®¹æ˜“å†™è¿™ä¸ªåº“ï¼Œç”¨æˆ·é˜…è¯»ä»£ç ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿</p><p>ä¸ªäººæ›´åŠ å€¾å‘äº MPermission</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;p&gt;æƒé™ç³»åˆ—&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://xsfelvis.github.io/2018/04/06/%E5%8A%A8%E6%80%81%E6%
      
    
    </summary>
    
      <category term="å¼€æºå­¦ä¹ " scheme="https://xsfelvis.github.io/categories/%E5%BC%80%E6%BA%90%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="æƒé™" scheme="https://xsfelvis.github.io/tags/%E6%9D%83%E9%99%90/"/>
    
  </entry>
  
</feed>
